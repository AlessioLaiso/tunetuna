var vm=Object.defineProperty;var ym=(e,t,n)=>t in e?vm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var On=(e,t,n)=>ym(e,typeof t!="symbol"?t+"":t,n);function wm(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const l in r)if(l!=="default"&&!(l in e)){const o=Object.getOwnPropertyDescriptor(r,l);o&&Object.defineProperty(e,l,o.get?o:{enumerable:!0,get:()=>r[l]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(l){if(l.ep)return;l.ep=!0;const o=n(l);fetch(l.href,o)}})();function Du(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _u={exports:{}},Fl={},$u={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ks=Symbol.for("react.element"),Sm=Symbol.for("react.portal"),Nm=Symbol.for("react.fragment"),jm=Symbol.for("react.strict_mode"),bm=Symbol.for("react.profiler"),Im=Symbol.for("react.provider"),km=Symbol.for("react.context"),Cm=Symbol.for("react.forward_ref"),Am=Symbol.for("react.suspense"),Em=Symbol.for("react.memo"),Pm=Symbol.for("react.lazy"),Zi=Symbol.iterator;function Mm(e){return e===null||typeof e!="object"?null:(e=Zi&&e[Zi]||e["@@iterator"],typeof e=="function"?e:null)}var Fu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Uu=Object.assign,Bu={};function Pr(e,t,n){this.props=e,this.context=t,this.refs=Bu,this.updater=n||Fu}Pr.prototype.isReactComponent={};Pr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Pr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Hu(){}Hu.prototype=Pr.prototype;function Ha(e,t,n){this.props=e,this.context=t,this.refs=Bu,this.updater=n||Fu}var Ga=Ha.prototype=new Hu;Ga.constructor=Ha;Uu(Ga,Pr.prototype);Ga.isPureReactComponent=!0;var ec=Array.isArray,Gu=Object.prototype.hasOwnProperty,Va={current:null},Vu={key:!0,ref:!0,__self:!0,__source:!0};function Qu(e,t,n){var r,l={},o=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)Gu.call(t,r)&&!Vu.hasOwnProperty(r)&&(l[r]=t[r]);var c=arguments.length-2;if(c===1)l.children=n;else if(1<c){for(var i=Array(c),d=0;d<c;d++)i[d]=arguments[d+2];l.children=i}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)l[r]===void 0&&(l[r]=c[r]);return{$$typeof:ks,type:e,key:o,ref:a,props:l,_owner:Va.current}}function Tm(e,t){return{$$typeof:ks,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Qa(e){return typeof e=="object"&&e!==null&&e.$$typeof===ks}function Rm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var tc=/\/+/g;function co(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Rm(""+e.key):t.toString(36)}function nl(e,t,n,r,l){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ks:case Sm:a=!0}}if(a)return a=e,l=l(a),e=r===""?"."+co(a,0):r,ec(l)?(n="",e!=null&&(n=e.replace(tc,"$&/")+"/"),nl(l,t,n,"",function(d){return d})):l!=null&&(Qa(l)&&(l=Tm(l,n+(!l.key||a&&a.key===l.key?"":(""+l.key).replace(tc,"$&/")+"/")+e)),t.push(l)),1;if(a=0,r=r===""?".":r+":",ec(e))for(var c=0;c<e.length;c++){o=e[c];var i=r+co(o,c);a+=nl(o,t,n,i,l)}else if(i=Mm(e),typeof i=="function")for(e=i.call(e),c=0;!(o=e.next()).done;)o=o.value,i=r+co(o,c++),a+=nl(o,t,n,i,l);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Ls(e,t,n){if(e==null)return e;var r=[],l=0;return nl(e,r,"","",function(o){return t.call(n,o,l++)}),r}function Lm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ft={current:null},rl={transition:null},zm={ReactCurrentDispatcher:ft,ReactCurrentBatchConfig:rl,ReactCurrentOwner:Va};function Yu(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Ls,forEach:function(e,t,n){Ls(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ls(e,function(){t++}),t},toArray:function(e){return Ls(e,function(t){return t})||[]},only:function(e){if(!Qa(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=Pr;ke.Fragment=Nm;ke.Profiler=bm;ke.PureComponent=Ha;ke.StrictMode=jm;ke.Suspense=Am;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zm;ke.act=Yu;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Uu({},e.props),l=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=Va.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(i in t)Gu.call(t,i)&&!Vu.hasOwnProperty(i)&&(r[i]=t[i]===void 0&&c!==void 0?c[i]:t[i])}var i=arguments.length-2;if(i===1)r.children=n;else if(1<i){c=Array(i);for(var d=0;d<i;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:ks,type:e.type,key:l,ref:o,props:r,_owner:a}};ke.createContext=function(e){return e={$$typeof:km,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Im,_context:e},e.Consumer=e};ke.createElement=Qu;ke.createFactory=function(e){var t=Qu.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:Cm,render:e}};ke.isValidElement=Qa;ke.lazy=function(e){return{$$typeof:Pm,_payload:{_status:-1,_result:e},_init:Lm}};ke.memo=function(e,t){return{$$typeof:Em,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=rl.transition;rl.transition={};try{e()}finally{rl.transition=t}};ke.unstable_act=Yu;ke.useCallback=function(e,t){return ft.current.useCallback(e,t)};ke.useContext=function(e){return ft.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return ft.current.useDeferredValue(e)};ke.useEffect=function(e,t){return ft.current.useEffect(e,t)};ke.useId=function(){return ft.current.useId()};ke.useImperativeHandle=function(e,t,n){return ft.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return ft.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return ft.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return ft.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return ft.current.useReducer(e,t,n)};ke.useRef=function(e){return ft.current.useRef(e)};ke.useState=function(e){return ft.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return ft.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return ft.current.useTransition()};ke.version="18.3.1";$u.exports=ke;var u=$u.exports;const Ya=Du(u),Om=wm({__proto__:null,default:Ya},[u]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm=u,_m=Symbol.for("react.element"),$m=Symbol.for("react.fragment"),Fm=Object.prototype.hasOwnProperty,Um=Dm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Bm={key:!0,ref:!0,__self:!0,__source:!0};function Wu(e,t,n){var r,l={},o=null,a=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)Fm.call(t,r)&&!Bm.hasOwnProperty(r)&&(l[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)l[r]===void 0&&(l[r]=t[r]);return{$$typeof:_m,type:e,key:o,ref:a,props:l,_owner:Um.current}}Fl.Fragment=$m;Fl.jsx=Wu;Fl.jsxs=Wu;_u.exports=Fl;var s=_u.exports,Qo={},Xu={exports:{}},It={},qu={exports:{}},Ku={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(C,$){var D=C.length;C.push($);e:for(;0<D;){var ae=D-1>>>1,W=C[ae];if(0<l(W,$))C[ae]=$,C[D]=W,D=ae;else break e}}function n(C){return C.length===0?null:C[0]}function r(C){if(C.length===0)return null;var $=C[0],D=C.pop();if(D!==$){C[0]=D;e:for(var ae=0,W=C.length,Ne=W>>>1;ae<Ne;){var he=2*(ae+1)-1,me=C[he],ge=he+1,Se=C[ge];if(0>l(me,D))ge<W&&0>l(Se,me)?(C[ae]=Se,C[ge]=D,ae=ge):(C[ae]=me,C[he]=D,ae=he);else if(ge<W&&0>l(Se,D))C[ae]=Se,C[ge]=D,ae=ge;else break e}}return $}function l(C,$){var D=C.sortIndex-$.sortIndex;return D!==0?D:C.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();e.unstable_now=function(){return a.now()-c}}var i=[],d=[],p=1,h=null,f=3,y=!1,w=!1,g=!1,N=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(C){for(var $=n(d);$!==null;){if($.callback===null)r(d);else if($.startTime<=C)r(d),$.sortIndex=$.expirationTime,t(i,$);else break;$=n(d)}}function S(C){if(g=!1,v(C),!w)if(n(i)!==null)w=!0,K(j);else{var $=n(d);$!==null&&z(S,$.startTime-C)}}function j(C,$){w=!1,g&&(g=!1,x(I),I=-1),y=!0;var D=f;try{for(v($),h=n(i);h!==null&&(!(h.expirationTime>$)||C&&!O());){var ae=h.callback;if(typeof ae=="function"){h.callback=null,f=h.priorityLevel;var W=ae(h.expirationTime<=$);$=e.unstable_now(),typeof W=="function"?h.callback=W:h===n(i)&&r(i),v($)}else r(i);h=n(i)}if(h!==null)var Ne=!0;else{var he=n(d);he!==null&&z(S,he.startTime-$),Ne=!1}return Ne}finally{h=null,f=D,y=!1}}var b=!1,k=null,I=-1,E=5,R=-1;function O(){return!(e.unstable_now()-R<E)}function ne(){if(k!==null){var C=e.unstable_now();R=C;var $=!0;try{$=k(!0,C)}finally{$?oe():(b=!1,k=null)}}else b=!1}var oe;if(typeof m=="function")oe=function(){m(ne)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,Z=F.port2;F.port1.onmessage=ne,oe=function(){Z.postMessage(null)}}else oe=function(){N(ne,0)};function K(C){k=C,b||(b=!0,oe())}function z(C,$){I=N(function(){C(e.unstable_now())},$)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(C){C.callback=null},e.unstable_continueExecution=function(){w||y||(w=!0,K(j))},e.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<C?Math.floor(1e3/C):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(i)},e.unstable_next=function(C){switch(f){case 1:case 2:case 3:var $=3;break;default:$=f}var D=f;f=$;try{return C()}finally{f=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(C,$){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var D=f;f=C;try{return $()}finally{f=D}},e.unstable_scheduleCallback=function(C,$,D){var ae=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?ae+D:ae):D=ae,C){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=D+W,C={id:p++,callback:$,priorityLevel:C,startTime:D,expirationTime:W,sortIndex:-1},D>ae?(C.sortIndex=D,t(d,C),n(i)===null&&C===n(d)&&(g?(x(I),I=-1):g=!0,z(S,D-ae))):(C.sortIndex=W,t(i,C),w||y||(w=!0,K(j))),C},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(C){var $=f;return function(){var D=f;f=$;try{return C.apply(this,arguments)}finally{f=D}}}})(Ku);qu.exports=Ku;var Hm=qu.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gm=u,bt=Hm;function Y(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ju=new Set,ls={};function Zn(e,t){Nr(e,t),Nr(e+"Capture",t)}function Nr(e,t){for(ls[e]=t,e=0;e<t.length;e++)Ju.add(t[e])}var sn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yo=Object.prototype.hasOwnProperty,Vm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,nc={},rc={};function Qm(e){return Yo.call(rc,e)?!0:Yo.call(nc,e)?!1:Vm.test(e)?rc[e]=!0:(nc[e]=!0,!1)}function Ym(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Wm(e,t,n,r){if(t===null||typeof t>"u"||Ym(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function mt(e,t,n,r,l,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var nt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){nt[e]=new mt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];nt[t]=new mt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){nt[e]=new mt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){nt[e]=new mt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){nt[e]=new mt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){nt[e]=new mt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){nt[e]=new mt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){nt[e]=new mt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){nt[e]=new mt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Wa=/[\-:]([a-z])/g;function Xa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Wa,Xa);nt[t]=new mt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Wa,Xa);nt[t]=new mt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Wa,Xa);nt[t]=new mt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){nt[e]=new mt(e,1,!1,e.toLowerCase(),null,!1,!1)});nt.xlinkHref=new mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){nt[e]=new mt(e,1,!1,e.toLowerCase(),null,!0,!0)});function qa(e,t,n,r){var l=nt.hasOwnProperty(t)?nt[t]:null;(l!==null?l.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Wm(t,n,l,r)&&(n=null),r||l===null?Qm(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,r=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var cn=Gm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zs=Symbol.for("react.element"),sr=Symbol.for("react.portal"),lr=Symbol.for("react.fragment"),Ka=Symbol.for("react.strict_mode"),Wo=Symbol.for("react.profiler"),Zu=Symbol.for("react.provider"),ed=Symbol.for("react.context"),Ja=Symbol.for("react.forward_ref"),Xo=Symbol.for("react.suspense"),qo=Symbol.for("react.suspense_list"),Za=Symbol.for("react.memo"),mn=Symbol.for("react.lazy"),td=Symbol.for("react.offscreen"),sc=Symbol.iterator;function Dr(e){return e===null||typeof e!="object"?null:(e=sc&&e[sc]||e["@@iterator"],typeof e=="function"?e:null)}var Fe=Object.assign,uo;function Vr(e){if(uo===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);uo=t&&t[1]||""}return`
`+uo+e}var fo=!1;function mo(e,t){if(!e||fo)return"";fo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var l=d.stack.split(`
`),o=r.stack.split(`
`),a=l.length-1,c=o.length-1;1<=a&&0<=c&&l[a]!==o[c];)c--;for(;1<=a&&0<=c;a--,c--)if(l[a]!==o[c]){if(a!==1||c!==1)do if(a--,c--,0>c||l[a]!==o[c]){var i=`
`+l[a].replace(" at new "," at ");return e.displayName&&i.includes("<anonymous>")&&(i=i.replace("<anonymous>",e.displayName)),i}while(1<=a&&0<=c);break}}}finally{fo=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Vr(e):""}function Xm(e){switch(e.tag){case 5:return Vr(e.type);case 16:return Vr("Lazy");case 13:return Vr("Suspense");case 19:return Vr("SuspenseList");case 0:case 2:case 15:return e=mo(e.type,!1),e;case 11:return e=mo(e.type.render,!1),e;case 1:return e=mo(e.type,!0),e;default:return""}}function Ko(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case lr:return"Fragment";case sr:return"Portal";case Wo:return"Profiler";case Ka:return"StrictMode";case Xo:return"Suspense";case qo:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ed:return(e.displayName||"Context")+".Consumer";case Zu:return(e._context.displayName||"Context")+".Provider";case Ja:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Za:return t=e.displayName||null,t!==null?t:Ko(e.type)||"Memo";case mn:t=e._payload,e=e._init;try{return Ko(e(t))}catch{}}return null}function qm(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ko(t);case 8:return t===Ka?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function En(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function nd(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Km(e){var t=nd(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Os(e){e._valueTracker||(e._valueTracker=Km(e))}function rd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=nd(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function pl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Jo(e,t){var n=t.checked;return Fe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function lc(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=En(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sd(e,t){t=t.checked,t!=null&&qa(e,"checked",t,!1)}function Zo(e,t){sd(e,t);var n=En(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ea(e,t.type,n):t.hasOwnProperty("defaultValue")&&ea(e,t.type,En(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function oc(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function ea(e,t,n){(t!=="number"||pl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Qr=Array.isArray;function gr(e,t,n,r){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&r&&(e[n].defaultSelected=!0)}else{for(n=""+En(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,r&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function ta(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Y(91));return Fe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ac(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Y(92));if(Qr(n)){if(1<n.length)throw Error(Y(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:En(n)}}function ld(e,t){var n=En(t.value),r=En(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function ic(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function od(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function na(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?od(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ds,ad=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ds=Ds||document.createElement("div"),Ds.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ds.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function os(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Xr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jm=["Webkit","ms","Moz","O"];Object.keys(Xr).forEach(function(e){Jm.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Xr[t]=Xr[e]})});function id(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Xr.hasOwnProperty(e)&&Xr[e]?(""+t).trim():t+"px"}function cd(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,l=id(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,l):e[n]=l}}var Zm=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ra(e,t){if(t){if(Zm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Y(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Y(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Y(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Y(62))}}function sa(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var la=null;function ei(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var oa=null,xr=null,vr=null;function cc(e){if(e=Es(e)){if(typeof oa!="function")throw Error(Y(280));var t=e.stateNode;t&&(t=Vl(t),oa(e.stateNode,e.type,t))}}function ud(e){xr?vr?vr.push(e):vr=[e]:xr=e}function dd(){if(xr){var e=xr,t=vr;if(vr=xr=null,cc(e),t)for(e=0;e<t.length;e++)cc(t[e])}}function fd(e,t){return e(t)}function md(){}var ho=!1;function hd(e,t,n){if(ho)return e(t,n);ho=!0;try{return fd(e,t,n)}finally{ho=!1,(xr!==null||vr!==null)&&(md(),dd())}}function as(e,t){var n=e.stateNode;if(n===null)return null;var r=Vl(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Y(231,t,typeof n));return n}var aa=!1;if(sn)try{var _r={};Object.defineProperty(_r,"passive",{get:function(){aa=!0}}),window.addEventListener("test",_r,_r),window.removeEventListener("test",_r,_r)}catch{aa=!1}function eh(e,t,n,r,l,o,a,c,i){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(p){this.onError(p)}}var qr=!1,gl=null,xl=!1,ia=null,th={onError:function(e){qr=!0,gl=e}};function nh(e,t,n,r,l,o,a,c,i){qr=!1,gl=null,eh.apply(th,arguments)}function rh(e,t,n,r,l,o,a,c,i){if(nh.apply(this,arguments),qr){if(qr){var d=gl;qr=!1,gl=null}else throw Error(Y(198));xl||(xl=!0,ia=d)}}function er(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function pd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function uc(e){if(er(e)!==e)throw Error(Y(188))}function sh(e){var t=e.alternate;if(!t){if(t=er(e),t===null)throw Error(Y(188));return t!==e?null:e}for(var n=e,r=t;;){var l=n.return;if(l===null)break;var o=l.alternate;if(o===null){if(r=l.return,r!==null){n=r;continue}break}if(l.child===o.child){for(o=l.child;o;){if(o===n)return uc(l),e;if(o===r)return uc(l),t;o=o.sibling}throw Error(Y(188))}if(n.return!==r.return)n=l,r=o;else{for(var a=!1,c=l.child;c;){if(c===n){a=!0,n=l,r=o;break}if(c===r){a=!0,r=l,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=l;break}if(c===r){a=!0,r=o,n=l;break}c=c.sibling}if(!a)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(n.tag!==3)throw Error(Y(188));return n.stateNode.current===n?e:t}function gd(e){return e=sh(e),e!==null?xd(e):null}function xd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=xd(e);if(t!==null)return t;e=e.sibling}return null}var vd=bt.unstable_scheduleCallback,dc=bt.unstable_cancelCallback,lh=bt.unstable_shouldYield,oh=bt.unstable_requestPaint,Be=bt.unstable_now,ah=bt.unstable_getCurrentPriorityLevel,ti=bt.unstable_ImmediatePriority,yd=bt.unstable_UserBlockingPriority,vl=bt.unstable_NormalPriority,ih=bt.unstable_LowPriority,wd=bt.unstable_IdlePriority,Ul=null,Wt=null;function ch(e){if(Wt&&typeof Wt.onCommitFiberRoot=="function")try{Wt.onCommitFiberRoot(Ul,e,void 0,(e.current.flags&128)===128)}catch{}}var Ut=Math.clz32?Math.clz32:fh,uh=Math.log,dh=Math.LN2;function fh(e){return e>>>=0,e===0?32:31-(uh(e)/dh|0)|0}var _s=64,$s=4194304;function Yr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function yl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,l=e.suspendedLanes,o=e.pingedLanes,a=n&268435455;if(a!==0){var c=a&~l;c!==0?r=Yr(c):(o&=a,o!==0&&(r=Yr(o)))}else a=n&~l,a!==0?r=Yr(a):o!==0&&(r=Yr(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&l)&&(l=r&-r,o=t&-t,l>=o||l===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ut(t),l=1<<n,r|=e[n],t&=~l;return r}function mh(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hh(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,l=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-Ut(o),c=1<<a,i=l[a];i===-1?(!(c&n)||c&r)&&(l[a]=mh(c,t)):i<=t&&(e.expiredLanes|=c),o&=~c}}function ca(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Sd(){var e=_s;return _s<<=1,!(_s&4194240)&&(_s=64),e}function po(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Cs(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ut(t),e[t]=n}function ph(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-Ut(n),o=1<<l;t[l]=0,r[l]=-1,e[l]=-1,n&=~o}}function ni(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ut(n),l=1<<r;l&t|e[r]&t&&(e[r]|=t),n&=~l}}var Me=0;function Nd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jd,ri,bd,Id,kd,ua=!1,Fs=[],wn=null,Sn=null,Nn=null,is=new Map,cs=new Map,pn=[],gh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function fc(e,t){switch(e){case"focusin":case"focusout":wn=null;break;case"dragenter":case"dragleave":Sn=null;break;case"mouseover":case"mouseout":Nn=null;break;case"pointerover":case"pointerout":is.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":cs.delete(t.pointerId)}}function $r(e,t,n,r,l,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[l]},t!==null&&(t=Es(t),t!==null&&ri(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function xh(e,t,n,r,l){switch(t){case"focusin":return wn=$r(wn,e,t,n,r,l),!0;case"dragenter":return Sn=$r(Sn,e,t,n,r,l),!0;case"mouseover":return Nn=$r(Nn,e,t,n,r,l),!0;case"pointerover":var o=l.pointerId;return is.set(o,$r(is.get(o)||null,e,t,n,r,l)),!0;case"gotpointercapture":return o=l.pointerId,cs.set(o,$r(cs.get(o)||null,e,t,n,r,l)),!0}return!1}function Cd(e){var t=$n(e.target);if(t!==null){var n=er(t);if(n!==null){if(t=n.tag,t===13){if(t=pd(n),t!==null){e.blockedOn=t,kd(e.priority,function(){bd(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function sl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=da(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);la=r,n.target.dispatchEvent(r),la=null}else return t=Es(n),t!==null&&ri(t),e.blockedOn=n,!1;t.shift()}return!0}function mc(e,t,n){sl(e)&&n.delete(t)}function vh(){ua=!1,wn!==null&&sl(wn)&&(wn=null),Sn!==null&&sl(Sn)&&(Sn=null),Nn!==null&&sl(Nn)&&(Nn=null),is.forEach(mc),cs.forEach(mc)}function Fr(e,t){e.blockedOn===t&&(e.blockedOn=null,ua||(ua=!0,bt.unstable_scheduleCallback(bt.unstable_NormalPriority,vh)))}function us(e){function t(l){return Fr(l,e)}if(0<Fs.length){Fr(Fs[0],e);for(var n=1;n<Fs.length;n++){var r=Fs[n];r.blockedOn===e&&(r.blockedOn=null)}}for(wn!==null&&Fr(wn,e),Sn!==null&&Fr(Sn,e),Nn!==null&&Fr(Nn,e),is.forEach(t),cs.forEach(t),n=0;n<pn.length;n++)r=pn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<pn.length&&(n=pn[0],n.blockedOn===null);)Cd(n),n.blockedOn===null&&pn.shift()}var yr=cn.ReactCurrentBatchConfig,wl=!0;function yh(e,t,n,r){var l=Me,o=yr.transition;yr.transition=null;try{Me=1,si(e,t,n,r)}finally{Me=l,yr.transition=o}}function wh(e,t,n,r){var l=Me,o=yr.transition;yr.transition=null;try{Me=4,si(e,t,n,r)}finally{Me=l,yr.transition=o}}function si(e,t,n,r){if(wl){var l=da(e,t,n,r);if(l===null)Io(e,t,r,Sl,n),fc(e,r);else if(xh(l,e,t,n,r))r.stopPropagation();else if(fc(e,r),t&4&&-1<gh.indexOf(e)){for(;l!==null;){var o=Es(l);if(o!==null&&jd(o),o=da(e,t,n,r),o===null&&Io(e,t,r,Sl,n),o===l)break;l=o}l!==null&&r.stopPropagation()}else Io(e,t,r,null,n)}}var Sl=null;function da(e,t,n,r){if(Sl=null,e=ei(r),e=$n(e),e!==null)if(t=er(e),t===null)e=null;else if(n=t.tag,n===13){if(e=pd(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Sl=e,null}function Ad(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ah()){case ti:return 1;case yd:return 4;case vl:case ih:return 16;case wd:return 536870912;default:return 16}default:return 16}}var xn=null,li=null,ll=null;function Ed(){if(ll)return ll;var e,t=li,n=t.length,r,l="value"in xn?xn.value:xn.textContent,o=l.length;for(e=0;e<n&&t[e]===l[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===l[o-r];r++);return ll=l.slice(e,1<r?1-r:void 0)}function ol(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Us(){return!0}function hc(){return!1}function kt(e){function t(n,r,l,o,a){this._reactName=n,this._targetInst=l,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Us:hc,this.isPropagationStopped=hc,this}return Fe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Us)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Us)},persist:function(){},isPersistent:Us}),t}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oi=kt(Mr),As=Fe({},Mr,{view:0,detail:0}),Sh=kt(As),go,xo,Ur,Bl=Fe({},As,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ai,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ur&&(Ur&&e.type==="mousemove"?(go=e.screenX-Ur.screenX,xo=e.screenY-Ur.screenY):xo=go=0,Ur=e),go)},movementY:function(e){return"movementY"in e?e.movementY:xo}}),pc=kt(Bl),Nh=Fe({},Bl,{dataTransfer:0}),jh=kt(Nh),bh=Fe({},As,{relatedTarget:0}),vo=kt(bh),Ih=Fe({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),kh=kt(Ih),Ch=Fe({},Mr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ah=kt(Ch),Eh=Fe({},Mr,{data:0}),gc=kt(Eh),Ph={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Th={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rh(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Th[e])?!!t[e]:!1}function ai(){return Rh}var Lh=Fe({},As,{key:function(e){if(e.key){var t=Ph[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ol(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ai,charCode:function(e){return e.type==="keypress"?ol(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ol(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),zh=kt(Lh),Oh=Fe({},Bl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xc=kt(Oh),Dh=Fe({},As,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ai}),_h=kt(Dh),$h=Fe({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Fh=kt($h),Uh=Fe({},Bl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Bh=kt(Uh),Hh=[9,13,27,32],ii=sn&&"CompositionEvent"in window,Kr=null;sn&&"documentMode"in document&&(Kr=document.documentMode);var Gh=sn&&"TextEvent"in window&&!Kr,Pd=sn&&(!ii||Kr&&8<Kr&&11>=Kr),vc=" ",yc=!1;function Md(e,t){switch(e){case"keyup":return Hh.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Td(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var or=!1;function Vh(e,t){switch(e){case"compositionend":return Td(t);case"keypress":return t.which!==32?null:(yc=!0,vc);case"textInput":return e=t.data,e===vc&&yc?null:e;default:return null}}function Qh(e,t){if(or)return e==="compositionend"||!ii&&Md(e,t)?(e=Ed(),ll=li=xn=null,or=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pd&&t.locale!=="ko"?null:t.data;default:return null}}var Yh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Yh[e.type]:t==="textarea"}function Rd(e,t,n,r){ud(r),t=Nl(t,"onChange"),0<t.length&&(n=new oi("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Jr=null,ds=null;function Wh(e){Gd(e,0)}function Hl(e){var t=cr(e);if(rd(t))return e}function Xh(e,t){if(e==="change")return t}var Ld=!1;if(sn){var yo;if(sn){var wo="oninput"in document;if(!wo){var Sc=document.createElement("div");Sc.setAttribute("oninput","return;"),wo=typeof Sc.oninput=="function"}yo=wo}else yo=!1;Ld=yo&&(!document.documentMode||9<document.documentMode)}function Nc(){Jr&&(Jr.detachEvent("onpropertychange",zd),ds=Jr=null)}function zd(e){if(e.propertyName==="value"&&Hl(ds)){var t=[];Rd(t,ds,e,ei(e)),hd(Wh,t)}}function qh(e,t,n){e==="focusin"?(Nc(),Jr=t,ds=n,Jr.attachEvent("onpropertychange",zd)):e==="focusout"&&Nc()}function Kh(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Hl(ds)}function Jh(e,t){if(e==="click")return Hl(t)}function Zh(e,t){if(e==="input"||e==="change")return Hl(t)}function ep(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ht=typeof Object.is=="function"?Object.is:ep;function fs(e,t){if(Ht(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var l=n[r];if(!Yo.call(t,l)||!Ht(e[l],t[l]))return!1}return!0}function jc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function bc(e,t){var n=jc(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jc(n)}}function Od(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Od(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dd(){for(var e=window,t=pl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=pl(e.document)}return t}function ci(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function tp(e){var t=Dd(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Od(n.ownerDocument.documentElement,n)){if(r!==null&&ci(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,o=Math.min(r.start,l);r=r.end===void 0?o:Math.min(r.end,l),!e.extend&&o>r&&(l=r,r=o,o=l),l=bc(n,o);var a=bc(n,r);l&&a&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var np=sn&&"documentMode"in document&&11>=document.documentMode,ar=null,fa=null,Zr=null,ma=!1;function Ic(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ma||ar==null||ar!==pl(r)||(r=ar,"selectionStart"in r&&ci(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Zr&&fs(Zr,r)||(Zr=r,r=Nl(fa,"onSelect"),0<r.length&&(t=new oi("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ar)))}function Bs(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ir={animationend:Bs("Animation","AnimationEnd"),animationiteration:Bs("Animation","AnimationIteration"),animationstart:Bs("Animation","AnimationStart"),transitionend:Bs("Transition","TransitionEnd")},So={},_d={};sn&&(_d=document.createElement("div").style,"AnimationEvent"in window||(delete ir.animationend.animation,delete ir.animationiteration.animation,delete ir.animationstart.animation),"TransitionEvent"in window||delete ir.transitionend.transition);function Gl(e){if(So[e])return So[e];if(!ir[e])return e;var t=ir[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in _d)return So[e]=t[n];return e}var $d=Gl("animationend"),Fd=Gl("animationiteration"),Ud=Gl("animationstart"),Bd=Gl("transitionend"),Hd=new Map,kc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tn(e,t){Hd.set(e,t),Zn(t,[e])}for(var No=0;No<kc.length;No++){var jo=kc[No],rp=jo.toLowerCase(),sp=jo[0].toUpperCase()+jo.slice(1);Tn(rp,"on"+sp)}Tn($d,"onAnimationEnd");Tn(Fd,"onAnimationIteration");Tn(Ud,"onAnimationStart");Tn("dblclick","onDoubleClick");Tn("focusin","onFocus");Tn("focusout","onBlur");Tn(Bd,"onTransitionEnd");Nr("onMouseEnter",["mouseout","mouseover"]);Nr("onMouseLeave",["mouseout","mouseover"]);Nr("onPointerEnter",["pointerout","pointerover"]);Nr("onPointerLeave",["pointerout","pointerover"]);Zn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lp=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wr));function Cc(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,rh(r,t,void 0,e),e.currentTarget=null}function Gd(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],l=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var c=r[a],i=c.instance,d=c.currentTarget;if(c=c.listener,i!==o&&l.isPropagationStopped())break e;Cc(l,c,d),o=i}else for(a=0;a<r.length;a++){if(c=r[a],i=c.instance,d=c.currentTarget,c=c.listener,i!==o&&l.isPropagationStopped())break e;Cc(l,c,d),o=i}}}if(xl)throw e=ia,xl=!1,ia=null,e}function Le(e,t){var n=t[va];n===void 0&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(Vd(t,e,2,!1),n.add(r))}function bo(e,t,n){var r=0;t&&(r|=4),Vd(n,e,r,t)}var Hs="_reactListening"+Math.random().toString(36).slice(2);function ms(e){if(!e[Hs]){e[Hs]=!0,Ju.forEach(function(n){n!=="selectionchange"&&(lp.has(n)||bo(n,!1,e),bo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Hs]||(t[Hs]=!0,bo("selectionchange",!1,t))}}function Vd(e,t,n,r){switch(Ad(t)){case 1:var l=yh;break;case 4:l=wh;break;default:l=si}n=l.bind(null,t,n,e),l=void 0,!aa||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),r?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function Io(e,t,n,r,l){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===l||c.nodeType===8&&c.parentNode===l)break;if(a===4)for(a=r.return;a!==null;){var i=a.tag;if((i===3||i===4)&&(i=a.stateNode.containerInfo,i===l||i.nodeType===8&&i.parentNode===l))return;a=a.return}for(;c!==null;){if(a=$n(c),a===null)return;if(i=a.tag,i===5||i===6){r=o=a;continue e}c=c.parentNode}}r=r.return}hd(function(){var d=o,p=ei(n),h=[];e:{var f=Hd.get(e);if(f!==void 0){var y=oi,w=e;switch(e){case"keypress":if(ol(n)===0)break e;case"keydown":case"keyup":y=zh;break;case"focusin":w="focus",y=vo;break;case"focusout":w="blur",y=vo;break;case"beforeblur":case"afterblur":y=vo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=pc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=jh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=_h;break;case $d:case Fd:case Ud:y=kh;break;case Bd:y=Fh;break;case"scroll":y=Sh;break;case"wheel":y=Bh;break;case"copy":case"cut":case"paste":y=Ah;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=xc}var g=(t&4)!==0,N=!g&&e==="scroll",x=g?f!==null?f+"Capture":null:f;g=[];for(var m=d,v;m!==null;){v=m;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,x!==null&&(S=as(m,x),S!=null&&g.push(hs(m,S,v)))),N)break;m=m.return}0<g.length&&(f=new y(f,w,null,n,p),h.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",y=e==="mouseout"||e==="pointerout",f&&n!==la&&(w=n.relatedTarget||n.fromElement)&&($n(w)||w[ln]))break e;if((y||f)&&(f=p.window===p?p:(f=p.ownerDocument)?f.defaultView||f.parentWindow:window,y?(w=n.relatedTarget||n.toElement,y=d,w=w?$n(w):null,w!==null&&(N=er(w),w!==N||w.tag!==5&&w.tag!==6)&&(w=null)):(y=null,w=d),y!==w)){if(g=pc,S="onMouseLeave",x="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(g=xc,S="onPointerLeave",x="onPointerEnter",m="pointer"),N=y==null?f:cr(y),v=w==null?f:cr(w),f=new g(S,m+"leave",y,n,p),f.target=N,f.relatedTarget=v,S=null,$n(p)===d&&(g=new g(x,m+"enter",w,n,p),g.target=v,g.relatedTarget=N,S=g),N=S,y&&w)t:{for(g=y,x=w,m=0,v=g;v;v=nr(v))m++;for(v=0,S=x;S;S=nr(S))v++;for(;0<m-v;)g=nr(g),m--;for(;0<v-m;)x=nr(x),v--;for(;m--;){if(g===x||x!==null&&g===x.alternate)break t;g=nr(g),x=nr(x)}g=null}else g=null;y!==null&&Ac(h,f,y,g,!1),w!==null&&N!==null&&Ac(h,N,w,g,!0)}}e:{if(f=d?cr(d):window,y=f.nodeName&&f.nodeName.toLowerCase(),y==="select"||y==="input"&&f.type==="file")var j=Xh;else if(wc(f))if(Ld)j=Zh;else{j=Kh;var b=qh}else(y=f.nodeName)&&y.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(j=Jh);if(j&&(j=j(e,d))){Rd(h,j,n,p);break e}b&&b(e,f,d),e==="focusout"&&(b=f._wrapperState)&&b.controlled&&f.type==="number"&&ea(f,"number",f.value)}switch(b=d?cr(d):window,e){case"focusin":(wc(b)||b.contentEditable==="true")&&(ar=b,fa=d,Zr=null);break;case"focusout":Zr=fa=ar=null;break;case"mousedown":ma=!0;break;case"contextmenu":case"mouseup":case"dragend":ma=!1,Ic(h,n,p);break;case"selectionchange":if(np)break;case"keydown":case"keyup":Ic(h,n,p)}var k;if(ii)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else or?Md(e,n)&&(I="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(Pd&&n.locale!=="ko"&&(or||I!=="onCompositionStart"?I==="onCompositionEnd"&&or&&(k=Ed()):(xn=p,li="value"in xn?xn.value:xn.textContent,or=!0)),b=Nl(d,I),0<b.length&&(I=new gc(I,e,null,n,p),h.push({event:I,listeners:b}),k?I.data=k:(k=Td(n),k!==null&&(I.data=k)))),(k=Gh?Vh(e,n):Qh(e,n))&&(d=Nl(d,"onBeforeInput"),0<d.length&&(p=new gc("onBeforeInput","beforeinput",null,n,p),h.push({event:p,listeners:d}),p.data=k))}Gd(h,t)})}function hs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Nl(e,t){for(var n=t+"Capture",r=[];e!==null;){var l=e,o=l.stateNode;l.tag===5&&o!==null&&(l=o,o=as(e,n),o!=null&&r.unshift(hs(e,o,l)),o=as(e,t),o!=null&&r.push(hs(e,o,l))),e=e.return}return r}function nr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ac(e,t,n,r,l){for(var o=t._reactName,a=[];n!==null&&n!==r;){var c=n,i=c.alternate,d=c.stateNode;if(i!==null&&i===r)break;c.tag===5&&d!==null&&(c=d,l?(i=as(n,o),i!=null&&a.unshift(hs(n,i,c))):l||(i=as(n,o),i!=null&&a.push(hs(n,i,c)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var op=/\r\n?/g,ap=/\u0000|\uFFFD/g;function Ec(e){return(typeof e=="string"?e:""+e).replace(op,`
`).replace(ap,"")}function Gs(e,t,n){if(t=Ec(t),Ec(e)!==t&&n)throw Error(Y(425))}function jl(){}var ha=null,pa=null;function ga(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var xa=typeof setTimeout=="function"?setTimeout:void 0,ip=typeof clearTimeout=="function"?clearTimeout:void 0,Pc=typeof Promise=="function"?Promise:void 0,cp=typeof queueMicrotask=="function"?queueMicrotask:typeof Pc<"u"?function(e){return Pc.resolve(null).then(e).catch(up)}:xa;function up(e){setTimeout(function(){throw e})}function ko(e,t){var n=t,r=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(r===0){e.removeChild(l),us(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=l}while(n);us(t)}function jn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Mc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Tr=Math.random().toString(36).slice(2),Yt="__reactFiber$"+Tr,ps="__reactProps$"+Tr,ln="__reactContainer$"+Tr,va="__reactEvents$"+Tr,dp="__reactListeners$"+Tr,fp="__reactHandles$"+Tr;function $n(e){var t=e[Yt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ln]||n[Yt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Mc(e);e!==null;){if(n=e[Yt])return n;e=Mc(e)}return t}e=n,n=e.parentNode}return null}function Es(e){return e=e[Yt]||e[ln],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function cr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Y(33))}function Vl(e){return e[ps]||null}var ya=[],ur=-1;function Rn(e){return{current:e}}function ze(e){0>ur||(e.current=ya[ur],ya[ur]=null,ur--)}function Re(e,t){ur++,ya[ur]=e.current,e.current=t}var Pn={},at=Rn(Pn),xt=Rn(!1),Vn=Pn;function jr(e,t){var n=e.type.contextTypes;if(!n)return Pn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var l={},o;for(o in n)l[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function vt(e){return e=e.childContextTypes,e!=null}function bl(){ze(xt),ze(at)}function Tc(e,t,n){if(at.current!==Pn)throw Error(Y(168));Re(at,t),Re(xt,n)}function Qd(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var l in r)if(!(l in t))throw Error(Y(108,qm(e)||"Unknown",l));return Fe({},n,r)}function Il(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pn,Vn=at.current,Re(at,e),Re(xt,xt.current),!0}function Rc(e,t,n){var r=e.stateNode;if(!r)throw Error(Y(169));n?(e=Qd(e,t,Vn),r.__reactInternalMemoizedMergedChildContext=e,ze(xt),ze(at),Re(at,e)):ze(xt),Re(xt,n)}var Zt=null,Ql=!1,Co=!1;function Yd(e){Zt===null?Zt=[e]:Zt.push(e)}function mp(e){Ql=!0,Yd(e)}function Ln(){if(!Co&&Zt!==null){Co=!0;var e=0,t=Me;try{var n=Zt;for(Me=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Zt=null,Ql=!1}catch(l){throw Zt!==null&&(Zt=Zt.slice(e+1)),vd(ti,Ln),l}finally{Me=t,Co=!1}}return null}var dr=[],fr=0,kl=null,Cl=0,At=[],Et=0,Qn=null,en=1,tn="";function Dn(e,t){dr[fr++]=Cl,dr[fr++]=kl,kl=e,Cl=t}function Wd(e,t,n){At[Et++]=en,At[Et++]=tn,At[Et++]=Qn,Qn=e;var r=en;e=tn;var l=32-Ut(r)-1;r&=~(1<<l),n+=1;var o=32-Ut(t)+l;if(30<o){var a=l-l%5;o=(r&(1<<a)-1).toString(32),r>>=a,l-=a,en=1<<32-Ut(t)+l|n<<l|r,tn=o+e}else en=1<<o|n<<l|r,tn=e}function ui(e){e.return!==null&&(Dn(e,1),Wd(e,1,0))}function di(e){for(;e===kl;)kl=dr[--fr],dr[fr]=null,Cl=dr[--fr],dr[fr]=null;for(;e===Qn;)Qn=At[--Et],At[Et]=null,tn=At[--Et],At[Et]=null,en=At[--Et],At[Et]=null}var jt=null,Nt=null,De=!1,_t=null;function Xd(e,t){var n=Pt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Lc(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,jt=e,Nt=jn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,jt=e,Nt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Qn!==null?{id:en,overflow:tn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Pt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,jt=e,Nt=null,!0):!1;default:return!1}}function wa(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Sa(e){if(De){var t=Nt;if(t){var n=t;if(!Lc(e,t)){if(wa(e))throw Error(Y(418));t=jn(n.nextSibling);var r=jt;t&&Lc(e,t)?Xd(r,n):(e.flags=e.flags&-4097|2,De=!1,jt=e)}}else{if(wa(e))throw Error(Y(418));e.flags=e.flags&-4097|2,De=!1,jt=e}}}function zc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;jt=e}function Vs(e){if(e!==jt)return!1;if(!De)return zc(e),De=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ga(e.type,e.memoizedProps)),t&&(t=Nt)){if(wa(e))throw qd(),Error(Y(418));for(;t;)Xd(e,t),t=jn(t.nextSibling)}if(zc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Y(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Nt=jn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Nt=null}}else Nt=jt?jn(e.stateNode.nextSibling):null;return!0}function qd(){for(var e=Nt;e;)e=jn(e.nextSibling)}function br(){Nt=jt=null,De=!1}function fi(e){_t===null?_t=[e]:_t.push(e)}var hp=cn.ReactCurrentBatchConfig;function Br(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,e));var l=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var c=l.refs;a===null?delete c[o]:c[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error(Y(284));if(!n._owner)throw Error(Y(290,e))}return e}function Qs(e,t){throw e=Object.prototype.toString.call(t),Error(Y(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Oc(e){var t=e._init;return t(e._payload)}function Kd(e){function t(x,m){if(e){var v=x.deletions;v===null?(x.deletions=[m],x.flags|=16):v.push(m)}}function n(x,m){if(!e)return null;for(;m!==null;)t(x,m),m=m.sibling;return null}function r(x,m){for(x=new Map;m!==null;)m.key!==null?x.set(m.key,m):x.set(m.index,m),m=m.sibling;return x}function l(x,m){return x=Cn(x,m),x.index=0,x.sibling=null,x}function o(x,m,v){return x.index=v,e?(v=x.alternate,v!==null?(v=v.index,v<m?(x.flags|=2,m):v):(x.flags|=2,m)):(x.flags|=1048576,m)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function c(x,m,v,S){return m===null||m.tag!==6?(m=Lo(v,x.mode,S),m.return=x,m):(m=l(m,v),m.return=x,m)}function i(x,m,v,S){var j=v.type;return j===lr?p(x,m,v.props.children,S,v.key):m!==null&&(m.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===mn&&Oc(j)===m.type)?(S=l(m,v.props),S.ref=Br(x,m,v),S.return=x,S):(S=ml(v.type,v.key,v.props,null,x.mode,S),S.ref=Br(x,m,v),S.return=x,S)}function d(x,m,v,S){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=zo(v,x.mode,S),m.return=x,m):(m=l(m,v.children||[]),m.return=x,m)}function p(x,m,v,S,j){return m===null||m.tag!==7?(m=Hn(v,x.mode,S,j),m.return=x,m):(m=l(m,v),m.return=x,m)}function h(x,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Lo(""+m,x.mode,v),m.return=x,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case zs:return v=ml(m.type,m.key,m.props,null,x.mode,v),v.ref=Br(x,null,m),v.return=x,v;case sr:return m=zo(m,x.mode,v),m.return=x,m;case mn:var S=m._init;return h(x,S(m._payload),v)}if(Qr(m)||Dr(m))return m=Hn(m,x.mode,v,null),m.return=x,m;Qs(x,m)}return null}function f(x,m,v,S){var j=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return j!==null?null:c(x,m,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case zs:return v.key===j?i(x,m,v,S):null;case sr:return v.key===j?d(x,m,v,S):null;case mn:return j=v._init,f(x,m,j(v._payload),S)}if(Qr(v)||Dr(v))return j!==null?null:p(x,m,v,S,null);Qs(x,v)}return null}function y(x,m,v,S,j){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(v)||null,c(m,x,""+S,j);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case zs:return x=x.get(S.key===null?v:S.key)||null,i(m,x,S,j);case sr:return x=x.get(S.key===null?v:S.key)||null,d(m,x,S,j);case mn:var b=S._init;return y(x,m,v,b(S._payload),j)}if(Qr(S)||Dr(S))return x=x.get(v)||null,p(m,x,S,j,null);Qs(m,S)}return null}function w(x,m,v,S){for(var j=null,b=null,k=m,I=m=0,E=null;k!==null&&I<v.length;I++){k.index>I?(E=k,k=null):E=k.sibling;var R=f(x,k,v[I],S);if(R===null){k===null&&(k=E);break}e&&k&&R.alternate===null&&t(x,k),m=o(R,m,I),b===null?j=R:b.sibling=R,b=R,k=E}if(I===v.length)return n(x,k),De&&Dn(x,I),j;if(k===null){for(;I<v.length;I++)k=h(x,v[I],S),k!==null&&(m=o(k,m,I),b===null?j=k:b.sibling=k,b=k);return De&&Dn(x,I),j}for(k=r(x,k);I<v.length;I++)E=y(k,x,I,v[I],S),E!==null&&(e&&E.alternate!==null&&k.delete(E.key===null?I:E.key),m=o(E,m,I),b===null?j=E:b.sibling=E,b=E);return e&&k.forEach(function(O){return t(x,O)}),De&&Dn(x,I),j}function g(x,m,v,S){var j=Dr(v);if(typeof j!="function")throw Error(Y(150));if(v=j.call(v),v==null)throw Error(Y(151));for(var b=j=null,k=m,I=m=0,E=null,R=v.next();k!==null&&!R.done;I++,R=v.next()){k.index>I?(E=k,k=null):E=k.sibling;var O=f(x,k,R.value,S);if(O===null){k===null&&(k=E);break}e&&k&&O.alternate===null&&t(x,k),m=o(O,m,I),b===null?j=O:b.sibling=O,b=O,k=E}if(R.done)return n(x,k),De&&Dn(x,I),j;if(k===null){for(;!R.done;I++,R=v.next())R=h(x,R.value,S),R!==null&&(m=o(R,m,I),b===null?j=R:b.sibling=R,b=R);return De&&Dn(x,I),j}for(k=r(x,k);!R.done;I++,R=v.next())R=y(k,x,I,R.value,S),R!==null&&(e&&R.alternate!==null&&k.delete(R.key===null?I:R.key),m=o(R,m,I),b===null?j=R:b.sibling=R,b=R);return e&&k.forEach(function(ne){return t(x,ne)}),De&&Dn(x,I),j}function N(x,m,v,S){if(typeof v=="object"&&v!==null&&v.type===lr&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case zs:e:{for(var j=v.key,b=m;b!==null;){if(b.key===j){if(j=v.type,j===lr){if(b.tag===7){n(x,b.sibling),m=l(b,v.props.children),m.return=x,x=m;break e}}else if(b.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===mn&&Oc(j)===b.type){n(x,b.sibling),m=l(b,v.props),m.ref=Br(x,b,v),m.return=x,x=m;break e}n(x,b);break}else t(x,b);b=b.sibling}v.type===lr?(m=Hn(v.props.children,x.mode,S,v.key),m.return=x,x=m):(S=ml(v.type,v.key,v.props,null,x.mode,S),S.ref=Br(x,m,v),S.return=x,x=S)}return a(x);case sr:e:{for(b=v.key;m!==null;){if(m.key===b)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){n(x,m.sibling),m=l(m,v.children||[]),m.return=x,x=m;break e}else{n(x,m);break}else t(x,m);m=m.sibling}m=zo(v,x.mode,S),m.return=x,x=m}return a(x);case mn:return b=v._init,N(x,m,b(v._payload),S)}if(Qr(v))return w(x,m,v,S);if(Dr(v))return g(x,m,v,S);Qs(x,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(n(x,m.sibling),m=l(m,v),m.return=x,x=m):(n(x,m),m=Lo(v,x.mode,S),m.return=x,x=m),a(x)):n(x,m)}return N}var Ir=Kd(!0),Jd=Kd(!1),Al=Rn(null),El=null,mr=null,mi=null;function hi(){mi=mr=El=null}function pi(e){var t=Al.current;ze(Al),e._currentValue=t}function Na(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function wr(e,t){El=e,mi=mr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(gt=!0),e.firstContext=null)}function Rt(e){var t=e._currentValue;if(mi!==e)if(e={context:e,memoizedValue:t,next:null},mr===null){if(El===null)throw Error(Y(308));mr=e,El.dependencies={lanes:0,firstContext:e}}else mr=mr.next=e;return t}var Fn=null;function gi(e){Fn===null?Fn=[e]:Fn.push(e)}function Zd(e,t,n,r){var l=t.interleaved;return l===null?(n.next=n,gi(t)):(n.next=l.next,l.next=n),t.interleaved=n,on(e,r)}function on(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var hn=!1;function xi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ef(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function nn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function bn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ee&2){var l=r.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),r.pending=t,on(e,n)}return l=r.interleaved,l===null?(t.next=t,gi(r)):(t.next=l.next,l.next=t),r.interleaved=t,on(e,n)}function al(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ni(e,n)}}function Dc(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var l=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?l=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?l=o=t:o=o.next=t}else l=o=t;n={baseState:r.baseState,firstBaseUpdate:l,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Pl(e,t,n,r){var l=e.updateQueue;hn=!1;var o=l.firstBaseUpdate,a=l.lastBaseUpdate,c=l.shared.pending;if(c!==null){l.shared.pending=null;var i=c,d=i.next;i.next=null,a===null?o=d:a.next=d,a=i;var p=e.alternate;p!==null&&(p=p.updateQueue,c=p.lastBaseUpdate,c!==a&&(c===null?p.firstBaseUpdate=d:c.next=d,p.lastBaseUpdate=i))}if(o!==null){var h=l.baseState;a=0,p=d=i=null,c=o;do{var f=c.lane,y=c.eventTime;if((r&f)===f){p!==null&&(p=p.next={eventTime:y,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=e,g=c;switch(f=t,y=n,g.tag){case 1:if(w=g.payload,typeof w=="function"){h=w.call(y,h,f);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=g.payload,f=typeof w=="function"?w.call(y,h,f):w,f==null)break e;h=Fe({},h,f);break e;case 2:hn=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,f=l.effects,f===null?l.effects=[c]:f.push(c))}else y={eventTime:y,lane:f,tag:c.tag,payload:c.payload,callback:c.callback,next:null},p===null?(d=p=y,i=h):p=p.next=y,a|=f;if(c=c.next,c===null){if(c=l.shared.pending,c===null)break;f=c,c=f.next,f.next=null,l.lastBaseUpdate=f,l.shared.pending=null}}while(!0);if(p===null&&(i=h),l.baseState=i,l.firstBaseUpdate=d,l.lastBaseUpdate=p,t=l.shared.interleaved,t!==null){l=t;do a|=l.lane,l=l.next;while(l!==t)}else o===null&&(l.shared.lanes=0);Wn|=a,e.lanes=a,e.memoizedState=h}}function _c(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],l=r.callback;if(l!==null){if(r.callback=null,r=n,typeof l!="function")throw Error(Y(191,l));l.call(r)}}}var Ps={},Xt=Rn(Ps),gs=Rn(Ps),xs=Rn(Ps);function Un(e){if(e===Ps)throw Error(Y(174));return e}function vi(e,t){switch(Re(xs,t),Re(gs,e),Re(Xt,Ps),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:na(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=na(t,e)}ze(Xt),Re(Xt,t)}function kr(){ze(Xt),ze(gs),ze(xs)}function tf(e){Un(xs.current);var t=Un(Xt.current),n=na(t,e.type);t!==n&&(Re(gs,e),Re(Xt,n))}function yi(e){gs.current===e&&(ze(Xt),ze(gs))}var _e=Rn(0);function Ml(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ao=[];function wi(){for(var e=0;e<Ao.length;e++)Ao[e]._workInProgressVersionPrimary=null;Ao.length=0}var il=cn.ReactCurrentDispatcher,Eo=cn.ReactCurrentBatchConfig,Yn=0,$e=null,Qe=null,Ke=null,Tl=!1,es=!1,vs=0,pp=0;function st(){throw Error(Y(321))}function Si(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ht(e[n],t[n]))return!1;return!0}function Ni(e,t,n,r,l,o){if(Yn=o,$e=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,il.current=e===null||e.memoizedState===null?yp:wp,e=n(r,l),es){o=0;do{if(es=!1,vs=0,25<=o)throw Error(Y(301));o+=1,Ke=Qe=null,t.updateQueue=null,il.current=Sp,e=n(r,l)}while(es)}if(il.current=Rl,t=Qe!==null&&Qe.next!==null,Yn=0,Ke=Qe=$e=null,Tl=!1,t)throw Error(Y(300));return e}function ji(){var e=vs!==0;return vs=0,e}function Qt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ke===null?$e.memoizedState=Ke=e:Ke=Ke.next=e,Ke}function Lt(){if(Qe===null){var e=$e.alternate;e=e!==null?e.memoizedState:null}else e=Qe.next;var t=Ke===null?$e.memoizedState:Ke.next;if(t!==null)Ke=t,Qe=e;else{if(e===null)throw Error(Y(310));Qe=e,e={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},Ke===null?$e.memoizedState=Ke=e:Ke=Ke.next=e}return Ke}function ys(e,t){return typeof t=="function"?t(e):t}function Po(e){var t=Lt(),n=t.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=e;var r=Qe,l=r.baseQueue,o=n.pending;if(o!==null){if(l!==null){var a=l.next;l.next=o.next,o.next=a}r.baseQueue=l=o,n.pending=null}if(l!==null){o=l.next,r=r.baseState;var c=a=null,i=null,d=o;do{var p=d.lane;if((Yn&p)===p)i!==null&&(i=i.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:p,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};i===null?(c=i=h,a=r):i=i.next=h,$e.lanes|=p,Wn|=p}d=d.next}while(d!==null&&d!==o);i===null?a=r:i.next=c,Ht(r,t.memoizedState)||(gt=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=i,n.lastRenderedState=r}if(e=n.interleaved,e!==null){l=e;do o=l.lane,$e.lanes|=o,Wn|=o,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Mo(e){var t=Lt(),n=t.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=e;var r=n.dispatch,l=n.pending,o=t.memoizedState;if(l!==null){n.pending=null;var a=l=l.next;do o=e(o,a.action),a=a.next;while(a!==l);Ht(o,t.memoizedState)||(gt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function nf(){}function rf(e,t){var n=$e,r=Lt(),l=t(),o=!Ht(r.memoizedState,l);if(o&&(r.memoizedState=l,gt=!0),r=r.queue,bi(of.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Ke!==null&&Ke.memoizedState.tag&1){if(n.flags|=2048,ws(9,lf.bind(null,n,r,l,t),void 0,null),Je===null)throw Error(Y(349));Yn&30||sf(n,t,l)}return l}function sf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=$e.updateQueue,t===null?(t={lastEffect:null,stores:null},$e.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function lf(e,t,n,r){t.value=n,t.getSnapshot=r,af(t)&&cf(e)}function of(e,t,n){return n(function(){af(t)&&cf(e)})}function af(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ht(e,n)}catch{return!0}}function cf(e){var t=on(e,1);t!==null&&Bt(t,e,1,-1)}function $c(e){var t=Qt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ys,lastRenderedState:e},t.queue=e,e=e.dispatch=vp.bind(null,$e,e),[t.memoizedState,e]}function ws(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=$e.updateQueue,t===null?(t={lastEffect:null,stores:null},$e.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function uf(){return Lt().memoizedState}function cl(e,t,n,r){var l=Qt();$e.flags|=e,l.memoizedState=ws(1|t,n,void 0,r===void 0?null:r)}function Yl(e,t,n,r){var l=Lt();r=r===void 0?null:r;var o=void 0;if(Qe!==null){var a=Qe.memoizedState;if(o=a.destroy,r!==null&&Si(r,a.deps)){l.memoizedState=ws(t,n,o,r);return}}$e.flags|=e,l.memoizedState=ws(1|t,n,o,r)}function Fc(e,t){return cl(8390656,8,e,t)}function bi(e,t){return Yl(2048,8,e,t)}function df(e,t){return Yl(4,2,e,t)}function ff(e,t){return Yl(4,4,e,t)}function mf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hf(e,t,n){return n=n!=null?n.concat([e]):null,Yl(4,4,mf.bind(null,t,e),n)}function Ii(){}function pf(e,t){var n=Lt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Si(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function gf(e,t){var n=Lt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Si(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function xf(e,t,n){return Yn&21?(Ht(n,t)||(n=Sd(),$e.lanes|=n,Wn|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,gt=!0),e.memoizedState=n)}function gp(e,t){var n=Me;Me=n!==0&&4>n?n:4,e(!0);var r=Eo.transition;Eo.transition={};try{e(!1),t()}finally{Me=n,Eo.transition=r}}function vf(){return Lt().memoizedState}function xp(e,t,n){var r=kn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},yf(e))wf(t,n);else if(n=Zd(e,t,n,r),n!==null){var l=dt();Bt(n,e,r,l),Sf(n,t,r)}}function vp(e,t,n){var r=kn(e),l={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(yf(e))wf(t,l);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,c=o(a,n);if(l.hasEagerState=!0,l.eagerState=c,Ht(c,a)){var i=t.interleaved;i===null?(l.next=l,gi(t)):(l.next=i.next,i.next=l),t.interleaved=l;return}}catch{}finally{}n=Zd(e,t,l,r),n!==null&&(l=dt(),Bt(n,e,r,l),Sf(n,t,r))}}function yf(e){var t=e.alternate;return e===$e||t!==null&&t===$e}function wf(e,t){es=Tl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Sf(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ni(e,n)}}var Rl={readContext:Rt,useCallback:st,useContext:st,useEffect:st,useImperativeHandle:st,useInsertionEffect:st,useLayoutEffect:st,useMemo:st,useReducer:st,useRef:st,useState:st,useDebugValue:st,useDeferredValue:st,useTransition:st,useMutableSource:st,useSyncExternalStore:st,useId:st,unstable_isNewReconciler:!1},yp={readContext:Rt,useCallback:function(e,t){return Qt().memoizedState=[e,t===void 0?null:t],e},useContext:Rt,useEffect:Fc,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,cl(4194308,4,mf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return cl(4194308,4,e,t)},useInsertionEffect:function(e,t){return cl(4,2,e,t)},useMemo:function(e,t){var n=Qt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Qt();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=xp.bind(null,$e,e),[r.memoizedState,e]},useRef:function(e){var t=Qt();return e={current:e},t.memoizedState=e},useState:$c,useDebugValue:Ii,useDeferredValue:function(e){return Qt().memoizedState=e},useTransition:function(){var e=$c(!1),t=e[0];return e=gp.bind(null,e[1]),Qt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=$e,l=Qt();if(De){if(n===void 0)throw Error(Y(407));n=n()}else{if(n=t(),Je===null)throw Error(Y(349));Yn&30||sf(r,t,n)}l.memoizedState=n;var o={value:n,getSnapshot:t};return l.queue=o,Fc(of.bind(null,r,o,e),[e]),r.flags|=2048,ws(9,lf.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Qt(),t=Je.identifierPrefix;if(De){var n=tn,r=en;n=(r&~(1<<32-Ut(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=vs++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=pp++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},wp={readContext:Rt,useCallback:pf,useContext:Rt,useEffect:bi,useImperativeHandle:hf,useInsertionEffect:df,useLayoutEffect:ff,useMemo:gf,useReducer:Po,useRef:uf,useState:function(){return Po(ys)},useDebugValue:Ii,useDeferredValue:function(e){var t=Lt();return xf(t,Qe.memoizedState,e)},useTransition:function(){var e=Po(ys)[0],t=Lt().memoizedState;return[e,t]},useMutableSource:nf,useSyncExternalStore:rf,useId:vf,unstable_isNewReconciler:!1},Sp={readContext:Rt,useCallback:pf,useContext:Rt,useEffect:bi,useImperativeHandle:hf,useInsertionEffect:df,useLayoutEffect:ff,useMemo:gf,useReducer:Mo,useRef:uf,useState:function(){return Mo(ys)},useDebugValue:Ii,useDeferredValue:function(e){var t=Lt();return Qe===null?t.memoizedState=e:xf(t,Qe.memoizedState,e)},useTransition:function(){var e=Mo(ys)[0],t=Lt().memoizedState;return[e,t]},useMutableSource:nf,useSyncExternalStore:rf,useId:vf,unstable_isNewReconciler:!1};function Ot(e,t){if(e&&e.defaultProps){t=Fe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ja(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Fe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wl={isMounted:function(e){return(e=e._reactInternals)?er(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=dt(),l=kn(e),o=nn(r,l);o.payload=t,n!=null&&(o.callback=n),t=bn(e,o,l),t!==null&&(Bt(t,e,l,r),al(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=dt(),l=kn(e),o=nn(r,l);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=bn(e,o,l),t!==null&&(Bt(t,e,l,r),al(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=dt(),r=kn(e),l=nn(n,r);l.tag=2,t!=null&&(l.callback=t),t=bn(e,l,r),t!==null&&(Bt(t,e,r,n),al(t,e,r))}};function Uc(e,t,n,r,l,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,a):t.prototype&&t.prototype.isPureReactComponent?!fs(n,r)||!fs(l,o):!0}function Nf(e,t,n){var r=!1,l=Pn,o=t.contextType;return typeof o=="object"&&o!==null?o=Rt(o):(l=vt(t)?Vn:at.current,r=t.contextTypes,o=(r=r!=null)?jr(e,l):Pn),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Wl,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=o),t}function Bc(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Wl.enqueueReplaceState(t,t.state,null)}function ba(e,t,n,r){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},xi(e);var o=t.contextType;typeof o=="object"&&o!==null?l.context=Rt(o):(o=vt(t)?Vn:at.current,l.context=jr(e,o)),l.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(ja(e,t,o,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&Wl.enqueueReplaceState(l,l.state,null),Pl(e,n,l,r),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Cr(e,t){try{var n="",r=t;do n+=Xm(r),r=r.return;while(r);var l=n}catch(o){l=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:l,digest:null}}function To(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ia(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Np=typeof WeakMap=="function"?WeakMap:Map;function jf(e,t,n){n=nn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){zl||(zl=!0,za=r),Ia(e,t)},n}function bf(e,t,n){n=nn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var l=t.value;n.payload=function(){return r(l)},n.callback=function(){Ia(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Ia(e,t),typeof r!="function"&&(In===null?In=new Set([this]):In.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Hc(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Np;var l=new Set;r.set(t,l)}else l=r.get(t),l===void 0&&(l=new Set,r.set(t,l));l.has(n)||(l.add(n),e=Op.bind(null,e,t,n),t.then(e,e))}function Gc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Vc(e,t,n,r,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=nn(-1,1),t.tag=2,bn(n,t,1))),n.lanes|=1),e)}var jp=cn.ReactCurrentOwner,gt=!1;function ut(e,t,n,r){t.child=e===null?Jd(t,null,n,r):Ir(t,e.child,n,r)}function Qc(e,t,n,r,l){n=n.render;var o=t.ref;return wr(t,l),r=Ni(e,t,n,r,o,l),n=ji(),e!==null&&!gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,an(e,t,l)):(De&&n&&ui(t),t.flags|=1,ut(e,t,r,l),t.child)}function Yc(e,t,n,r,l){if(e===null){var o=n.type;return typeof o=="function"&&!Ri(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,If(e,t,o,r,l)):(e=ml(n.type,null,r,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&l)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:fs,n(a,r)&&e.ref===t.ref)return an(e,t,l)}return t.flags|=1,e=Cn(o,r),e.ref=t.ref,e.return=t,t.child=e}function If(e,t,n,r,l){if(e!==null){var o=e.memoizedProps;if(fs(o,r)&&e.ref===t.ref)if(gt=!1,t.pendingProps=r=o,(e.lanes&l)!==0)e.flags&131072&&(gt=!0);else return t.lanes=e.lanes,an(e,t,l)}return ka(e,t,n,r,l)}function kf(e,t,n){var r=t.pendingProps,l=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Re(pr,St),St|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Re(pr,St),St|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Re(pr,St),St|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Re(pr,St),St|=r;return ut(e,t,l,n),t.child}function Cf(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ka(e,t,n,r,l){var o=vt(n)?Vn:at.current;return o=jr(t,o),wr(t,l),n=Ni(e,t,n,r,o,l),r=ji(),e!==null&&!gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,an(e,t,l)):(De&&r&&ui(t),t.flags|=1,ut(e,t,n,l),t.child)}function Wc(e,t,n,r,l){if(vt(n)){var o=!0;Il(t)}else o=!1;if(wr(t,l),t.stateNode===null)ul(e,t),Nf(t,n,r),ba(t,n,r,l),r=!0;else if(e===null){var a=t.stateNode,c=t.memoizedProps;a.props=c;var i=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=Rt(d):(d=vt(n)?Vn:at.current,d=jr(t,d));var p=n.getDerivedStateFromProps,h=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||i!==d)&&Bc(t,a,r,d),hn=!1;var f=t.memoizedState;a.state=f,Pl(t,r,a,l),i=t.memoizedState,c!==r||f!==i||xt.current||hn?(typeof p=="function"&&(ja(t,n,p,r),i=t.memoizedState),(c=hn||Uc(t,n,c,r,f,i,d))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=i),a.props=r,a.state=i,a.context=d,r=c):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,ef(e,t),c=t.memoizedProps,d=t.type===t.elementType?c:Ot(t.type,c),a.props=d,h=t.pendingProps,f=a.context,i=n.contextType,typeof i=="object"&&i!==null?i=Rt(i):(i=vt(n)?Vn:at.current,i=jr(t,i));var y=n.getDerivedStateFromProps;(p=typeof y=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==h||f!==i)&&Bc(t,a,r,i),hn=!1,f=t.memoizedState,a.state=f,Pl(t,r,a,l);var w=t.memoizedState;c!==h||f!==w||xt.current||hn?(typeof y=="function"&&(ja(t,n,y,r),w=t.memoizedState),(d=hn||Uc(t,n,d,r,f,w,i)||!1)?(p||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,w,i),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,w,i)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),a.props=r,a.state=w,a.context=i,r=d):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return Ca(e,t,n,r,o,l)}function Ca(e,t,n,r,l,o){Cf(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return l&&Rc(t,n,!1),an(e,t,o);r=t.stateNode,jp.current=t;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=Ir(t,e.child,null,o),t.child=Ir(t,null,c,o)):ut(e,t,c,o),t.memoizedState=r.state,l&&Rc(t,n,!0),t.child}function Af(e){var t=e.stateNode;t.pendingContext?Tc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Tc(e,t.context,!1),vi(e,t.containerInfo)}function Xc(e,t,n,r,l){return br(),fi(l),t.flags|=256,ut(e,t,n,r),t.child}var Aa={dehydrated:null,treeContext:null,retryLane:0};function Ea(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ef(e,t,n){var r=t.pendingProps,l=_e.current,o=!1,a=(t.flags&128)!==0,c;if((c=a)||(c=e!==null&&e.memoizedState===null?!1:(l&2)!==0),c?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),Re(_e,l&1),e===null)return Sa(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,o?(r=t.mode,o=t.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Kl(a,r,0,null),e=Hn(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Ea(n),t.memoizedState=Aa,e):ki(t,a));if(l=e.memoizedState,l!==null&&(c=l.dehydrated,c!==null))return bp(e,t,a,r,c,l,n);if(o){o=r.fallback,a=t.mode,l=e.child,c=l.sibling;var i={mode:"hidden",children:r.children};return!(a&1)&&t.child!==l?(r=t.child,r.childLanes=0,r.pendingProps=i,t.deletions=null):(r=Cn(l,i),r.subtreeFlags=l.subtreeFlags&14680064),c!==null?o=Cn(c,o):(o=Hn(o,a,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,a=e.child.memoizedState,a=a===null?Ea(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~n,t.memoizedState=Aa,r}return o=e.child,e=o.sibling,r=Cn(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function ki(e,t){return t=Kl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ys(e,t,n,r){return r!==null&&fi(r),Ir(t,e.child,null,n),e=ki(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function bp(e,t,n,r,l,o,a){if(n)return t.flags&256?(t.flags&=-257,r=To(Error(Y(422))),Ys(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,l=t.mode,r=Kl({mode:"visible",children:r.children},l,0,null),o=Hn(o,l,a,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Ir(t,e.child,null,a),t.child.memoizedState=Ea(a),t.memoizedState=Aa,o);if(!(t.mode&1))return Ys(e,t,a,null);if(l.data==="$!"){if(r=l.nextSibling&&l.nextSibling.dataset,r)var c=r.dgst;return r=c,o=Error(Y(419)),r=To(o,r,void 0),Ys(e,t,a,r)}if(c=(a&e.childLanes)!==0,gt||c){if(r=Je,r!==null){switch(a&-a){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(r.suspendedLanes|a)?0:l,l!==0&&l!==o.retryLane&&(o.retryLane=l,on(e,l),Bt(r,e,l,-1))}return Ti(),r=To(Error(Y(421))),Ys(e,t,a,r)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=Dp.bind(null,e),l._reactRetry=t,null):(e=o.treeContext,Nt=jn(l.nextSibling),jt=t,De=!0,_t=null,e!==null&&(At[Et++]=en,At[Et++]=tn,At[Et++]=Qn,en=e.id,tn=e.overflow,Qn=t),t=ki(t,r.children),t.flags|=4096,t)}function qc(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Na(e.return,t,n)}function Ro(e,t,n,r,l){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:l}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=l)}function Pf(e,t,n){var r=t.pendingProps,l=r.revealOrder,o=r.tail;if(ut(e,t,r.children,n),r=_e.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&qc(e,n,t);else if(e.tag===19)qc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Re(_e,r),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&Ml(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),Ro(t,!1,l,n,o);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Ml(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}Ro(t,!0,n,null,o);break;case"together":Ro(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ul(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function an(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Wn|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Y(153));if(t.child!==null){for(e=t.child,n=Cn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Cn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Ip(e,t,n){switch(t.tag){case 3:Af(t),br();break;case 5:tf(t);break;case 1:vt(t.type)&&Il(t);break;case 4:vi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,l=t.memoizedProps.value;Re(Al,r._currentValue),r._currentValue=l;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Re(_e,_e.current&1),t.flags|=128,null):n&t.child.childLanes?Ef(e,t,n):(Re(_e,_e.current&1),e=an(e,t,n),e!==null?e.sibling:null);Re(_e,_e.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Pf(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),Re(_e,_e.current),r)break;return null;case 22:case 23:return t.lanes=0,kf(e,t,n)}return an(e,t,n)}var Mf,Pa,Tf,Rf;Mf=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Pa=function(){};Tf=function(e,t,n,r){var l=e.memoizedProps;if(l!==r){e=t.stateNode,Un(Xt.current);var o=null;switch(n){case"input":l=Jo(e,l),r=Jo(e,r),o=[];break;case"select":l=Fe({},l,{value:void 0}),r=Fe({},r,{value:void 0}),o=[];break;case"textarea":l=ta(e,l),r=ta(e,r),o=[];break;default:typeof l.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=jl)}ra(n,r);var a;n=null;for(d in l)if(!r.hasOwnProperty(d)&&l.hasOwnProperty(d)&&l[d]!=null)if(d==="style"){var c=l[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ls.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var i=r[d];if(c=l!=null?l[d]:void 0,r.hasOwnProperty(d)&&i!==c&&(i!=null||c!=null))if(d==="style")if(c){for(a in c)!c.hasOwnProperty(a)||i&&i.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in i)i.hasOwnProperty(a)&&c[a]!==i[a]&&(n||(n={}),n[a]=i[a])}else n||(o||(o=[]),o.push(d,n)),n=i;else d==="dangerouslySetInnerHTML"?(i=i?i.__html:void 0,c=c?c.__html:void 0,i!=null&&c!==i&&(o=o||[]).push(d,i)):d==="children"?typeof i!="string"&&typeof i!="number"||(o=o||[]).push(d,""+i):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ls.hasOwnProperty(d)?(i!=null&&d==="onScroll"&&Le("scroll",e),o||c===i||(o=[])):(o=o||[]).push(d,i))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};Rf=function(e,t,n,r){n!==r&&(t.flags|=4)};function Hr(e,t){if(!De)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function lt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags&14680064,r|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags,r|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function kp(e,t,n){var r=t.pendingProps;switch(di(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(t),null;case 1:return vt(t.type)&&bl(),lt(t),null;case 3:return r=t.stateNode,kr(),ze(xt),ze(at),wi(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Vs(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_t!==null&&(_a(_t),_t=null))),Pa(e,t),lt(t),null;case 5:yi(t);var l=Un(xs.current);if(n=t.type,e!==null&&t.stateNode!=null)Tf(e,t,n,r,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Y(166));return lt(t),null}if(e=Un(Xt.current),Vs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Yt]=t,r[ps]=o,e=(t.mode&1)!==0,n){case"dialog":Le("cancel",r),Le("close",r);break;case"iframe":case"object":case"embed":Le("load",r);break;case"video":case"audio":for(l=0;l<Wr.length;l++)Le(Wr[l],r);break;case"source":Le("error",r);break;case"img":case"image":case"link":Le("error",r),Le("load",r);break;case"details":Le("toggle",r);break;case"input":lc(r,o),Le("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Le("invalid",r);break;case"textarea":ac(r,o),Le("invalid",r)}ra(n,o),l=null;for(var a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="children"?typeof c=="string"?r.textContent!==c&&(o.suppressHydrationWarning!==!0&&Gs(r.textContent,c,e),l=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&Gs(r.textContent,c,e),l=["children",""+c]):ls.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&Le("scroll",r)}switch(n){case"input":Os(r),oc(r,o,!0);break;case"textarea":Os(r),ic(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=jl)}r=l,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=od(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Yt]=t,e[ps]=r,Mf(e,t,!1,!1),t.stateNode=e;e:{switch(a=sa(n,r),n){case"dialog":Le("cancel",e),Le("close",e),l=r;break;case"iframe":case"object":case"embed":Le("load",e),l=r;break;case"video":case"audio":for(l=0;l<Wr.length;l++)Le(Wr[l],e);l=r;break;case"source":Le("error",e),l=r;break;case"img":case"image":case"link":Le("error",e),Le("load",e),l=r;break;case"details":Le("toggle",e),l=r;break;case"input":lc(e,r),l=Jo(e,r),Le("invalid",e);break;case"option":l=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=Fe({},r,{value:void 0}),Le("invalid",e);break;case"textarea":ac(e,r),l=ta(e,r),Le("invalid",e);break;default:l=r}ra(n,l),c=l;for(o in c)if(c.hasOwnProperty(o)){var i=c[o];o==="style"?cd(e,i):o==="dangerouslySetInnerHTML"?(i=i?i.__html:void 0,i!=null&&ad(e,i)):o==="children"?typeof i=="string"?(n!=="textarea"||i!=="")&&os(e,i):typeof i=="number"&&os(e,""+i):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(ls.hasOwnProperty(o)?i!=null&&o==="onScroll"&&Le("scroll",e):i!=null&&qa(e,o,i,a))}switch(n){case"input":Os(e),oc(e,r,!1);break;case"textarea":Os(e),ic(e);break;case"option":r.value!=null&&e.setAttribute("value",""+En(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?gr(e,!!r.multiple,o,!1):r.defaultValue!=null&&gr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=jl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return lt(t),null;case 6:if(e&&t.stateNode!=null)Rf(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Y(166));if(n=Un(xs.current),Un(Xt.current),Vs(t)){if(r=t.stateNode,n=t.memoizedProps,r[Yt]=t,(o=r.nodeValue!==n)&&(e=jt,e!==null))switch(e.tag){case 3:Gs(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Gs(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Yt]=t,t.stateNode=r}return lt(t),null;case 13:if(ze(_e),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(De&&Nt!==null&&t.mode&1&&!(t.flags&128))qd(),br(),t.flags|=98560,o=!1;else if(o=Vs(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(Y(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Y(317));o[Yt]=t}else br(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;lt(t),o=!1}else _t!==null&&(_a(_t),_t=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||_e.current&1?Ye===0&&(Ye=3):Ti())),t.updateQueue!==null&&(t.flags|=4),lt(t),null);case 4:return kr(),Pa(e,t),e===null&&ms(t.stateNode.containerInfo),lt(t),null;case 10:return pi(t.type._context),lt(t),null;case 17:return vt(t.type)&&bl(),lt(t),null;case 19:if(ze(_e),o=t.memoizedState,o===null)return lt(t),null;if(r=(t.flags&128)!==0,a=o.rendering,a===null)if(r)Hr(o,!1);else{if(Ye!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ml(e),a!==null){for(t.flags|=128,Hr(o,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Re(_e,_e.current&1|2),t.child}e=e.sibling}o.tail!==null&&Be()>Ar&&(t.flags|=128,r=!0,Hr(o,!1),t.lanes=4194304)}else{if(!r)if(e=Ml(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Hr(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!De)return lt(t),null}else 2*Be()-o.renderingStartTime>Ar&&n!==1073741824&&(t.flags|=128,r=!0,Hr(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(n=o.last,n!==null?n.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Be(),t.sibling=null,n=_e.current,Re(_e,r?n&1|2:n&1),t):(lt(t),null);case 22:case 23:return Mi(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?St&1073741824&&(lt(t),t.subtreeFlags&6&&(t.flags|=8192)):lt(t),null;case 24:return null;case 25:return null}throw Error(Y(156,t.tag))}function Cp(e,t){switch(di(t),t.tag){case 1:return vt(t.type)&&bl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return kr(),ze(xt),ze(at),wi(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return yi(t),null;case 13:if(ze(_e),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Y(340));br()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ze(_e),null;case 4:return kr(),null;case 10:return pi(t.type._context),null;case 22:case 23:return Mi(),null;case 24:return null;default:return null}}var Ws=!1,ot=!1,Ap=typeof WeakSet=="function"?WeakSet:Set,ce=null;function hr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ue(e,t,r)}else n.current=null}function Ma(e,t,n){try{n()}catch(r){Ue(e,t,r)}}var Kc=!1;function Ep(e,t){if(ha=wl,e=Dd(),ci(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var l=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,c=-1,i=-1,d=0,p=0,h=e,f=null;t:for(;;){for(var y;h!==n||l!==0&&h.nodeType!==3||(c=a+l),h!==o||r!==0&&h.nodeType!==3||(i=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(y=h.firstChild)!==null;)f=h,h=y;for(;;){if(h===e)break t;if(f===n&&++d===l&&(c=a),f===o&&++p===r&&(i=a),(y=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=y}n=c===-1||i===-1?null:{start:c,end:i}}else n=null}n=n||{start:0,end:0}}else n=null;for(pa={focusedElem:e,selectionRange:n},wl=!1,ce=t;ce!==null;)if(t=ce,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ce=e;else for(;ce!==null;){t=ce;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var g=w.memoizedProps,N=w.memoizedState,x=t.stateNode,m=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ot(t.type,g),N);x.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(S){Ue(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,ce=e;break}ce=t.return}return w=Kc,Kc=!1,w}function ts(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&e)===e){var o=l.destroy;l.destroy=void 0,o!==void 0&&Ma(t,n,o)}l=l.next}while(l!==r)}}function Xl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ta(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Lf(e){var t=e.alternate;t!==null&&(e.alternate=null,Lf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Yt],delete t[ps],delete t[va],delete t[dp],delete t[fp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function zf(e){return e.tag===5||e.tag===3||e.tag===4}function Jc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||zf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ra(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=jl));else if(r!==4&&(e=e.child,e!==null))for(Ra(e,t,n),e=e.sibling;e!==null;)Ra(e,t,n),e=e.sibling}function La(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(La(e,t,n),e=e.sibling;e!==null;)La(e,t,n),e=e.sibling}var Ze=null,Dt=!1;function fn(e,t,n){for(n=n.child;n!==null;)Of(e,t,n),n=n.sibling}function Of(e,t,n){if(Wt&&typeof Wt.onCommitFiberUnmount=="function")try{Wt.onCommitFiberUnmount(Ul,n)}catch{}switch(n.tag){case 5:ot||hr(n,t);case 6:var r=Ze,l=Dt;Ze=null,fn(e,t,n),Ze=r,Dt=l,Ze!==null&&(Dt?(e=Ze,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ze.removeChild(n.stateNode));break;case 18:Ze!==null&&(Dt?(e=Ze,n=n.stateNode,e.nodeType===8?ko(e.parentNode,n):e.nodeType===1&&ko(e,n),us(e)):ko(Ze,n.stateNode));break;case 4:r=Ze,l=Dt,Ze=n.stateNode.containerInfo,Dt=!0,fn(e,t,n),Ze=r,Dt=l;break;case 0:case 11:case 14:case 15:if(!ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){l=r=r.next;do{var o=l,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&Ma(n,t,a),l=l.next}while(l!==r)}fn(e,t,n);break;case 1:if(!ot&&(hr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Ue(n,t,c)}fn(e,t,n);break;case 21:fn(e,t,n);break;case 22:n.mode&1?(ot=(r=ot)||n.memoizedState!==null,fn(e,t,n),ot=r):fn(e,t,n);break;default:fn(e,t,n)}}function Zc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Ap),t.forEach(function(r){var l=_p.bind(null,e,r);n.has(r)||(n.add(r),r.then(l,l))})}}function zt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var l=n[r];try{var o=e,a=t,c=a;e:for(;c!==null;){switch(c.tag){case 5:Ze=c.stateNode,Dt=!1;break e;case 3:Ze=c.stateNode.containerInfo,Dt=!0;break e;case 4:Ze=c.stateNode.containerInfo,Dt=!0;break e}c=c.return}if(Ze===null)throw Error(Y(160));Of(o,a,l),Ze=null,Dt=!1;var i=l.alternate;i!==null&&(i.return=null),l.return=null}catch(d){Ue(l,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Df(t,e),t=t.sibling}function Df(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(zt(t,e),Gt(e),r&4){try{ts(3,e,e.return),Xl(3,e)}catch(g){Ue(e,e.return,g)}try{ts(5,e,e.return)}catch(g){Ue(e,e.return,g)}}break;case 1:zt(t,e),Gt(e),r&512&&n!==null&&hr(n,n.return);break;case 5:if(zt(t,e),Gt(e),r&512&&n!==null&&hr(n,n.return),e.flags&32){var l=e.stateNode;try{os(l,"")}catch(g){Ue(e,e.return,g)}}if(r&4&&(l=e.stateNode,l!=null)){var o=e.memoizedProps,a=n!==null?n.memoizedProps:o,c=e.type,i=e.updateQueue;if(e.updateQueue=null,i!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&sd(l,o),sa(c,a);var d=sa(c,o);for(a=0;a<i.length;a+=2){var p=i[a],h=i[a+1];p==="style"?cd(l,h):p==="dangerouslySetInnerHTML"?ad(l,h):p==="children"?os(l,h):qa(l,p,h,d)}switch(c){case"input":Zo(l,o);break;case"textarea":ld(l,o);break;case"select":var f=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!o.multiple;var y=o.value;y!=null?gr(l,!!o.multiple,y,!1):f!==!!o.multiple&&(o.defaultValue!=null?gr(l,!!o.multiple,o.defaultValue,!0):gr(l,!!o.multiple,o.multiple?[]:"",!1))}l[ps]=o}catch(g){Ue(e,e.return,g)}}break;case 6:if(zt(t,e),Gt(e),r&4){if(e.stateNode===null)throw Error(Y(162));l=e.stateNode,o=e.memoizedProps;try{l.nodeValue=o}catch(g){Ue(e,e.return,g)}}break;case 3:if(zt(t,e),Gt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{us(t.containerInfo)}catch(g){Ue(e,e.return,g)}break;case 4:zt(t,e),Gt(e);break;case 13:zt(t,e),Gt(e),l=e.child,l.flags&8192&&(o=l.memoizedState!==null,l.stateNode.isHidden=o,!o||l.alternate!==null&&l.alternate.memoizedState!==null||(Ei=Be())),r&4&&Zc(e);break;case 22:if(p=n!==null&&n.memoizedState!==null,e.mode&1?(ot=(d=ot)||p,zt(t,e),ot=d):zt(t,e),Gt(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!p&&e.mode&1)for(ce=e,p=e.child;p!==null;){for(h=ce=p;ce!==null;){switch(f=ce,y=f.child,f.tag){case 0:case 11:case 14:case 15:ts(4,f,f.return);break;case 1:hr(f,f.return);var w=f.stateNode;if(typeof w.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(g){Ue(r,n,g)}}break;case 5:hr(f,f.return);break;case 22:if(f.memoizedState!==null){tu(h);continue}}y!==null?(y.return=f,ce=y):tu(h)}p=p.sibling}e:for(p=null,h=e;;){if(h.tag===5){if(p===null){p=h;try{l=h.stateNode,d?(o=l.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=h.stateNode,i=h.memoizedProps.style,a=i!=null&&i.hasOwnProperty("display")?i.display:null,c.style.display=id("display",a))}catch(g){Ue(e,e.return,g)}}}else if(h.tag===6){if(p===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){Ue(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;p===h&&(p=null),h=h.return}p===h&&(p=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:zt(t,e),Gt(e),r&4&&Zc(e);break;case 21:break;default:zt(t,e),Gt(e)}}function Gt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(zf(n)){var r=n;break e}n=n.return}throw Error(Y(160))}switch(r.tag){case 5:var l=r.stateNode;r.flags&32&&(os(l,""),r.flags&=-33);var o=Jc(e);La(e,o,l);break;case 3:case 4:var a=r.stateNode.containerInfo,c=Jc(e);Ra(e,c,a);break;default:throw Error(Y(161))}}catch(i){Ue(e,e.return,i)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Pp(e,t,n){ce=e,_f(e)}function _f(e,t,n){for(var r=(e.mode&1)!==0;ce!==null;){var l=ce,o=l.child;if(l.tag===22&&r){var a=l.memoizedState!==null||Ws;if(!a){var c=l.alternate,i=c!==null&&c.memoizedState!==null||ot;c=Ws;var d=ot;if(Ws=a,(ot=i)&&!d)for(ce=l;ce!==null;)a=ce,i=a.child,a.tag===22&&a.memoizedState!==null?nu(l):i!==null?(i.return=a,ce=i):nu(l);for(;o!==null;)ce=o,_f(o),o=o.sibling;ce=l,Ws=c,ot=d}eu(e)}else l.subtreeFlags&8772&&o!==null?(o.return=l,ce=o):eu(e)}}function eu(e){for(;ce!==null;){var t=ce;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ot||Xl(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ot)if(n===null)r.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:Ot(t.type,n.memoizedProps);r.componentDidUpdate(l,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&_c(t,o,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}_c(t,a,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var i=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":i.autoFocus&&n.focus();break;case"img":i.src&&(n.src=i.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var p=d.memoizedState;if(p!==null){var h=p.dehydrated;h!==null&&us(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}ot||t.flags&512&&Ta(t)}catch(f){Ue(t,t.return,f)}}if(t===e){ce=null;break}if(n=t.sibling,n!==null){n.return=t.return,ce=n;break}ce=t.return}}function tu(e){for(;ce!==null;){var t=ce;if(t===e){ce=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ce=n;break}ce=t.return}}function nu(e){for(;ce!==null;){var t=ce;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Xl(4,t)}catch(i){Ue(t,n,i)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var l=t.return;try{r.componentDidMount()}catch(i){Ue(t,l,i)}}var o=t.return;try{Ta(t)}catch(i){Ue(t,o,i)}break;case 5:var a=t.return;try{Ta(t)}catch(i){Ue(t,a,i)}}}catch(i){Ue(t,t.return,i)}if(t===e){ce=null;break}var c=t.sibling;if(c!==null){c.return=t.return,ce=c;break}ce=t.return}}var Mp=Math.ceil,Ll=cn.ReactCurrentDispatcher,Ci=cn.ReactCurrentOwner,Mt=cn.ReactCurrentBatchConfig,Ee=0,Je=null,Ge=null,et=0,St=0,pr=Rn(0),Ye=0,Ss=null,Wn=0,ql=0,Ai=0,ns=null,pt=null,Ei=0,Ar=1/0,Jt=null,zl=!1,za=null,In=null,Xs=!1,vn=null,Ol=0,rs=0,Oa=null,dl=-1,fl=0;function dt(){return Ee&6?Be():dl!==-1?dl:dl=Be()}function kn(e){return e.mode&1?Ee&2&&et!==0?et&-et:hp.transition!==null?(fl===0&&(fl=Sd()),fl):(e=Me,e!==0||(e=window.event,e=e===void 0?16:Ad(e.type)),e):1}function Bt(e,t,n,r){if(50<rs)throw rs=0,Oa=null,Error(Y(185));Cs(e,n,r),(!(Ee&2)||e!==Je)&&(e===Je&&(!(Ee&2)&&(ql|=n),Ye===4&&gn(e,et)),yt(e,r),n===1&&Ee===0&&!(t.mode&1)&&(Ar=Be()+500,Ql&&Ln()))}function yt(e,t){var n=e.callbackNode;hh(e,t);var r=yl(e,e===Je?et:0);if(r===0)n!==null&&dc(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&dc(n),t===1)e.tag===0?mp(ru.bind(null,e)):Yd(ru.bind(null,e)),cp(function(){!(Ee&6)&&Ln()}),n=null;else{switch(Nd(r)){case 1:n=ti;break;case 4:n=yd;break;case 16:n=vl;break;case 536870912:n=wd;break;default:n=vl}n=Qf(n,$f.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function $f(e,t){if(dl=-1,fl=0,Ee&6)throw Error(Y(327));var n=e.callbackNode;if(Sr()&&e.callbackNode!==n)return null;var r=yl(e,e===Je?et:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Dl(e,r);else{t=r;var l=Ee;Ee|=2;var o=Uf();(Je!==e||et!==t)&&(Jt=null,Ar=Be()+500,Bn(e,t));do try{Lp();break}catch(c){Ff(e,c)}while(!0);hi(),Ll.current=o,Ee=l,Ge!==null?t=0:(Je=null,et=0,t=Ye)}if(t!==0){if(t===2&&(l=ca(e),l!==0&&(r=l,t=Da(e,l))),t===1)throw n=Ss,Bn(e,0),gn(e,r),yt(e,Be()),n;if(t===6)gn(e,r);else{if(l=e.current.alternate,!(r&30)&&!Tp(l)&&(t=Dl(e,r),t===2&&(o=ca(e),o!==0&&(r=o,t=Da(e,o))),t===1))throw n=Ss,Bn(e,0),gn(e,r),yt(e,Be()),n;switch(e.finishedWork=l,e.finishedLanes=r,t){case 0:case 1:throw Error(Y(345));case 2:_n(e,pt,Jt);break;case 3:if(gn(e,r),(r&130023424)===r&&(t=Ei+500-Be(),10<t)){if(yl(e,0)!==0)break;if(l=e.suspendedLanes,(l&r)!==r){dt(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=xa(_n.bind(null,e,pt,Jt),t);break}_n(e,pt,Jt);break;case 4:if(gn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,l=-1;0<r;){var a=31-Ut(r);o=1<<a,a=t[a],a>l&&(l=a),r&=~o}if(r=l,r=Be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Mp(r/1960))-r,10<r){e.timeoutHandle=xa(_n.bind(null,e,pt,Jt),r);break}_n(e,pt,Jt);break;case 5:_n(e,pt,Jt);break;default:throw Error(Y(329))}}}return yt(e,Be()),e.callbackNode===n?$f.bind(null,e):null}function Da(e,t){var n=ns;return e.current.memoizedState.isDehydrated&&(Bn(e,t).flags|=256),e=Dl(e,t),e!==2&&(t=pt,pt=n,t!==null&&_a(t)),e}function _a(e){pt===null?pt=e:pt.push.apply(pt,e)}function Tp(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var l=n[r],o=l.getSnapshot;l=l.value;try{if(!Ht(o(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function gn(e,t){for(t&=~Ai,t&=~ql,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ut(t),r=1<<n;e[n]=-1,t&=~r}}function ru(e){if(Ee&6)throw Error(Y(327));Sr();var t=yl(e,0);if(!(t&1))return yt(e,Be()),null;var n=Dl(e,t);if(e.tag!==0&&n===2){var r=ca(e);r!==0&&(t=r,n=Da(e,r))}if(n===1)throw n=Ss,Bn(e,0),gn(e,t),yt(e,Be()),n;if(n===6)throw Error(Y(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_n(e,pt,Jt),yt(e,Be()),null}function Pi(e,t){var n=Ee;Ee|=1;try{return e(t)}finally{Ee=n,Ee===0&&(Ar=Be()+500,Ql&&Ln())}}function Xn(e){vn!==null&&vn.tag===0&&!(Ee&6)&&Sr();var t=Ee;Ee|=1;var n=Mt.transition,r=Me;try{if(Mt.transition=null,Me=1,e)return e()}finally{Me=r,Mt.transition=n,Ee=t,!(Ee&6)&&Ln()}}function Mi(){St=pr.current,ze(pr)}function Bn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,ip(n)),Ge!==null)for(n=Ge.return;n!==null;){var r=n;switch(di(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&bl();break;case 3:kr(),ze(xt),ze(at),wi();break;case 5:yi(r);break;case 4:kr();break;case 13:ze(_e);break;case 19:ze(_e);break;case 10:pi(r.type._context);break;case 22:case 23:Mi()}n=n.return}if(Je=e,Ge=e=Cn(e.current,null),et=St=t,Ye=0,Ss=null,Ai=ql=Wn=0,pt=ns=null,Fn!==null){for(t=0;t<Fn.length;t++)if(n=Fn[t],r=n.interleaved,r!==null){n.interleaved=null;var l=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=l,r.next=a}n.pending=r}Fn=null}return e}function Ff(e,t){do{var n=Ge;try{if(hi(),il.current=Rl,Tl){for(var r=$e.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}Tl=!1}if(Yn=0,Ke=Qe=$e=null,es=!1,vs=0,Ci.current=null,n===null||n.return===null){Ye=1,Ss=t,Ge=null;break}e:{var o=e,a=n.return,c=n,i=t;if(t=et,c.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){var d=i,p=c,h=p.tag;if(!(p.mode&1)&&(h===0||h===11||h===15)){var f=p.alternate;f?(p.updateQueue=f.updateQueue,p.memoizedState=f.memoizedState,p.lanes=f.lanes):(p.updateQueue=null,p.memoizedState=null)}var y=Gc(a);if(y!==null){y.flags&=-257,Vc(y,a,c,o,t),y.mode&1&&Hc(o,d,t),t=y,i=d;var w=t.updateQueue;if(w===null){var g=new Set;g.add(i),t.updateQueue=g}else w.add(i);break e}else{if(!(t&1)){Hc(o,d,t),Ti();break e}i=Error(Y(426))}}else if(De&&c.mode&1){var N=Gc(a);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Vc(N,a,c,o,t),fi(Cr(i,c));break e}}o=i=Cr(i,c),Ye!==4&&(Ye=2),ns===null?ns=[o]:ns.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var x=jf(o,i,t);Dc(o,x);break e;case 1:c=i;var m=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(In===null||!In.has(v)))){o.flags|=65536,t&=-t,o.lanes|=t;var S=bf(o,c,t);Dc(o,S);break e}}o=o.return}while(o!==null)}Hf(n)}catch(j){t=j,Ge===n&&n!==null&&(Ge=n=n.return);continue}break}while(!0)}function Uf(){var e=Ll.current;return Ll.current=Rl,e===null?Rl:e}function Ti(){(Ye===0||Ye===3||Ye===2)&&(Ye=4),Je===null||!(Wn&268435455)&&!(ql&268435455)||gn(Je,et)}function Dl(e,t){var n=Ee;Ee|=2;var r=Uf();(Je!==e||et!==t)&&(Jt=null,Bn(e,t));do try{Rp();break}catch(l){Ff(e,l)}while(!0);if(hi(),Ee=n,Ll.current=r,Ge!==null)throw Error(Y(261));return Je=null,et=0,Ye}function Rp(){for(;Ge!==null;)Bf(Ge)}function Lp(){for(;Ge!==null&&!lh();)Bf(Ge)}function Bf(e){var t=Vf(e.alternate,e,St);e.memoizedProps=e.pendingProps,t===null?Hf(e):Ge=t,Ci.current=null}function Hf(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Cp(n,t),n!==null){n.flags&=32767,Ge=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ye=6,Ge=null;return}}else if(n=kp(n,t,St),n!==null){Ge=n;return}if(t=t.sibling,t!==null){Ge=t;return}Ge=t=e}while(t!==null);Ye===0&&(Ye=5)}function _n(e,t,n){var r=Me,l=Mt.transition;try{Mt.transition=null,Me=1,zp(e,t,n,r)}finally{Mt.transition=l,Me=r}return null}function zp(e,t,n,r){do Sr();while(vn!==null);if(Ee&6)throw Error(Y(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Y(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(ph(e,o),e===Je&&(Ge=Je=null,et=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xs||(Xs=!0,Qf(vl,function(){return Sr(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Mt.transition,Mt.transition=null;var a=Me;Me=1;var c=Ee;Ee|=4,Ci.current=null,Ep(e,n),Df(n,e),tp(pa),wl=!!ha,pa=ha=null,e.current=n,Pp(n),oh(),Ee=c,Me=a,Mt.transition=o}else e.current=n;if(Xs&&(Xs=!1,vn=e,Ol=l),o=e.pendingLanes,o===0&&(In=null),ch(n.stateNode),yt(e,Be()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],r(l.value,{componentStack:l.stack,digest:l.digest});if(zl)throw zl=!1,e=za,za=null,e;return Ol&1&&e.tag!==0&&Sr(),o=e.pendingLanes,o&1?e===Oa?rs++:(rs=0,Oa=e):rs=0,Ln(),null}function Sr(){if(vn!==null){var e=Nd(Ol),t=Mt.transition,n=Me;try{if(Mt.transition=null,Me=16>e?16:e,vn===null)var r=!1;else{if(e=vn,vn=null,Ol=0,Ee&6)throw Error(Y(331));var l=Ee;for(Ee|=4,ce=e.current;ce!==null;){var o=ce,a=o.child;if(ce.flags&16){var c=o.deletions;if(c!==null){for(var i=0;i<c.length;i++){var d=c[i];for(ce=d;ce!==null;){var p=ce;switch(p.tag){case 0:case 11:case 15:ts(8,p,o)}var h=p.child;if(h!==null)h.return=p,ce=h;else for(;ce!==null;){p=ce;var f=p.sibling,y=p.return;if(Lf(p),p===d){ce=null;break}if(f!==null){f.return=y,ce=f;break}ce=y}}}var w=o.alternate;if(w!==null){var g=w.child;if(g!==null){w.child=null;do{var N=g.sibling;g.sibling=null,g=N}while(g!==null)}}ce=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,ce=a;else e:for(;ce!==null;){if(o=ce,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ts(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,ce=x;break e}ce=o.return}}var m=e.current;for(ce=m;ce!==null;){a=ce;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,ce=v;else e:for(a=m;ce!==null;){if(c=ce,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Xl(9,c)}}catch(j){Ue(c,c.return,j)}if(c===a){ce=null;break e}var S=c.sibling;if(S!==null){S.return=c.return,ce=S;break e}ce=c.return}}if(Ee=l,Ln(),Wt&&typeof Wt.onPostCommitFiberRoot=="function")try{Wt.onPostCommitFiberRoot(Ul,e)}catch{}r=!0}return r}finally{Me=n,Mt.transition=t}}return!1}function su(e,t,n){t=Cr(n,t),t=jf(e,t,1),e=bn(e,t,1),t=dt(),e!==null&&(Cs(e,1,t),yt(e,t))}function Ue(e,t,n){if(e.tag===3)su(e,e,n);else for(;t!==null;){if(t.tag===3){su(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(In===null||!In.has(r))){e=Cr(n,e),e=bf(t,e,1),t=bn(t,e,1),e=dt(),t!==null&&(Cs(t,1,e),yt(t,e));break}}t=t.return}}function Op(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=dt(),e.pingedLanes|=e.suspendedLanes&n,Je===e&&(et&n)===n&&(Ye===4||Ye===3&&(et&130023424)===et&&500>Be()-Ei?Bn(e,0):Ai|=n),yt(e,t)}function Gf(e,t){t===0&&(e.mode&1?(t=$s,$s<<=1,!($s&130023424)&&($s=4194304)):t=1);var n=dt();e=on(e,t),e!==null&&(Cs(e,t,n),yt(e,n))}function Dp(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Gf(e,n)}function _p(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Y(314))}r!==null&&r.delete(t),Gf(e,n)}var Vf;Vf=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||xt.current)gt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return gt=!1,Ip(e,t,n);gt=!!(e.flags&131072)}else gt=!1,De&&t.flags&1048576&&Wd(t,Cl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ul(e,t),e=t.pendingProps;var l=jr(t,at.current);wr(t,n),l=Ni(null,t,r,e,l,n);var o=ji();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,vt(r)?(o=!0,Il(t)):o=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,xi(t),l.updater=Wl,t.stateNode=l,l._reactInternals=t,ba(t,r,e,n),t=Ca(null,t,r,!0,o,n)):(t.tag=0,De&&o&&ui(t),ut(null,t,l,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ul(e,t),e=t.pendingProps,l=r._init,r=l(r._payload),t.type=r,l=t.tag=Fp(r),e=Ot(r,e),l){case 0:t=ka(null,t,r,e,n);break e;case 1:t=Wc(null,t,r,e,n);break e;case 11:t=Qc(null,t,r,e,n);break e;case 14:t=Yc(null,t,r,Ot(r.type,e),n);break e}throw Error(Y(306,r,""))}return t;case 0:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Ot(r,l),ka(e,t,r,l,n);case 1:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Ot(r,l),Wc(e,t,r,l,n);case 3:e:{if(Af(t),e===null)throw Error(Y(387));r=t.pendingProps,o=t.memoizedState,l=o.element,ef(e,t),Pl(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){l=Cr(Error(Y(423)),t),t=Xc(e,t,r,n,l);break e}else if(r!==l){l=Cr(Error(Y(424)),t),t=Xc(e,t,r,n,l);break e}else for(Nt=jn(t.stateNode.containerInfo.firstChild),jt=t,De=!0,_t=null,n=Jd(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(br(),r===l){t=an(e,t,n);break e}ut(e,t,r,n)}t=t.child}return t;case 5:return tf(t),e===null&&Sa(t),r=t.type,l=t.pendingProps,o=e!==null?e.memoizedProps:null,a=l.children,ga(r,l)?a=null:o!==null&&ga(r,o)&&(t.flags|=32),Cf(e,t),ut(e,t,a,n),t.child;case 6:return e===null&&Sa(t),null;case 13:return Ef(e,t,n);case 4:return vi(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ir(t,null,r,n):ut(e,t,r,n),t.child;case 11:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Ot(r,l),Qc(e,t,r,l,n);case 7:return ut(e,t,t.pendingProps,n),t.child;case 8:return ut(e,t,t.pendingProps.children,n),t.child;case 12:return ut(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,l=t.pendingProps,o=t.memoizedProps,a=l.value,Re(Al,r._currentValue),r._currentValue=a,o!==null)if(Ht(o.value,a)){if(o.children===l.children&&!xt.current){t=an(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var c=o.dependencies;if(c!==null){a=o.child;for(var i=c.firstContext;i!==null;){if(i.context===r){if(o.tag===1){i=nn(-1,n&-n),i.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var p=d.pending;p===null?i.next=i:(i.next=p.next,p.next=i),d.pending=i}}o.lanes|=n,i=o.alternate,i!==null&&(i.lanes|=n),Na(o.return,n,t),c.lanes|=n;break}i=i.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(Y(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Na(a,n,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}ut(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,r=t.pendingProps.children,wr(t,n),l=Rt(l),r=r(l),t.flags|=1,ut(e,t,r,n),t.child;case 14:return r=t.type,l=Ot(r,t.pendingProps),l=Ot(r.type,l),Yc(e,t,r,l,n);case 15:return If(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:Ot(r,l),ul(e,t),t.tag=1,vt(r)?(e=!0,Il(t)):e=!1,wr(t,n),Nf(t,r,l),ba(t,r,l,n),Ca(null,t,r,!0,e,n);case 19:return Pf(e,t,n);case 22:return kf(e,t,n)}throw Error(Y(156,t.tag))};function Qf(e,t){return vd(e,t)}function $p(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pt(e,t,n,r){return new $p(e,t,n,r)}function Ri(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fp(e){if(typeof e=="function")return Ri(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ja)return 11;if(e===Za)return 14}return 2}function Cn(e,t){var n=e.alternate;return n===null?(n=Pt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ml(e,t,n,r,l,o){var a=2;if(r=e,typeof e=="function")Ri(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case lr:return Hn(n.children,l,o,t);case Ka:a=8,l|=8;break;case Wo:return e=Pt(12,n,t,l|2),e.elementType=Wo,e.lanes=o,e;case Xo:return e=Pt(13,n,t,l),e.elementType=Xo,e.lanes=o,e;case qo:return e=Pt(19,n,t,l),e.elementType=qo,e.lanes=o,e;case td:return Kl(n,l,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Zu:a=10;break e;case ed:a=9;break e;case Ja:a=11;break e;case Za:a=14;break e;case mn:a=16,r=null;break e}throw Error(Y(130,e==null?e:typeof e,""))}return t=Pt(a,n,t,l),t.elementType=e,t.type=r,t.lanes=o,t}function Hn(e,t,n,r){return e=Pt(7,e,r,t),e.lanes=n,e}function Kl(e,t,n,r){return e=Pt(22,e,r,t),e.elementType=td,e.lanes=n,e.stateNode={isHidden:!1},e}function Lo(e,t,n){return e=Pt(6,e,null,t),e.lanes=n,e}function zo(e,t,n){return t=Pt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Up(e,t,n,r,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=po(0),this.expirationTimes=po(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=po(0),this.identifierPrefix=r,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Li(e,t,n,r,l,o,a,c,i){return e=new Up(e,t,n,c,i),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Pt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xi(o),e}function Bp(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:sr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Yf(e){if(!e)return Pn;e=e._reactInternals;e:{if(er(e)!==e||e.tag!==1)throw Error(Y(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(vt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Y(171))}if(e.tag===1){var n=e.type;if(vt(n))return Qd(e,n,t)}return t}function Wf(e,t,n,r,l,o,a,c,i){return e=Li(n,r,!0,e,l,o,a,c,i),e.context=Yf(null),n=e.current,r=dt(),l=kn(n),o=nn(r,l),o.callback=t??null,bn(n,o,l),e.current.lanes=l,Cs(e,l,r),yt(e,r),e}function Jl(e,t,n,r){var l=t.current,o=dt(),a=kn(l);return n=Yf(n),t.context===null?t.context=n:t.pendingContext=n,t=nn(o,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=bn(l,t,a),e!==null&&(Bt(e,l,a,o),al(e,l,a)),a}function _l(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function lu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function zi(e,t){lu(e,t),(e=e.alternate)&&lu(e,t)}function Hp(){return null}var Xf=typeof reportError=="function"?reportError:function(e){console.error(e)};function Oi(e){this._internalRoot=e}Zl.prototype.render=Oi.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Y(409));Jl(e,t,null,null)};Zl.prototype.unmount=Oi.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xn(function(){Jl(null,e,null,null)}),t[ln]=null}};function Zl(e){this._internalRoot=e}Zl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Id();e={blockedOn:null,target:e,priority:t};for(var n=0;n<pn.length&&t!==0&&t<pn[n].priority;n++);pn.splice(n,0,e),n===0&&Cd(e)}};function Di(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function eo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ou(){}function Gp(e,t,n,r,l){if(l){if(typeof r=="function"){var o=r;r=function(){var d=_l(a);o.call(d)}}var a=Wf(t,r,e,0,null,!1,!1,"",ou);return e._reactRootContainer=a,e[ln]=a.current,ms(e.nodeType===8?e.parentNode:e),Xn(),a}for(;l=e.lastChild;)e.removeChild(l);if(typeof r=="function"){var c=r;r=function(){var d=_l(i);c.call(d)}}var i=Li(e,0,!1,null,null,!1,!1,"",ou);return e._reactRootContainer=i,e[ln]=i.current,ms(e.nodeType===8?e.parentNode:e),Xn(function(){Jl(t,i,n,r)}),i}function to(e,t,n,r,l){var o=n._reactRootContainer;if(o){var a=o;if(typeof l=="function"){var c=l;l=function(){var i=_l(a);c.call(i)}}Jl(t,a,e,l)}else a=Gp(n,t,e,l,r);return _l(a)}jd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Yr(t.pendingLanes);n!==0&&(ni(t,n|1),yt(t,Be()),!(Ee&6)&&(Ar=Be()+500,Ln()))}break;case 13:Xn(function(){var r=on(e,1);if(r!==null){var l=dt();Bt(r,e,1,l)}}),zi(e,1)}};ri=function(e){if(e.tag===13){var t=on(e,134217728);if(t!==null){var n=dt();Bt(t,e,134217728,n)}zi(e,134217728)}};bd=function(e){if(e.tag===13){var t=kn(e),n=on(e,t);if(n!==null){var r=dt();Bt(n,e,t,r)}zi(e,t)}};Id=function(){return Me};kd=function(e,t){var n=Me;try{return Me=e,t()}finally{Me=n}};oa=function(e,t,n){switch(t){case"input":if(Zo(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var l=Vl(r);if(!l)throw Error(Y(90));rd(r),Zo(r,l)}}}break;case"textarea":ld(e,n);break;case"select":t=n.value,t!=null&&gr(e,!!n.multiple,t,!1)}};fd=Pi;md=Xn;var Vp={usingClientEntryPoint:!1,Events:[Es,cr,Vl,ud,dd,Pi]},Gr={findFiberByHostInstance:$n,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qp={bundleType:Gr.bundleType,version:Gr.version,rendererPackageName:Gr.rendererPackageName,rendererConfig:Gr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=gd(e),e===null?null:e.stateNode},findFiberByHostInstance:Gr.findFiberByHostInstance||Hp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qs.isDisabled&&qs.supportsFiber)try{Ul=qs.inject(Qp),Wt=qs}catch{}}It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vp;It.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Di(t))throw Error(Y(200));return Bp(e,t,null,n)};It.createRoot=function(e,t){if(!Di(e))throw Error(Y(299));var n=!1,r="",l=Xf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Li(e,1,!1,null,null,n,!1,r,l),e[ln]=t.current,ms(e.nodeType===8?e.parentNode:e),new Oi(t)};It.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Y(188)):(e=Object.keys(e).join(","),Error(Y(268,e)));return e=gd(t),e=e===null?null:e.stateNode,e};It.flushSync=function(e){return Xn(e)};It.hydrate=function(e,t,n){if(!eo(t))throw Error(Y(200));return to(null,e,t,!0,n)};It.hydrateRoot=function(e,t,n){if(!Di(e))throw Error(Y(405));var r=n!=null&&n.hydratedSources||null,l=!1,o="",a=Xf;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Wf(t,null,e,1,n??null,l,!1,o,a),e[ln]=t.current,ms(e),r)for(e=0;e<r.length;e++)n=r[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new Zl(t)};It.render=function(e,t,n){if(!eo(t))throw Error(Y(200));return to(null,e,t,!1,n)};It.unmountComponentAtNode=function(e){if(!eo(e))throw Error(Y(40));return e._reactRootContainer?(Xn(function(){to(null,null,e,!1,function(){e._reactRootContainer=null,e[ln]=null})}),!0):!1};It.unstable_batchedUpdates=Pi;It.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!eo(n))throw Error(Y(200));if(e==null||e._reactInternals===void 0)throw Error(Y(38));return to(e,t,n,!1,r)};It.version="18.3.1-next-f1338f8080-20240426";function qf(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qf)}catch(e){console.error(e)}}qf(),Xu.exports=It;var tr=Xu.exports,au=tr;Qo.createRoot=au.createRoot,Qo.hydrateRoot=au.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ns(){return Ns=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ns.apply(this,arguments)}var yn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(yn||(yn={}));const iu="popstate";function Yp(e){e===void 0&&(e={});function t(r,l){let{pathname:o,search:a,hash:c}=r.location;return $a("",{pathname:o,search:a,hash:c},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function n(r,l){return typeof l=="string"?l:$l(l)}return Xp(t,n,null,e)}function He(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function _i(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Wp(){return Math.random().toString(36).substr(2,8)}function cu(e,t){return{usr:e.state,key:e.key,idx:t}}function $a(e,t,n,r){return n===void 0&&(n=null),Ns({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Rr(t):t,{state:n,key:t&&t.key||r||Wp()})}function $l(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Rr(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Xp(e,t,n,r){r===void 0&&(r={});let{window:l=document.defaultView,v5Compat:o=!1}=r,a=l.history,c=yn.Pop,i=null,d=p();d==null&&(d=0,a.replaceState(Ns({},a.state,{idx:d}),""));function p(){return(a.state||{idx:null}).idx}function h(){c=yn.Pop;let N=p(),x=N==null?null:N-d;d=N,i&&i({action:c,location:g.location,delta:x})}function f(N,x){c=yn.Push;let m=$a(g.location,N,x);d=p()+1;let v=cu(m,d),S=g.createHref(m);try{a.pushState(v,"",S)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;l.location.assign(S)}o&&i&&i({action:c,location:g.location,delta:1})}function y(N,x){c=yn.Replace;let m=$a(g.location,N,x);d=p();let v=cu(m,d),S=g.createHref(m);a.replaceState(v,"",S),o&&i&&i({action:c,location:g.location,delta:0})}function w(N){let x=l.location.origin!=="null"?l.location.origin:l.location.href,m=typeof N=="string"?N:$l(N);return m=m.replace(/ $/,"%20"),He(x,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,x)}let g={get action(){return c},get location(){return e(l,a)},listen(N){if(i)throw new Error("A history only accepts one active listener");return l.addEventListener(iu,h),i=N,()=>{l.removeEventListener(iu,h),i=null}},createHref(N){return t(l,N)},createURL:w,encodeLocation(N){let x=w(N);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:y,go(N){return a.go(N)}};return g}var uu;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(uu||(uu={}));function qp(e,t,n){return n===void 0&&(n="/"),Kp(e,t,n)}function Kp(e,t,n,r){let l=typeof t=="string"?Rr(t):t,o=$i(l.pathname||"/",n);if(o==null)return null;let a=Kf(e);Jp(a);let c=null;for(let i=0;c==null&&i<a.length;++i){let d=ug(o);c=ag(a[i],d)}return c}function Kf(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let l=(o,a,c)=>{let i={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};i.relativePath.startsWith("/")&&(He(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),i.relativePath=i.relativePath.slice(r.length));let d=An([r,i.relativePath]),p=n.concat(i);o.children&&o.children.length>0&&(He(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Kf(o.children,t,p,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:lg(d,o.index),routesMeta:p})};return e.forEach((o,a)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))l(o,a);else for(let i of Jf(o.path))l(o,a,i)}),t}function Jf(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,l=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return l?[o,""]:[o];let a=Jf(r.join("/")),c=[];return c.push(...a.map(i=>i===""?o:[o,i].join("/"))),l&&c.push(...a),c.map(i=>e.startsWith("/")&&i===""?"/":i)}function Jp(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:og(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Zp=/^:[\w-]+$/,eg=3,tg=2,ng=1,rg=10,sg=-2,du=e=>e==="*";function lg(e,t){let n=e.split("/"),r=n.length;return n.some(du)&&(r+=sg),t&&(r+=tg),n.filter(l=>!du(l)).reduce((l,o)=>l+(Zp.test(o)?eg:o===""?ng:rg),r)}function og(e,t){return e.length===t.length&&e.slice(0,-1).every((r,l)=>r===t[l])?e[e.length-1]-t[t.length-1]:0}function ag(e,t,n){let{routesMeta:r}=e,l={},o="/",a=[];for(let c=0;c<r.length;++c){let i=r[c],d=c===r.length-1,p=o==="/"?t:t.slice(o.length)||"/",h=ig({path:i.relativePath,caseSensitive:i.caseSensitive,end:d},p),f=i.route;if(!h)return null;Object.assign(l,h.params),a.push({params:l,pathname:An([o,h.pathname]),pathnameBase:pg(An([o,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(o=An([o,h.pathnameBase]))}return a}function ig(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=cg(e.path,e.caseSensitive,e.end),l=t.match(n);if(!l)return null;let o=l[0],a=o.replace(/(.)\/+$/,"$1"),c=l.slice(1);return{params:r.reduce((d,p,h)=>{let{paramName:f,isOptional:y}=p;if(f==="*"){let g=c[h]||"";a=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const w=c[h];return y&&!w?d[f]=void 0:d[f]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:a,pattern:e}}function cg(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),_i(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],l="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,i)=>(r.push({paramName:c,isOptional:i!=null}),i?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),l+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?l+="\\/*$":e!==""&&e!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,t?void 0:"i"),r]}function ug(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return _i(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function $i(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const dg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fg=e=>dg.test(e);function mg(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:l=""}=typeof e=="string"?Rr(e):e,o;if(n)if(fg(n))o=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),_i(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+n))}n.startsWith("/")?o=fu(n.substring(1),"/"):o=fu(n,t)}else o=t;return{pathname:o,search:gg(r),hash:xg(l)}}function fu(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(l=>{l===".."?n.length>1&&n.pop():l!=="."&&n.push(l)}),n.length>1?n.join("/"):"/"}function Oo(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hg(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Fi(e,t){let n=hg(e);return t?n.map((r,l)=>l===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Ui(e,t,n,r){r===void 0&&(r=!1);let l;typeof e=="string"?l=Rr(e):(l=Ns({},e),He(!l.pathname||!l.pathname.includes("?"),Oo("?","pathname","search",l)),He(!l.pathname||!l.pathname.includes("#"),Oo("#","pathname","hash",l)),He(!l.search||!l.search.includes("#"),Oo("#","search","hash",l)));let o=e===""||l.pathname==="",a=o?"/":l.pathname,c;if(a==null)c=n;else{let h=t.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;l.pathname=f.join("/")}c=h>=0?t[h]:"/"}let i=mg(l,c),d=a&&a!=="/"&&a.endsWith("/"),p=(o||a===".")&&n.endsWith("/");return!i.pathname.endsWith("/")&&(d||p)&&(i.pathname+="/"),i}const An=e=>e.join("/").replace(/\/\/+/g,"/"),pg=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),gg=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,xg=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function vg(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Zf=["post","put","patch","delete"];new Set(Zf);const yg=["get",...Zf];new Set(yg);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function js(){return js=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},js.apply(this,arguments)}const Bi=u.createContext(null),wg=u.createContext(null),zn=u.createContext(null),no=u.createContext(null),un=u.createContext({outlet:null,matches:[],isDataRoute:!1}),em=u.createContext(null);function Sg(e,t){let{relative:n}=t===void 0?{}:t;Lr()||He(!1);let{basename:r,navigator:l}=u.useContext(zn),{hash:o,pathname:a,search:c}=nm(e,{relative:n}),i=a;return r!=="/"&&(i=a==="/"?r:An([r,a])),l.createHref({pathname:i,search:c,hash:o})}function Lr(){return u.useContext(no)!=null}function dn(){return Lr()||He(!1),u.useContext(no).location}function tm(e){u.useContext(zn).static||u.useLayoutEffect(e)}function Ve(){let{isDataRoute:e}=u.useContext(un);return e?Lg():Ng()}function Ng(){Lr()||He(!1);let e=u.useContext(Bi),{basename:t,future:n,navigator:r}=u.useContext(zn),{matches:l}=u.useContext(un),{pathname:o}=dn(),a=JSON.stringify(Fi(l,n.v7_relativeSplatPath)),c=u.useRef(!1);return tm(()=>{c.current=!0}),u.useCallback(function(d,p){if(p===void 0&&(p={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let h=Ui(d,JSON.parse(a),o,p.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:An([t,h.pathname])),(p.replace?r.replace:r.push)(h,p.state,p)},[t,r,a,o,e])}function ro(){let{matches:e}=u.useContext(un),t=e[e.length-1];return t?t.params:{}}function nm(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=u.useContext(zn),{matches:l}=u.useContext(un),{pathname:o}=dn(),a=JSON.stringify(Fi(l,r.v7_relativeSplatPath));return u.useMemo(()=>Ui(e,JSON.parse(a),o,n==="path"),[e,a,o,n])}function jg(e,t){return bg(e,t)}function bg(e,t,n,r){Lr()||He(!1);let{navigator:l}=u.useContext(zn),{matches:o}=u.useContext(un),a=o[o.length-1],c=a?a.params:{};a&&a.pathname;let i=a?a.pathnameBase:"/";a&&a.route;let d=dn(),p;if(t){var h;let N=typeof t=="string"?Rr(t):t;i==="/"||(h=N.pathname)!=null&&h.startsWith(i)||He(!1),p=N}else p=d;let f=p.pathname||"/",y=f;if(i!=="/"){let N=i.replace(/^\//,"").split("/");y="/"+f.replace(/^\//,"").split("/").slice(N.length).join("/")}let w=qp(e,{pathname:y}),g=Eg(w&&w.map(N=>Object.assign({},N,{params:Object.assign({},c,N.params),pathname:An([i,l.encodeLocation?l.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?i:An([i,l.encodeLocation?l.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),o,n,r);return t&&g?u.createElement(no.Provider,{value:{location:js({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:yn.Pop}},g):g}function Ig(){let e=Rg(),t=vg(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return u.createElement(u.Fragment,null,u.createElement("h2",null,"Unexpected Application Error!"),u.createElement("h3",{style:{fontStyle:"italic"}},t),n?u.createElement("pre",{style:l},n):null,null)}const kg=u.createElement(Ig,null);class Cg extends u.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?u.createElement(un.Provider,{value:this.props.routeContext},u.createElement(em.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ag(e){let{routeContext:t,match:n,children:r}=e,l=u.useContext(Bi);return l&&l.static&&l.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=n.route.id),u.createElement(un.Provider,{value:t},r)}function Eg(e,t,n,r){var l;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,c=(l=n)==null?void 0:l.errors;if(c!=null){let p=a.findIndex(h=>h.route.id&&(c==null?void 0:c[h.route.id])!==void 0);p>=0||He(!1),a=a.slice(0,Math.min(a.length,p+1))}let i=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let p=0;p<a.length;p++){let h=a[p];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=p),h.route.id){let{loaderData:f,errors:y}=n,w=h.route.loader&&f[h.route.id]===void 0&&(!y||y[h.route.id]===void 0);if(h.route.lazy||w){i=!0,d>=0?a=a.slice(0,d+1):a=[a[0]];break}}}return a.reduceRight((p,h,f)=>{let y,w=!1,g=null,N=null;n&&(y=c&&h.route.id?c[h.route.id]:void 0,g=h.route.errorElement||kg,i&&(d<0&&f===0?(zg("route-fallback"),w=!0,N=null):d===f&&(w=!0,N=h.route.hydrateFallbackElement||null)));let x=t.concat(a.slice(0,f+1)),m=()=>{let v;return y?v=g:w?v=N:h.route.Component?v=u.createElement(h.route.Component,null):h.route.element?v=h.route.element:v=p,u.createElement(Ag,{match:h,routeContext:{outlet:p,matches:x,isDataRoute:n!=null},children:v})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?u.createElement(Cg,{location:n.location,revalidation:n.revalidation,component:g,error:y,children:m(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):m()},null)}var rm=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(rm||{}),sm=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(sm||{});function Pg(e){let t=u.useContext(Bi);return t||He(!1),t}function Mg(e){let t=u.useContext(wg);return t||He(!1),t}function Tg(e){let t=u.useContext(un);return t||He(!1),t}function lm(e){let t=Tg(),n=t.matches[t.matches.length-1];return n.route.id||He(!1),n.route.id}function Rg(){var e;let t=u.useContext(em),n=Mg(),r=lm();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function Lg(){let{router:e}=Pg(rm.UseNavigateStable),t=lm(sm.UseNavigateStable),n=u.useRef(!1);return tm(()=>{n.current=!0}),u.useCallback(function(l,o){o===void 0&&(o={}),n.current&&(typeof l=="number"?e.navigate(l):e.navigate(l,js({fromRouteId:t},o)))},[e,t])}const mu={};function zg(e,t,n){mu[e]||(mu[e]=!0)}function Og(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Dg(e){let{to:t,replace:n,state:r,relative:l}=e;Lr()||He(!1);let{future:o,static:a}=u.useContext(zn),{matches:c}=u.useContext(un),{pathname:i}=dn(),d=Ve(),p=Ui(t,Fi(c,o.v7_relativeSplatPath),i,l==="path"),h=JSON.stringify(p);return u.useEffect(()=>d(JSON.parse(h),{replace:n,state:r,relative:l}),[d,h,l,n,r]),null}function wt(e){He(!1)}function _g(e){let{basename:t="/",children:n=null,location:r,navigationType:l=yn.Pop,navigator:o,static:a=!1,future:c}=e;Lr()&&He(!1);let i=t.replace(/^\/*/,"/"),d=u.useMemo(()=>({basename:i,navigator:o,static:a,future:js({v7_relativeSplatPath:!1},c)}),[i,c,o,a]);typeof r=="string"&&(r=Rr(r));let{pathname:p="/",search:h="",hash:f="",state:y=null,key:w="default"}=r,g=u.useMemo(()=>{let N=$i(p,i);return N==null?null:{location:{pathname:N,search:h,hash:f,state:y,key:w},navigationType:l}},[i,p,h,f,y,w,l]);return g==null?null:u.createElement(zn.Provider,{value:d},u.createElement(no.Provider,{children:n,value:g}))}function $g(e){let{children:t,location:n}=e;return jg(Fa(t),n)}new Promise(()=>{});function Fa(e,t){t===void 0&&(t=[]);let n=[];return u.Children.forEach(e,(r,l)=>{if(!u.isValidElement(r))return;let o=[...t,l];if(r.type===u.Fragment){n.push.apply(n,Fa(r.props.children,o));return}r.type!==wt&&He(!1),!r.props.index||!r.props.children||He(!1);let a={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Fa(r.props.children,o)),n.push(a)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ua(){return Ua=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ua.apply(this,arguments)}function Fg(e,t){if(e==null)return{};var n={},r=Object.keys(e),l,o;for(o=0;o<r.length;o++)l=r[o],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function Ug(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Bg(e,t){return e.button===0&&(!t||t==="_self")&&!Ug(e)}function Ba(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(l=>[n,l]):[[n,r]])},[]))}function Hg(e,t){let n=Ba(e);return t&&t.forEach((r,l)=>{n.has(l)||t.getAll(l).forEach(o=>{n.append(l,o)})}),n}const Gg=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Vg="6";try{window.__reactRouterVersion=Vg}catch{}const Qg="startTransition",hu=Om[Qg];function Yg(e){let{basename:t,children:n,future:r,window:l}=e,o=u.useRef();o.current==null&&(o.current=Yp({window:l,v5Compat:!0}));let a=o.current,[c,i]=u.useState({action:a.action,location:a.location}),{v7_startTransition:d}=r||{},p=u.useCallback(h=>{d&&hu?hu(()=>i(h)):i(h)},[i,d]);return u.useLayoutEffect(()=>a.listen(p),[a,p]),u.useEffect(()=>Og(r),[r]),u.createElement(_g,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:a,future:r})}const Wg=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Xg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pu=u.forwardRef(function(t,n){let{onClick:r,relative:l,reloadDocument:o,replace:a,state:c,target:i,to:d,preventScrollReset:p,viewTransition:h}=t,f=Fg(t,Gg),{basename:y}=u.useContext(zn),w,g=!1;if(typeof d=="string"&&Xg.test(d)&&(w=d,Wg))try{let v=new URL(window.location.href),S=d.startsWith("//")?new URL(v.protocol+d):new URL(d),j=$i(S.pathname,y);S.origin===v.origin&&j!=null?d=j+S.search+S.hash:g=!0}catch{}let N=Sg(d,{relative:l}),x=qg(d,{replace:a,state:c,target:i,preventScrollReset:p,relative:l,viewTransition:h});function m(v){r&&r(v),v.defaultPrevented||x(v)}return u.createElement("a",Ua({},f,{href:w||N,onClick:g||o?r:m,ref:n,target:i}))});var gu;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(gu||(gu={}));var xu;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(xu||(xu={}));function qg(e,t){let{target:n,replace:r,state:l,preventScrollReset:o,relative:a,viewTransition:c}=t===void 0?{}:t,i=Ve(),d=dn(),p=nm(e,{relative:a});return u.useCallback(h=>{if(Bg(h,n)){h.preventDefault();let f=r!==void 0?r:$l(d)===$l(p);i(e,{replace:f,state:l,preventScrollReset:o,relative:a,viewTransition:c})}},[d,i,p,r,l,n,e,o,a,c])}function Kg(e){let t=u.useRef(Ba(e)),n=u.useRef(!1),r=dn(),l=u.useMemo(()=>Hg(r.search,n.current?null:t.current),[r.search]),o=Ve(),a=u.useCallback((c,i)=>{const d=Ba(typeof c=="function"?c(l):c);n.current=!0,o("?"+d,i)},[o,l]);return[l,a]}const Jg={},vu=e=>{let t;const n=new Set,r=(p,h)=>{const f=typeof p=="function"?p(t):p;if(!Object.is(f,t)){const y=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(w=>w(t,y))}},l=()=>t,i={setState:r,getState:l,getInitialState:()=>d,subscribe:p=>(n.add(p),()=>n.delete(p)),destroy:()=>{(Jg?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,l,i);return i},Zg=e=>e?vu(e):vu;var om={exports:{}},am={},im={exports:{}},cm={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Er=u;function ex(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tx=typeof Object.is=="function"?Object.is:ex,nx=Er.useState,rx=Er.useEffect,sx=Er.useLayoutEffect,lx=Er.useDebugValue;function ox(e,t){var n=t(),r=nx({inst:{value:n,getSnapshot:t}}),l=r[0].inst,o=r[1];return sx(function(){l.value=n,l.getSnapshot=t,Do(l)&&o({inst:l})},[e,n,t]),rx(function(){return Do(l)&&o({inst:l}),e(function(){Do(l)&&o({inst:l})})},[e]),lx(n),n}function Do(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!tx(e,n)}catch{return!0}}function ax(e,t){return t()}var ix=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ax:ox;cm.useSyncExternalStore=Er.useSyncExternalStore!==void 0?Er.useSyncExternalStore:ix;im.exports=cm;var cx=im.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var so=u,ux=cx;function dx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fx=typeof Object.is=="function"?Object.is:dx,mx=ux.useSyncExternalStore,hx=so.useRef,px=so.useEffect,gx=so.useMemo,xx=so.useDebugValue;am.useSyncExternalStoreWithSelector=function(e,t,n,r,l){var o=hx(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=gx(function(){function i(y){if(!d){if(d=!0,p=y,y=r(y),l!==void 0&&a.hasValue){var w=a.value;if(l(w,y))return h=w}return h=y}if(w=h,fx(p,y))return w;var g=r(y);return l!==void 0&&l(w,g)?(p=y,w):(p=y,h=g)}var d=!1,p,h,f=n===void 0?null:n;return[function(){return i(t())},f===null?void 0:function(){return i(f())}]},[t,n,r,l]);var c=mx(e,o[0],o[1]);return px(function(){a.hasValue=!0,a.value=c},[c]),xx(c),c};om.exports=am;var vx=om.exports;const yx=Du(vx),um={},{useDebugValue:wx}=Ya,{useSyncExternalStoreWithSelector:Sx}=yx;let yu=!1;const Nx=e=>e;function jx(e,t=Nx,n){(um?"production":void 0)!=="production"&&n&&!yu&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),yu=!0);const r=Sx(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return wx(r),r}const wu=e=>{(um?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Zg(e):e,n=(r,l)=>jx(t,r,l);return Object.assign(n,t),n},Ms=e=>e?wu(e):wu,bx={};function Ix(e,t){let n;try{n=e()}catch{return}return{getItem:l=>{var o;const a=i=>i===null?null:JSON.parse(i,void 0),c=(o=n.getItem(l))!=null?o:null;return c instanceof Promise?c.then(a):a(c)},setItem:(l,o)=>n.setItem(l,JSON.stringify(o,void 0)),removeItem:l=>n.removeItem(l)}}const bs=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return bs(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return bs(r)(n)}}}},kx=(e,t)=>(n,r,l)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:N=>N,version:0,merge:(N,x)=>({...x,...N}),...t},a=!1;const c=new Set,i=new Set;let d;try{d=o.getStorage()}catch{}if(!d)return e((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...N)},r,l);const p=bs(o.serialize),h=()=>{const N=o.partialize({...r()});let x;const m=p({state:N,version:o.version}).then(v=>d.setItem(o.name,v)).catch(v=>{x=v});if(x)throw x;return m},f=l.setState;l.setState=(N,x)=>{f(N,x),h()};const y=e((...N)=>{n(...N),h()},r,l);let w;const g=()=>{var N;if(!d)return;a=!1,c.forEach(m=>m(r()));const x=((N=o.onRehydrateStorage)==null?void 0:N.call(o,r()))||void 0;return bs(d.getItem.bind(d))(o.name).then(m=>{if(m)return o.deserialize(m)}).then(m=>{if(m)if(typeof m.version=="number"&&m.version!==o.version){if(o.migrate)return o.migrate(m.state,m.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return m.state}).then(m=>{var v;return w=o.merge(m,(v=r())!=null?v:y),n(w,!0),h()}).then(()=>{x==null||x(w,void 0),a=!0,i.forEach(m=>m(w))}).catch(m=>{x==null||x(void 0,m)})};return l.persist={setOptions:N=>{o={...o,...N},N.getStorage&&(d=N.getStorage())},clearStorage:()=>{d==null||d.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>g(),hasHydrated:()=>a,onHydrate:N=>(c.add(N),()=>{c.delete(N)}),onFinishHydration:N=>(i.add(N),()=>{i.delete(N)})},g(),w||y},Cx=(e,t)=>(n,r,l)=>{let o={storage:Ix(()=>localStorage),partialize:g=>g,version:0,merge:(g,N)=>({...N,...g}),...t},a=!1;const c=new Set,i=new Set;let d=o.storage;if(!d)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...g)},r,l);const p=()=>{const g=o.partialize({...r()});return d.setItem(o.name,{state:g,version:o.version})},h=l.setState;l.setState=(g,N)=>{h(g,N),p()};const f=e((...g)=>{n(...g),p()},r,l);l.getInitialState=()=>f;let y;const w=()=>{var g,N;if(!d)return;a=!1,c.forEach(m=>{var v;return m((v=r())!=null?v:f)});const x=((N=o.onRehydrateStorage)==null?void 0:N.call(o,(g=r())!=null?g:f))||void 0;return bs(d.getItem.bind(d))(o.name).then(m=>{if(m)if(typeof m.version=="number"&&m.version!==o.version){if(o.migrate)return[!0,o.migrate(m.state,m.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,m.state];return[!1,void 0]}).then(m=>{var v;const[S,j]=m;if(y=o.merge(j,(v=r())!=null?v:f),n(y,!0),S)return p()}).then(()=>{x==null||x(y,void 0),y=r(),a=!0,i.forEach(m=>m(y))}).catch(m=>{x==null||x(void 0,m)})};return l.persist={setOptions:g=>{o={...o,...g},g.storage&&(d=g.storage)},clearStorage:()=>{d==null||d.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>w(),hasHydrated:()=>a,onHydrate:g=>(c.add(g),()=>{c.delete(g)}),onFinishHydration:g=>(i.add(g),()=>{i.delete(g)})},o.skipHydration||w(),y||f},Ax=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((bx?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),kx(e,t)):Cx(e,t),lo=Ax,Is={get(e){try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}},set(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(n){console.error("Failed to save to localStorage:",n)}},remove(e){try{localStorage.removeItem(e)}catch(t){console.error("Failed to remove from localStorage:",t)}},clear(){try{localStorage.clear()}catch(e){console.error("Failed to clear localStorage:",e)}}};function Ex(){if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;const t=Array.from(e).map(n=>n.toString(16).padStart(2,"0")).join("");return[t.slice(0,8),t.slice(8,12),t.slice(12,16),t.slice(16,20),t.slice(20,32)].join("-")}const Px={getItem:async e=>new Promise(t=>{const n=indexedDB.open("tunetuna-storage",1);n.onupgradeneeded=()=>{n.result.createObjectStore("zustand")},n.onsuccess=()=>{const a=n.result.transaction(["zustand"],"readonly").objectStore("zustand").get(e);a.onsuccess=()=>{t(a.result||null)},a.onerror=()=>{t(null)}},n.onerror=()=>{t(null)}}),setItem:async(e,t)=>new Promise((n,r)=>{const l=indexedDB.open("tunetuna-storage",1);l.onupgradeneeded=()=>{l.result.createObjectStore("zustand")},l.onsuccess=()=>{const i=l.result.transaction(["zustand"],"readwrite").objectStore("zustand").put(t,e);i.onsuccess=()=>{n()},i.onerror=()=>{r(i.error)}},l.onerror=()=>{r(l.error)}}),removeItem:async e=>new Promise(t=>{const n=indexedDB.open("tunetuna-storage",1);n.onsuccess=()=>{const a=n.result.transaction(["zustand"],"readwrite").objectStore("zustand").delete(e);a.onsuccess=()=>{t()},a.onerror=()=>{t()}},n.onerror=()=>{t()}})},Ce=Ms()(lo(e=>({artists:[],albums:[],songs:[],genres:[],genresLastUpdated:null,genresLastChecked:null,genreSongs:{},years:[],yearsLastUpdated:null,yearsLastChecked:null,lastSyncCompleted:null,recentlyAdded:[],recentlyPlayed:[],shufflePool:[],lastPoolUpdate:null,loading:{artists:!1,albums:!1,songs:!1,genres:!1,recentlyAdded:!1,recentlyPlayed:!1},sortPreferences:{artists:"RecentlyAdded",albums:"RecentlyAdded",songs:"RecentlyAdded",playlists:"RecentlyAdded"},setArtists:t=>e({artists:t}),setAlbums:t=>e({albums:t}),setGenres:t=>e({genres:t}),setGenreSongs:(t,n)=>e(r=>({genreSongs:{...r.genreSongs,[t]:n}})),clearGenreSongs:()=>e({genreSongs:{}}),clearGenreSongsForGenre:t=>e(n=>{const r={...n.genreSongs};return delete r[t],{genreSongs:r}}),setYears:t=>e({years:t}),setRecentlyAdded:t=>e({recentlyAdded:t}),setRecentlyPlayed:t=>e({recentlyPlayed:t}),addToRecentlyPlayed:t=>e(n=>{const r=n.recentlyPlayed.filter(o=>o.Id!==t.Id);return{recentlyPlayed:[t,...r].slice(0,10)}}),setLoading:(t,n)=>e(r=>({loading:{...r.loading,[t]:n}})),setSortPreference:(t,n)=>e(r=>({sortPreferences:{...r.sortPreferences,[t]:n}})),setSongs:t=>e({songs:t}),setLastSyncCompleted:t=>e({lastSyncCompleted:t}),refreshShufflePool:()=>e(t=>{let r=t.songs;const l=Object.values(t.genreSongs).flat().length;if(t.songs.length===0&&l>0&&(r=Object.values(t.genreSongs).flat()),r.length===0)return{shufflePool:[]};const o=new Set(t.recentlyPlayed.slice(0,10).map(d=>d.Id));r=r.filter(d=>!o.has(d.Id));let a=r;if(a.length<30){const d=t.recentlyPlayed.slice(0,30-a.length);a=[...a,...d.map(p=>t.songs.find(h=>h.Id===p.Id)).filter(Boolean)]}const c=[...a];for(let d=c.length-1;d>0;d--){const p=Math.floor(Math.random()*(d+1));[c[d],c[p]]=[c[p],c[d]]}return{shufflePool:c.slice(0,30),lastPoolUpdate:Date.now()}})}),{name:"music-storage",storage:Px,partialize:e=>({genres:e.genres,genresLastUpdated:e.genresLastUpdated,genresLastChecked:e.genresLastChecked,genreSongs:e.genreSongs,songs:e.songs,shufflePool:e.shufflePool,lastPoolUpdate:e.lastPoolUpdate,years:e.years,yearsLastUpdated:e.yearsLastUpdated,yearsLastChecked:e.yearsLastChecked,lastSyncCompleted:e.lastSyncCompleted,recentlyPlayed:e.recentlyPlayed})}));function hl(e){return e&&e.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/[\u2032\u2033]/g,"'")}function Vt(e){return e&&hl(e).replace(/'/g,"")}class Mx{constructor(){On(this,"baseUrl","");On(this,"accessToken","");On(this,"userId","");On(this,"genresCache",null);On(this,"isPreloading",!1)}get serverBaseUrl(){return this.baseUrl}setCredentials(t,n,r){this.baseUrl=t.replace(/\/$/,""),this.accessToken=n,this.userId=r,this.genresCache=null}clearGenresCache(){this.genresCache=null}getHeaders(){return{Authorization:`MediaBrowser Token="${this.accessToken}"`,"Content-Type":"application/json","X-Emby-Authorization":`MediaBrowser Client="Tunetuna", Device="Web", DeviceId="${this.getDeviceId()}", Version="1.0.0"`}}getDeviceId(){let t=Is.get("deviceId");return t||(t=Ex(),Is.set("deviceId",t)),t}async request(t,n={}){const r=`${this.baseUrl}${t}`,l=await fetch(r,{...n,headers:{...this.getHeaders(),...n.headers}});if(!l.ok)throw l.status===401?new Error("Unauthorized - please login again"):new Error(`API request failed: ${l.statusText}`);return l.json()}async authenticate(t,n,r){const l=t.replace(/\/$/,"")+"/Users/authenticatebyname",o=new AbortController,a=setTimeout(()=>{console.warn("Authentication request timed out after 30 seconds"),o.abort()},3e4);let c;try{c=await fetch(l,{method:"POST",signal:o.signal,headers:{"Content-Type":"application/json","X-Emby-Authorization":`MediaBrowser Client="Tunetuna", Device="Web", DeviceId="${this.getDeviceId()}", Version="1.0.0"`},body:JSON.stringify({Username:n,Pw:r})}),clearTimeout(a)}catch(d){if(clearTimeout(a),d instanceof Error&&d.name==="AbortError"){const h=/^https?:\/\/100\.\d+\.\d+\.\d+/.test(t)?`
  VPN/Tailscale IP detected (100.x.x.x). Your phone may not be on the same VPN network.
   Try using your local network IP instead (e.g., http://192.168.1.x:8096)
`:"";throw new Error(`Request timeout - server did not respond within 30 seconds.

Possible issues:
- Server URL may be incorrect: ${l}
- Server may be down or unreachable${h}- CORS may be blocking the request (check browser console/Network tab)
- Network connectivity issues

If this was working earlier, check:
- Is the Jellyfin server still running?
- Are there any CORS errors in the browser console?
- Try accessing ${l} directly in your browser
- If using VPN/Tailscale IP, ensure your phone is on the same network`)}if(d instanceof TypeError){const p=d.message.toLowerCase();if(p.includes("failed to fetch")||p.includes("networkerror")){const f=/^https?:\/\/100\.\d+\.\d+\.\d+/.test(t)?`
  VPN/Tailscale IP detected. Your phone may not be able to access this IP.
   Try using your local network IP instead (e.g., http://192.168.1.x:8096)
`:"";throw new Error(`Network error - unable to reach server at ${l}

Possible issues:
- CORS is blocking the request (check Jellyfin server CORS settings)${f}- Server is not accessible from this network
- Invalid server URL

Check browser console for detailed error information.`)}throw new Error(`Network error: ${d.message}`)}throw d}if(!c.ok){const d=await c.text().catch(()=>"");throw new Error(d||`Authentication failed (${c.status})`)}const i=await c.json();return this.setCredentials(t,i.AccessToken,i.User.Id),i}getImageUrl(t,n="Primary",r){if(!this.baseUrl||!t)return"";const l=r??300,c=[`quality=${l<=128?75:90}`,`fillHeight=${l}`,`fillWidth=${l}`];return r&&c.push(`maxWidth=${r}`),`${this.baseUrl}/Items/${t}/Images/${n}?${c.join("&")}`}getArtistImageUrl(t,n){return this.getImageUrl(t,"Primary",n)}getArtistBackdropUrl(t,n){return this.getImageUrl(t,"Backdrop",n)}getAlbumArtUrl(t,n){return this.getImageUrl(t,"Primary",n)}buildQueryString(t,n=!1){const r=new URLSearchParams;return t.sortBy&&t.sortBy.forEach(l=>r.append("SortBy",l)),t.sortOrder&&r.append("SortOrder",t.sortOrder),t.limit&&r.append("Limit",t.limit.toString()),t.startIndex&&r.append("StartIndex",t.startIndex.toString()),t.includeItemTypes&&t.includeItemTypes.forEach(l=>r.append("IncludeItemTypes",l)),t.recursive!==void 0&&r.append("Recursive",t.recursive.toString()),t.parentId&&r.append("ParentId",t.parentId),t.searchTerm&&t.searchTerm.trim().length>0&&r.append("SearchTerm",t.searchTerm.trim()),t.genreIds&&t.genreIds.forEach(l=>r.append("GenreIds",l)),t.artistIds&&t.artistIds.forEach(l=>r.append("ArtistIds",l)),t.albumIds&&t.albumIds.forEach(l=>r.append("AlbumIds",l)),t.years&&t.years.forEach(l=>r.append("Years",l.toString())),t.minDateLastSaved&&r.append("MinDateLastSaved",t.minDateLastSaved.toISOString()),r.append("UserId",this.userId),r.append("Fields","PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount,Genres,ProductionYear,DateCreated,DateModified,DateLastSaved"),n&&r.append("_t",Date.now().toString()),r.toString()}async getArtistById(t){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=new URLSearchParams({UserId:this.userId,Fields:"PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount,Genres,Overview"});try{return await this.request(`/Items/${t}?${n}`)}catch(r){return console.error("Failed to get artist by ID:",r),null}}async getArtists(t={}){var l;if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=this.buildQueryString({...t,includeItemTypes:["MusicArtist"],recursive:!0});let r=await this.request(`/Artists?${n}`);return(((l=r.Items)==null?void 0:l.length)||0)===0&&(r.TotalRecordCount||0)===0&&(r=await this.request(`/Items?${n}`)),{Items:r.Items||[],TotalRecordCount:r.TotalRecordCount||0,StartIndex:r.StartIndex||0}}async getAlbumById(t){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=new URLSearchParams({UserId:this.userId,Fields:"PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount,Genres,Overview"});try{return await this.request(`/Items/${t}?${n}`)}catch(r){return console.error("Failed to get album by ID:",r),null}}async getSongById(t){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=new URLSearchParams({UserId:this.userId,Fields:"PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount,Genres"});try{return await this.request(`/Items/${t}?${n}`)}catch(r){return console.error("Failed to get song by ID:",r),null}}async getAlbums(t={}){const n=this.buildQueryString({...t,includeItemTypes:["MusicAlbum"],recursive:!0});return this.request(`/Items?${n}`)}async getSongs(t={},n=!1){const r=this.buildQueryString({...t,includeItemTypes:["Audio"],recursive:!0},n);return this.request(`/Items?${r}`)}async getGenres(t=!1){if(this.genresCache&&!t)return this.genresCache;if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=Ce.getState(),r=12*60*60*1e3;if(!t&&n.genres.length>0&&n.genresLastUpdated){const l=Date.now(),o=n.genresLastChecked||0;if(!(l-o>=r))return this.genresCache=n.genres,n.genres;try{const c=await this.getRecentlyAdded(50),i=await this.getSongs({limit:50,sortBy:["DateLastSaved"],sortOrder:"Descending"}),d=[...c.Items||[],...i.Items||[]];let p=0;for(const h of d){if(h.DateCreated){const f=new Date(h.DateCreated).getTime();f>p&&(p=f)}if(h.DateLastSaved){const f=new Date(h.DateLastSaved).getTime();f>p&&(p=f)}}if(Ce.setState({genresLastChecked:l}),p<=n.genresLastUpdated)return this.genresCache=n.genres,n.genres}catch(c){return console.warn("[getGenres] Failed to check for new/modified tracks, using cached genres:",c),this.genresCache=n.genres,n.genres}}try{const l=new Map;let o=0;const a=200;let c=!0;for(;c;){const x=(await this.getAlbums({limit:a,startIndex:o})).Items||[];if(x.forEach(m=>{m.Genres&&m.Genres.forEach(v=>{const S=v.toLowerCase();l.has(S)||l.set(S,v)})}),c=x.length===a,o+=a,o>1e4)break}const i=new Set;let d=0,p=!0;for(;p;){const x=(await this.getSongs({limit:200,startIndex:d})).Items||[];if(x.forEach(m=>{m.Genres&&m.Genres.forEach(v=>{i.add(v.toLowerCase())})}),p=x.length===200,d+=200,d>1e4)break}const h=new Map,f=new Map;try{const N=new URLSearchParams({UserId:this.userId,Recursive:"true"}),x=await this.request(`/Genres?${N}`);let m=[];Array.isArray(x)?m=x:x&&typeof x=="object"&&"Items"in x&&(m=x.Items||[]),m.forEach(v=>{if(v.Name){const S=v.Name.toLowerCase();l.has(S)&&(h.set(S,v.Id),f.set(v.Id,v))}})}catch(N){console.warn("[getGenres] Failed to get genre IDs from API, will use synthetic IDs:",N)}const y=[],w=new Set;for(const[N,x]of l){if(w.has(N)||!i.has(N))continue;const m=h.get(N);if(m){const v=f.get(m);v&&(y.push(v),w.add(N))}else y.push({Id:`synthetic-${N.replace(/\s+/g,"-")}`,Name:x,Type:"Genre"}),w.add(N)}const g=Date.now();return Ce.getState().setGenres(y),Ce.setState({genresLastUpdated:g,genresLastChecked:g}),this.genresCache=y,y}catch(l){return console.error("[getGenres] Failed to build music genres:",l),n.genres.length>0?(this.genresCache=n.genres,n.genres):(this.genresCache=[],[])}}async getYears(t=!1){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=Ce.getState(),r=12*60*60*1e3;if(!t&&n.years.length>0&&n.yearsLastUpdated){const l=Date.now(),o=n.yearsLastChecked||0;if(!(l-o>=r))return n.years;try{const i=(await this.getRecentlyAdded(50)).Items||[];let d=0;for(const p of i)if(p.DateCreated){const h=new Date(p.DateCreated).getTime();h>d&&(d=h)}if(Ce.setState({yearsLastChecked:l}),d<=n.yearsLastUpdated)return n.years}catch(c){return console.warn("[getYears] Failed to check for new tracks, using cached years:",c),n.years}}try{const l=new Set;let o=0;const a=200;let c=!0;for(;c;){const h=(await this.getSongs({limit:a,startIndex:o})).Items||[];if(h.forEach(f=>{f.ProductionYear&&f.ProductionYear>0&&l.add(f.ProductionYear)}),c=h.length===a,o+=a,o>1e4)break}const i=Array.from(l).sort((p,h)=>p-h),d=Date.now();return Ce.getState().setYears(i),Ce.setState({yearsLastUpdated:d,yearsLastChecked:d}),i}catch(l){return console.error("[getYears] Failed to extract years:",l),n.years.length>0?n.years:[]}}async getGenreSongs(t,n,r=!1){let l=[];if(t.startsWith("synthetic-")||r){let c=0;const i=200;let d=!0;for(;d;){const h=(await this.getSongs({limit:i,startIndex:c},!0)).Items||[];if(l.push(...h),d=h.length===i,c+=i,c>5e4)break}}else{let c=0;const i=200;let d=!0;for(;d;){const h=(await this.getSongs({genreIds:[t],limit:i,startIndex:c})).Items||[];if(l.push(...h),d=h.length===i,c+=i,c>5e4)break}}return l.filter(c=>{var d;return(d=c.Genres)==null?void 0:d.some(p=>p.toLowerCase()===n.toLowerCase())}).map(c=>({Id:c.Id,Name:c.Name,AlbumArtist:c.AlbumArtist,ArtistItems:c.ArtistItems,Album:c.Album,AlbumId:c.AlbumId,IndexNumber:c.IndexNumber,ProductionYear:c.ProductionYear,PremiereDate:c.PremiereDate,RunTimeTicks:c.RunTimeTicks,Genres:c.Genres}))}async syncLibrary(t={scope:"incremental"}){const n=Ce.getState();if(t.scope==="incremental"){const o=n.lastSyncCompleted,a=await this.getGenres(!1);let c=[];if(o){let g=0;const N=200;let x=!0;for(;x;){const v=(await this.getSongs({minDateLastSaved:new Date(o),limit:N,startIndex:g},!0)).Items||[];if(c.push(...v),x=v.length===N,g+=N,g>1e4)break}}else c=(await this.getSongs({limit:1e3,sortBy:["DateLastSaved"],sortOrder:"Descending"})).Items||[];const i=c.map(g=>({Id:g.Id,Name:g.Name,AlbumArtist:g.AlbumArtist,ArtistItems:g.ArtistItems,Album:g.Album,AlbumId:g.AlbumId,IndexNumber:g.IndexNumber,ProductionYear:g.ProductionYear,PremiereDate:g.PremiereDate,RunTimeTicks:g.RunTimeTicks,Genres:g.Genres})),d=n.songs,p=new Set(d.map(g=>g.Id)),h=i.filter(g=>!p.has(g.Id)),f=[...d,...h];try{n.setSongs(f)}catch(g){throw g instanceof DOMException&&g.name==="QuotaExceededError"?new Error("Storage quota exceeded. Please clear some data or use a smaller sync scope."):g}const y=new Set;h.forEach(g=>{var N;(N=g.Genres)==null||N.forEach(x=>{a.forEach(m=>{var v;((v=m.Name)==null?void 0:v.toLowerCase())===x.toLowerCase()&&y.add(m.Id)})})});const w=Array.from(y).map(async g=>{const N=a.find(S=>S.Id===g);if(!(N!=null&&N.Name))return;const x=n.genreSongs[g]||[];new Set(x.map(S=>S.Id));const m=h.filter(S=>{var j;return(j=S.Genres)==null?void 0:j.some(b=>b.toLowerCase()===N.Name.toLowerCase())}),v=[...x,...m];n.setGenreSongs(g,v)});await Promise.all(w);return}this.clearGenresCache(),n.clearGenreSongs();const l=(await this.getGenres(!0)).map(async o=>{if(!(!o.Name||!o.Id))try{const a=await this.getGenreSongs(o.Id,o.Name);n.setGenreSongs(o.Id,a)}catch(a){console.warn(`[syncLibrary] Failed to load songs for genre ${o.Name}:`,a)}});await Promise.all(l)}async search(t,n=20){const r=t?hl(t.trim()):"",l=r.length>0,o=r.length,a=l&&o<3,c={limit:n,includeItemTypes:["MusicAlbum","Playlist","Audio"],recursive:!0};l&&(c.searchTerm=r,o>=3&&(c.includeItemTypes=["MusicArtist","MusicAlbum","Playlist","Audio"]));const i=this.buildQueryString(c),d=await this.request(`/Items?${i}`);let p=[];const h=[],f=[],y=[],w=new Set;if(d.Items.forEach(g=>{g.Type==="MusicArtist"?p.push(g):g.Type==="MusicAlbum"?h.push(g):g.Type==="Playlist"?f.push(g):g.Type==="Audio"&&(y.push(g),w.add(g.Id))}),a)try{const g=await this.getArtists({limit:1e3}),N=r.toLowerCase();p=(g.Items||[]).filter(x=>hl(x.Name||"").toLowerCase().includes(N))}catch(g){console.error("Failed to fetch all artists for short query:",g)}if(l&&p.length>0){const g=r.toLowerCase(),x=p.filter(v=>hl(v.Name||"").toLowerCase().includes(g)).map(v=>this.getArtistItems(v.Id).catch(S=>(console.error(`Failed to fetch songs for artist ${v.Id}:`,S),{albums:[],songs:[]})));(await Promise.all(x)).forEach(({songs:v})=>{v.forEach(S=>{w.has(S.Id)||(y.push(S),w.add(S.Id))})})}return{Artists:{Items:p,TotalRecordCount:p.length,StartIndex:0},Albums:{Items:h,TotalRecordCount:h.length,StartIndex:0},Playlists:{Items:f,TotalRecordCount:f.length,StartIndex:0},Songs:{Items:y,TotalRecordCount:y.length,StartIndex:0}}}async getRecentlyAdded(t=20){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=this.buildQueryString({limit:t,includeItemTypes:["MusicAlbum"],recursive:!0,sortBy:["DateCreated"],sortOrder:"Descending"});return await this.request(`/Items?${n}`)}async getRecentlyPlayed(t=20){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=new URLSearchParams({Limit:t.toString(),IncludeItemTypes:"Audio",Recursive:"true",SortBy:"DatePlayed",SortOrder:"Descending",Filters:"IsPlayed",UserId:this.userId,Fields:"PrimaryImageAspectRatio,Genres"});return await this.request(`/Items?${n}`)}async getAlbumTracks(t){const n=new URLSearchParams({ParentId:t,IncludeItemTypes:"Audio",SortBy:"IndexNumber",SortOrder:"Ascending",UserId:this.userId,Fields:"PrimaryImageAspectRatio,Genres"});return(await this.request(`/Items?${n}`)).Items}async getArtistItems(t){const n=new URLSearchParams({ArtistIds:t,IncludeItemTypes:"MusicAlbum,Audio",Recursive:"true",UserId:this.userId,Fields:"PrimaryImageAspectRatio,Genres"}),r=await this.request(`/Items?${n}`),l=[],o=[];return r.Items.forEach(a=>{a.Type==="MusicAlbum"?l.push(a):a.Type==="Audio"&&o.push(a)}),{albums:l,songs:o}}async getGenreItems(t,n=50){const r=this.buildQueryString({genreIds:[t],includeItemTypes:["MusicAlbum"],recursive:!0,limit:n,sortBy:["DateCreated"],sortOrder:"Descending"});return this.request(`/Items?${r}`)}async getPlaylists(t={}){const n=this.buildQueryString({...t,includeItemTypes:["Playlist"],recursive:!0});return this.request(`/Items?${n}`)}async markItemAsPlayed(t){if(!this.userId||!this.baseUrl||!t)throw new Error("Not authenticated or invalid item ID");try{await this.request(`/Users/${this.userId}/PlayedItems/${t}`,{method:"POST"})}catch(n){console.warn("Failed to mark item as played:",n)}}async getLyrics(t){if(!this.userId||!this.baseUrl||!t)return null;try{const n=[`/Items/${t}/Lyrics`,`/Items/${t}/RemoteLyrics`,`/Audio/${t}/Lyrics`];let r=null;for(const l of n){const o=new URLSearchParams({UserId:this.userId}),a=`${this.baseUrl}${l}?${o}`;try{const c=await fetch(a,{headers:this.getHeaders()});if(c.ok){const i=await c.json();if(i.Lyrics&&Array.isArray(i.Lyrics)&&i.Lyrics.length>0)return i.Lyrics.map(p=>p.Text||"").join(`
`);if(typeof i=="string")return i;if(i.Text)return i.Text}else if(c.status===404){r=`404 for ${l}`;continue}else{const i=await c.text().catch(()=>"");r=`${c.status}: ${i}`;continue}}catch(c){r=c instanceof Error?c.message:String(c);continue}}return null}catch(n){return console.warn("[getLyrics] Failed to fetch lyrics:",n),null}}}const L=new Mx,Hi=Ms()(lo(e=>({serverUrl:"",username:"",accessToken:"",userId:"",isAuthenticated:!1,login:async(t,n,r)=>{try{const l=await L.authenticate(t,n,r);e({serverUrl:t,username:n,accessToken:l.AccessToken,userId:l.User.Id,isAuthenticated:!0}),L.setCredentials(t,l.AccessToken,l.User.Id)}catch(l){throw l}},logout:()=>{e({serverUrl:"",username:"",accessToken:"",userId:"",isAuthenticated:!1}),Is.remove("auth-storage")},setCredentials:(t,n,r)=>{e({serverUrl:t,accessToken:n,userId:r,isAuthenticated:!0}),L.setCredentials(t,n,r)}}),{name:"auth-storage",onRehydrateStorage:()=>e=>{fetch("http://127.0.0.1:7244/ingest/db317f2b-adc3-4aff-b0fa-c76ea1078e11",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:"authStore.ts:66",message:"AuthStore rehydrated from localStorage",data:{rehydratedState:e,localStorageData:localStorage.getItem("auth-storage")},timestamp:Date.now(),sessionId:"debug-session",runId:"initial",hypothesisId:"A"})}).catch(()=>{})},onRehydrateStorage:()=>e=>{e!=null&&e.isAuthenticated&&e.serverUrl&&e.accessToken&&e.userId&&L.setCredentials(e.serverUrl,e.accessToken,e.userId)}})),Tt=Ms()(lo(e=>({serverUrl:"",setServerUrl:t=>e({serverUrl:t}),pageVisibility:{artists:!0,albums:!0,songs:!0,genres:!0,playlists:!0},setPageVisibility:t=>e(n=>({pageVisibility:{...n.pageVisibility,...t}})),accentColor:"blue",setAccentColor:t=>e({accentColor:t}),showQueueRecommendations:!0,setShowQueueRecommendations:t=>e({showQueueRecommendations:t}),recommendationsQuality:"good",setRecommendationsQuality:t=>e({recommendationsQuality:t})}),{name:"settings-storage"})),Su="last-server-url";function Tx(){const[e,t]=u.useState(""),[n,r]=u.useState(""),[l,o]=u.useState(""),[a,c]=u.useState(""),[i,d]=u.useState(!1),p=Hi(f=>f.login);u.useEffect(()=>{const f=Is.get(Su);f&&t(f)},[]);const h=async f=>{f.preventDefault(),c(""),d(!0),e.trim()&&Is.set(Su,e.trim());try{await p(e,n,l)}catch(y){c(y instanceof Error?y.message:"Login failed. Please check your credentials.")}finally{d(!1)}};return s.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:s.jsxs("div",{className:"w-full max-w-md",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Tunetuna"}),s.jsx("p",{className:"text-gray-400",children:"Sign in to your Jellyfin server"})]}),s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"serverUrl",className:"block text-sm font-medium text-gray-300 mb-2",children:"Server URL"}),s.jsx("input",{id:"serverUrl",type:"url",value:e,onChange:f=>t(f.target.value),placeholder:"https://your-server.com",required:!0,className:"w-full px-4 py-3 bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)] focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),s.jsx("input",{id:"username",type:"text",value:n,onChange:f=>r(f.target.value),placeholder:"Your username",required:!0,className:"w-full px-4 py-3 bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)] focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),s.jsx("input",{id:"password",type:"password",value:l,onChange:f=>o(f.target.value),placeholder:"Your password",required:!0,className:"w-full px-4 py-3 bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)] focus:border-transparent"})]}),a&&s.jsx("div",{className:"bg-red-900/30 border border-red-800 text-red-200 px-4 py-3 rounded-lg text-sm whitespace-pre-wrap",children:a}),s.jsx("button",{type:"submit",disabled:i,className:"w-full bg-[var(--accent-color)] hover:brightness-90 disabled:bg-gray-700 disabled:cursor-not-allowed text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:i?"Signing in...":"Sign In"})]})]})})}/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rx=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Lx=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),Nu=e=>{const t=Lx(e);return t.charAt(0).toUpperCase()+t.slice(1)},dm=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),zx=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ox={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dx=u.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:l="",children:o,iconNode:a,...c},i)=>u.createElement("svg",{ref:i,...Ox,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:dm("lucide",l),...!o&&!zx(c)&&{"aria-hidden":"true"},...c},[...a.map(([d,p])=>u.createElement(d,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=(e,t)=>{const n=u.forwardRef(({className:r,...l},o)=>u.createElement(Dx,{ref:o,iconNode:t,className:dm(`lucide-${Rx(Nu(e))}`,`lucide-${e}`,r),...l}));return n.displayName=Nu(e),n};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _x=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Gn=Ie("arrow-left",_x);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $x=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],zr=Ie("arrow-up-down",$x);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fx=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Gi=Ie("calendar",Fx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ux=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Vi=Ie("chevron-down",Ux);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bx=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Hx=Ie("chevron-left",Bx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Vx=Ie("chevron-right",Gx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qx=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],fm=Ie("chevron-up",Qx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Xe=Ie("disc",Yx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wx=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Qi=Ie("ellipsis",Wx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],qx=Ie("github",Xx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],Jx=Ie("grip-horizontal",Kx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zx=[["path",{d:"m11.9 12.1 4.514-4.514",key:"109xqo"}],["path",{d:"M20.1 2.3a1 1 0 0 0-1.4 0l-1.114 1.114A2 2 0 0 0 17 4.828v1.344a2 2 0 0 1-.586 1.414A2 2 0 0 1 17.828 7h1.344a2 2 0 0 0 1.414-.586L21.7 5.3a1 1 0 0 0 0-1.4z",key:"txyc8t"}],["path",{d:"m6 16 2 2",key:"16qmzd"}],["path",{d:"M8.23 9.85A3 3 0 0 1 11 8a5 5 0 0 1 5 5 3 3 0 0 1-1.85 2.77l-.92.38A2 2 0 0 0 12 18a4 4 0 0 1-4 4 6 6 0 0 1-6-6 4 4 0 0 1 4-4 2 2 0 0 0 1.85-1.23z",key:"1de1vg"}]],qn=Ie("guitar",Zx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=[["path",{d:"M19.414 14.414C21 12.828 22 11.5 22 9.5a5.5 5.5 0 0 0-9.591-3.676.6.6 0 0 1-.818.001A5.5 5.5 0 0 0 2 9.5c0 2.3 1.5 4 3 5.5l5.535 5.362a2 2 0 0 0 2.879.052 2.12 2.12 0 0 0-.004-3 2.124 2.124 0 1 0 3-3 2.124 2.124 0 0 0 3.004 0 2 2 0 0 0 0-2.828l-1.881-1.882a2.41 2.41 0 0 0-3.409 0l-1.71 1.71a2 2 0 0 1-2.828 0 2 2 0 0 1 0-2.828l2.823-2.762",key:"17lmqv"}]],t0=Ie("heart-handshake",e0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],r0=Ie("house",n0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M16 12H3",key:"1a2rj7"}],["path",{d:"M9 19H3",key:"s61nz1"}],["path",{d:"m16 16-3 3 3 3",key:"117b85"}],["path",{d:"M21 5v12a2 2 0 0 1-2 2h-6",key:"hey24a"}]],$t=Ie("list-end",s0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M11 19H3",key:"zflm78"}],["path",{d:"M21 16V5",key:"yxg4q8"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],o0=Ie("list-music",l0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=[["path",{d:"M3 5h6",key:"1ltk0q"}],["path",{d:"M3 12h13",key:"ppymz1"}],["path",{d:"M3 19h13",key:"bpdczq"}],["path",{d:"m16 8-3-3 3-3",key:"1pjpp6"}],["path",{d:"M21 19V7a2 2 0 0 0-2-2h-6",key:"4zzq67"}]],Ks=Ie("list-start",a0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M10 12H3",key:"1ulcyk"}],["path",{d:"M10 19H3",key:"108z41"}],["path",{d:"M15 12.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997a1 1 0 0 1-1.517-.86z",key:"ms4nik"}]],mm=Ie("list-video",i0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],u0=Ie("log-out",c0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]],f0=Ie("mic-vocal",d0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],h0=Ie("music",m0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Mn=Ie("pause",p0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],tt=Ie("play",g0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x0=[["path",{d:"M13 16a3 3 0 0 1 2.24 5",key:"1epib5"}],["path",{d:"M18 12h.01",key:"yjnet6"}],["path",{d:"M18 21h-8a4 4 0 0 1-4-4 7 7 0 0 1 7-7h.2L9.6 6.4a1 1 0 1 1 2.8-2.8L15.8 7h.2c3.3 0 6 2.7 6 6v1a2 2 0 0 1-2 2h-1a3 3 0 0 0-3 3",key:"ue9ozu"}],["path",{d:"M20 8.54V4a2 2 0 1 0-4 0v3",key:"49iql8"}],["path",{d:"M7.612 12.524a3 3 0 1 0-1.6 4.3",key:"1e33i0"}]],v0=Ie("rabbit",x0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ss=Ie("refresh-cw",y0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}],["path",{d:"M11 10h1v4",key:"70cz1p"}]],Yi=Ie("repeat-1",w0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Wi=Ie("repeat",S0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],j0=Ie("settings",N0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],rn=Ie("shuffle",b0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],Xi=Ie("skip-back",I0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],qi=Ie("skip-forward",k0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}],["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}]],A0=Ie("square-play",C0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=[["path",{d:"m12 10 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a8 8 0 1 0-16 0v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3l2-4h4Z",key:"1lbbv7"}],["path",{d:"M4.82 7.9 8 10",key:"m9wose"}],["path",{d:"M15.18 7.9 12 10",key:"p8dp2u"}],["path",{d:"M16.93 10H20a2 2 0 0 1 0 4H2",key:"12nsm7"}]],P0=Ie("turtle",E0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],it=Ie("user",M0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T0=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}]],R0=Ie("volume-1",T0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],z0=Ie("volume-2",L0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}]],D0=Ie("volume",O0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],hm=Ie("x",_0),Or=Ms((e,t)=>({state:"idle",source:null,message:null,abortController:null,startSync:(n,r="Syncing...")=>{const l=new AbortController;e({state:"syncing",source:n,message:r,abortController:l})},completeSync:(n,r)=>{e({state:n?"success":"error",message:r||(n?"Sync complete":"Sync failed"),abortController:null}),setTimeout(()=>{t().reset()},3e3)},cancelSync:()=>{const{abortController:n}=t();n&&n.abort(),e({state:"idle",source:null,message:null,abortController:null})},reset:()=>{e({state:"idle",source:null,message:null,abortController:null})}})),$0=new Set,ju=new Map;function F0(e,t,n=5e3){const r=setTimeout(async()=>{const l=t();if((l==null?void 0:l.Id)===e)try{await L.markItemAsPlayed(e),$0.add(e),setTimeout(()=>{window.dispatchEvent(new CustomEvent("trackPlayed",{detail:{trackId:e}}))},4e3)}catch{}ju.delete(e)},n);ju.set(e,r)}function Kt(e){const t=[...e];for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}const ye=Ms()(lo((e,t)=>({songs:[],currentIndex:-1,previousIndex:-1,standardOrder:[],shuffleOrder:[],isPlaying:!1,currentTime:0,duration:0,volume:1,shuffle:!1,repeat:"off",audioElement:null,isFetchingRecommendations:!1,isLoadingMoreSongs:!1,shuffleHasMoreSongs:!1,lastPlayedTrack:null,isShuffleAllActive:!1,isShuffleGenreActive:!1,manuallyCleared:!1,isQueueSidebarOpen:!1,setAudioElement:n=>{e({audioElement:n}),n&&(n.volume=t().volume)},setIsFetchingRecommendations:n=>{e({isFetchingRecommendations:n})},setIsLoadingMoreSongs:n=>{e({isLoadingMoreSongs:n})},setCurrentTime:n=>{e({currentTime:n})},setDuration:n=>{e({duration:n})},setVolume:n=>{e({volume:n});const r=t().audioElement;r&&(r.volume=n)},clearQueue:()=>{e(n=>{const r=n.currentIndex>=0?[n.songs[n.currentIndex]]:[];return{songs:r,currentIndex:r.length>0?0:-1,previousIndex:-1,standardOrder:r.map(l=>l.Id),shuffleOrder:r.map(l=>l.Id),manuallyCleared:!0}})},addToQueue:(n,r=!1,l="user")=>{e(o=>{const a=o.currentIndex>=0?o.songs[o.currentIndex]:null,c=n.map(g=>({...g,source:l}));let i,d=[...o.standardOrder],p=[...o.shuffleOrder],h;const f=c;if(r){const g=o.shuffle?Kt([...c]):c,N=o.currentIndex+1,x=o.songs.slice(0,N),m=o.songs.slice(N);h=[...x,...g,...m],i=h.filter(S=>S.source==="user");const v=g.map(S=>S.Id);if(o.shuffle){const S=o.currentIndex;p=[...o.shuffleOrder.slice(0,S+1),...v,...o.shuffleOrder.slice(S+1)]}else d=i.map(S=>S.Id)}else{if(l==="recommendation")h=[...o.songs,...f];else{const N=o.songs.findIndex((x,m)=>m>o.currentIndex&&x.source==="recommendation");N!==-1?h=[...o.songs.slice(0,N),...f,...o.songs.slice(N)]:h=[...o.songs,...f]}i=h.filter(N=>N.source==="user");const g=f.map(N=>N.Id);if(o.shuffle){const N=(a==null?void 0:a.source)==="recommendation"?o.currentIndex+1:o.shuffleOrder.length;p=[...o.shuffleOrder.slice(0,N),...g,...o.shuffleOrder.slice(N)]}else{const N=(a==null?void 0:a.source)==="recommendation"?o.currentIndex+1:o.standardOrder.length;d=[...o.standardOrder.slice(0,N),...g,...o.standardOrder.slice(N)]}}let y=o.currentIndex;if(!r&&o.currentIndex>=0&&l==="user"){const g=o.currentIndex;y=h.findIndex(N=>N.Id===(a==null?void 0:a.Id)),y===-1&&(console.error("[addToQueue] CRITICAL: Could not find current song in new queue!"),y=g)}let w=h;if(h.length>1e3){const g=h.slice(0,y),N=h.slice(y+1),x=g.slice(-5),m=N,v=1e3-x.length-(a?1:0)-m.length,S=g.slice(-Math.max(0,v));w=[...S,...a?[a]:[],...m],y=a?S.length:-1}return{songs:w,currentIndex:y,standardOrder:d,shuffleOrder:p,manuallyCleared:!1}})},removeFromQueue:n=>{e(r=>{if(n<0||n>=r.songs.length)return r;const l=r.songs[n],o=r.songs.filter((p,h)=>h!==n);let a=r.standardOrder.filter(p=>p!==l.Id),c=r.shuffleOrder.filter(p=>p!==l.Id),i=r.currentIndex,d=r.previousIndex;return n<r.currentIndex?i=r.currentIndex-1:n===r.currentIndex&&(i=-1),n<r.previousIndex?d=r.previousIndex-1:n===r.previousIndex&&(d=-1),{songs:o,currentIndex:i,previousIndex:d,standardOrder:a,shuffleOrder:c}})},reorderQueue:(n,r)=>{e(l=>{if(n<0||r<0||n>=l.songs.length||r>=l.songs.length||n===r)return l;const o=l.songs[n],a=l.songs[r];if(o.source!==a.source)return l;const c=[...l.songs],[i]=c.splice(n,1);if(c.splice(r,0,i),o.source==="user"){const p=l.shuffle?"shuffleOrder":"standardOrder",h=l[p],f=h.indexOf(o.Id);if(f>=0){const y=[...h];y.splice(f,1);const g=c.slice(0,r+1).filter(x=>x.source==="user").length-1;y.splice(g,0,o.Id);const N=r===l.currentIndex||n===l.currentIndex?r:l.currentIndex;return{songs:c,[p]:y,currentIndex:N,previousIndex:r===l.previousIndex||n===l.previousIndex?r:l.previousIndex}}}const d=r===l.currentIndex||n===l.currentIndex?r:l.currentIndex;return{songs:c,currentIndex:d,previousIndex:r===l.previousIndex||n===l.previousIndex?r:l.previousIndex}})},play:()=>{const{audioElement:n,currentIndex:r,songs:l}=t();if(n&&r>=0&&r<l.length){const o=l[r],a=L.serverBaseUrl,c=a?`${a}/Audio/${o.Id}/stream?static=true`:"";n.src!==c&&(n.src=c,n.load()),n.play().then(()=>{e({isPlaying:!0}),F0(o.Id,()=>t().songs[t().currentIndex]||null),Ce.getState().addToRecentlyPlayed(o)}).catch(i=>{console.error("Playback error:",i),e({isPlaying:!1})})}},pause:()=>{const n=t().audioElement;n&&(n.pause(),e({isPlaying:!1}))},togglePlayPause:()=>{const{isPlaying:n,play:r,pause:l}=t();n?l():r()},next:()=>{e(n=>{if(n.songs.length===0)return n;let r=n.currentIndex+1;if(r>=n.songs.length)if(n.repeat==="all")r=0;else return n;const l=n.currentIndex>=0?n.songs[n.currentIndex]:null;return{previousIndex:n.currentIndex,currentIndex:r,lastPlayedTrack:l}}),t().play()},previous:()=>{e(n=>{if(n.songs.length===0)return n;let r=n.currentIndex,l=n.currentIndex;if(n.currentIndex>0)r=n.currentIndex-1;else if(n.repeat==="all")r=n.songs.length-1;else return n;return{currentIndex:r,previousIndex:l}}),t().play()},seek:n=>{const r=t().audioElement;r&&(r.currentTime=n,e({currentTime:n}))},toggleShuffle:()=>{e(n=>{const r=!n.shuffle;if(r){const l=n.songs.slice(0,n.currentIndex),o=n.currentIndex>=0?n.songs[n.currentIndex]:null,a=n.songs.slice(n.currentIndex+1).filter(f=>f.source==="user"),c=n.songs.filter(f=>f.source==="recommendation"),i=Kt(a.map(f=>f.Id)),d=i.map(f=>a.find(y=>y.Id===f)).filter(Boolean),p=[...l,...o?[o]:[],...d,...c],h=[...n.standardOrder.slice(0,n.currentIndex+1),...i];return{shuffle:r,shuffleOrder:h,songs:p}}else{const l=n.songs.slice(0,n.currentIndex),o=n.currentIndex>=0?n.songs[n.currentIndex]:null,c=n.standardOrder.slice(n.currentIndex+1).map(p=>n.songs.find(h=>h.Id===p&&h.source==="user")).filter(Boolean),i=n.songs.filter(p=>p.source==="recommendation"),d=[...l,...o?[o]:[],...c,...i];return{shuffle:r,songs:d}}})},toggleRepeat:()=>{e(n=>({repeat:n.repeat==="off"?"all":n.repeat==="all"?"one":"off"}))},playTrack:(n,r)=>{let l,o;r?(l=r,o=r.findIndex(c=>c.Id===n.Id),o===-1&&(l=[n,...r.filter(c=>c.Id!==n.Id)],o=0)):(l=[n],o=0);const a=l.map(c=>({...c,source:"user"}));e({songs:a,standardOrder:a.map(c=>c.Id),shuffleOrder:a.map(c=>c.Id),currentIndex:o,previousIndex:o>0?o-1:-1,shuffle:!1,isPlaying:!1,currentTime:0,duration:0,manuallyCleared:!1}),t().play()},playAlbum:(n,r=0)=>{const l=n.map(o=>({...o,source:"user"}));e({songs:l,standardOrder:l.map(o=>o.Id),shuffleOrder:l.map(o=>o.Id),currentIndex:r,previousIndex:r>0?r-1:-1,shuffle:!1,isPlaying:!1,currentTime:0,duration:0,manuallyCleared:!1}),t().play()},playNext:n=>{t().addToQueue(n,!0)},shuffleArtist:n=>{const l=Kt(n).map(o=>({...o,source:"user"}));e({songs:l,standardOrder:l.map(o=>o.Id),shuffleOrder:l.map(o=>o.Id),currentIndex:0,previousIndex:-1,shuffle:!1,isPlaying:!1,currentTime:0,duration:0,manuallyCleared:!1}),t().play()},shuffleAllSongs:async()=>{t().clearQueue();const{setShowQueueRecommendations:n}=Tt.getState();n(!1);const l=typeof window<"u"&&window.innerWidth<768?400:800,o=Ce.getState();let a=[];if(o.shufflePool.length>=1){const h=Math.min(5,o.shufflePool.length);a=o.shufflePool.slice(0,h);const f=o.shufflePool.slice(h),y=o.songs,w=new Set(o.recentlyPlayed.slice(0,10).map(m=>m.Id)),g=y.filter(m=>!w.has(m.Id)),N=Kt(g).slice(0,h),x=[...f,...N];Ce.setState({shufflePool:x,lastPoolUpdate:Date.now()})}else{let h=o.songs;if(!h||h.length===0)try{h=(await L.getSongs({limit:Math.max(50,l),sortBy:["SortName"],sortOrder:"Ascending"})).Items||[]}catch(f){console.error("Failed to fetch songs for shuffle all:",f);return}a=Kt(h).slice(0,5),h.filter(f=>!a.some(y=>y.Id===f.Id)),Ce.setState({songs:h,shufflePool:Kt(h).slice(0,30),lastPoolUpdate:Date.now()})}const c=a.map(h=>({...h,source:"user"})),i=a.length,p=o.songs.length+Object.values(o.genreSongs).flat().length>a.length;e({songs:c,standardOrder:c.map(h=>h.Id),shuffleOrder:c.map(h=>h.Id),currentIndex:0,previousIndex:-1,shuffle:!0,isPlaying:!1,currentTime:0,duration:0,isLoadingMoreSongs:!1,shuffleHasMoreSongs:p,manuallyCleared:!0}),t().play(),setTimeout(async()=>{try{const h=t();if(!h.shuffle||h.songs.length!==i)return;let f=o.songs;(!f||f.length===0)&&(f=(await L.getSongs({limit:l,sortBy:["SortName"],sortOrder:"Ascending"})).Items||[]);const y=Object.values(o.genreSongs).flat(),w=[...f,...y],g=new Map;w.forEach(v=>g.set(v.Id,v));const N=Array.from(g.values()),x=new Set(c.map(v=>v.Id)),m=N.filter(v=>!x.has(v.Id));if(m.length>0){const v=Math.min(l-i,m.length),j=Kt(m).slice(0,v).map(k=>({...k,source:"user"})),b=[...c,...j];e({songs:b,standardOrder:b.map(k=>k.Id),shuffleOrder:b.map(k=>k.Id),shuffleHasMoreSongs:m.length>v}),Ce.getState().refreshShufflePool()}}catch(h){console.error("Failed to expand shuffle queue:",h)}},100)},shuffleGenreSongs:async(n,r)=>{t().clearQueue();const{setShowQueueRecommendations:l}=Tt.getState();l(!1);const a=typeof window<"u"&&window.innerWidth<768?400:800,c=Ce.getState().genreSongs[n];if(!c||c.length===0){console.warn(`No songs found for genre: ${r}`);return}const i=Kt(c).slice(0,5),d=c.filter(f=>!i.some(y=>y.Id===f.Id)),p=i.map(f=>({...f,source:"user"})),h=c.length>5;e({songs:p,standardOrder:p.map(f=>f.Id),shuffleOrder:p.map(f=>f.Id),currentIndex:0,previousIndex:-1,shuffle:!0,isPlaying:!1,currentTime:0,duration:0,isLoadingMoreSongs:!1,shuffleHasMoreSongs:h,manuallyCleared:!0}),t().play(),setTimeout(async()=>{try{const f=t();if(!f.shuffle||f.songs.length!==5)return;if(d.length>0){const y=Math.min(a-5,d.length),g=Kt(d).slice(0,y).map(x=>({...x,source:"user"})),N=[...p,...g];e({songs:N,standardOrder:N.map(x=>x.Id),shuffleOrder:N.map(x=>x.Id),shuffleHasMoreSongs:d.length>y})}}catch(f){console.error("Failed to expand genre shuffle queue:",f)}},100)},skipToTrack:n=>{const{songs:r,currentIndex:l}=t();if(n<0||n>=r.length)return;const o=l>=0?r[l]:null;e({previousIndex:l>=0?l:-1,currentIndex:n,lastPlayedTrack:o}),t().play()},refreshCurrentTrack:async()=>{const{currentIndex:n,songs:r}=t();if(n<0||n>=r.length)return;const l=r[n];try{const o=await L.getSongById(l.Id);o&&e(a=>{const c=[...a.songs];return c[a.currentIndex]={...c[a.currentIndex],...o},{songs:c}})}catch(o){console.error("Failed to refresh current track:",o)}},toggleQueueSidebar:()=>{e(n=>({isQueueSidebarOpen:!n.isQueueSidebarOpen}))}}),{name:"player-storage",partialize:e=>({songs:e.songs,currentIndex:e.currentIndex,previousIndex:e.previousIndex,standardOrder:e.standardOrder,shuffleOrder:e.shuffleOrder,volume:e.volume,shuffle:e.shuffle,repeat:e.repeat,lastPlayedTrack:e.lastPlayedTrack,isShuffleAllActive:e.isShuffleAllActive,isShuffleGenreActive:e.isShuffleGenreActive,manuallyCleared:e.manuallyCleared,isQueueSidebarOpen:e.isQueueSidebarOpen}),onRehydrateStorage:e=>{e&&(e.isPlaying=!1,e.currentTime=0,e.duration=0,e.audioElement=null,e.isFetchingRecommendations=!1,e.isShuffleAllActive=!1,e.isShuffleGenreActive=!1)}}));function Ft({variant:e="horizontal",onClose:t,onOpenPopover:n,popoverPosition:r,popoverDirection:l="up",className:o,onRef:a}){const{volume:c,setVolume:i}=ye(),[d,p]=u.useState(!1),[h,f]=u.useState(1),y=u.useRef(null),w=F=>{a&&e==="compact"&&a(F)},g=F=>{a&&e==="horizontal"&&a(F)};u.useEffect(()=>{const F=localStorage.getItem("lastNonZeroVolume");F?f(Math.max(.01,Math.min(1,parseFloat(F)))):c>0&&f(c)},[]),u.useEffect(()=>{c>0&&(f(c),localStorage.setItem("lastNonZeroVolume",c.toString()))},[c]);const N=()=>c===0?D0:c<=.5?R0:z0,x=u.useCallback(F=>{if(!y.current)return;const Z=y.current.getBoundingClientRect();let K,z;if(F instanceof TouchEvent||F.touches?(K=F.touches[0].clientX,z=F.touches[0].clientY):(K=F.clientX,z=F.clientY),e==="horizontal"){const C=K-Z.left,$=Math.max(0,Math.min(1,C/Z.width));i($)}else{const C=Z.bottom-z,$=Math.max(0,Math.min(1,C/Z.height));i($)}},[i,e]),m=F=>{F.preventDefault(),F.stopPropagation(),p(!0),x(F)},v=F=>{F.stopPropagation(),m(F)},S=F=>{F.stopPropagation(),k(F)},j=u.useCallback(F=>{d&&(F.preventDefault(),F.stopPropagation(),x(F))},[d,x]),b=u.useCallback(()=>{p(!1)},[]),k=F=>{F.preventDefault(),F.stopPropagation(),p(!0),x(F)},I=u.useCallback(F=>{d&&(F.preventDefault(),F.stopPropagation(),x(F))},[d,x]),E=u.useCallback(()=>{p(!1)},[]),R=F=>{F.stopPropagation(),ye.getState().volume>0?i(0):i(h)},O=F=>{F.stopPropagation()};u.useEffect(()=>{if(d)return document.addEventListener("mousemove",j),document.addEventListener("mouseup",b),document.addEventListener("touchmove",I,{passive:!1}),document.addEventListener("touchend",E),()=>{document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",b),document.removeEventListener("touchmove",I),document.removeEventListener("touchend",E)}},[d,j,b,I,E]);const ne=N();if(e==="compact")return s.jsx("button",{ref:w,onClick:F=>{F.stopPropagation(),n&&n()},className:o||"text-gray-400 hover:text-zinc-300 transition-colors",children:s.jsx(ne,{className:"w-6 h-6"})});if(e==="horizontal")return s.jsxs("div",{ref:g,className:"flex items-center gap-2 px-2 select-none",style:{width:"120px"},onClick:O,children:[s.jsx("button",{onClick:R,className:"text-gray-400 hover:text-zinc-300 flex-shrink-0",children:s.jsx(ne,{className:"w-5 h-5"})}),s.jsx("div",{ref:y,className:"flex-1 relative cursor-pointer",style:{height:"24px"},onMouseDown:v,onTouchStart:S,children:s.jsx("div",{className:"absolute top-1/2 left-0 right-0 -translate-y-1/2 h-1 bg-zinc-800 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-gray-400 rounded-full transition-all duration-100",style:{width:`${c*100}%`}})})})]});const oe=r?{position:"fixed",top:`${r.top}px`,left:`${r.left}px`,transform:l==="down"?"translate(-50%, 8px)":"translate(-50%, calc(-100% - 8px))"}:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"};return s.jsxs("div",{className:"fixed inset-0 z-50",children:[s.jsx("div",{className:"fixed inset-0",onClick:t,onTouchStart:F=>F.preventDefault(),onTouchMove:F=>F.preventDefault()}),s.jsx("div",{className:"relative z-10 bg-zinc-900 rounded-lg py-4 px-0 shadow-xl border border-zinc-700",style:oe,children:s.jsxs("div",{className:"h-[200px] w-[38px] cursor-pointer group relative touch-none mx-auto",children:[s.jsx("div",{ref:y,onMouseDown:m,onTouchStart:k,className:"absolute inset-0"}),s.jsxs("div",{className:"h-full w-1 bg-zinc-800 rounded-full relative flex flex-col justify-end mx-auto",children:[s.jsx("div",{className:"w-full bg-gray-400 rounded-full transition-all",style:{height:`${c*100}%`}}),s.jsx("div",{className:"absolute left-1/2 w-4 h-4 bg-white rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",style:{bottom:`${c*100}%`,transform:"translate(-50%, 50%)"}})]})]})})]})}const U0=[{path:"/",label:"Home",icon:r0,key:"home"},{path:"/artists",label:"Artists",icon:it,key:"artists"},{path:"/albums",label:"Albums",icon:Xe,key:"albums"},{path:"/songs",label:"Songs",icon:h0,key:"songs"},{path:"/genres",label:"Genres",icon:qn,key:"genres"},{path:"/playlists",label:"Playlists",icon:o0,key:"playlists"}];function B0(){const e=dn(),{pageVisibility:t}=Tt(),{state:n}=Or(),[r,l]=u.useState(!1),o=U0.filter(i=>i.key==="home"?!0:t[i.key]),a=(i,d)=>{window.dispatchEvent(new CustomEvent("closePlayerModal")),e.pathname===d&&i.preventDefault()},c=e.pathname.startsWith("/artists/")&&e.pathname!=="/artists";return s.jsxs(s.Fragment,{children:[s.jsxs("nav",{className:"fixed left-0 right-0 bg-zinc-900 border-t border-zinc-800 z-40 lg:hidden",style:{bottom:"calc(env(safe-area-inset-bottom) - 8px)"},children:[s.jsxs("div",{className:"relative h-16",children:[s.jsx("div",{className:"max-w-[600px] mx-auto h-full",children:s.jsx("div",{className:"flex justify-around items-center h-full",children:o.map(i=>{const d=e.pathname===i.path,p=i.icon;return s.jsxs(pu,{to:i.path,onClick:h=>a(h,i.path),className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${d?"text-[var(--accent-color)]":"text-gray-400 hover:text-zinc-300"}`,children:[s.jsx(p,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"text-xs font-medium",children:i.label})]},i.path)})})}),s.jsx("div",{className:"absolute right-4 top-3.5 hidden lg:block",children:s.jsx(Ft,{variant:"horizontal"})})]}),r&&s.jsx(Ft,{variant:"vertical",onClose:()=>l(!1)})]}),s.jsx("nav",{className:"fixed left-0 top-0 bottom-16 bg-black z-30 hidden lg:flex flex-col",style:{width:"4rem",top:n!=="idle"?"28px":"0px"},children:s.jsx("div",{className:`absolute inset-0 flex flex-col items-center justify-center ${c?"border-r border-zinc-800":""}`,children:o.map((i,d)=>{const p=e.pathname===i.path,h=i.icon;return s.jsxs(pu,{to:i.path,onClick:f=>a(f,i.path),className:`flex flex-col items-center justify-center py-5 transition-colors ${p?"text-[var(--accent-color)]":"text-gray-400 hover:text-zinc-300"} ${d<o.length-1?"mb-0":""}`,style:{marginBottom:d<o.length-1?"0px":"0"},children:[s.jsx(h,{className:"w-6 h-6 mb-2"}),s.jsx("span",{className:"text-xs font-medium text-center leading-tight",children:i.label})]},i.path)})})})]})}function Ct(){const{songs:e,currentIndex:t}=ye();return t>=0&&e[t]?e[t]:null}function Ki(){const{lastPlayedTrack:e}=ye();return e}function ct({src:e,alt:t,className:n="",fallback:r,style:l,showOutline:o,rounded:a="rounded",onError:c}){const[i,d]=u.useState(e),[p,h]=u.useState(!1),[f,y]=u.useState(!1);u.useEffect(()=>{d(e),h(!1),y(!1)},[e]);const w=()=>{!p&&r?(d(r),h(!0)):c?(c(),y(!0)):d('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23333" width="300" height="300"/%3E%3Ctext fill="%23999" font-family="sans-serif" font-size="20" dy="10.5" font-weight="bold" x="50%25" y="50%25" text-anchor="middle"%3ENo Image%3C/text%3E%3C/svg%3E')};return f?null:s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("img",{src:i,alt:t,className:`block ${n}`,onError:w,loading:"lazy",style:l}),o&&s.jsx("div",{className:`absolute inset-0 pointer-events-none border ${a}`,style:{borderColor:"rgba(24, 24, 27, 0.6)",borderWidth:"1px"}})]})}function qt(){return s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}function Ji({isOpen:e,onClose:t,children:n,zIndex:r=110}){const[l,o]=u.useState(!1),[a,c]=u.useState(!1);if(u.useEffect(()=>{if(e)o(!1),c(!0),requestAnimationFrame(()=>{requestAnimationFrame(()=>{o(!0)})}),document.body.style.overflow="hidden";else{o(!1);const d=setTimeout(()=>{c(!1),document.body.style.overflow=""},300);return()=>{clearTimeout(d),document.body.style.overflow=""}}},[e]),!a)return null;const i=s.jsxs("div",{className:"fixed inset-0",style:{zIndex:r},children:[s.jsx("div",{className:`absolute inset-0 bg-black/50 transition-opacity duration-300 ${l?"opacity-100":"opacity-0"}`,onClick:t}),s.jsx("div",{className:`absolute bottom-0 left-0 right-0 bg-zinc-900 rounded-t-2xl shadow-2xl transform transition-transform duration-300 ease-out ${l?"translate-y-0":"translate-y-full"}`,onClick:d=>d.stopPropagation(),children:s.jsx("div",{className:"pb-safe pt-4",children:s.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:n})})})]});return tr.createPortal(i,document.body)}function We({item:e,itemType:t,isOpen:n,onClose:r,zIndex:l,onNavigate:o,mode:a="mobile",position:c}){const i=Ve(),[d,p]=u.useState(!1),[h,f]=u.useState(null),{playTrack:y,playAlbum:w,addToQueue:g,playNext:N,shuffleArtist:x,toggleShuffle:m}=ye(),{startSync:v,completeSync:S}=Or(),{genres:j}=Ce();if(!e||!t)return null;const b=O=>{if(!O)return null;const ne=j.find(oe=>{var F;return((F=oe.Name)==null?void 0:F.toLowerCase())===O.toLowerCase()});return(ne==null?void 0:ne.Id)||null},k=async O=>{var ne,oe,F,Z,K;if(e){if(O.startsWith("goTo")){if(r(),o&&o(),O==="goToArtist"){const z=((oe=(ne=e.ArtistItems)==null?void 0:ne[0])==null?void 0:oe.Id)||((Z=(F=e.AlbumArtists)==null?void 0:F[0])==null?void 0:Z.Id);z&&i(`/artist/${z}`)}else if(O==="goToAlbum")e.AlbumId&&i(`/album/${e.AlbumId}`);else if(O==="goToGenre"){const z=(K=e.Genres)==null?void 0:K[0];if(z){const C=b(z);if(C)i(`/genre/${C}`);else{const D=(await L.getGenres()).find(ae=>{var W;return((W=ae.Name)==null?void 0:W.toLowerCase())===z.toLowerCase()});D!=null&&D.Id&&i(`/genre/${D.Id}`)}}}return}p(!0),f(O);try{switch(t){case"album":{if(O==="play"){const z=await L.getAlbumTracks(e.Id),{shuffle:C}=ye.getState();C&&m(),w(z)}else if(O==="shuffle"){const z=await L.getAlbumTracks(e.Id),{shuffle:C}=ye.getState();C&&m(),w(z),requestAnimationFrame(()=>{const{shuffle:$}=ye.getState();$||m()})}else if(O==="playNext"){const z=await L.getAlbumTracks(e.Id);N(z)}else if(O==="addToQueue"){const z=await L.getAlbumTracks(e.Id);g(z)}else if(O==="sync"){v("context-menu",`Syncing ${e.Name}...`);try{await L.getAlbumTracks(e.Id),S(!0,`${e.Name} synced`)}catch{S(!1,`Failed to sync ${e.Name}`)}}break}case"song":{if(O==="play")console.log("ContextMenu: Playing song",e.Name),y(e);else if(O==="playNext")console.log("ContextMenu: Adding song to play next",e.Name),N([e]);else if(O==="addToQueue")console.log("ContextMenu: Adding song to queue",e.Name),g([e]);else if(O==="sync"){v("context-menu",`Syncing ${e.Name}...`);try{const z=await L.getSongById(e.Id);if(z.Genres){const C=await L.getGenres();z.Genres.forEach($=>{const D=C.find(ae=>{var W;return((W=ae.Name)==null?void 0:W.toLowerCase())===$.toLowerCase()});D!=null&&D.Id&&Ce.getState().clearGenreSongsForGenre(D.Id)})}S(!0,`${e.Name} synced`)}catch{S(!1,`Failed to sync ${e.Name}`)}}break}case"artist":{if(O==="shuffle"){const{songs:z}=await L.getArtistItems(e.Id);x(z)}else if(O==="playNext"){const{songs:z}=await L.getArtistItems(e.Id);N(z)}else if(O==="addToQueue"){const{songs:z}=await L.getArtistItems(e.Id);g(z)}else if(O==="sync"){v("context-menu",`Syncing ${e.Name}...`);try{await L.getArtistItems(e.Id),S(!0,`${e.Name} synced`)}catch{S(!1,`Failed to sync ${e.Name}`)}}break}case"playlist":{if(O==="play"){const z=await L.getAlbumTracks(e.Id),{shuffle:C}=ye.getState();C&&m(),w(z)}else if(O==="shuffle"){const z=await L.getAlbumTracks(e.Id),{shuffle:C}=ye.getState();C&&m(),w(z),requestAnimationFrame(()=>{const{shuffle:$}=ye.getState();$||m()})}else if(O==="playNext"){const z=await L.getAlbumTracks(e.Id);N(z)}else if(O==="addToQueue"){const z=await L.getAlbumTracks(e.Id);g(z)}break}}r()}catch(z){console.error("Context menu action failed:",z)}finally{p(!1),f(null)}}},E=(()=>{var O,ne,oe,F,Z,K,z,C;switch(t){case"album":{const $=((ne=(O=e.ArtistItems)==null?void 0:O[0])==null?void 0:ne.Name)||((F=(oe=e.AlbumArtists)==null?void 0:oe[0])==null?void 0:F.Name)||"Artist",D=((Z=e.Genres)==null?void 0:Z[0])||"Genre";return[{id:"play",label:"Play",icon:tt},{id:"shuffle",label:"Shuffle",icon:rn},{id:"playNext",label:"Play Next",icon:Ks},{id:"addToQueue",label:"Add to Queue",icon:$t},{id:"goToArtist",label:`Go to ${$}`,icon:it},{id:"goToGenre",label:`Go to ${D}`,icon:qn},{id:"sync",label:"Sync",icon:ss}]}case"song":{const $=((z=(K=e.ArtistItems)==null?void 0:K[0])==null?void 0:z.Name)||e.AlbumArtist||"Artist",D=e.Album||"Album",ae=((C=e.Genres)==null?void 0:C[0])||"Genre";return[{id:"play",label:"Play",icon:tt},{id:"playNext",label:"Play Next",icon:Ks},{id:"addToQueue",label:"Add to Queue",icon:$t},{id:"goToArtist",label:`Go to ${$}`,icon:it},{id:"goToAlbum",label:`Go to ${D}`,icon:Xe},{id:"goToGenre",label:`Go to ${ae}`,icon:qn},{id:"sync",label:"Sync",icon:ss}]}case"artist":return[{id:"shuffle",label:"Shuffle",icon:rn},{id:"playNext",label:"Play Next",icon:Ks},{id:"addToQueue",label:"Add to Queue",icon:$t},{id:"sync",label:"Sync",icon:ss}];case"playlist":return[{id:"play",label:"Play",icon:tt},{id:"shuffle",label:"Shuffle",icon:rn},{id:"playNext",label:"Play Next",icon:Ks},{id:"addToQueue",label:"Add to Queue",icon:$t}];default:return[]}})(),R=e.Name||"Unknown";if(a==="desktop"&&n){const ne=Math.min(400,E.length*44+8);let oe=(c==null?void 0:c.x)||100,F=(c==null?void 0:c.y)||100;return oe+240>window.innerWidth&&(oe=window.innerWidth-240-10),F+ne>window.innerHeight&&(F=window.innerHeight-ne-10),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40",onClick:r,style:{zIndex:l-1}}),s.jsx("div",{className:"fixed z-50 bg-zinc-900 border border-zinc-700 rounded-lg shadow-2xl py-1 min-w-[200px]",style:{left:oe,top:F,zIndex:l},onClick:Z=>Z.stopPropagation(),children:s.jsx("div",{className:"space-y-0",children:E.map(Z=>{const K=Z.icon,z=d&&h===Z.id;return s.jsxs("button",{onClick:()=>k(Z.id),disabled:d,className:"w-full flex items-center gap-3 px-4 py-2 hover:bg-zinc-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-left",children:[s.jsx(K,{className:"w-4 h-4 text-white flex-shrink-0"}),s.jsx("span",{className:"flex-1 text-sm text-white",children:Z.label}),z&&s.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin flex-shrink-0"})]},Z.id)})})})]})}return s.jsx(Ji,{isOpen:n,onClose:r,zIndex:l,children:s.jsxs("div",{className:"pb-6",children:[s.jsx("div",{className:"mb-4 ml-4",children:s.jsx("div",{className:"text-lg font-semibold text-white break-words",children:R})}),s.jsx("div",{className:"space-y-1",children:E.map(O=>{const ne=O.icon,oe=d&&h===O.id;return s.jsxs("button",{onClick:()=>k(O.id),disabled:d,className:"w-full flex items-center gap-4 pl-4 pr-4 py-3 rounded-lg hover:bg-white/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(ne,{className:"w-5 h-5 text-white"}),s.jsx("span",{className:"flex-1 text-left text-white font-medium",children:O.label}),oe&&s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})]},O.id)})})]})})}function Te({onLongPress:e,onClick:t,delay:n=500,moveThreshold:r=10}){const l=u.useRef(null),o=u.useRef(null),a=u.useRef(!1),c=u.useRef(null),i=u.useRef(!1),d=u.useCallback(f=>{a.current=!1,i.current=!1,o.current=f.target,!("button"in f&&f.button!==0)&&(f.preventDefault(),"touches"in f&&f.touches.length>0?c.current={x:f.touches[0].clientX,y:f.touches[0].clientY}:c.current=null,l.current=setTimeout(()=>{i.current||(a.current=!0,e(f))},n))},[e,n]),p=u.useCallback(f=>{if(!c.current||f.touches.length===0)return;const y=f.touches[0].clientX,w=f.touches[0].clientY,g=Math.abs(y-c.current.x),N=Math.abs(w-c.current.y);Math.sqrt(g*g+N*N)>r&&(i.current=!0,l.current&&(clearTimeout(l.current),l.current=null))},[r]),h=u.useCallback(f=>{if("button"in f&&f.button!==0){a.current=!1,i.current=!1,o.current=null,c.current=null;return}const y=a.current;l.current&&(clearTimeout(l.current),l.current=null),t&&o.current===f.target&&!y&&!i.current&&t(f),a.current=!1,i.current=!1,o.current=null,c.current=null},[t]);return{onMouseDown:d,onTouchStart:d,onTouchMove:p,onMouseUp:h,onMouseLeave:f=>{l.current&&(clearTimeout(l.current),l.current=null),a.current=!1,i.current=!1,o.current=null,c.current=null},onTouchEnd:h}}const H0=45,G0=45;function Js({track:e,index:t,isCurrent:n,isPlaying:r,showRemoveButton:l=!0,onClick:o,onRemove:a,onReorderDragStart:c,onReorderDragEnd:i,onReorderDrop:d,onContextMenu:p,isDragOver:h,onDragEnterRow:f}){var N,x;const y=u.useRef(!1),w=Te({onLongPress:m=>{m.preventDefault(),y.current=!0,p(e,"mobile"),setTimeout(()=>{y.current=!1},300)}}),g=m=>{if(y.current){m.preventDefault(),m.stopPropagation();return}o()};return s.jsxs("div",{onDragOver:m=>{m.preventDefault(),m.dataTransfer.dropEffect="move"},onDragEnter:m=>{m.preventDefault(),n||f(t)},onDrop:m=>!n&&d(m,t),className:`queue-row flex items-center gap-3 p-3 ${n?"cursor-pointer":"hover:bg-zinc-900 cursor-pointer"} ${n?"bg-zinc-900":""} relative`,onClick:n?void 0:g,onContextMenu:m=>{m.preventDefault(),y.current=!0,p(e,"desktop",{x:m.clientX,y:m.clientY}),setTimeout(()=>{y.current=!1},300)},...w,children:[h&&!n&&s.jsx("div",{className:"absolute left-3 right-3 top-0 h-0.5 bg-[var(--accent-color)] rounded-full pointer-events-none"}),s.jsx("div",{className:"queue-drag-art w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 ml-1",children:s.jsx(ct,{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:`text-sm font-medium truncate ${n?"text-[var(--accent-color)]":"text-white"}`,children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((x=(N=e.ArtistItems)==null?void 0:N[0])==null?void 0:x.Name)||"Unknown Artist"})]}),n?s.jsx("button",{onClick:m=>{m.stopPropagation(),o()},className:"text-gray-400 hover:text-zinc-300 transition-colors p-2",children:r?s.jsx(Mn,{className:"w-5 h-5"}):s.jsx(tt,{className:"w-5 h-5"})}):s.jsx(s.Fragment,{children:l&&s.jsxs(s.Fragment,{children:[s.jsx("button",{draggable:!0,onMouseDown:m=>m.stopPropagation(),onTouchStart:m=>m.stopPropagation(),onDragStart:m=>{m.stopPropagation(),c(m,t)},onDragEnd:m=>{m.stopPropagation(),i()},className:"text-gray-500 hover:text-zinc-300 transition-colors p-2 cursor-grab active:cursor-grabbing",children:s.jsx(Jx,{className:"w-4 h-4"})}),a&&s.jsx("button",{onClick:m=>{m.stopPropagation(),a()},className:"text-gray-400 hover:text-zinc-300 transition-colors p-2",children:s.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})}function pm({onNavigateFromContextMenu:e,header:t,contentPaddingBottom:n="8rem"}){const[r,l]=u.useState(!1),[o,a]=u.useState(null),[c,i]=u.useState("mobile"),[d,p]=u.useState(null),[h,f]=u.useState(null),[y,w]=u.useState(null),[g,N]=u.useState(H0),[x,m]=u.useState(!1),{songs:v,currentIndex:S,isPlaying:j,togglePlayPause:b,skipToTrack:k,removeFromQueue:I,reorderQueue:E,isFetchingRecommendations:R,isLoadingMoreSongs:O}=ye(),{showQueueRecommendations:ne,setShowQueueRecommendations:oe,recommendationsQuality:F}=Tt(),Z=(X,q)=>{X.dataTransfer.effectAllowed="move",X.dataTransfer.setData("text/plain",q.toString()),w(q);const te=X.currentTarget,U=te==null?void 0:te.closest(".queue-row");if(U&&X.dataTransfer.setDragImage){const pe=U.querySelector(".queue-drag-art")??U,le=pe.getBoundingClientRect();X.dataTransfer.setDragImage(pe,le.width/2,le.height/2)}},K=()=>{w(null),f(null)},z=(X,q)=>{X.preventDefault();const te=X.dataTransfer.getData("text/plain")||X.dataTransfer.getData("text/html"),U=parseInt(te,10);if(Number.isNaN(U))return;const pe=v[y??U],le=v[q];if(pe&&le&&pe.source!==le.source){f(null),w(null);return}U!==q&&E(U,q),f(null),w(null)},C=S>=0?v[S]:null,$=v.filter((X,q)=>q<S);let D=-1;for(let X=v.length-1;X>S;X--)if(v[X].source==="user"){D=X;break}const ae=v.filter((X,q)=>q<=S?!1:D!==-1?q<=D:!1),W=v.filter((X,q)=>X.source!=="recommendation"||q<=S?!1:D!==-1?q>D:!0);let Ne=g;const he=$.slice(-Math.min(Ne,$.length));Ne-=he.length,Ne-=C?1:0;const me=ae.slice(0,Math.max(0,Ne));Ne-=me.length;const ge=W.slice(0,Math.max(0,Ne)),Se=(X,q="mobile",te)=>{a(X),i(q),p(te||null),l(!0)},ue=X=>{if(y==null)return;const q=v[y],te=v[X];if(!(!q||!te)){if(q.source!==te.source){f(null);return}f(X)}};return u.useEffect(()=>{const X=document.querySelector(".queue-list-container");if(!X)return;const q=()=>{const te=X.scrollTop,U=X.clientHeight,B=X.scrollHeight;te+U*2.5>=B&&N(pe=>Math.min(pe+G0,v.length))};return X.addEventListener("scroll",q,{passive:!0}),q(),()=>X.removeEventListener("scroll",q)},[v.length]),s.jsx("div",{className:"flex-1 flex flex-col min-h-0 w-full relative",children:s.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 queue-list-container w-full",style:{paddingBottom:"8rem"},children:[s.jsxs("div",{className:"max-w-[864px] mx-auto w-full",children:[t,v.length===0&&!C?s.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 py-10",children:s.jsx("p",{children:"Queue is empty"})}):s.jsxs("div",{children:[he.length>0&&x&&s.jsxs("div",{children:[s.jsxs("div",{className:"px-4 pb-0 pt-7 flex items-center justify-between",children:[s.jsx("div",{className:"text-base font-bold text-white tracking-wider",children:"Previous"}),s.jsx("button",{onClick:()=>m(!1),className:"text-xs font-semibold text-gray-300 hover:opacity-80 transition-opacity tracking-wider",children:"Hide"})]}),he.map((X,q)=>{const te=v.indexOf(X);return s.jsx(Js,{track:X,index:te,isCurrent:!1,isPlaying:!1,showRemoveButton:!1,onClick:()=>k(te),onReorderDragStart:Z,onReorderDragEnd:K,onReorderDrop:z,onContextMenu:Se,isDragOver:!1,onDragEnterRow:ue},`${X.Id}-${q}`)})]}),C&&s.jsxs("div",{children:[s.jsxs("div",{className:"px-4 pb-0 pt-7 flex items-center justify-between",children:[s.jsx("div",{className:"text-base font-bold text-white tracking-wider",children:"Now Playing"}),he.length>0&&!x&&s.jsx("button",{onClick:()=>m(!0),className:"text-xs font-semibold text-gray-300 hover:opacity-80 transition-opacity tracking-wider",children:"Show Previous"})]}),s.jsx(Js,{track:C,index:S,isCurrent:!0,isPlaying:j,showRemoveButton:!1,onClick:b,onReorderDragStart:Z,onReorderDragEnd:K,onReorderDrop:z,onContextMenu:Se,isDragOver:!1,onDragEnterRow:ue})]}),me.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"px-4 pb-0 pt-7 flex items-center justify-between",children:[s.jsx("div",{className:"text-base font-bold text-white tracking-wider",children:"Coming Up"}),s.jsx("button",{onClick:()=>{const q=v.filter((U,B)=>B<=S||U.source==="recommendation"),te=Math.min(S,q.length-1);ye.setState({songs:q,currentIndex:te,standardOrder:q.filter(U=>U.source==="user").map(U=>U.Id),shuffleOrder:q.filter(U=>U.source==="user").map(U=>U.Id)})},className:"text-xs font-semibold text-gray-300 hover:opacity-80 transition-opacity tracking-wider",children:"Clear"})]}),me.map((X,q)=>{const te=v.indexOf(X);return s.jsx(Js,{track:X,index:te,isCurrent:!1,isPlaying:!1,showRemoveButton:!0,onClick:()=>k(te),onRemove:()=>I(te),onReorderDragStart:Z,onReorderDragEnd:K,onReorderDrop:z,onContextMenu:Se,isDragOver:h===te,onDragEnterRow:ue},`${X.Id}-${q}`)}),O&&s.jsxs("div",{className:"flex items-center justify-center py-4",children:[s.jsx(qt,{}),s.jsx("span",{className:"ml-2 text-sm text-gray-400",children:"Loading more songs..."})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"px-4 pb-0 pt-7 flex items-center justify-between",children:[s.jsxs("div",{className:"text-base font-bold text-white tracking-wider flex items-baseline gap-2",children:["Recommendations",R&&s.jsx("span",{className:"text-xs text-gray-400 font-normal",children:"Syncing genres..."}),!R&&F==="failed"&&s.jsx("span",{className:"text-xs text-red-400 font-normal",children:"(Unable to generate)"})]}),s.jsx("button",{onClick:()=>{const X=!ne;if(oe(X),!X){const q=v.filter(U=>U.source!=="recommendation"),te=Math.min(S,q.length-1);ye.setState({songs:q,currentIndex:te,standardOrder:q.filter(U=>U.source==="user").map(U=>U.Id),shuffleOrder:q.filter(U=>U.source==="user").map(U=>U.Id)})}},className:`relative w-12 h-6 rounded-full transition-colors ${ne?"bg-[var(--accent-color)]":"bg-zinc-600"}`,children:s.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${ne?"translate-x-6":"translate-x-0"}`})})]}),ne&&s.jsxs(s.Fragment,{children:[ge.map((X,q)=>{const te=v.indexOf(X);return s.jsx(Js,{track:X,index:te,isCurrent:!1,isPlaying:!1,showRemoveButton:!0,onClick:()=>k(te),onRemove:()=>I(te),onReorderDragStart:Z,onReorderDragEnd:K,onReorderDrop:z,onContextMenu:Se,isDragOver:h===te,onDragEnterRow:ue},`${X.Id}-${q}`)}),R&&s.jsx("div",{className:"px-4 pt-4 pb-6 flex justify-center",children:s.jsx(qt,{})})]})]})]})]}),s.jsx(We,{item:o,itemType:o?"song":null,isOpen:r,onClose:()=>{l(!1),a(null)},onNavigate:e,mode:c,position:d||void 0})]})})}function V0({onClose:e,onNavigateFromContextMenu:t}){const n=u.useRef(null),[r,l]=u.useState(!1),[o,a]=u.useState(null),{songs:c,currentIndex:i,isPlaying:d,shuffle:p,repeat:h,togglePlayPause:f,toggleShuffle:y,toggleRepeat:w,next:g,previous:N}=ye(),x=i>=0&&i<c.length-1,m=i>0;return s.jsxs("div",{className:"flex-1 flex flex-col min-h-0 w-full",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[s.jsx(pm,{onNavigateFromContextMenu:t,contentPaddingBottom:"8rem"}),s.jsx("div",{ref:n,className:"px-6 pt-2 space-y-6 flex-shrink-0 max-w-[864px] mx-auto w-full",style:{paddingBottom:"1.5rem"},children:s.jsxs("div",{className:"flex items-center justify-center gap-8 relative",children:[s.jsx("button",{onClick:y,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${p?"text-[var(--accent-color)]":"text-gray-400 hover:text-zinc-300"}`,children:s.jsx(rn,{className:"w-6 h-6"})}),s.jsx("button",{onClick:N,disabled:!m,className:`w-12 h-12 flex-shrink-0 aspect-square flex items-center justify-center rounded-full transition-colors ${m?"text-white hover:bg-zinc-800 active:bg-zinc-800":"text-zinc-600 cursor-not-allowed"}`,children:s.jsx(Xi,{className:"w-8 h-8"})}),s.jsx("button",{onClick:f,className:"w-16 h-16 flex items-center justify-center rounded-full transition-colors aspect-square bg-[var(--accent-color)] text-white hover:opacity-90",children:d?s.jsx(Mn,{className:"w-8 h-8"}):s.jsx(tt,{className:"w-8 h-8"})}),s.jsx("button",{onClick:g,disabled:!x,className:`w-12 h-12 flex-shrink-0 aspect-square flex items-center justify-center rounded-full transition-colors ${x?"text-white hover:bg-zinc-800 active:bg-zinc-800":"text-zinc-600 cursor-not-allowed"}`,children:s.jsx(qi,{className:"w-8 h-8"})}),s.jsx("button",{onClick:w,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${h!=="off"?"text-[var(--accent-color)]":"text-gray-400 hover:text-zinc-300"}`,children:h==="one"?s.jsx(Yi,{className:"w-6 h-6"}):s.jsx(Wi,{className:"w-6 h-6"})}),s.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 hidden md:flex md:-mr-6",children:s.jsx(Ft,{variant:"horizontal"})})]})}),r&&o&&s.jsx(Ft,{variant:"vertical",onClose:()=>l(!1),popoverPosition:o})]})}function Q0(){const e=Ct(),t=Ki(),n=e||t,[r,l]=u.useState(null),[o,a]=u.useState(!1);return u.useEffect(()=>{(async()=>{if(!n){l(null);return}a(!0);try{const i=await L.getLyrics(n.Id);l(i)}catch(i){console.error("Failed to fetch lyrics:",i),l(null)}finally{a(!1)}})()},[n==null?void 0:n.Id]),n?s.jsx("div",{className:"fixed left-0 right-0 bg-zinc-900 z-[55] flex flex-col",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 4rem)",bottom:"calc(11rem + env(safe-area-inset-bottom))"},children:s.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 px-6 py-4 relative",children:[s.jsx("div",{className:"sticky left-0 right-0 h-16 bg-gradient-to-b from-zinc-900 via-zinc-900/50 to-transparent pointer-events-none z-10 -mx-6",style:{top:"-24px"}}),o?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("div",{className:"text-gray-400",children:"Loading lyrics..."})}):r?s.jsx("div",{className:"max-w-[768px] mx-auto pb-8",children:s.jsx("div",{className:"text-white text-left whitespace-pre-line leading-relaxed",children:r.split(`
`).map((c,i)=>s.jsx("div",{className:"mb-2",children:c},i))})}):s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("div",{className:"text-gray-400 text-center",children:"This song has no lyrics"})}),s.jsx("div",{className:"sticky left-0 right-0 h-16 bg-gradient-to-t from-zinc-900 via-zinc-900/50 to-transparent pointer-events-none z-10 -mx-6",style:{bottom:"-16px"}})]})}):null}function Y0({onClose:e,onClosingStart:t,closeRef:n}){const r=Ve(),{songs:l,currentIndex:o,isPlaying:a,currentTime:c,duration:i,shuffle:d,repeat:p,togglePlayPause:h,next:f,previous:y,seek:w,setVolume:g,toggleShuffle:N,toggleRepeat:x,playTrack:m}=ye(),v=Ct(),S=Ki(),j=v||S,[b,k]=u.useState(!1);u.useEffect(()=>{k(!1)},[]);const[I,E]=u.useState(!1),[R,O]=u.useState(!1),[ne,oe]=u.useState(null),[F,Z]=u.useState("up"),[K,z]=u.useState(null),[C,$]=u.useState(null),[D,ae]=u.useState(!1),[W,Ne]=u.useState(!1),[he,me]=u.useState(!1),[ge,Se]=u.useState(!1),ue=u.useRef(null),X=u.useRef(null),q=u.useRef(null),te=u.useRef(null),U=u.useRef(!1),B=u.useRef(null);u.useEffect(()=>{const se=window.getComputedStyle(document.body).overflowY,M=window.getComputedStyle(document.documentElement).overflowY,J=document.getElementById("root")?window.getComputedStyle(document.getElementById("root")).overflowY:"N/A";document.body.style.overflowY="hidden",document.documentElement.style.overflowY="hidden";const Pe=document.getElementById("root");return Pe&&(Pe.style.overflowY="hidden"),()=>{document.body.style.overflowY=se,document.documentElement.style.overflowY=M,Pe&&(Pe.style.overflowY=J!=="N/A"?J:"")}},[]),u.useEffect(()=>{requestAnimationFrame(()=>{me(!0)})},[]);const pe=o>=0&&o<l.length-1,le=o>0;u.useEffect(()=>{(async()=>{if(!j){ae(!1);return}try{const M=await L.getLyrics(j.Id),J=M!==null&&M.trim().length>0;ae(J)}catch(M){console.warn("[PlayerModal] Lyrics check failed:",M),ae(!1)}})()},[j]);const P=se=>{if(!se)return"Unknown";if(se.Name&&se.Name.trim())return se.Name;const M=se.Path;return M&&typeof M=="string"&&(M.split("/").pop()||M.split("\\").pop())||"Unknown"},V=se=>{var M,J;return se&&(se.AlbumArtist||((J=(M=se.ArtistItems)==null?void 0:M[0])==null?void 0:J.Name))||""};if(u.useEffect(()=>{"mediaSession"in navigator&&j&&(navigator.mediaSession.metadata=new MediaMetadata({title:P(j),artist:V(j),album:j.Album||"",artwork:[{src:L.getAlbumArtUrl(j.AlbumId||j.Id,512),sizes:"512x512",type:"image/jpeg"}]}),navigator.mediaSession.setActionHandler("play",h),navigator.mediaSession.setActionHandler("pause",h),navigator.mediaSession.setActionHandler("previoustrack",y),navigator.mediaSession.setActionHandler("nexttrack",f))},[j,a,h,f,y]),u.useEffect(()=>{Se(!1)},[j==null?void 0:j.Id]),!j)return null;const G=i>0?c/i*100:0,fe=se=>{const M=Math.floor(se/60),J=Math.floor(se%60);return`${M}:${J.toString().padStart(2,"0")}`},re=()=>{if(j.Name&&j.Name.trim())return j.Name;const se=j.Path;return se&&typeof se=="string"&&(se.split("/").pop()||se.split("\\").pop())||"Unknown"},de=()=>{var se,M;return j.AlbumArtist||((M=(se=j.ArtistItems)==null?void 0:se[0])==null?void 0:M.Name)},T=j.AlbumId&&j.Album&&j.Album.trim(),A=se=>{if(!ue.current||!i||U.current)return;const M=ue.current.getBoundingClientRect(),J=(se.clientX-M.left)/M.width;w(Math.max(0,Math.min(1,J))*i)},H=se=>{if(!ue.current||!i)return;U.current=!0,B.current=se.clientX;const M=ue.current.getBoundingClientRect(),J=(se.clientX-M.left)/M.width;w(Math.max(0,Math.min(1,J))*i)},ee=()=>{U.current=!1,B.current=null},ie=se=>{if(!ue.current||!i)return;se.stopPropagation(),U.current=!0;const M=se.touches[0],J=ue.current.getBoundingClientRect(),Pe=(M.clientX-J.left)/J.width;w(Math.max(0,Math.min(1,Pe))*i)},xe=se=>{if(!U.current||!ue.current||!i)return;se.stopPropagation(),se.preventDefault();const M=se.touches[0],J=ue.current.getBoundingClientRect(),Pe=(M.clientX-J.left)/J.width;w(Math.max(0,Math.min(1,Pe))*i)},je=se=>{se.stopPropagation(),U.current=!1,B.current=null};u.useEffect(()=>{const se=J=>{if(!U.current||!ue.current||!i)return;const Pe=ue.current.getBoundingClientRect(),_=(J.clientX-Pe.left)/Pe.width;w(Math.max(0,Math.min(1,_))*i)},M=()=>{U.current&&(U.current=!1,B.current=null)};return document.addEventListener("mousemove",se),document.addEventListener("mouseup",M),()=>{document.removeEventListener("mousemove",se),document.removeEventListener("mouseup",M)}},[i,w]);const Q=()=>{Ne(!0),t==null||t(),setTimeout(()=>{e()},300)},we=(se="up")=>{const M=se==="down"?C:K;if(M){const J=M.getBoundingClientRect();oe({top:se==="down"?J.bottom:J.top,left:J.left+J.width/2}),Z(se),O(!0)}};u.useEffect(()=>(n&&(n.current=Q),()=>{n&&(n.current=null)}),[n]);const be=se=>{b||I||(X.current=se.touches[0].clientY,q.current=Date.now())},Ae=se=>{if(b||I||X.current===null)return;const J=se.touches[0].clientY-X.current;if(J>0&&te.current){const Pe=Math.min(J,window.innerHeight*.5);te.current.style.transform=`translateY(${Pe}px)`}},qe=se=>{if(b||I||X.current===null||q.current===null){X.current=null,q.current=null,te.current&&(te.current.style.transform="");return}const J=se.changedTouches[0].clientY-X.current,Pe=Date.now()-q.current,_=50,ve=.3;te.current&&(te.current.style.transform="");const rt=J/Pe;(J>_||J>30&&rt>ve)&&Q(),X.current=null,q.current=null};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
      @media (min-aspect-ratio: 4/3) and (min-width: 768px) {
        .landscape\\:flex-row { flex-direction: row; }
        .landscape\\:items-center { align-items: center; }
        .landscape\\:gap-8 { gap: 2rem; }
        .landscape\\:order-1 { order: 1; }
        .landscape\\:flex-shrink-0 { flex-shrink: 0; }
        .landscape\\:order-2 { order: 2; }
        .landscape\\:text-left { text-align: left; }
        .landscape\\:flex-1 { flex: 1; }
        .landscape\\:max-w-xs { max-width: 20rem; }
        .landscape\\:justify-start { justify-content: flex-start; }
        .landscape\\:mx-0 { margin-left: 0; margin-right: 0; }
      }

      @media (min-width: 1024px) {
        .lg\\:max-w-\\[864px\\] { max-width: 864px; }
      }
    `}),s.jsxs("div",{ref:te,onTouchStart:be,onTouchMove:Ae,onTouchEnd:qe,className:`fixed left-0 right-0 bg-zinc-900 z-[70] flex flex-col transition-transform duration-300 ease-out ${W?"translate-y-full":he?"translate-y-0":"translate-y-full"}`,style:{top:"var(--header-offset, 0px)",paddingTop:"calc(env(safe-area-inset-top) + var(--header-offset, 0px))",bottom:"calc(-1 * env(safe-area-inset-bottom))",height:"calc(100% + env(safe-area-inset-bottom) + var(--header-offset, 0px))",transition:X.current===null?"transform 300ms ease-out":"none"},children:[s.jsxs("div",{className:"flex items-center justify-between p-4 relative",children:[s.jsx("div",{className:"flex items-center gap-2 z-10 flex-shrink-0",children:s.jsx("button",{onClick:Q,className:"text-white hover:text-zinc-300 transition-colors z-10 flex-shrink-0",children:s.jsx(Vi,{className:"w-8 h-8"})})}),I&&j&&s.jsx("h2",{className:"absolute left-0 right-0 text-center text-white text-sm sm:text-base font-medium px-20 truncate",children:re()}),s.jsxs("div",{className:"flex items-center gap-2 z-10 flex-shrink-0",children:[s.jsx("div",{className:`md:hidden ${I?"hidden":""}`,children:s.jsx(Ft,{variant:"compact",onOpenPopover:()=>we("down"),onRef:$,className:"text-white hover:text-zinc-300 transition-colors p-2"})}),D&&!b&&s.jsx("button",{onClick:()=>E(!I),className:`transition-colors p-2 ${I?"text-[var(--accent-color)] hover:text-[var(--accent-color)]":"text-white hover:text-zinc-300"}`,children:s.jsx(f0,{className:"w-6 h-6"})}),s.jsx("button",{onClick:()=>{b||E(!1),k(!b)},className:"text-white hover:text-zinc-300 transition-colors p-2 xl:hidden",children:b?s.jsx(A0,{className:"w-6 h-6"}):s.jsx(mm,{className:"w-6 h-6"})})]})]}),b?s.jsx(V0,{onClose:()=>k(!1),onNavigateFromContextMenu:()=>{Q()}}):s.jsxs("div",{className:"flex-1 flex flex-col min-h-0 max-w-[768px] lg:max-w-[864px] mx-auto w-full relative",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[s.jsx("div",{className:"flex-1 overflow-hidden min-h-0 flex items-center justify-center",children:s.jsx("div",{className:"w-full flex flex-col items-center px-4 sm:px-8 md:pr-0",children:s.jsxs("div",{className:"w-full flex flex-col items-center landscape:flex-row landscape:items-center landscape:gap-8",children:[s.jsx("div",{className:"landscape:order-1 landscape:flex-shrink-0",children:s.jsx("div",{className:`rounded overflow-hidden mb-4 lg:mb-8 bg-zinc-900 ${ge?"":"shadow-2xl"}`,style:{width:"clamp(224px, min(70vw, 50vh), 480px)",height:"clamp(224px, min(70vw, 50vh), 480px)",maxWidth:"100%"},children:ge?s.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-zinc-900 flex items-center justify-center relative",children:s.jsx("img",{src:"/assets/vinyl.png",alt:"Vinyl Record",className:"w-full h-full object-cover",onError:se=>{console.error("Failed to load vinyl image"),se.currentTarget.style.display="none"}})}):s.jsx(ct,{src:L.getAlbumArtUrl(j.AlbumId||j.Id),alt:j.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>Se(!0)})})}),s.jsxs("div",{className:"text-center landscape:text-left w-full landscape:order-2 landscape:flex-1 landscape:max-w-xs",children:[s.jsx("h3",{className:"text-xl sm:text-2xl font-bold mb-2",children:re()}),de()&&s.jsxs("button",{onClick:()=>{var M,J;const se=(J=(M=j.ArtistItems)==null?void 0:M[0])==null?void 0:J.Id;se&&(e(),r(`/artist/${se}`))},className:"flex items-center justify-start landscape:justify-start gap-2 text-gray-400 text-base sm:text-lg hover:text-white transition-colors mx-auto landscape:mx-0 landscape:text-left max-w-full min-w-0",children:[s.jsx(it,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"break-words min-w-0",children:de()})]}),T&&s.jsxs("button",{onClick:()=>{e(),r(`/album/${j.AlbumId}`)},className:"flex items-center justify-start landscape:justify-start gap-2 text-gray-400 text-base sm:text-lg hover:text-white transition-colors mx-auto landscape:mx-0 landscape:text-left mt-1 max-w-full min-w-0",children:[s.jsx(Xe,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),s.jsx("span",{className:"break-words min-w-0",children:j.Album})]})]})]})})}),s.jsxs("div",{className:"pt-2 space-y-6 flex-shrink-0 mt-4 sm:mt-0 max-w-[768px] lg:max-w-[864px] mx-auto w-full",style:{paddingBottom:"1.5rem"},children:[s.jsx("div",{className:"space-y-3 px-4 w-full",children:s.jsxs("div",{className:"max-w-[768px] lg:max-w-[864px] mx-auto",children:[s.jsx("div",{ref:ue,className:"h-2 bg-zinc-800 rounded-full cursor-pointer w-full select-none overflow-hidden",onClick:A,onMouseDown:H,onMouseUp:ee,onMouseLeave:ee,onTouchStart:ie,onTouchMove:xe,onTouchEnd:je,children:s.jsx("div",{className:"h-full bg-[var(--accent-color)] transition-all",style:{width:`${G}%`,borderTopLeftRadius:"9999px",borderBottomLeftRadius:"9999px",borderTopRightRadius:G>=100?"9999px":"0",borderBottomRightRadius:G>=100?"9999px":"0"}})}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[s.jsx("span",{children:fe(c)}),s.jsx("span",{children:fe(i)})]})]})}),s.jsxs("div",{className:"flex items-center justify-center gap-8 px-6 relative",children:[s.jsx("button",{onClick:N,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${d?"text-[var(--accent-color)]":"text-gray-400 hover:text-zinc-300"}`,children:s.jsx(rn,{className:"w-6 h-6"})}),s.jsx("button",{onClick:y,disabled:!le,className:`w-12 h-12 flex-shrink-0 aspect-square flex items-center justify-center rounded-full transition-colors ${le?"text-white hover:bg-zinc-800 active:bg-zinc-800":"text-gray-600 cursor-not-allowed"}`,children:s.jsx(Xi,{className:"w-8 h-8"})}),s.jsx("button",{onClick:()=>{v?h():j&&m(j)},className:"w-16 h-16 flex items-center justify-center rounded-full transition-colors aspect-square bg-[var(--accent-color)] text-white hover:opacity-90",children:a&&v?s.jsx(Mn,{className:"w-8 h-8"}):s.jsx(tt,{className:"w-8 h-8"})}),s.jsx("button",{onClick:f,disabled:!pe,className:`w-12 h-12 flex-shrink-0 aspect-square flex items-center justify-center rounded-full transition-colors ${pe?"text-white hover:bg-zinc-800 active:bg-zinc-800":"text-gray-600 cursor-not-allowed"}`,children:s.jsx(qi,{className:"w-8 h-8"})}),s.jsx("button",{onClick:x,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${p!=="off"?"text-[var(--accent-color)]":"text-gray-400 hover:text-zinc-300"}`,children:p==="one"?s.jsx(Yi,{className:"w-6 h-6"}):s.jsx(Wi,{className:"w-6 h-6"})}),s.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 hidden md:flex",children:s.jsx(Ft,{variant:"horizontal"})})]})]})]}),I&&s.jsx(Q0,{}),R&&ne&&s.jsx(Ft,{variant:"vertical",onClose:()=>O(!1),popoverPosition:ne,popoverDirection:F})]})]})}function W0(){var U,B,pe,le;const{songs:e,currentIndex:t,isPlaying:n,currentTime:r,duration:l,audioElement:o,setAudioElement:a,togglePlayPause:c,next:i,setCurrentTime:d,setDuration:p,playTrack:h,repeat:f,shuffle:y,toggleShuffle:w,toggleRepeat:g,previous:N,seek:x}=ye(),m=Ct(),v=Ki(),[S,j]=u.useState(!1),[b,k]=u.useState(!1),[I,E]=u.useState(!1),[R,O]=u.useState(!1),[ne,oe]=u.useState(null),[F,Z]=u.useState(null),[K,z]=u.useState(null),C=u.useRef(null),$=u.useRef(null),D=dn(),ae=u.useRef(null),W=u.useRef(null),Ne=u.useRef(null);u.useEffect(()=>{S&&(k(!0),setTimeout(()=>{j(!1),k(!1)},300))},[D.pathname]),u.useEffect(()=>{j(!1),k(!1)},[]),u.useEffect(()=>{const P=()=>{S&&$.current&&$.current()};return window.addEventListener("closePlayerModal",P),()=>{window.removeEventListener("closePlayerModal",P)}},[S]);const he=()=>{k(!0),setTimeout(()=>{j(!1),k(!1)},300)};u.useEffect(()=>{C.current||(C.current=new Audio,C.current.setAttribute("playsinline","true"),C.current.setAttribute("preload","auto"),a(C.current));const P=C.current;if(!P)return;const V=()=>{d(P.currentTime)},G=()=>{p(P.duration)},fe=async()=>{if(m)try{await L.markItemAsPlayed(m.Id),setTimeout(()=>{window.dispatchEvent(new CustomEvent("trackPlayed",{detail:{trackId:m.Id}}))},4e3)}catch{}i()},re=()=>{ye.setState({isPlaying:!0})},de=()=>{ye.setState({isPlaying:!1})};return P.addEventListener("timeupdate",V),P.addEventListener("loadedmetadata",G),P.addEventListener("ended",fe),P.addEventListener("play",re),P.addEventListener("pause",de),()=>{P.removeEventListener("timeupdate",V),P.removeEventListener("loadedmetadata",G),P.removeEventListener("ended",fe),P.removeEventListener("play",re),P.removeEventListener("pause",de)}},[a,d,p,i]),u.useEffect(()=>{C.current&&(C.current.volume=ye.getState().volume)},[]),u.useEffect(()=>{if(m&&!n&&o){const P=L.serverBaseUrl,V=P?`${P}/Audio/${m.Id}/stream?static=true`:"";o.src!==V&&(o.src=V,o.load())}},[m,n,o]),u.useEffect(()=>{if(o&&m&&!n){const P=L.serverBaseUrl,V=P?`${P}/Audio/${m.Id}/stream?static=true`:"";o.src!==V&&(o.src=V,o.load())}},[o,m,n]);const me=m||v;u.useEffect(()=>{E(!1)},[me==null?void 0:me.Id]);const ge=l>0?r/l*100:0,Se=e.length>0&&(t<0||t<e.length-1||f==="all"),ue=t>0,X=()=>{const V=window.innerWidth<768?K:F;if(V){const G=V.getBoundingClientRect();oe({top:G.top,left:G.left+G.width/2}),O(!0)}},q=P=>{ae.current=P.touches[0].clientX,W.current=Date.now()},te=P=>{if(ae.current===null||W.current===null){ae.current=null,W.current=null;return}const G=P.changedTouches[0].clientX-ae.current,fe=Date.now()-W.current,re=50,de=.3,T=Math.abs(G)/fe;G>re||G>30&&T>de?ue&&N():(G<-re||G<-30&&T>de)&&Se&&i(),ae.current=null,W.current=null};return me?s.jsxs(s.Fragment,{children:[s.jsxs("div",{ref:Ne,className:"fixed left-0 right-0 bg-zinc-900 border-t border-zinc-800 z-40 cursor-pointer bottom-[calc(4rem-8px)] lg:bottom-0",style:{paddingBottom:"env(safe-area-inset-bottom)"},onClick:()=>{j(!0)},onTouchStart:q,onTouchEnd:te,children:[s.jsx("div",{className:"hidden lg:block",children:me&&s.jsx("div",{className:"h-1 bg-zinc-800 hover:bg-zinc-600 cursor-pointer transition-colors duration-200",onClick:P=>{if(P.stopPropagation(),!l)return;const V=P.currentTarget.getBoundingClientRect(),G=(P.clientX-V.left)/V.width;x(Math.max(0,Math.min(1,G))*l)},onTouchStart:P=>{if(P.stopPropagation(),!l)return;const V=P.touches[0],G=P.currentTarget.getBoundingClientRect(),fe=(V.clientX-G.left)/G.width;x(Math.max(0,Math.min(1,fe))*l)},children:s.jsx("div",{className:"h-full bg-[var(--accent-color)] transition-all",style:{width:`${ge}%`}})})}),s.jsxs("div",{className:"hidden md:block md:relative md:px-4 md:py-3",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0 max-w-[37%]",children:[!I&&s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900",children:s.jsx(ct,{src:L.getAlbumArtUrl((m||me).AlbumId||(m||me).Id,96),alt:(m||me).Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm",onError:()=>E(!0)},(m==null?void 0:m.Id)||me.Id)}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate",children:(m||me).Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:(m||me).AlbumArtist||((B=(U=(m||me).ArtistItems)==null?void 0:U[0])==null?void 0:B.Name)||"Unknown Artist"})]})]}),s.jsxs("div",{className:"absolute top-1/2 -translate-y-1/2 md:right-16 md:left-auto md:translate-x-0 lg:left-1/2 lg:right-auto lg:-translate-x-1/2 flex items-center gap-2",children:[s.jsx("button",{onClick:P=>{P.stopPropagation(),w()},className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${y?"text-[var(--accent-color)]":"text-gray-400 hover:text-zinc-300"}`,children:s.jsx(rn,{className:"w-5 h-5"})}),s.jsx("button",{onClick:P=>{P.stopPropagation(),ue&&N()},disabled:!ue,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${ue?"text-white hover:bg-zinc-800":"text-gray-600 cursor-not-allowed"}`,children:s.jsx(Xi,{className:"w-5 h-5"})}),s.jsx("button",{onClick:P=>{P.stopPropagation(),m?c():me&&h(me)},className:"w-10 h-10 mx-2 flex items-center justify-center rounded-full transition-colors text-white bg-[var(--accent-color)] hover:opacity-90",children:n&&m?s.jsx(Mn,{className:"w-5 h-5"}):s.jsx(tt,{className:"w-5 h-5"})}),s.jsx("button",{onClick:P=>{P.stopPropagation(),Se&&i()},disabled:!Se,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${Se?"text-white hover:bg-zinc-800":"text-gray-600 cursor-not-allowed"}`,children:s.jsx(qi,{className:"w-5 h-5"})}),s.jsx("button",{onClick:P=>{P.stopPropagation(),g()},className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${f!=="off"?"text-[var(--accent-color)]":"text-gray-400 hover:text-zinc-300"}`,children:f==="one"?s.jsx(Yi,{className:"w-5 h-5"}):s.jsx(Wi,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-4",children:[s.jsx("div",{className:"hidden xl:block",children:!ye(P=>P.isQueueSidebarOpen)&&s.jsx("button",{onClick:P=>{P.stopPropagation(),ye.getState().toggleQueueSidebar()},className:"text-gray-400 hover:text-white transition-colors flex items-center justify-center w-10 h-10",title:"Open Queue",children:s.jsx(mm,{className:"w-5 h-5"})})}),s.jsx("div",{className:"hidden lg:block",onClick:P=>P.stopPropagation(),children:s.jsx(Ft,{variant:"horizontal"})}),s.jsx("div",{className:"hidden md:block lg:hidden",children:s.jsx(Ft,{variant:"compact",onOpenPopover:X,onRef:Z,className:"w-10 h-10 flex items-center justify-center text-white hover:text-zinc-300 transition-colors"})})]})]}),s.jsxs("div",{className:"flex items-center gap-3 py-3 pr-3 pl-4 md:hidden",children:[!I&&s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900",children:s.jsx(ct,{src:L.getAlbumArtUrl((m||me).AlbumId||(m||me).Id,96),alt:(m||me).Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm",onError:()=>E(!0)},(m==null?void 0:m.Id)||me.Id)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate",children:(m||me).Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:(m||me).AlbumArtist||((le=(pe=(m||me).ArtistItems)==null?void 0:pe[0])==null?void 0:le.Name)||"Unknown Artist"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ft,{variant:"compact",onOpenPopover:X,onRef:z,className:"text-white hover:text-zinc-300 transition-colors"}),s.jsx("button",{onClick:P=>{P.stopPropagation(),m?c():me&&h(me)},className:"w-10 h-10 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors",children:n&&m?s.jsx(Mn,{className:"w-5 h-5"}):s.jsx(tt,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"lg:hidden",children:me&&s.jsx("div",{className:"h-1 bg-zinc-800 hover:bg-zinc-600 cursor-pointer transition-colors duration-200",onClick:P=>{if(P.stopPropagation(),!l)return;const V=P.currentTarget.getBoundingClientRect(),G=(P.clientX-V.left)/V.width;x(Math.max(0,Math.min(1,G))*l)},onTouchStart:P=>{if(P.stopPropagation(),!l)return;const V=P.touches[0],G=P.currentTarget.getBoundingClientRect(),fe=(V.clientX-G.left)/G.width;x(Math.max(0,Math.min(1,fe))*l)},children:s.jsx("div",{className:"h-full bg-[var(--accent-color)] transition-all",style:{width:`${ge}%`}})})})]}),S&&s.jsx(Y0,{onClose:he,onClosingStart:()=>k(!0),closeRef:$}),R&&ne&&s.jsx(Ft,{variant:"vertical",onClose:()=>O(!1),popoverPosition:ne})]}):null}function X0(){const{state:e,message:t,cancelSync:n}=Or(),{isQueueSidebarOpen:r}=ye();if(e==="idle")return null;const l=()=>{switch(e){case"syncing":return"bg-zinc-800";case"success":return"bg-green-800";case"error":return"bg-red-800";default:return"bg-zinc-800"}};return s.jsx("div",{className:`fixed top-0 left-0 right-0 z-[10002] ${l()} transition-colors duration-300 lg:pl-16`,style:{height:"28px",top:"0px",paddingRight:r?"var(--sidebar-width)":"0px"},children:s.jsx("div",{className:"max-w-[768px] w-full mx-auto lg:flex lg:justify-center h-full",children:s.jsxs("div",{className:"w-full max-w-[768px] h-full flex items-center justify-between px-4",children:[s.jsx("span",{className:"text-white text-sm font-medium truncate",children:t}),e==="syncing"&&s.jsx("button",{onClick:n,className:"text-white text-sm font-medium hover:text-zinc-300 transition-colors",children:"Cancel"})]})})})}const _o=new Set;async function q0(e){const t=e.toLowerCase();if(_o.has(t)){console.log(`[Recommendations] Genre "${e}" is already being synced, skipping...`);return}_o.add(t);try{console.log(`[Recommendations] Auto-syncing genre "${e}" for better recommendations...`);const{genres:n,setGenreSongs:r}=Ce.getState();let l=n;l.length===0&&(l=await L.getGenres());const o=l.find(c=>c.Name&&e&&c.Name.toLowerCase()===e.toLowerCase());if(!o||!o.Id){console.warn(`[Recommendations] Genre "${e}" not found in server`);return}console.log(`[Recommendations] Fetching songs for genre "${e}"...`);const a=await L.getGenreSongs(o.Id,e);a.length>0?(r(o.Id,a),console.log(`[Recommendations]  Successfully cached ${a.length} songs for genre "${e}"`)):console.warn(`[Recommendations] No songs found for genre "${e}" on server`)}catch(n){console.error(`[Recommendations] Failed to sync genre "${e}":`,n)}finally{setTimeout(()=>{_o.delete(t)},1e4)}}async function K0({currentTrack:e,queue:t}){var x,m,v;const n=((m=(x=import.meta)==null?void 0:x.env)==null?void 0:m.DEV)??!1;if(!e)return n&&console.log("[Recommendations] No current track"),{recommendations:[],hasGenreMatches:!1};const{songs:r,genreSongs:l,genres:o}=Ce.getState(),a=e.Genres||[];let c=[];if(a.length>0&&o.length>0){const S=o.filter(j=>j.Name&&a.some(b=>b.toLowerCase()===j.Name.toLowerCase())).map(j=>j.Id).filter(j=>l[j]&&l[j].length>0);S.length>0&&(c=S.flatMap(j=>l[j]),n&&console.log(`[Recommendations] Using ${c.length} pre-filtered songs from ${S.length} matching genres`))}if(c.length===0&&r.length>0&&(c=r,n&&console.log(`[Recommendations] Using ${c.length} songs from main cache`)),c.length===0){const S=Object.values(l).flat();S.length>0&&(c=S,n&&console.log(`[Recommendations] Using ${c.length} songs from all genre caches`))}if(c.length===0){n&&console.log("[Recommendations] No cached songs available");const{setRecommendationsQuality:S}=Tt.getState();return S("failed"),console.warn("Couldn't generate recommendations. Try syncing your library"),{recommendations:[],hasGenreMatches:!1}}n&&(console.log("[Recommendations] Using",c.length,"available songs"),console.log("[Recommendations] Current track genres:",a,"(count:",a.length+")"),console.log("[Recommendations] Current track year:",e.ProductionYear),console.log("[Recommendations] Queue size:",t.length),console.log("[Recommendations] Sample available songs:",c.slice(0,3).map(S=>{var j;return`${S.Name} (${S.ProductionYear}) [${(j=S.Genres)==null?void 0:j.join(", ")}]`})));let i=[],d=!1;const p=()=>i.flatMap(S=>{var j;return((j=S.ArtistItems)==null?void 0:j.map(b=>b.Id))||[]});if(a.length>0){let S=0,j=0,b=0,k=0;const I=c.filter(R=>{var Z,K;return((Z=R.Genres)==null?void 0:Z.some(z=>a.some(C=>z.toLowerCase()===C.toLowerCase())))?(S++,R.Id!==e.Id?t.some(z=>z.Id===R.Id)?(b++,!1):(K=R.ArtistItems)!=null&&K.some(z=>p().includes(z.Id))?(k++,!1):!0:(j++,!1)):!1});if(console.log("[Recommendations] Genre matching results:",{totalGenreMatches:S,filteredByCurrentTrack:j,filteredByQueue:b,filteredByArtist:k,passedAllFilters:I.length}),S===0&&a.length>0){console.log("[Recommendations] No songs found matching genres:",a),console.log("[Recommendations] Triggering auto-sync for these genres...");for(const R of a)q0(R).catch(O=>console.error(`[Recommendations] Genre sync failed for ${R}:`,O));return{recommendations:[],hasGenreMatches:!1,triggeredGenreSync:!0}}const E=$o(I);i.push(...E.slice(0,8)),n&&console.log(`[Recommendations] Added ${Math.min(E.length,8)} genre matches to recommendations`),a.length>0&&I.length>0?d=!0:a.length>0&&I.length===0&&(console.warn("[Recommendations] No genre matches passed filters - falling back to year/artist matching"),d=!1)}else n&&console.log("[Recommendations] No genres on current track");const h=e.ProductionYear;if(h&&i.length<10){const S=[{range:3,years:Array.from({length:7},(E,R)=>h-3+R)},{range:6,years:Array.from({length:13},(E,R)=>h-6+R)},{range:10,years:Array.from({length:21},(E,R)=>h-10+R)}];let j=[];for(const{years:E}of S){if(j.length>=12)break;const R=c.filter(O=>{var z;const ne=O.ProductionYear&&E.includes(O.ProductionYear),oe=!t.some(C=>C.Id===O.Id),F=!i.some(C=>C.Id===O.Id),Z=O.Id!==e.Id,K=!((z=O.ArtistItems)!=null&&z.some(C=>p().includes(C.Id)));return ne&&Z&&oe&&F&&K});j.push(...R)}const b=Array.from(new Map(j.map(E=>[E.Id,E])).values()),I=$o(b).slice(0,12);i.push(...I),n&&console.log(`[Recommendations] Total year matches used: ${I.length}`)}const f=$o(i),y=[],w=[...f];for(;w.length>0&&y.length<12;){let S=-1;if(y.length>0){const k=((v=y[y.length-1].ArtistItems)==null?void 0:v.map(I=>I.Id))||[];S=w.findIndex(I=>{var R;return!(((R=I.ArtistItems)==null?void 0:R.map(O=>O.Id))||[]).some(O=>k.includes(O))})}S===-1&&(S=0);const j=w.splice(S,1)[0];y.push(j)}const g=y,{setRecommendationsQuality:N}=Tt.getState();return console.log("[Recommendations] Quality decision:",{finalRecommendationsCount:g.length,genreMatchSuccess:d,hasGenres:a.length>0,availableSongsCount:c.length}),g.length===0?(console.log("[Recommendations] Got 0 final recommendations"),N("failed")):!d&&a.length>0?(console.log("[Recommendations] No genre matches found, setting degraded quality"),N("degraded")):N("good"),n&&(console.log(`[Recommendations] Generated ${g.length} recommendations`),g.length>0&&console.log("[Recommendations] Sample:",g.slice(0,3).map(S=>S.Name))),{recommendations:g,hasGenreMatches:d,triggeredGenreSync:!1}}function $o(e){if(e.length<=1)return[...e];const t=[...e];for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}function J0(e){const t=[...e];for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}function Z0(){const{songs:e,currentIndex:t,addToQueue:n,refreshCurrentTrack:r,isFetchingRecommendations:l,setIsFetchingRecommendations:o}=ye(),{showQueueRecommendations:a}=Tt(),c=u.useRef([]),i=u.useRef(!1),d=u.useRef(0),p=u.useRef(0),h=u.useRef(0),f=3;u.useEffect(()=>{c.current=e.slice(-20)},[e]),u.useEffect(()=>{d.current=0,p.current=0,h.current=0},[t]),u.useEffect(()=>{d.current=0,p.current=0,h.current=0},[a]),u.useEffect(()=>{const y=e.slice(t+1).filter(m=>m.source==="recommendation").length,w=Date.now()-d.current,g=Date.now()-p.current;if(!!!(a&&!i.current&&!l&&t>=0&&y<12&&w>1e4&&g>5e3)){if(y>=12)return;g<=5e3&&console.log(`[Recommendations] Waiting for cooldown (${5-Math.floor(g/1e3)}s remaining)`);return}(async()=>{var v;console.log("[Recommendations] Starting fetch, setting isRecommending = true"),i.current=!0,o(!0);const m=setTimeout(()=>{console.log("[Recommendations] Safety timeout triggered, resetting flags"),i.current=!1,o(!1)},3e4);try{await r();const S=e[t];if(!S)return;const j=[S],b=[t-1,t+1,t+2];for(const K of b)if(K>=0&&K<e.length&&j.length<3){const z=e[K];z&&!j.some(C=>C.Id===z.Id)&&j.push(z)}const k=[];for(const K of j){console.log(`[Recommendations] Generating recommendations for seed: ${K.Name}`);const z=await K0({currentTrack:K,queue:e,recentQueue:c.current,lastPlayedTrack:null});if(console.log(`[Recommendations] Result for seed ${K.Name}:`,{recommendationsCount:((v=z.recommendations)==null?void 0:v.length)||0,hasGenreMatches:z.hasGenreMatches,triggeredGenreSync:z.triggeredGenreSync,resultType:typeof z,isArray:Array.isArray(z)}),z.triggeredGenreSync){if(h.current+=1,h.current>f){console.warn("[Recommendations] Max retries reached, giving up"),d.current=Date.now();const{setRecommendationsQuality:$}=Tt.getState();$("failed");return}const C=15e3*Math.pow(2,h.current-1);console.log(`[Recommendations] Genre sync triggered (attempt ${h.current}/${f}), retry in ${C/1e3}s`),setTimeout(()=>{d.current=0},C);return}z.recommendations&&Array.isArray(z.recommendations)?k.push(z):console.warn(`[Recommendations] Invalid result for seed ${K.Name}:`,z)}const I=k.filter(K=>K.hasGenreMatches);if(console.log(`[Recommendations] ${I.length} out of ${j.length} seeds found genre matches`),I.length===0){const{setRecommendationsQuality:K}=Tt.getState();K("degraded"),console.log("[Recommendations] No genre matches found - falling back to year/artist only")}const E=e.slice(t+1).filter(K=>K.source==="recommendation").length,R=Math.max(0,12-E);if(R===0){console.log("[Recommendations] Already have 12 upcoming recommendations, skipping");return}console.log(`[Recommendations] Currently have ${E} upcoming, need ${R} more to reach 12`);const O=I.length>0?I:k,ne=Math.ceil(R/O.length),oe=[];for(const K of O){const z=K.recommendations.filter($=>{const D=e.some(W=>W.Id===$.Id),ae=oe.some(W=>W.Id===$.Id);return!D&&!ae}),C=z.slice(0,ne);oe.push(...C),console.log(`[Recommendations] Added ${C.length} recommendations from seed (${z.length} available, genreMatch: ${K.hasGenreMatches})`)}const F=oe.slice(0,R),Z=J0(F);console.log(`[Recommendations] Final ${F.length} recommendations (distributed across ${j.length} seeds)`),Z.length>0?(console.log(`[Recommendations] Adding ${Z.length} recommendations (had ${E}, will have ${E+Z.length})`),console.log("[Recommendations] Recommendations to add:",Z.map(K=>K.Name)),d.current=0,p.current=Date.now(),h.current=0,n(Z,!1,"recommendation"),console.log("[Recommendations] Successfully added recommendations to queue")):(console.log("[Recommendations] No safe recommendations to add - marking as failed attempt"),d.current=Date.now())}catch(S){console.error("[Recommendations Hook] Failed to get recommendations:",S),i.current=!1,o(!1)}finally{clearTimeout(m),console.log("[Recommendations] Finished fetch, setting isRecommending = false"),i.current=!1,o(!1)}})()},[e,t,n,r,a,l,o])}function ev(){const{isQueueSidebarOpen:e,toggleQueueSidebar:t}=ye();return u.useEffect(()=>{const n=r=>{r.key==="Escape"&&e&&t()};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[e,t]),e?s.jsxs("div",{className:"fixed top-0 right-0 bottom-0 bg-black border-l border-zinc-800 z-30 flex flex-col hidden xl:flex shadow-xl",style:{width:"var(--sidebar-width)",paddingTop:"var(--header-offset, 0px)"},children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800 flex-shrink-0",children:[s.jsx("h2",{className:"text-base font-bold text-white tracking-wider",children:"Queue"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors p-2 rounded-full hover:bg-zinc-800",children:s.jsx(hm,{className:"w-5 h-5"})})]}),s.jsx(pm,{contentPaddingBottom:"8rem"})]}):null}const bu={slate:"#64748b",gray:"#6b7280",zinc:"#71717a",neutral:"#737373",stone:"#78716c",red:"#ef4444",orange:"#f97316",amber:"#f59e0b",yellow:"#eab308",lime:"#84cc16",green:"#22c55e",emerald:"#10b981",teal:"#14b8a6",cyan:"#06b6d4",sky:"#0ea5e9",blue:"#3b82f6",indigo:"#6366f1",violet:"#8b5cf6",purple:"#a855f7",fuchsia:"#d946ef",pink:"#ec4899",rose:"#f43f5e"};function tv({children:e}){Z0();const{accentColor:t}=Tt(),{genres:n,songs:r,genreSongs:l}=Ce(),{state:o}=Or(),{isQueueSidebarOpen:a}=ye(),c=i=>{const d=[...i];for(let p=d.length-1;p>0;p--){const h=Math.floor(Math.random()*(p+1));[d[p],d[h]]=[d[h],d[p]]}return d};return u.useEffect(()=>{const i=bu[t]||bu.blue;document.documentElement.style.setProperty("--accent-color",i)},[t]),u.useEffect(()=>{const i=o!=="idle"?"28px":"0px";document.documentElement.style.setProperty("--header-offset",i)},[o]),u.useEffect(()=>{n.length===0&&L.getGenres().catch(i=>{console.warn("Background genre preload failed:",i)})},[n.length]),u.useEffect(()=>{const i=Ce.getState(),d=r.length+Object.values(l).flat().length;d>0&&i.shufflePool.length===0?i.refreshShufflePool():d===0&&setTimeout(async()=>{try{const h=(await L.getSongs({limit:1})).TotalRecordCount||1e3,f=[];for(let N=0;N<3;N++){const x=Math.floor(Math.random()*h);f.push(x)}const y=f.map(N=>L.getSongs({limit:1,sortBy:["SortName"],sortOrder:"Ascending",startIndex:N})),g=(await Promise.all(y)).flatMap(N=>N.Items||[]);if(g.length>0){const N=g.map(x=>({Id:x.Id,Name:x.Name,AlbumArtist:x.AlbumArtist,ArtistItems:x.ArtistItems,Album:x.Album,AlbumId:x.AlbumId,IndexNumber:x.IndexNumber,ProductionYear:x.ProductionYear,PremiereDate:x.PremiereDate,RunTimeTicks:x.RunTimeTicks,Genres:x.Genres}));Ce.setState({songs:N,shufflePool:c(N),lastPoolUpdate:Date.now()})}}catch(p){console.warn("Minimal song preload failed:",p)}},300)},[r.length,l]),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed top-0 right-0 bg-black z-50 pointer-events-none left-0 lg:left-8",style:{height:"env(safe-area-inset-top)",top:o!=="idle"?"28px":"0px"}}),s.jsx(X0,{}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-zinc-900 z-40 pointer-events-none lg:hidden",style:{height:"calc(4rem + env(safe-area-inset-bottom) - 8px)"}}),s.jsx("div",{className:"fixed top-0 left-0 bottom-0 bg-black z-30 pointer-events-none hidden lg:block",style:{width:"4rem"}}),s.jsxs("div",{className:`main-scrollable h-screen bg-black text-white lg:pl-16 transition-[padding] duration-300 ${a?"sidebar-open-padding":""}`,style:{paddingBottom:"calc(6rem + env(safe-area-inset-bottom))",paddingTop:o!=="idle"?"28px":"0",overflowY:"auto",overflowX:"hidden",maxWidth:"100vw",width:"100%",scrollbarGutter:"stable"},children:[s.jsx("div",{className:"max-w-[768px] w-full mx-auto lg:flex lg:justify-center",children:s.jsx("div",{className:"w-full max-w-[768px]",children:e})}),s.jsx(W0,{}),s.jsx(B0,{})]}),s.jsx(ev,{})]})}const Kn=u.forwardRef(({value:e,onChange:t,placeholder:n="Search...",debounceMs:r=300,showClearButton:l=!1,onClear:o},a)=>{const[c,i]=u.useState(e),d=u.useRef(t),p=u.useRef(null),h=f=>{p.current=f,typeof a=="function"?a(f):a&&(a.current=f)};return u.useEffect(()=>{d.current=t},[t]),u.useEffect(()=>{const f=setTimeout(()=>{d.current(c)},r);return()=>clearTimeout(f)},[c,r]),u.useEffect(()=>{i(e)},[e]),s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:h,type:"text",value:c,onChange:f=>{i(f.target.value)},placeholder:n,className:"w-full px-4 py-2 pl-10 pr-10 bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)] focus:border-transparent"}),s.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("button",{onClick:f=>{f.preventDefault(),f.stopPropagation(),i(""),o&&o(),setTimeout(()=>{var y;(y=p.current)==null||y.focus()},0)},className:`absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 transition-opacity ${l&&c?"text-gray-400 hover:text-white opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,"aria-label":"Clear search",type:"button",children:s.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"w-full h-full",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})});Kn.displayName="SearchInput";function Jn({isOpen:e,onClose:t,filterType:n,availableYears:r=[],yearRange:l={min:null,max:null},onApplyYear:o,genres:a=[],selectedValues:c=[],onApply:i}){const[d,p]=u.useState(l),[h,f]=u.useState(c),y=u.useRef(null),w=u.useRef(null);u.useEffect(()=>{p(l)},[l]),u.useEffect(()=>{f(c)},[c]);const g=b=>{f(k=>k.includes(b)?k.filter(I=>I!==b):[...k,b])},N=()=>{n==="year"&&o?o(d):n==="genre"&&i&&i(h),t()},x=()=>{n==="year"?(p({min:null,max:null}),o&&o({min:null,max:null})):n==="genre"&&f([]),t()},m=r.length>0?r[0]:1900,v=r.length>0?r[r.length-1]:new Date().getFullYear();u.useEffect(()=>{if(n==="year"&&e&&r.length>0){if(y.current&&d.min!==null){const b=r.indexOf(d.min);b!==-1&&setTimeout(()=>{var I;const k=(I=y.current)==null?void 0:I.querySelector(`[data-year-index="${b}"]`);k&&k.scrollIntoView({behavior:"smooth",block:"center"})},100)}if(w.current&&d.max!==null){const b=r.indexOf(d.max);b!==-1&&setTimeout(()=>{var I;const k=(I=w.current)==null?void 0:I.querySelector(`[data-year-index="${b}"]`);k&&k.scrollIntoView({behavior:"smooth",block:"center"})},100)}}},[n,e,d.min,d.max,r]);const S=(b,k)=>{p(I=>{if(b==="min"){const E=I.max!==null&&k>I.max?I.max:k;return setTimeout(()=>{const R=r.indexOf(E);if(R!==-1&&y.current){const O=y.current.querySelector(`[data-year-index="${R}"]`);O&&O.scrollIntoView({behavior:"smooth",block:"center"})}},50),{...I,min:E}}else{const E=I.min!==null&&k<I.min?I.min:k;return setTimeout(()=>{const R=r.indexOf(E);if(R!==-1&&w.current){const O=w.current.querySelector(`[data-year-index="${R}"]`);O&&O.scrollIntoView({behavior:"smooth",block:"center"})}},50),{...I,max:E}}})},j=(d.min===null||d.min===m)&&(d.max===null||d.max===v)&&l.min===null&&l.max===null;return s.jsx(Ji,{isOpen:e,onClose:t,zIndex:10001,children:s.jsxs("div",{className:"pb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[s.jsxs("div",{className:"text-lg font-semibold text-white",children:["Filter by ",n==="genre"?"Genre":"Year"]}),s.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center text-white hover:bg-white/10 rounded-full transition-colors","aria-label":"Close",children:s.jsx(hm,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"px-4 max-h-[75vh] overflow-y-auto",children:n==="year"?s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("div",{ref:y,className:"h-64 overflow-y-auto scroll-smooth snap-y snap-mandatory py-[calc(50%-1.5rem)]",children:r.length>0?r.map((b,k)=>{const I=d.min===b,E=d.max!==null&&b>d.max;return s.jsx("button",{"data-year-index":k,onClick:()=>S("min",b),disabled:E,className:`w-full py-3 px-4 text-center snap-center transition-colors ${I?"bg-[var(--accent-color)] text-white font-semibold rounded-lg":E?"text-gray-500 cursor-not-allowed":"text-white hover:bg-white/10"}`,children:b},b)}):s.jsx("div",{className:"text-center py-8 text-gray-400",children:s.jsx("div",{className:"text-sm",children:"No years available"})})}),s.jsx("div",{className:"absolute top-0 left-0 right-0 h-12 bg-gradient-to-b from-zinc-900 to-transparent pointer-events-none"}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-zinc-900 to-transparent pointer-events-none"})]}),s.jsx("div",{className:"text-white font-medium self-center",children:"to"}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("div",{ref:w,className:"h-64 overflow-y-auto scroll-smooth snap-y snap-mandatory py-[calc(50%-1.5rem)]",children:r.length>0?r.map((b,k)=>{const I=d.max===b,E=d.min!==null&&b<d.min;return s.jsx("button",{"data-year-index":k,onClick:()=>S("max",b),disabled:E,className:`w-full py-3 px-4 text-center snap-center transition-colors ${I?"bg-[var(--accent-color)] text-white font-semibold rounded-lg":E?"text-gray-500 cursor-not-allowed":"text-white hover:bg-white/10"}`,children:b},b)}):s.jsx("div",{className:"text-center py-8 text-gray-400",children:s.jsx("div",{className:"text-sm",children:"No years available"})})}),s.jsx("div",{className:"absolute top-0 left-0 right-0 h-14 bg-gradient-to-b from-zinc-900 via-zinc-900/80 to-transparent pointer-events-none"}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-14 bg-gradient-to-t from-zinc-900 via-zinc-900/80 to-transparent pointer-events-none"})]})]})}):s.jsx("div",{className:"space-y-2",children:n==="genre"?a.length>0?[...a].sort((b,k)=>(b.Name||"").localeCompare(k.Name||"")).map(b=>{const k=b.Name||"",I=h.includes(k);return s.jsxs("button",{onClick:()=>g(k),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors text-left",children:[s.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${I?"bg-white border-white":"border-white/40 bg-transparent"}`,children:I&&s.jsx("svg",{className:"w-3 h-3 text-zinc-900",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),s.jsx("span",{className:"text-white font-medium",children:k})]},b.Id)}):s.jsx("div",{className:"text-center py-8 text-gray-400",children:s.jsx("div",{className:"text-sm",children:"No genres available"})}):s.jsx("div",{className:"text-center py-8 text-gray-400",children:s.jsx("div",{className:"text-sm",children:"No genres available"})})})}),s.jsxs("div",{className:"flex gap-3 mt-6 px-4",children:[s.jsx("button",{onClick:x,disabled:n==="year"&&j,className:"flex-1 px-4 py-3 bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors",children:"Clear"}),s.jsx("button",{onClick:N,className:"flex-1 px-4 py-3 bg-white text-zinc-900 font-medium rounded-lg hover:bg-gray-100 transition-colors",children:"Apply"})]})]})})}async function Ts(e,t){var w,g,N,x;const n=await L.search(e,t);let r=((w=n.Songs)==null?void 0:w.Items)||[],l=((g=n.Albums)==null?void 0:g.Items)||[],o=((N=n.Artists)==null?void 0:N.Items)||[],a=((x=n.Playlists)==null?void 0:x.Items)||[];if(!(r.length>0||l.length>0||o.length>0||a.length>0)&&e.trim().length>0){const m=await Rs(t);r=m.songs,l=m.albums,o=m.artists,a=m.playlists}const d=Vt(e).toLowerCase().trim(),p=r.filter(m=>{var j,b,k;if(Vt(m.Name||"").toLowerCase().includes(d))return!0;const S=[];return m.AlbumArtist&&S.push(Vt(m.AlbumArtist)),(j=m.AlbumArtists)!=null&&j.length&&S.push(...m.AlbumArtists.map(I=>Vt(I.Name||"")).filter(Boolean)),(b=m.ArtistItems)!=null&&b.length&&S.push(...m.ArtistItems.map(I=>Vt(I.Name||"")).filter(Boolean)),!!(S.some(I=>I.toLowerCase().includes(d))||(k=m.Genres)!=null&&k.some(I=>Vt(I).toLowerCase().includes(d)))}),h=o.filter(m=>Vt(m.Name||"").toLowerCase().includes(d)),f=l.filter(m=>{var j,b;const v=Vt(m.Name||""),S=Vt(m.AlbumArtist||((b=(j=m.ArtistItems)==null?void 0:j[0])==null?void 0:b.Name)||"");return v.toLowerCase().includes(d)||S.toLowerCase().includes(d)}),y=a.filter(m=>Vt(m.Name||"").toLowerCase().includes(d));return{artists:h,albums:f,playlists:y,songs:p}}async function Rs(e){const[t,n,r,l]=await Promise.all([L.getArtists({limit:e}),L.getAlbums({limit:e}),L.getPlaylists({limit:e}),L.getSongs({limit:e})]);return{artists:t.Items||[],albums:n.Items||[],playlists:r.Items||[],songs:l.Items||[]}}const Fo=new Map;function nv({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var y,w;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,[i,d]=u.useState(null);u.useEffect(()=>{var m;if((m=e.ImageTags)!=null&&m.Primary){d(null);return}const g=Fo.get(e.Id);if(g!==void 0){d(g);return}let N=!1;return(async()=>{try{const{albums:v,songs:S}=await L.getArtistItems(e.Id),j=v[0],b=S.find(R=>R.AlbumId)||S[0],k=j||b,I=k?k.AlbumId||k.Id:null,E=I?L.getAlbumArtUrl(I,96):null;Fo.set(e.Id,E),N||d(E)}catch(v){console.error("Failed to load fallback album art for artist (home search):",e.Id,v),Fo.set(e.Id,null)}})(),()=>{N=!0}},[e.Id,e.ImageTags]);const p=g=>{if(c||a.current){g.preventDefault(),g.stopPropagation(),a.current=!1;return}t(e.Id)},h=g=>{g.preventDefault(),g.stopPropagation(),a.current=!0,n(e,"artist","desktop",{x:g.clientX,y:g.clientY}),setTimeout(()=>{a.current=!1},300)},f=Te({onLongPress:g=>{g.preventDefault(),a.current=!0,n(e,"artist","mobile")},onClick:()=>{if(a.current){a.current=!1;return}p({})}});return s.jsxs("button",{onClick:()=>{if(a.current){a.current=!1;return}p({})},onContextMenu:h,...f,className:`w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left px-4 h-[72px] ${c?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:l?s.jsx(it,{className:"w-6 h-6 text-gray-500"}):(y=e.ImageTags)!=null&&y.Primary||i?s.jsx("img",{src:(w=e.ImageTags)!=null&&w.Primary?L.getArtistImageUrl(e.Id,96):i||"",alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):s.jsx(it,{className:"w-6 h-6 text-gray-500"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function rv({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,i=y=>{if(c||a.current){y.preventDefault(),y.stopPropagation(),a.current=!1;return}t(e.Id)},d=y=>{y.preventDefault(),y.stopPropagation(),a.current=!0,n(e,"album","desktop",{x:y.clientX,y:y.clientY}),setTimeout(()=>{a.current=!1},300)},p=Te({onLongPress:y=>{y.preventDefault(),a.current=!0,n(e,"album","mobile")},onClick:()=>{if(a.current){a.current=!1;return}i({})}});return s.jsxs("button",{onClick:()=>{if(a.current){a.current=!1;return}i({})},onContextMenu:d,...p,className:"text-left group",children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:l?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function sv({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:l=!0}){var w,g;const o=Ct(),a=u.useRef(!1),c=r===e.Id,[i,d]=u.useState(!1),p=N=>{const x=Math.floor(N/1e7),m=Math.floor(x/60),v=x%60;return`${m}:${v.toString().padStart(2,"0")}`},h=N=>{if(c||a.current){N.preventDefault(),N.stopPropagation(),a.current=!1;return}t(e)},f=N=>{N.preventDefault(),N.stopPropagation(),a.current=!0,n(e,"song","desktop",{x:N.clientX,y:N.clientY}),setTimeout(()=>{a.current=!1},300)},y=Te({onLongPress:N=>{N.preventDefault(),a.current=!0,n(e,"song","mobile")},onClick:()=>{if(a.current){a.current=!1;return}h({})}});return s.jsxs("button",{onClick:()=>{if(a.current){a.current=!1;return}h({})},onContextMenu:f,...y,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${c?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:i?s.jsx(Xe,{className:"w-7 h-7 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>d(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(o==null?void 0:o.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((g=(w=e.ArtistItems)==null?void 0:w[0])==null?void 0:g.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:p(e.RunTimeTicks)})]})}function lv({onSearchStateChange:e}){const[t,n]=u.useState(""),[r,l]=u.useState(!1),[o,a]=u.useState(null),[c,i]=u.useState(!1),[d,p]=u.useState(!1),[h,f]=u.useState("mobile"),[y,w]=u.useState(null),[g,N]=u.useState(null),[x,m]=u.useState(null),v=u.useRef(null),[S,j]=u.useState([]),[b,k]=u.useState({min:null,max:null}),[I,E]=u.useState(!1),[R,O]=u.useState(null),{genres:ne}=Ce(),[oe,F]=u.useState([]),[Z,K]=u.useState(!1),[z,C]=u.useState(45),{playAlbum:$,addToQueue:D,playTrack:ae,shuffleAllSongs:W,isQueueSidebarOpen:Ne}=ye(),[he,me]=u.useState(!1);u.useEffect(()=>{if(he){const A=setTimeout(()=>{me(!1)},1e4);return()=>clearTimeout(A)}},[he]);const ge=Ve();u.useEffect(()=>{(async()=>{K(!0);try{const H=Ce.getState();if(H.years.length>0)F(H.years);else{const ee=await L.getYears();F(ee)}}catch(H){console.error("Failed to load filter values:",H)}finally{K(!1)}})()},[]);const Se=S.length>0||b.min!==null||b.max!==null;u.useEffect(()=>{const A=t.trim().length>0;if(A||Se){i(!0);const H=window.setTimeout(()=>{(async()=>{try{if(A){const ie=await Ts(t,450);a(ie)}else{const ie=await Rs(450);a(ie)}}catch(ie){console.error("Search failed:",ie),a(null)}finally{i(!1)}})()},250);return()=>{window.clearTimeout(H)}}else a(null),i(!1)},[t,Se]),u.useEffect(()=>{C(45)},[t,r,o==null?void 0:o.songs.length]),u.useEffect(()=>{var H;if(!r||!((H=o==null?void 0:o.songs)!=null&&H.length))return;const A=()=>{const ee=window.scrollY||document.documentElement.scrollTop,ie=window.innerHeight||document.documentElement.clientHeight,xe=document.documentElement.scrollHeight;ee+ie*1.5>=xe&&C(je=>Math.min(je+45,o.songs.length))};return window.addEventListener("scroll",A,{passive:!0}),()=>window.removeEventListener("scroll",A)},[r,o==null?void 0:o.songs.length]);const ue=u.useMemo(()=>{if(!o)return null;const A=ie=>{if(b.min!==null||b.max!==null)return!1;if(S.length>0){const xe=ie.Genres||[];if(!S.some(Q=>xe.some(we=>we.toLowerCase()===Q.toLowerCase())))return!1}return!0},H=ie=>{if(S.length>0){const xe=ie.Genres||[];if(!S.some(Q=>xe.some(we=>we.toLowerCase()===Q.toLowerCase())))return!1}if(b.min!==null||b.max!==null){const xe=ie.ProductionYear;if(!xe||xe<=0||b.min!==null&&xe<b.min||b.max!==null&&xe>b.max)return!1}return!0},ee=ie=>!(b.min!==null||b.max!==null||S.length>0);return{artists:o.artists.filter(A),albums:o.albums.filter(H),playlists:(o.playlists||[]).filter(ee),songs:o.songs.filter(H)}},[o,S,b]),X=A=>{n(A),A.trim().length>0&&!r&&l(!0)},q=A=>{ge(`/artist/${A}`),l(!1),n(""),a(null)},te=A=>{ge(`/album/${A}`),l(!1),n(""),a(null)},U=A=>{ae(A,[A])},B=A=>{ge(`/playlist/${A}`),l(!1),n(""),a(null)},pe=(A,H,ee="mobile",ie)=>{N(A),m(H),f(ee),w(ie||null),p(!0)},le=()=>{n(""),a(null)},P=()=>{l(!1),n(""),a(null),j([]),k({min:null,max:null})},V=A=>{O(A),E(!0)},G=A=>{j(A)},fe=A=>{k(A)},re=A=>{A.preventDefault(),A.stopPropagation(),ue!=null&&ue.songs&&ue.songs.length>0&&$(ue.songs)},de=A=>{A.preventDefault(),A.stopPropagation(),ue!=null&&ue.songs&&ue.songs.length>0&&D(ue.songs)},T=r;return u.useEffect(()=>{e&&e(T)},[T,e]),u.useEffect(()=>{var A;if(r&&((A=v.current)==null||A.focus(),v.current)){const H=v.current.value.length;v.current.setSelectionRange(H,H)}},[r]),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"px-4 pt-4 pb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"text-lg font-semibold text-white",children:"Tunetuna"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:async()=>{const A=ye.getState(),{isShuffleAllActive:H,isShuffleGenreActive:ee,shuffle:ie}=A;if(!(he||H||ee)){me(!0);try{await W()}catch(xe){console.error("Home shuffle button - shuffleAllSongs failed:",xe),console.error("Shuffle all failed:",xe)}finally{me(!1)}}},disabled:he,className:"w-8 h-8 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors disabled:opacity-50","aria-label":"Shuffle all songs",children:he?s.jsx("div",{className:"w-4 h-4 border-2 border-zinc-400 border-t-white rounded-full animate-spin"}):s.jsx(rn,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>ge("/settings"),className:"w-8 h-8 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors","aria-label":"Settings",children:s.jsx(j0,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"relative",onClick:()=>l(!0),children:s.jsx(Kn,{value:t,onChange:X,placeholder:"Search for artists, albums, songs...",showClearButton:t.trim().length>0,onClear:le})})]}),r&&tr.createPortal(s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] overflow-y-scroll p-0 m-0",children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:s.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:s.jsxs("div",{className:"flex items-center gap-3 pl-2 pr-4 pt-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Kn,{ref:v,value:t,onChange:X,showClearButton:t.trim().length>0,onClear:le})}),s.jsx("button",{onClick:P,className:"px-4 py-2 text-white text-sm font-medium hover:text-zinc-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),s.jsxs("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(76px + env(safe-area-inset-top))"},children:[s.jsx("div",{className:"sticky bg-black z-10 pt-3 pb-4",style:{top:"calc(76px + env(safe-area-inset-top))"},children:s.jsxs("div",{className:"flex items-center gap-3 pl-2 pr-4",children:[s.jsxs("button",{onClick:()=>V("genre"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${S.length>0?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by genre",children:[s.jsx(qn,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Genre"})]}),s.jsxs("button",{onClick:()=>V("year"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${b.min!==null||b.max!==null?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by year",children:[s.jsx(Gi,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Year"})]})]})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${Ne?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 76px + 4rem)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{className:"pb-32",style:{paddingTop:"40px"},children:c?s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):ue?s.jsxs("div",{className:"space-y-8",children:[ue.artists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 pl-2 pr-4",children:"Artists"}),s.jsx("div",{className:"space-y-0",children:ue.artists.slice(0,5).map(A=>s.jsx(nv,{artist:A,onClick:q,onContextMenu:pe,contextMenuItemId:(g==null?void 0:g.Id)||null},A.Id))})]}),ue.albums.length>0&&s.jsxs("div",{className:"pl-2 pr-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:ue.albums.slice(0,12).map(A=>s.jsx(rv,{album:A,onClick:te,onContextMenu:pe,contextMenuItemId:(g==null?void 0:g.Id)||null},A.Id))})]}),ue.playlists&&ue.playlists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 pl-2 pr-4",children:"Playlists"}),s.jsx("div",{className:"space-y-0",children:ue.playlists.map(A=>s.jsxs("button",{onClick:()=>B(A.Id),onContextMenu:H=>{H.preventDefault(),H.stopPropagation(),pe(A,"playlist","desktop",{x:H.clientX,y:H.clientY})},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:s.jsx("img",{src:L.getAlbumArtUrl(A.Id,96),alt:A.Name,className:"w-full h-full object-cover",loading:"lazy"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:A.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:A.ChildCount?`${A.ChildCount} tracks`:"Playlist"})]})]},A.Id))})]}),ue.songs.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 pl-2 pr-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:re,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:s.jsx(tt,{className:"w-5 h-5"})}),s.jsx("button",{type:"button",onClick:de,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:s.jsx($t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"space-y-0",children:ue.songs.map((A,H)=>s.jsx(sv,{song:A,onClick:U,onContextMenu:pe,contextMenuItemId:(g==null?void 0:g.Id)||null,showImage:H<z},A.Id))})]}),ue.artists.length===0&&ue.albums.length===0&&(!ue.playlists||ue.playlists.length===0)&&ue.songs.length===0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[s.jsx("div",{className:"text-lg mb-2",children:"No results found"}),s.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):s.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})]})]}),s.jsx(We,{item:g,itemType:x,isOpen:d,onClose:()=>{p(!1),N(null),m(null)},zIndex:999999,mode:h,position:y||void 0})]}),document.body),R==="genre"&&s.jsx(Jn,{isOpen:I,onClose:()=>E(!1),filterType:"genre",genres:ne,selectedValues:S,onApply:G}),R==="year"&&s.jsx(Jn,{isOpen:I,onClose:()=>E(!1),filterType:"year",availableYears:oe,yearRange:b,onApplyYear:fe})]})}function Iu({album:e,onNavigate:t,onContextMenu:n}){var d,p;const[r,l]=u.useState(!1),o=u.useRef(!1),a=h=>{if(o.current){h.preventDefault(),h.stopPropagation(),o.current=!1;return}t(e.Id)},c=h=>{h.preventDefault(),h.stopPropagation(),o.current=!0,n(e,"desktop",{x:h.clientX,y:h.clientY}),setTimeout(()=>{o.current=!1},300)},i=Te({onLongPress:h=>{h.preventDefault(),o.current=!0,n(e,"mobile")},onClick:()=>{if(o.current){o.current=!1;return}a({})}});return s.jsxs("button",{onClick:()=>{if(o.current){o.current=!1;return}a({})},onContextMenu:c,...i,className:"text-left group",children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-2 bg-zinc-900 flex items-center justify-center",children:r?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):s.jsx(ct,{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>l(!0)})}),s.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((p=(d=e.ArtistItems)==null?void 0:d[0])==null?void 0:p.Name)||"Unknown Artist"})]})}function ov(){const{recentlyAdded:e,setRecentlyAdded:t,setLoading:n}=Ce(),r=Ve(),l=u.useRef(null),[o,a]=u.useState(0),[c,i]=u.useState(!1),[d,p]=u.useState("mobile"),[h,f]=u.useState(null),[y,w]=u.useState(null);u.useEffect(()=>{(async()=>{n("recentlyAdded",!0);try{const S=await L.getRecentlyAdded(18);t(S.Items||[])}catch(S){console.error("Failed to load recently added:",S)}finally{n("recentlyAdded",!1)}})()},[t,n]);const g=()=>{if(!l.current)return;const v=l.current,S=v.scrollLeft,j=v.clientWidth,b=Math.round(S/j);a(b)},N=v=>{if(!l.current)return;const S=l.current,j=S.clientWidth;S.scrollTo({left:v*j,behavior:"smooth"})};if(!e||e.length===0)return null;const x=6,m=[];for(let v=0;v<e.length;v+=x)m.push(e.slice(v,v+x));return s.jsxs("div",{className:"px-4 mb-8",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"Recently Added"}),s.jsxs("div",{className:"md:hidden",children:[s.jsx("div",{ref:l,onScroll:g,className:"overflow-x-auto snap-x snap-mandatory scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:s.jsx("div",{className:"flex",style:{width:`${m.length*100}%`},children:m.map((v,S)=>{const j=Math.ceil(v.length/3);return s.jsx("div",{className:"snap-start flex-shrink-0 w-full",style:{width:`${100/m.length}%`},children:s.jsx("div",{className:"grid grid-cols-3 gap-3",style:{gridTemplateRows:`repeat(${j}, minmax(0, 1fr))`},children:v.map(b=>s.jsx(Iu,{album:b,onNavigate:k=>r(`/album/${k}`),onContextMenu:(k,I,E)=>{w(k),p(I||"desktop"),f(E||null),i(!0)}},b.Id))})},S)})})}),m.length>1&&s.jsx("div",{className:"flex justify-center gap-2 mt-4",children:m.map((v,S)=>s.jsx("button",{onClick:()=>N(S),className:`w-2 h-2 rounded-full transition-colors ${S===o?"bg-white":"bg-zinc-600"}`,"aria-label":`Go to page ${S+1}`},S))})]}),s.jsx("div",{className:"hidden md:block",children:s.jsx("div",{className:"grid grid-cols-4 gap-3",children:e.slice(0,8).map(v=>s.jsx(Iu,{album:v,onNavigate:S=>r(`/album/${S}`),onContextMenu:(S,j,b)=>{w(S),p(j||"desktop"),f(b||null),i(!0)}},v.Id))})}),s.jsx("style",{children:`
        .scrollbar-hide::-webkit-scrollbar {
          display: none;
        }
      `}),s.jsx(We,{item:y,itemType:"album",isOpen:c,onClose:()=>{i(!1),w(null)},zIndex:999999,mode:d,position:h||void 0})]})}function av({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var p,h;const l=Ct(),[o,a]=u.useState(!1),c=r===e.Id,i=f=>{const y=Math.floor(f/1e7),w=Math.floor(y/60),g=y%60;return`${w}:${g.toString().padStart(2,"0")}`},d=Te({onLongPress:f=>{f.preventDefault(),n(e,"mobile")},onClick:()=>t(e)});return s.jsxs("button",{onClick:()=>t(e),onContextMenu:f=>{f.preventDefault(),n(e,"desktop",{x:f.clientX,y:f.clientY})},...d,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${c?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center flex items-center justify-center",children:o?s.jsx(Xe,{className:"w-7 h-7 text-gray-500"}):s.jsx(ct,{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm",onError:()=>a(!0)})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(l==null?void 0:l.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((h=(p=e.ArtistItems)==null?void 0:p[0])==null?void 0:h.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:i(e.RunTimeTicks)})]})}function iv(){const{recentlyPlayed:e}=Ce(),{playTrack:t}=ye(),[n,r]=u.useState(!1),[l,o]=u.useState("mobile"),[a,c]=u.useState(null),[i,d]=u.useState(null),p=h=>{t(h,e)};return!e||e.length===0?null:s.jsxs("div",{className:"mb-8",children:[s.jsx("h2",{className:"text-xl font-bold mb-2 px-4",children:"Recently Played"}),s.jsx("div",{className:"space-y-0",children:e.map(h=>s.jsx(av,{song:h,onClick:p,onContextMenu:(f,y,w)=>{d(f),o(y||"mobile"),c(w||null),r(!0)},contextMenuItemId:(i==null?void 0:i.Id)||null},h.Id))}),s.jsx(We,{item:i,itemType:"song",isOpen:n,onClose:()=>{r(!1),d(null)},zIndex:99999,mode:l,position:a||void 0})]})}function cv(){const[e,t]=u.useState(!1),{recentlyAdded:n,recentlyPlayed:r,loading:l}=Ce(),o=u.useRef(!1),{isQueueSidebarOpen:a}=ye();u.useEffect(()=>{(l.recentlyAdded||l.recentlyPlayed)&&(o.current=!0)},[l.recentlyAdded,l.recentlyPlayed]);const c=o.current&&!l.recentlyAdded&&!l.recentlyPlayed&&n.length===0&&r.length===0;return s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${a?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsx(lv,{onSearchStateChange:t})})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${a?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 7.5rem - 2px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{className:e?"hidden":"",style:{paddingTop:"calc(env(safe-area-inset-top) + 7.5rem + 24px)"},children:s.jsxs("div",{className:"max-w-[768px] mx-auto",children:[s.jsx(ov,{}),s.jsx(iv,{}),c&&s.jsx("div",{className:"flex items-center justify-center py-16 text-gray-400",children:s.jsx("p",{children:"No music found"})})]})})]})}const Uo=new Map;function uv({artist:e,onContextMenu:t,contextMenuItemId:n}){var v,S;const r=Ve(),[l,o]=u.useState(!1),[a,c]=u.useState(!1),[i,d]=u.useState("mobile"),[p,h]=u.useState(null),f=u.useRef(!1),[y,w]=u.useState(null),g=n===e.Id;u.useEffect(()=>{var I;if((I=e.ImageTags)!=null&&I.Primary){w(null);return}const j=Uo.get(e.Id);if(j!==void 0){w(j);return}let b=!1;return(async()=>{try{const{albums:E,songs:R}=await L.getArtistItems(e.Id),O=E[0],ne=R.find(K=>K.AlbumId)||R[0],oe=O||ne,F=oe?oe.AlbumId||oe.Id:null,Z=F?L.getAlbumArtUrl(F,96):null;Uo.set(e.Id,Z),b||w(Z)}catch(E){console.error("Failed to load fallback album art for artist:",e.Id,E),Uo.set(e.Id,null)}})(),()=>{b=!0}},[e.Id,e.ImageTags]);const N=j=>{if(f.current){j.preventDefault(),f.current=!1;return}r(`/artist/${e.Id}`)},x=Te({onLongPress:j=>{j.preventDefault(),t?(f.current=!0,t(e,"artist","mobile")):(f.current=!0,d("mobile"),h(null),c(!0))}}),m=j=>{var b,k,I,E;j.preventDefault(),j.stopPropagation(),(k=(b=j.nativeEvent)==null?void 0:b.preventDefault)==null||k.call(b),(E=(I=j.nativeEvent)==null?void 0:I.stopImmediatePropagation)==null||E.call(I),f.current=!0,t?t(e,"artist","desktop",{x:j.clientX,y:j.clientY}):(d("desktop"),h({x:j.clientX,y:j.clientY}),c(!0)),setTimeout(()=>{f.current=!1},300)};return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:j=>{if(a||f.current){j.preventDefault(),j.stopPropagation();return}N(j)},onContextMenu:m,...x,className:`w-full flex items-center gap-4 hover:bg-white/10 transition-colors group px-4 h-[72px] ${g?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:l?s.jsx(it,{className:"w-6 h-6 text-gray-500"}):(v=e.ImageTags)!=null&&v.Primary||y?s.jsx("img",{src:(S=e.ImageTags)!=null&&S.Primary?L.getArtistImageUrl(e.Id,96):y||"",alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):s.jsx(it,{className:"w-6 h-6 text-gray-500"})}),s.jsx("div",{className:"flex-1 min-w-0 text-left",children:s.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]}),s.jsx(We,{item:e,itemType:"artist",isOpen:a,onClose:()=>c(!1),zIndex:99999,mode:i,position:p||void 0})]})}function oo({currentPage:e,totalPages:t,onPageChange:n,itemsPerPage:r,totalItems:l}){if(t<=1)return null;const o=e*r+1,a=Math.min((e+1)*r,l);return s.jsxs("div",{className:"flex items-center justify-between px-4 py-4",children:[s.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",o,"-",a," of ",l]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>n(e-1),disabled:e===0,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:s.jsx(Hx,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-sm text-white min-w-[60px] text-center",children:[e+1," / ",t]}),s.jsx("button",{onClick:()=>n(e+1),disabled:e>=t-1,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:s.jsx(Vx,{className:"w-5 h-5"})})]})]})}const Bo=new Map;function dv({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var y;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,[i,d]=u.useState(null);u.useEffect(()=>{var x;if((x=e.ImageTags)!=null&&x.Primary){d(null);return}const w=Bo.get(e.Id);if(w!==void 0){d(w);return}let g=!1;return(async()=>{try{const{albums:m,songs:v}=await L.getArtistItems(e.Id),S=m[0],j=v.find(E=>E.AlbumId)||v[0],b=S||j,k=b?b.AlbumId||b.Id:null,I=k?L.getAlbumArtUrl(k,96):null;Bo.set(e.Id,I),g||d(I)}catch(m){console.error("Failed to load fallback album art for artist (search item):",e.Id,m),Bo.set(e.Id,null)}})(),()=>{g=!0}},[e.Id,e.ImageTags]);const p=w=>{if(c||a.current){w.preventDefault(),w.stopPropagation(),a.current=!1;return}t(e.Id)},h=w=>{w.preventDefault(),w.stopPropagation(),a.current=!0,n(e,"artist","desktop",{x:w.clientX,y:w.clientY}),setTimeout(()=>{a.current=!1},300)},f=Te({onLongPress:w=>{w.preventDefault(),a.current=!0,n(e,"artist","mobile")},onClick:p});return s.jsxs("button",{onClick:p,onContextMenu:h,...f,className:`w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left cursor-pointer px-4 h-[72px] ${c?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:l?s.jsx(it,{className:"w-6 h-6 text-gray-500"}):i||(y=e.ImageTags)!=null&&y.Primary?s.jsx("img",{src:i||L.getArtistImageUrl(e.Id,96),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):s.jsx(it,{className:"w-6 h-6 text-gray-500"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function fv({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,i=y=>{if(c||a.current){y.preventDefault(),y.stopPropagation(),a.current=!1;return}t(e.Id)},d=y=>{y.preventDefault(),y.stopPropagation(),a.current=!0,n(e,"album","desktop",{x:y.clientX,y:y.clientY}),setTimeout(()=>{a.current=!1},300)},p=Te({onLongPress:y=>{y.preventDefault(),a.current=!0,n(e,"album","mobile")},onClick:i});return s.jsxs("button",{onClick:i,onContextMenu:d,...p,className:"text-left group",children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:l?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function mv({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:l=!0}){var y,w;const o=u.useRef(!1),a=r===e.Id,[c,i]=u.useState(!1),d=g=>{const N=Math.floor(g/1e7),x=Math.floor(N/60),m=N%60;return`${x}:${m.toString().padStart(2,"0")}`},p=g=>{if(a||o.current){g.preventDefault(),g.stopPropagation(),o.current=!1;return}t(e)},h=g=>{g.preventDefault(),g.stopPropagation(),o.current=!0,n(e,"song","desktop",{x:g.clientX,y:g.clientY}),setTimeout(()=>{o.current=!1},300)},f=Te({onLongPress:g=>{g.preventDefault(),o.current=!0,n(e,"song","mobile")},onClick:p});return s.jsxs("button",{onClick:p,onContextMenu:h,...f,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${a?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:c?s.jsx(Xe,{className:"w-7 h-7 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>i(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((w=(y=e.ArtistItems)==null?void 0:y[0])==null?void 0:w.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:d(e.RunTimeTicks)})]})}const rr=90,ku=45,hv=45,Cu=45,pv=45;function gv(){const{artists:e,setArtists:t,sortPreferences:n,setSortPreference:r,setLoading:l,loading:o,genres:a}=Ce(),{playTrack:c,playAlbum:i,addToQueue:d}=ye(),[p,h]=u.useState(""),[f,y]=u.useState(!1),[w,g]=u.useState(null),[N,x]=u.useState(!1),[m,v]=u.useState(!1),[S,j]=u.useState("mobile"),[b,k]=u.useState(null),[I,E]=u.useState(null),[R,O]=u.useState(null),[ne,oe]=u.useState(0),[F,Z]=u.useState(0),[K,z]=u.useState(Cu),C=Ve(),$=u.useRef(null),[D,ae]=u.useState([]),[W,Ne]=u.useState(!1),[he,me]=u.useState(null),ge=n.artists,Se=u.useRef(!0),[ue,X]=u.useState(!1),q=u.useRef(ge),[te,U]=u.useState(ku),B=ye(Q=>Q.isQueueSidebarOpen),pe=D.length>0;u.useEffect(()=>{const Q=p.trim().length>0;if(Q||pe){x(!0);const we=window.setTimeout(()=>{(async()=>{try{if(Q){const Ae=await Ts(p,450);g(Ae)}else{const Ae=await Rs(450);g(Ae)}}catch(Ae){console.error("Search failed:",Ae),g(null)}finally{x(!1)}})()},250);return()=>{window.clearTimeout(we)}}else g(null),x(!1)},[p,pe]);const le=u.useMemo(()=>{if(!w)return null;const Q=be=>{if(D.length>0){const Ae=be.Genres||[];if(!D.some(se=>Ae.some(M=>M.toLowerCase()===se.toLowerCase())))return!1}return!0},we=be=>{if(D.length>0){const Ae=be.Genres||[];if(!D.some(se=>Ae.some(M=>M.toLowerCase()===se.toLowerCase())))return!1}return!0};return{artists:w.artists.filter(Q),albums:w.albums.filter(we),playlists:w.playlists||[],songs:w.songs.filter(we)}},[w,D]);u.useEffect(()=>{var Q;if(f&&((Q=$.current)==null||Q.focus(),$.current)){const we=$.current.value.length;$.current.setSelectionRange(we,we)}},[f]);const P=Q=>{h(Q),Q.trim().length>0&&!f&&y(!0)},V=()=>{h(""),g(null)},G=()=>{y(!1),h(""),g(null),ae([])},fe=()=>{me("genre"),Ne(!0)},re=Q=>{ae(Q)},de=Q=>{C(`/artist/${Q}`),y(!1),h(""),g(null)},T=Q=>{C(`/album/${Q}`),y(!1),h(""),g(null)},A=Q=>{c(Q,[Q])},H=Q=>{Q.preventDefault(),Q.stopPropagation(),le!=null&&le.songs&&le.songs.length>0&&i(le.songs)},ee=Q=>{Q.preventDefault(),Q.stopPropagation(),le!=null&&le.songs&&le.songs.length>0&&d(le.songs)},ie=Q=>{C(`/playlist/${Q}`),y(!1),h(""),g(null)},xe=(Q,we,be="mobile",Ae)=>{E(Q),O(we),j(be),k(Ae||null),v(!0)},je=async()=>{var we;const Q=Date.now();l("artists",!0);try{const be={limit:rr,startIndex:ne*rr};ge==="RecentlyAdded"?(be.sortBy=["DateCreated"],be.sortOrder="Descending"):(be.sortBy=["SortName"],be.sortOrder="Ascending");let Ae=await L.getArtists(be);(((we=Ae.Items)==null?void 0:we.length)||0)===0&&(Ae=await L.getArtists({limit:rr,startIndex:ne*rr}));const qe=Ae.Items||[];Z(Ae.TotalRecordCount||0);const se=Date.now()-Q;t(qe)}catch(be){console.error("Failed to load artists:",be),t([]),Z(0)}finally{l("artists",!1),X(!1)}};return u.useEffect(()=>{!p.trim()&&!f&&oe(0)},[ge,p,f]),u.useEffect(()=>{U(ku)},[p,f,w==null?void 0:w.songs.length]),u.useEffect(()=>{var we;if(!f||!((we=w==null?void 0:w.songs)!=null&&we.length))return;const Q=()=>{const be=window.scrollY||document.documentElement.scrollTop,Ae=window.innerHeight||document.documentElement.clientHeight,qe=document.documentElement.scrollHeight;be+Ae*1.5>=qe&&U(se=>Math.min(se+hv,w.songs.length))};return window.addEventListener("scroll",Q,{passive:!0}),()=>window.removeEventListener("scroll",Q)},[f,w==null?void 0:w.songs.length]),u.useEffect(()=>{z(Cu)},[ne,e.length]),u.useEffect(()=>{const Q=()=>{const we=window.scrollY||document.documentElement.scrollTop,be=window.innerHeight||document.documentElement.clientHeight,Ae=document.documentElement.scrollHeight;we+be*1.5>=Ae&&z(qe=>Math.min(qe+pv,e.length))};return window.addEventListener("scroll",Q,{passive:!0}),()=>window.removeEventListener("scroll",Q)},[e.length]),u.useEffect(()=>{!p.trim()&&!f&&(!Se.current&&q.current!==ge&&X(!0),q.current=ge,je())},[ne,ge,p,f]),u.useEffect(()=>{Se.current&&(Se.current=!1)},[]),s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${B?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Artists"}),s.jsx("button",{onClick:()=>y(!0),className:"w-10 h-10 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors","aria-label":"Search",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),!f&&s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsxs("button",{onClick:()=>r("artists",ge==="RecentlyAdded"?"Alphabetical":"RecentlyAdded"),className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[ge==="RecentlyAdded"?"Recently Added":"Alphabetically",s.jsx(zr,{className:"w-4 h-4"})]}),o.artists&&!Se.current&&s.jsx("div",{className:"flex items-center",children:s.jsx(qt,{})})]})]})})}),s.jsx("div",{className:`fixed left-0 right-0 z-10 lg:left-16 transition-[left,right] duration-300 ${B?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 7rem - 8px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 7rem)"},children:!f&&s.jsxs("div",{className:ue?"opacity-50 pointer-events-none":"",children:[e.length===0&&!o.artists&&s.jsx("div",{className:"flex items-center justify-center py-8 text-gray-400",children:s.jsx("p",{children:"No artists found"})}),e.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-0",children:e.slice(0,K).map(Q=>s.jsx(uv,{artist:Q,onContextMenu:xe,contextMenuItemId:(I==null?void 0:I.Id)||null},Q.Id))}),s.jsx(oo,{currentPage:ne,totalPages:Math.ceil(F/rr),onPageChange:oe,itemsPerPage:rr,totalItems:F})]})]})})]}),f&&tr.createPortal(s.jsx(s.Fragment,{children:s.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:s.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:s.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Kn,{ref:$,value:p,onChange:P,showClearButton:p.trim().length>0,onClear:V})}),s.jsx("button",{onClick:G,className:"px-4 py-2 text-white text-sm font-medium hover:text-zinc-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),s.jsxs("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(52px + env(safe-area-inset-top))"},children:[s.jsx("div",{className:"sticky bg-black z-10 pt-3 pb-4",style:{top:"calc(76px + env(safe-area-inset-top))"},children:s.jsx("div",{className:"flex items-center gap-3 px-4",children:s.jsxs("button",{onClick:fe,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${D.length>0?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by genre",children:[s.jsx(qn,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Genre"})]})})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${B?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 76px + 4rem)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{className:"pb-32",style:{paddingTop:"40px"},children:N?s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):le?s.jsxs("div",{className:"space-y-8",children:[le.artists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),s.jsx("div",{className:"space-y-0",children:le.artists.map(Q=>s.jsx(dv,{artist:Q,onClick:de,onContextMenu:xe,contextMenuItemId:(I==null?void 0:I.Id)||null},Q.Id))})]}),le.albums.length>0&&s.jsxs("div",{className:"px-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),s.jsx("div",{className:"grid grid-cols-3 gap-4",children:le.albums.slice(0,12).map(Q=>s.jsx(fv,{album:Q,onClick:T,onContextMenu:xe,contextMenuItemId:(I==null?void 0:I.Id)||null},Q.Id))})]}),le.playlists&&le.playlists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),s.jsx("div",{className:"space-y-0",children:le.playlists.map(Q=>s.jsxs("button",{onClick:()=>ie(Q.Id),onContextMenu:we=>{we.preventDefault(),we.stopPropagation(),xe(Q,"playlist","desktop",{x:we.clientX,y:we.clientY})},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:s.jsx("img",{src:L.getAlbumArtUrl(Q.Id,96),alt:Q.Name,className:"w-full h-full object-cover",loading:"lazy"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:Q.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:"Playlist"})]})]},Q.Id))})]}),le.songs.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:H,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:s.jsx(tt,{className:"w-5 h-5"})}),s.jsx("button",{type:"button",onClick:ee,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:s.jsx($t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"space-y-0",children:le.songs.map((Q,we)=>s.jsx(mv,{song:Q,onClick:A,onContextMenu:xe,contextMenuItemId:(I==null?void 0:I.Id)||null,showImage:we<te},Q.Id))})]}),le.artists.length===0&&le.albums.length===0&&(!le.playlists||le.playlists.length===0)&&le.songs.length===0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[s.jsx("div",{className:"text-lg mb-2",children:"No results found"}),s.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):s.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})]})]})}),document.body),he==="genre"&&s.jsx(Jn,{isOpen:W,onClose:()=>Ne(!1),filterType:"genre",genres:a,selectedValues:D,onApply:re}),s.jsx(We,{item:I,itemType:R,isOpen:m,onClose:()=>{v(!1),E(null),O(null)},zIndex:99999,mode:S,position:b||void 0})]})}function xv({album:e,onContextMenu:t,contextMenuItemId:n,showImage:r=!0}){var m,v;const l=Ve(),[o,a]=u.useState(!1),[c,i]=u.useState("mobile"),[d,p]=u.useState(null),[h,f]=u.useState(!1),y=u.useRef(!1),w=n===e.Id,g=S=>{if(y.current){S.preventDefault(),y.current=!1;return}l(`/album/${e.Id}`)},N=S=>{var j,b,k,I;S.preventDefault(),S.stopPropagation(),(b=(j=S.nativeEvent)==null?void 0:j.preventDefault)==null||b.call(j),(I=(k=S.nativeEvent)==null?void 0:k.stopImmediatePropagation)==null||I.call(k),y.current=!0,t?t(e,"album","desktop",{x:S.clientX,y:S.clientY}):(i("desktop"),p({x:S.clientX,y:S.clientY}),a(!0)),setTimeout(()=>{y.current=!1},300)},x=Te({onLongPress:S=>{S.preventDefault(),t?(y.current=!0,t(e,"album","mobile")):(y.current=!0,i("mobile"),p(null),a(!0))}});return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:S=>{if(o||y.current){S.preventDefault(),S.stopPropagation();return}g(S)},onContextMenu:S=>{N(S)},...x,className:`text-left group ${w?"ring-2 ring-blue-500":""}`,children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-2 bg-zinc-900 relative flex items-center justify-center",children:h?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):r?s.jsx(ct,{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>f(!0)}):s.jsx("div",{className:"w-full h-full bg-zinc-900"})}),s.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((v=(m=e.ArtistItems)==null?void 0:m[0])==null?void 0:v.Name)||"Unknown Artist"})]}),s.jsx(We,{item:e,itemType:"album",isOpen:o,onClose:()=>a(!1),mode:c,position:d||void 0})]})}const Ho=new Map;function vv({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var y,w;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,[i,d]=u.useState(null);u.useEffect(()=>{var m;if((m=e.ImageTags)!=null&&m.Primary){d(null);return}const g=Ho.get(e.Id);if(g!==void 0){d(g);return}let N=!1;return(async()=>{try{const{albums:v,songs:S}=await L.getArtistItems(e.Id),j=v[0],b=S.find(R=>R.AlbumId)||S[0],k=j||b,I=k?k.AlbumId||k.Id:null,E=I?L.getAlbumArtUrl(I,96):null;Ho.set(e.Id,E),N||d(E)}catch(v){console.error("Failed to load fallback album art for artist (albums search):",e.Id,v),Ho.set(e.Id,null)}})(),()=>{N=!0}},[e.Id,e.ImageTags]);const p=g=>{if(c||a.current){g.preventDefault(),g.stopPropagation(),a.current=!1;return}t(e.Id)},h=g=>{g.preventDefault(),g.stopPropagation(),a.current=!0,n(e,"artist","desktop",{x:g.clientX,y:g.clientY}),setTimeout(()=>{a.current=!1},300)},f=Te({onLongPress:g=>{g.preventDefault(),a.current=!0,n(e,"artist","mobile")},onClick:p});return s.jsxs("button",{onClick:p,onContextMenu:h,...f,className:`w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left px-4 h-[72px] ${c?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:l?s.jsx(it,{className:"w-6 h-6 text-gray-500"}):(y=e.ImageTags)!=null&&y.Primary||i?s.jsx("img",{src:(w=e.ImageTags)!=null&&w.Primary?L.getArtistImageUrl(e.Id,96):i||"",alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):s.jsx(it,{className:"w-6 h-6 text-gray-500"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function yv({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,i=y=>{if(c||a.current){y.preventDefault(),y.stopPropagation(),a.current=!1;return}t(e.Id)},d=y=>{y.preventDefault(),y.stopPropagation(),a.current=!0,n(e,"album","desktop",{x:y.clientX,y:y.clientY}),setTimeout(()=>{a.current=!1},300)},p=Te({onLongPress:y=>{y.preventDefault(),a.current=!0,n(e,"album","mobile")},onClick:i});return s.jsxs("button",{onClick:i,onContextMenu:d,...p,className:"text-left group",children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:l?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function wv({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:l=!0}){var y,w;const o=u.useRef(!1),a=r===e.Id,[c,i]=u.useState(!1),d=g=>{const N=Math.floor(g/1e7),x=Math.floor(N/60),m=N%60;return`${x}:${m.toString().padStart(2,"0")}`},p=g=>{if(a||o.current){g.preventDefault(),g.stopPropagation(),o.current=!1;return}t(e)},h=g=>{g.preventDefault(),g.stopPropagation(),o.current=!0,n(e,"song","desktop",{x:g.clientX,y:g.clientY}),setTimeout(()=>{o.current=!1},300)},f=Te({onLongPress:g=>{g.preventDefault(),o.current=!0,n(e,"song","mobile")},onClick:p});return s.jsxs("button",{onClick:p,onContextMenu:h,...f,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${a?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:c?s.jsx(Xe,{className:"w-7 h-7 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>i(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((w=(y=e.ArtistItems)==null?void 0:y[0])==null?void 0:w.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:d(e.RunTimeTicks)})]})}const Zs=84,Au=45,Sv=45,Eu=45,Nv=45;function jv(){const{albums:e,setAlbums:t,sortPreferences:n,setSortPreference:r,setLoading:l,loading:o,genres:a}=Ce(),{playTrack:c,playAlbum:i,addToQueue:d}=ye(),[p,h]=u.useState(""),[f,y]=u.useState(!1),[w,g]=u.useState(null),[N,x]=u.useState(!1),[m,v]=u.useState(!1),[S,j]=u.useState("mobile"),[b,k]=u.useState(null),[I,E]=u.useState(null),[R,O]=u.useState(null),[ne,oe]=u.useState(0),[F,Z]=u.useState(0),[K,z]=u.useState(Au),C=Ve(),[$,D]=Kg(),ae=u.useRef(null),[W,Ne]=u.useState([]),[he,me]=u.useState({min:null,max:null}),[ge,Se]=u.useState(!1),[ue,X]=u.useState(null),[q,te]=u.useState([]),U=n.albums,B=u.useRef(!0),[pe,le]=u.useState(!1),P=u.useRef(U),[V,G]=u.useState(Eu),fe=ye(_=>_.isQueueSidebarOpen);u.useEffect(()=>{const _=$.get("year");if(_){const ve=parseInt(_,10);!isNaN(ve)&&ve>0&&(me({min:ve,max:ve}),y(!0),D({},{replace:!0}))}},[$,D]),u.useEffect(()=>{(async()=>{try{const ve=Ce.getState();if(ve.years.length>0)te(ve.years);else{const rt=await L.getYears();te(rt)}}catch(ve){console.error("Failed to load filter values:",ve)}})()},[]);const re=W.length>0||he.min!==null||he.max!==null;u.useEffect(()=>{const _=p.trim().length>0;if(_||re){x(!0);const ve=window.setTimeout(()=>{(async()=>{try{if(_){const Oe=await Ts(p,450);g(Oe)}else{const Oe=await Rs(450);g(Oe)}}catch(Oe){console.error("Search failed:",Oe),g(null)}finally{x(!1)}})()},250);return()=>{window.clearTimeout(ve)}}else g(null),x(!1)},[p,re]);const de=u.useMemo(()=>{if(!w)return null;const _=Oe=>{if(he.min!==null||he.max!==null)return!1;if(W.length>0){const ht=Oe.Genres||[];if(!W.some(ao=>ht.some(io=>io.toLowerCase()===ao.toLowerCase())))return!1}return!0},ve=Oe=>{if(W.length>0){const ht=Oe.Genres||[];if(!W.some(ao=>ht.some(io=>io.toLowerCase()===ao.toLowerCase())))return!1}if(he.min!==null||he.max!==null){const ht=Oe.ProductionYear;if(!ht||ht<=0||he.min!==null&&ht<he.min||he.max!==null&&ht>he.max)return!1}return!0},rt=Oe=>!(he.min!==null||he.max!==null||W.length>0);return{albums:w.albums.filter(ve),artists:w.artists.filter(_),playlists:(w.playlists||[]).filter(rt),songs:w.songs.filter(ve)}},[w,W,he]);u.useEffect(()=>{var _;if(f&&((_=ae.current)==null||_.focus(),ae.current)){const ve=ae.current.value.length;ae.current.setSelectionRange(ve,ve)}},[f]);const T=_=>{h(_),_.trim().length>0&&!f&&y(!0)},A=()=>{h(""),g(null)},H=()=>{y(!1),h(""),g(null),Ne([]),me({min:null,max:null})},ee=_=>{X(_),Se(!0)},ie=_=>{Ne(_)},xe=_=>{me(_)},je=_=>{C(`/artist/${_}`),y(!1),h(""),g(null)},Q=_=>{C(`/album/${_}`),y(!1),h(""),g(null)},we=_=>{c(_,[_])},be=_=>{_.preventDefault(),_.stopPropagation(),de!=null&&de.songs&&de.songs.length>0&&i(de.songs)},Ae=_=>{_.preventDefault(),_.stopPropagation(),de!=null&&de.songs&&de.songs.length>0&&d(de.songs)},qe=_=>{C(`/playlist/${_}`),y(!1),h(""),g(null)},se=(_,ve,rt="mobile",Oe)=>{E(_),O(ve),j(rt),k(Oe||null),v(!0)};u.useEffect(()=>{const _=ve=>{};return document.addEventListener("contextmenu",_,!0),()=>{document.removeEventListener("contextmenu",_,!0)}},[]),u.useEffect(()=>{p.trim()||oe(0)},[U,p]),u.useEffect(()=>{G(Eu)},[p,f,w==null?void 0:w.songs.length]);const M=u.useCallback(()=>{var Oe;if(!f||!((Oe=w==null?void 0:w.songs)!=null&&Oe.length))return;const _=window.scrollY||document.documentElement.scrollTop,ve=window.innerHeight||document.documentElement.clientHeight,rt=document.documentElement.scrollHeight;_+ve*1.5>=rt&&G(ht=>Math.min(ht+Nv,w.songs.length))},[f,w==null?void 0:w.songs.length]);u.useEffect(()=>{var _;if(!(!f||!((_=w==null?void 0:w.songs)!=null&&_.length)))return document.addEventListener("scroll",M,{passive:!0,capture:!0}),window.addEventListener("scroll",M,{passive:!0}),document.addEventListener("touchmove",M,{passive:!0}),document.addEventListener("touchend",M,{passive:!0}),()=>{document.removeEventListener("scroll",M,{capture:!0}),window.removeEventListener("scroll",M),document.removeEventListener("touchmove",M),document.removeEventListener("touchend",M)}},[M]),u.useEffect(()=>{z(Au)},[ne,e.length]);const J=u.useCallback(()=>{const _=window.scrollY||document.documentElement.scrollTop,ve=window.innerHeight||document.documentElement.clientHeight,rt=document.documentElement.scrollHeight;_+ve*1.5>=rt&&z(Oe=>Math.min(Oe+Sv,e.length))},[e.length]);u.useEffect(()=>(document.addEventListener("scroll",J,{passive:!0,capture:!0}),window.addEventListener("scroll",J,{passive:!0}),document.addEventListener("touchmove",J,{passive:!0}),document.addEventListener("touchend",J,{passive:!0}),()=>{document.removeEventListener("scroll",J,{capture:!0}),window.removeEventListener("scroll",J),document.removeEventListener("touchmove",J),document.removeEventListener("touchend",J)}),[J]),u.useEffect(()=>{p.trim()||(!B.current&&P.current!==U&&le(!0),P.current=U,Pe())},[ne,U,p]),u.useEffect(()=>{B.current&&(B.current=!1)},[]);const Pe=async()=>{l("albums",!0);try{const _={limit:Zs,startIndex:ne*Zs};U==="RecentlyAdded"?(_.sortBy=["DateCreated"],_.sortOrder="Descending"):U==="Newest"?(_.sortBy=["ProductionYear","SortName"],_.sortOrder=["Descending","Ascending"]):(_.sortBy=["SortName"],_.sortOrder="Ascending");const ve=await L.getAlbums(_);t(ve.Items),Z(ve.TotalRecordCount||0)}catch(_){console.error("Failed to load albums:",_),t([]),Z(0)}finally{l("albums",!1),le(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${fe?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Albums"}),s.jsx("button",{onClick:()=>y(!0),className:"w-10 h-10 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors","aria-label":"Search",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),!f&&s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsxs("button",{onClick:()=>{r("albums",U==="RecentlyAdded"?"Alphabetical":U==="Alphabetical"?"Newest":"RecentlyAdded")},className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[U==="RecentlyAdded"?"Recently Added":U==="Newest"?"Newest":"Alphabetically",s.jsx(zr,{className:"w-4 h-4"})]}),o.albums&&!B.current&&s.jsx("div",{className:"flex items-center",children:s.jsx(qt,{})})]})]})})}),s.jsx("div",{className:`fixed left-0 right-0 z-10 lg:left-16 transition-[left,right] duration-300 ${fe?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 7rem - 8px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 7rem)"},onContextMenu:_=>{},children:!f&&s.jsx("div",{className:pe?"opacity-50 pointer-events-none":"",onContextMenu:_=>{},children:e.length===0&&!o.albums?s.jsx("div",{className:"flex items-center justify-center py-16 text-gray-400",children:s.jsx("p",{children:"No albums found"})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-4",children:s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",onContextMenu:_=>{},children:e.map((_,ve)=>s.jsx(xv,{album:_,onContextMenu:se,contextMenuItemId:(I==null?void 0:I.Id)||null,showImage:ve<K},_.Id))})}),s.jsx(oo,{currentPage:ne,totalPages:Math.ceil(F/Zs),onPageChange:oe,itemsPerPage:Zs,totalItems:F})]})})})]}),f&&tr.createPortal(s.jsx(s.Fragment,{children:s.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:s.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:s.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Kn,{ref:ae,value:p,onChange:T,showClearButton:p.trim().length>0,onClear:A})}),s.jsx("button",{onClick:H,className:"px-4 py-2 text-white text-sm font-medium hover:text-zinc-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),s.jsxs("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(52px + env(safe-area-inset-top))"},children:[s.jsx("div",{className:"sticky bg-black z-10 pt-3 pb-4",style:{top:"calc(76px + env(safe-area-inset-top))"},children:s.jsxs("div",{className:"flex items-center gap-3 px-4",children:[s.jsxs("button",{onClick:()=>ee("genre"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${W.length>0?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by genre",children:[s.jsx(qn,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Genre"})]}),s.jsxs("button",{onClick:()=>ee("year"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${he.min!==null||he.max!==null?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by year",children:[s.jsx(Gi,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Year"})]})]})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${fe?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 76px + 4rem)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{className:"pb-32",style:{paddingTop:"40px"},children:N?s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):de?s.jsxs("div",{className:"space-y-8",children:[de.albums.length>0&&s.jsxs("div",{className:"px-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:de.albums.map(_=>s.jsx(yv,{album:_,onClick:Q,onContextMenu:se,contextMenuItemId:(I==null?void 0:I.Id)||null},_.Id))})]}),de.artists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),s.jsx("div",{className:"space-y-0",children:de.artists.slice(0,5).map(_=>s.jsx(vv,{artist:_,onClick:je,onContextMenu:se,contextMenuItemId:(I==null?void 0:I.Id)||null},_.Id))})]}),de.playlists&&de.playlists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),s.jsx("div",{className:"space-y-0",children:de.playlists.map(_=>s.jsxs("button",{onClick:()=>qe(_.Id),onContextMenu:ve=>{ve.preventDefault(),ve.stopPropagation(),se(_,"playlist","desktop",{x:ve.clientX,y:ve.clientY})},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:s.jsx("img",{src:L.getAlbumArtUrl(_.Id,96),alt:_.Name,className:"w-full h-full object-cover",loading:"lazy"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:_.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:_.ChildCount?`${_.ChildCount} tracks`:"Playlist"})]})]},_.Id))})]}),de.songs.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:be,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:s.jsx(tt,{className:"w-5 h-5"})}),s.jsx("button",{type:"button",onClick:Ae,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:s.jsx($t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"space-y-0",children:de.songs.map((_,ve)=>s.jsx(wv,{song:_,onClick:we,onContextMenu:se,contextMenuItemId:(I==null?void 0:I.Id)||null,showImage:ve<V},_.Id))})]}),de.artists.length===0&&de.albums.length===0&&(!de.playlists||de.playlists.length===0)&&de.songs.length===0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[s.jsx("div",{className:"text-lg mb-2",children:"No results found"}),s.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):s.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})]})]})}),document.body),ue==="genre"&&s.jsx(Jn,{isOpen:ge,onClose:()=>Se(!1),filterType:"genre",genres:a,selectedValues:W,onApply:ie}),ue==="year"&&s.jsx(Jn,{isOpen:ge,onClose:()=>Se(!1),filterType:"year",availableYears:q,yearRange:he,onApplyYear:xe}),s.jsx(We,{item:I,itemType:R,isOpen:m,onClose:()=>{v(!1),E(null),O(null)},zIndex:99999,mode:S,position:b||void 0})]})}function gm({song:e,showImage:t=!0,onContextMenu:n,contextMenuItemId:r}){var S,j;const{playTrack:l}=ye(),o=Ct(),[a,c]=u.useState(!1),[i,d]=u.useState("mobile"),[p,h]=u.useState(null),f=u.useRef(!1),[y,w]=u.useState(!1),g=r===e.Id,N=b=>{const k=Math.floor(b/1e7),I=Math.floor(k/60),E=k%60;return`${I}:${E.toString().padStart(2,"0")}`},x=b=>{if(f.current){b.preventDefault(),f.current=!1;return}l(e)},m=b=>{var k,I,E,R;b.preventDefault(),b.stopPropagation(),(I=(k=b.nativeEvent)==null?void 0:k.preventDefault)==null||I.call(k),(R=(E=b.nativeEvent)==null?void 0:E.stopImmediatePropagation)==null||R.call(E),f.current=!0,n?n(e,"song","desktop",{x:b.clientX,y:b.clientY}):(d("desktop"),h({x:b.clientX,y:b.clientY}),c(!0)),setTimeout(()=>{f.current=!1},300)},v=Te({onLongPress:b=>{b.preventDefault(),n?(f.current=!0,n(e,"song","mobile")):(f.current=!0,d("mobile"),h(null),c(!0))}});return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:b=>{if(a||f.current){b.preventDefault(),b.stopPropagation();return}x(b)},onContextMenu:m,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${g?"bg-white/10":""}`,...v,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center flex items-center justify-center",children:y?s.jsx(Xe,{className:"w-7 h-7 text-gray-500"}):t?s.jsx(ct,{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm",onError:()=>w(!0)}):s.jsx("div",{className:"w-full h-full bg-zinc-900"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(o==null?void 0:o.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((j=(S=e.ArtistItems)==null?void 0:S[0])==null?void 0:j.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:N(e.RunTimeTicks)})]}),s.jsx(We,{item:e,itemType:"song",isOpen:a,onClose:()=>c(!1),mode:i,position:p||void 0})]})}const Go=new Map;function bv({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var y;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,[i,d]=u.useState(null);u.useEffect(()=>{var x;if((x=e.ImageTags)!=null&&x.Primary){d(null);return}const w=Go.get(e.Id);if(w!==void 0){d(w);return}let g=!1;return(async()=>{try{const{albums:m,songs:v}=await L.getArtistItems(e.Id),S=m[0],j=v.find(E=>E.AlbumId)||v[0],b=S||j,k=b?b.AlbumId||b.Id:null,I=k?L.getAlbumArtUrl(k,96):null;Go.set(e.Id,I),g||d(I)}catch(m){console.error("Failed to load fallback album art for artist (search item):",e.Id,m),Go.set(e.Id,null)}})(),()=>{g=!0}},[e.Id,e.ImageTags]);const p=w=>{if(c||a.current){w.preventDefault(),w.stopPropagation(),a.current=!1;return}t(e.Id)},h=w=>{w.preventDefault(),w.stopPropagation(),a.current=!0,n(e,"artist","desktop",{x:w.clientX,y:w.clientY}),setTimeout(()=>{a.current=!1},300)},f=Te({onLongPress:w=>{w.preventDefault(),a.current=!0,n(e,"artist","mobile")},onClick:p});return s.jsxs("button",{onClick:p,onContextMenu:h,...f,className:`w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left cursor-pointer px-4 h-[72px] ${c?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:l?s.jsx(it,{className:"w-6 h-6 text-gray-500"}):i||(y=e.ImageTags)!=null&&y.Primary?s.jsx("img",{src:i||L.getArtistImageUrl(e.Id,96),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):s.jsx(it,{className:"w-6 h-6 text-gray-500"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function Iv({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,i=y=>{if(c||a.current){y.preventDefault(),y.stopPropagation(),a.current=!1;return}t(e.Id)},d=y=>{y.preventDefault(),y.stopPropagation(),a.current=!0,n(e,"album","desktop",{x:y.clientX,y:y.clientY}),setTimeout(()=>{a.current=!1},300)},p=Te({onLongPress:y=>{y.preventDefault(),a.current=!0,n(e,"album","mobile")},onClick:i});return s.jsxs("button",{onClick:i,onContextMenu:d,...p,className:"text-left group",children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:l?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function kv({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:l=!0}){var y,w;const o=u.useRef(!1),a=r===e.Id,[c,i]=u.useState(!1),d=g=>{const N=Math.floor(g/1e7),x=Math.floor(N/60),m=N%60;return`${x}:${m.toString().padStart(2,"0")}`},p=g=>{if(a||o.current){g.preventDefault(),g.stopPropagation(),o.current=!1;return}t(e)},h=g=>{g.preventDefault(),g.stopPropagation(),o.current=!0,n(e,"song","desktop",{x:g.clientX,y:g.clientY}),setTimeout(()=>{o.current=!1},300)},f=Te({onLongPress:g=>{g.preventDefault(),o.current=!0,n(e,"song","mobile")},onClick:p});return s.jsxs("button",{onClick:p,onContextMenu:h,...f,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${a?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:c?s.jsx(Xe,{className:"w-7 h-7 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>i(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((w=(y=e.ArtistItems)==null?void 0:y[0])==null?void 0:w.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:d(e.RunTimeTicks)})]})}const el=90,Pu=45,Cv=45,Mu=45,Av=45;function Ev(){const{songs:e,setSongs:t,sortPreferences:n,setSortPreference:r,setLoading:l,loading:o,genres:a}=Ce(),{playTrack:c,playAlbum:i,addToQueue:d}=ye(),p=ye(M=>M.isQueueSidebarOpen),[h,f]=u.useState(""),[y,w]=u.useState(!1),[g,N]=u.useState(null),[x,m]=u.useState(!1),[v,S]=u.useState("mobile"),[j,b]=u.useState(null),[k,I]=u.useState(null),[E,R]=u.useState(null),[O,ne]=u.useState(!1),[oe,F]=u.useState(0),[Z,K]=u.useState(0),z=Ve(),C=u.useRef(null),$=u.useRef(null),[D,ae]=u.useState([]),[W,Ne]=u.useState({min:null,max:null}),[he,me]=u.useState(!1),[ge,Se]=u.useState(null),[ue,X]=u.useState([]),q=n.songs,te=u.useRef(!0),[U,B]=u.useState(!1),pe=u.useRef(q),[le,P]=u.useState(Pu),[V,G]=u.useState(Mu);u.useEffect(()=>{(async()=>{try{const J=Ce.getState();if(J.years.length>0)X(J.years);else{const Pe=await L.getYears();X(Pe)}}catch(J){console.error("Failed to load filter values:",J)}})()},[]);const fe=D.length>0||W.min!==null||W.max!==null;u.useEffect(()=>{const M=h.trim().length>0;if(M||fe){ne(!0);const J=window.setTimeout(()=>{(async()=>{try{if(M){const _=await Ts(h,450);N(_)}else{const _=await Rs(450);N(_)}}catch(_){console.error("Search failed:",_),N(null)}finally{ne(!1)}})()},250);return()=>{window.clearTimeout(J)}}else N(null),ne(!1)},[h,fe]);const re=u.useMemo(()=>{if(!g)return null;const M=_=>{if(W.min!==null||W.max!==null)return!1;if(D.length>0){const ve=_.Genres||[];if(!D.some(Oe=>ve.some(ht=>ht.toLowerCase()===Oe.toLowerCase())))return!1}return!0},J=_=>{if(D.length>0){const ve=_.Genres||[];if(!D.some(Oe=>ve.some(ht=>ht.toLowerCase()===Oe.toLowerCase())))return!1}if(W.min!==null||W.max!==null){const ve=_.ProductionYear;if(!ve||ve<=0||W.min!==null&&ve<W.min||W.max!==null&&ve>W.max)return!1}return!0},Pe=_=>!(W.min!==null||W.max!==null||D.length>0);return{songs:g.songs.filter(J),artists:g.artists.filter(M),albums:g.albums.filter(J),playlists:(g.playlists||[]).filter(Pe)}},[g,D,W]);u.useEffect(()=>{var M;if(y&&((M=C.current)==null||M.focus(),C.current)){const J=C.current.value.length;C.current.setSelectionRange(J,J)}},[y]);const de=M=>{f(M),M.trim().length>0&&!y&&w(!0)},T=()=>{f(""),N(null)},A=()=>{w(!1),f(""),N(null),ae([]),Ne({min:null,max:null})},H=M=>{Se(M),me(!0)},ee=M=>{ae(M)},ie=M=>{Ne(M)},xe=M=>{z(`/artist/${M}`),w(!1),f(""),N(null)},je=M=>{z(`/album/${M}`),w(!1),f(""),N(null)},Q=M=>{c(M,[M])},we=M=>{M.preventDefault(),M.stopPropagation(),re!=null&&re.songs&&re.songs.length>0&&i(re.songs)},be=M=>{M.preventDefault(),M.stopPropagation(),re!=null&&re.songs&&re.songs.length>0&&d(re.songs)},Ae=M=>{z(`/playlist/${M}`),w(!1),f(""),N(null)},qe=(M,J,Pe="mobile",_)=>{I(M),R(J),S(Pe),b(_||null),m(!0)};u.useEffect(()=>{h.trim()||F(0)},[q,h]),u.useEffect(()=>{G(Mu)},[h,y,g==null?void 0:g.songs.length]),u.useEffect(()=>{var Pe;const M=$.current;if(!y||!M||!((Pe=g==null?void 0:g.songs)!=null&&Pe.length))return;const J=()=>{const _=M.scrollTop,ve=M.clientHeight,rt=M.scrollHeight;_+ve*1.5>=rt&&G(Oe=>Math.min(Oe+Av,g.songs.length))};return M.addEventListener("scroll",J,{passive:!0}),()=>M.removeEventListener("scroll",J)},[y,g==null?void 0:g.songs.length,V]),u.useEffect(()=>{P(Pu)},[oe,e.length]),u.useEffect(()=>{const M=()=>{const J=window.scrollY||document.documentElement.scrollTop,Pe=window.innerHeight||document.documentElement.clientHeight,_=document.documentElement.scrollHeight;J+Pe*1.5>=_&&P(ve=>Math.min(ve+Cv,e.length))};return window.addEventListener("scroll",M,{passive:!0}),()=>window.removeEventListener("scroll",M)},[e.length]),u.useEffect(()=>{h.trim()||(!te.current&&pe.current!==q&&B(!0),pe.current=q,se())},[oe,q,h]),u.useEffect(()=>{te.current&&(te.current=!1)},[]);const se=async()=>{l("songs",!0);try{const M={limit:el,startIndex:oe*el};q==="RecentlyAdded"?(M.sortBy=["DateCreated"],M.sortOrder="Descending"):(M.sortBy=["SortName"],M.sortOrder="Ascending");const J=await L.getSongs(M);t(J.Items),K(J.TotalRecordCount||0)}catch(M){console.error("Failed to load songs:",M),t([]),K(0)}finally{l("songs",!1),B(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${p?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Songs"}),s.jsx("button",{onClick:()=>w(!0),className:"w-10 h-10 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors","aria-label":"Search",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),!y&&s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsxs("button",{onClick:()=>r("songs",q==="RecentlyAdded"?"Alphabetical":"RecentlyAdded"),className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[q==="RecentlyAdded"?"Recently Added":"Alphabetically",s.jsx(zr,{className:"w-4 h-4"})]}),o.songs&&!te.current&&s.jsx("div",{className:"flex items-center",children:s.jsx(qt,{})})]})]})})}),s.jsx("div",{className:`fixed left-0 right-0 z-10 lg:left-16 transition-[left,right] duration-300 ${p?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 7rem - 8px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 7rem)"},children:!y&&s.jsx("div",{className:U?"opacity-50 pointer-events-none":"",children:e.length===0&&!o.songs?s.jsx("div",{className:"flex items-center justify-center py-16 text-gray-400",children:s.jsx("p",{children:"No songs found"})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"space-y-0",children:e.map((M,J)=>s.jsx(gm,{song:M,showImage:J<le,onContextMenu:qe,contextMenuItemId:(k==null?void 0:k.Id)||null},M.Id))}),s.jsx(oo,{currentPage:oe,totalPages:Math.ceil(Z/el),onPageChange:F,itemsPerPage:el,totalItems:Z})]})})})]}),y&&tr.createPortal(s.jsx(s.Fragment,{children:s.jsxs("div",{ref:$,className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:s.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:s.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Kn,{ref:C,value:h,onChange:de,showClearButton:h.trim().length>0,onClear:T})}),s.jsx("button",{onClick:A,className:"px-4 py-2 text-white text-sm font-medium hover:text-zinc-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),s.jsxs("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(52px + env(safe-area-inset-top))"},children:[s.jsx("div",{className:"sticky bg-black z-10 pt-3 pb-4",style:{top:"calc(76px + env(safe-area-inset-top))"},children:s.jsxs("div",{className:"flex items-center gap-3 px-4",children:[s.jsxs("button",{onClick:()=>H("genre"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${D.length>0?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by genre",children:[s.jsx(qn,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Genre"})]}),s.jsxs("button",{onClick:()=>H("year"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${W.min!==null||W.max!==null?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by year",children:[s.jsx(Gi,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Year"})]})]})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${p?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 76px + 4rem)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{className:"pb-32",style:{paddingTop:"40px"},children:O?s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):re?s.jsxs("div",{className:"space-y-8",children:[re.songs.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:we,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:s.jsx(tt,{className:"w-5 h-5"})}),s.jsx("button",{type:"button",onClick:be,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:s.jsx($t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"space-y-0",children:re.songs.map((M,J)=>s.jsx(kv,{song:M,onClick:Q,onContextMenu:qe,contextMenuItemId:(k==null?void 0:k.Id)||null,showImage:J<V},M.Id))})]}),re.artists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),s.jsx("div",{className:"space-y-0",children:re.artists.slice(0,5).map(M=>s.jsx(bv,{artist:M,onClick:xe,onContextMenu:qe,contextMenuItemId:(k==null?void 0:k.Id)||null},M.Id))})]}),re.albums.length>0&&s.jsxs("div",{className:"px-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),s.jsx("div",{className:"grid grid-cols-3 gap-4",children:re.albums.slice(0,12).map(M=>s.jsx(Iv,{album:M,onClick:je,onContextMenu:qe,contextMenuItemId:(k==null?void 0:k.Id)||null},M.Id))})]}),re.playlists&&re.playlists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),s.jsx("div",{className:"space-y-0",children:re.playlists.map(M=>s.jsxs("button",{onClick:()=>Ae(M.Id),onContextMenu:J=>{J.preventDefault(),J.stopPropagation(),qe(M,"playlist","desktop",{x:J.clientX,y:J.clientY})},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:s.jsx("img",{src:L.getAlbumArtUrl(M.Id,96),alt:M.Name,className:"w-full h-full object-cover",loading:"lazy"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:M.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:M.ChildCount?`${M.ChildCount} tracks`:"Playlist"})]})]},M.Id))})]}),re.artists.length===0&&re.albums.length===0&&(!re.playlists||re.playlists.length===0)&&re.songs.length===0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[s.jsx("div",{className:"text-lg mb-2",children:"No results found"}),s.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):s.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})]})]})}),document.body),ge==="genre"&&s.jsx(Jn,{isOpen:he,onClose:()=>me(!1),filterType:"genre",genres:a,selectedValues:D,onApply:ee}),ge==="year"&&s.jsx(Jn,{isOpen:he,onClose:()=>me(!1),filterType:"year",availableYears:ue,yearRange:W,onApplyYear:ie}),s.jsx(We,{item:k,itemType:E,isOpen:x,onClose:()=>{m(!1),I(null),R(null)},zIndex:99999,mode:v,position:j||void 0})]})}function Pv({genre:e}){const t=Ve();return s.jsx("button",{onClick:()=>t(`/genre/${e.Id}`),className:"w-full flex items-center justify-between h-12 pl-4 pr-4 hover:bg-zinc-900 transition-colors group",children:s.jsx("div",{className:"text-base font-medium text-white group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})}function Mv(){const{genres:e,setGenres:t,setLoading:n,loading:r}=Ce(),l=ye(o=>o.isQueueSidebarOpen);return u.useEffect(()=>{if(e.length>0)return;(async()=>{n("genres",!0);try{const c=(await L.getGenres()||[]).sort((i,d)=>(i.Name||"").localeCompare(d.Name||""));t(c)}catch(a){console.error("Failed to load genres:",a),t([])}finally{n("genres",!1)}})()},[e.length,t,n]),s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${l?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Genres"}),r.genres&&s.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:s.jsx(qt,{})}),!r.genres&&s.jsx("div",{className:"w-10 h-10"})]})})})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${l?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 6rem - 16px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsxs("div",{className:"pb-4",style:{paddingTop:"calc(env(safe-area-inset-top) + 6rem)"},children:[e.length===0&&!r.genres&&s.jsx("div",{className:"flex items-center justify-center py-8 text-gray-400",children:s.jsx("p",{children:"No genres found"})}),e.length>0&&s.jsx("div",{className:"space-y-2",children:[...e].sort((o,a)=>(o.Name||"").localeCompare(a.Name||"")).map(o=>s.jsx(Pv,{genre:o},o.Id))})]})]})}function Tv({playlist:e}){const t=Ve(),[n,r]=u.useState(!1),[l,o]=u.useState("mobile"),[a,c]=u.useState(null),i=u.useRef(!1),d=f=>{if(i.current){f.preventDefault(),i.current=!1;return}t(`/playlist/${e.Id}`)},p=Te({onLongPress:f=>{f.preventDefault(),i.current=!0,o("mobile"),c(null),r(!0)}}),h=f=>{f.preventDefault(),f.stopPropagation(),i.current=!0,o("desktop"),c({x:f.clientX,y:f.clientY}),r(!0),setTimeout(()=>{i.current=!1},300)};return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:f=>{if(n||i.current){f.preventDefault(),f.stopPropagation();return}d(f)},onContextMenu:h,...p,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:s.jsx(ct,{src:L.getAlbumArtUrl(e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left flex flex-col justify-center",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.ChildCount?`${e.ChildCount} tracks`:"Playlist"})]})]}),s.jsx(We,{item:e,itemType:"playlist",isOpen:n,onClose:()=>r(!1),mode:l,position:a||void 0})]})}const Vo=new Map;function Rv({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var y,w;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,[i,d]=u.useState(null);u.useEffect(()=>{var m;if((m=e.ImageTags)!=null&&m.Primary){d(null);return}const g=Vo.get(e.Id);if(g!==void 0){d(g);return}let N=!1;return(async()=>{try{const{albums:v,songs:S}=await L.getArtistItems(e.Id),j=v[0],b=S.find(R=>R.AlbumId)||S[0],k=j||b,I=k?k.AlbumId||k.Id:null,E=I?L.getAlbumArtUrl(I,96):null;Vo.set(e.Id,E),N||d(E)}catch(v){console.error("Failed to load fallback album art for artist (playlists search):",e.Id,v),Vo.set(e.Id,null)}})(),()=>{N=!0}},[e.Id,e.ImageTags]);const p=g=>{if(c||a.current){g.preventDefault(),g.stopPropagation(),a.current=!1;return}t(e.Id)},h=g=>{g.preventDefault(),g.stopPropagation(),a.current=!0,n(e,"artist"),setTimeout(()=>{a.current=!1},300)},f=Te({onLongPress:g=>{g.preventDefault(),a.current=!0,n(e,"artist")},onClick:p});return s.jsxs("button",{onClick:p,onContextMenu:h,...f,className:`w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left px-4 h-[72px] ${c?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:l?s.jsx(it,{className:"w-6 h-6 text-gray-500"}):(y=e.ImageTags)!=null&&y.Primary||i?s.jsx("img",{src:(w=e.ImageTags)!=null&&w.Primary?L.getArtistImageUrl(e.Id,96):i||"",alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):s.jsx(it,{className:"w-6 h-6 text-gray-500"})}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function Lv({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[l,o]=u.useState(!1),a=u.useRef(!1),c=r===e.Id,i=y=>{if(c||a.current){y.preventDefault(),y.stopPropagation(),a.current=!1;return}t(e.Id)},d=y=>{y.preventDefault(),y.stopPropagation(),a.current=!0,n(e,"album"),setTimeout(()=>{a.current=!1},300)},p=Te({onLongPress:y=>{y.preventDefault(),a.current=!0,n(e,"album")},onClick:i});return s.jsxs("button",{onClick:i,onContextMenu:d,...p,className:"text-left group",children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:l?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function zv({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:l=!0}){var y,w;const o=u.useRef(!1),a=r===e.Id,[c,i]=u.useState(!1),d=g=>{const N=Math.floor(g/1e7),x=Math.floor(N/60),m=N%60;return`${x}:${m.toString().padStart(2,"0")}`},p=g=>{if(a||o.current){g.preventDefault(),g.stopPropagation(),o.current=!1;return}t(e)},h=g=>{g.preventDefault(),g.stopPropagation(),o.current=!0,n(e,"song"),setTimeout(()=>{o.current=!1},300)},f=Te({onLongPress:g=>{g.preventDefault(),o.current=!0,n(e,"song")},onClick:p});return s.jsxs("button",{onClick:p,onContextMenu:h,...f,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${a?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:c?s.jsx(Xe,{className:"w-7 h-7 text-gray-500"}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>i(!0)}),s.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((w=(y=e.ArtistItems)==null?void 0:y[0])==null?void 0:w.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:d(e.RunTimeTicks)})]})}function Ov(){const[e,t]=u.useState([]),[n,r]=u.useState(!0),{sortPreferences:l,setSortPreference:o}=Ce(),{playTrack:a,playAlbum:c,addToQueue:i}=ye(),d=l.playlists,p=u.useRef(!0),[h,f]=u.useState(!1),y=u.useRef(d),w=Ve(),g=u.useRef(null),[N,x]=u.useState(""),[m,v]=u.useState(!1),[S,j]=u.useState(null),[b,k]=u.useState(!1),[I,E]=u.useState(!1),[R,O]=u.useState(null),[ne,oe]=u.useState(null),[F,Z]=u.useState("mobile"),[K,z]=u.useState(null),[C,$]=u.useState(45),D=ye(B=>B.isQueueSidebarOpen);u.useEffect(()=>{m||(!p.current&&y.current!==d&&f(!0),y.current=d,ae())},[d,m]),u.useEffect(()=>{p.current&&(p.current=!1)},[]),u.useEffect(()=>{if(N.trim()){k(!0);const B=window.setTimeout(()=>{(async()=>{try{const le=await Ts(N,450);j(le)}catch(le){console.error("Search failed:",le),j(null)}finally{k(!1)}})()},250);return()=>{window.clearTimeout(B)}}else j(null),k(!1)},[N]),u.useEffect(()=>{$(45)},[N,m,S==null?void 0:S.songs.length]),u.useEffect(()=>{var pe;if(!m||!((pe=S==null?void 0:S.songs)!=null&&pe.length))return;const B=()=>{const le=window.scrollY||document.documentElement.scrollTop,P=window.innerHeight||document.documentElement.clientHeight,V=document.documentElement.scrollHeight;le+P*1.5>=V&&$(G=>Math.min(G+45,S.songs.length))};return window.addEventListener("scroll",B,{passive:!0}),()=>window.removeEventListener("scroll",B)},[m,S==null?void 0:S.songs.length]),u.useEffect(()=>{var B;if(m&&((B=g.current)==null||B.focus(),g.current)){const pe=g.current.value.length;g.current.setSelectionRange(pe,pe)}},[m]);const ae=async()=>{r(!0);try{const B={limit:100};d==="RecentlyAdded"?(B.sortBy=["DateCreated"],B.sortOrder="Descending"):(B.sortBy=["SortName"],B.sortOrder="Ascending");const pe=await L.getPlaylists(B);t(pe.Items)}catch(B){console.error("Failed to load playlists:",B)}finally{r(!1),f(!1)}},W=B=>{x(B),B.trim().length>0&&!m&&v(!0)},Ne=()=>{x(""),j(null)},he=()=>{v(!1),x(""),j(null)},me=B=>{w(`/artist/${B}`),v(!1),x(""),j(null)},ge=B=>{w(`/album/${B}`),v(!1),x(""),j(null)},Se=B=>{a(B,[B])},ue=B=>{B.preventDefault(),B.stopPropagation(),U!=null&&U.songs&&U.songs.length>0&&c(U.songs)},X=B=>{B.preventDefault(),B.stopPropagation(),U!=null&&U.songs&&U.songs.length>0&&i(U.songs)},q=B=>{w(`/playlist/${B}`),v(!1),x(""),j(null)},te=(B,pe,le="mobile",P)=>{O(B),oe(pe),Z(le),z(P||null),E(!0)},U=u.useMemo(()=>S?{playlists:S.playlists||[],artists:S.artists||[],albums:S.albums||[],songs:S.songs||[]}:null,[S]);return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${D?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h1",{className:"text-2xl font-bold text-white",children:"Playlists"}),s.jsx("button",{onClick:()=>v(!0),className:"w-10 h-10 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors","aria-label":"Search",children:s.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),!m&&s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsxs("button",{onClick:()=>o("playlists",d==="RecentlyAdded"?"Alphabetical":"RecentlyAdded"),className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[d==="RecentlyAdded"?"Recently Added":"Alphabetically",s.jsx(zr,{className:"w-4 h-4"})]}),n&&!p.current&&s.jsx("div",{className:"flex items-center",children:s.jsx(qt,{})})]})]})})}),s.jsx("div",{className:`fixed left-0 right-0 z-10 lg:left-16 transition-[left,right] duration-300 ${D?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 7rem - 8px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 7rem)"},children:!m&&s.jsx("div",{className:h?"opacity-50 pointer-events-none":"",children:e.length===0&&!n?s.jsx("div",{className:"flex items-center justify-center py-16 text-gray-400",children:s.jsx("p",{children:"No playlists found"})}):s.jsx("div",{className:"space-y-0",children:e.map(B=>s.jsx(Tv,{playlist:B},B.Id))})})})]}),m&&tr.createPortal(s.jsx(s.Fragment,{children:s.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),s.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:s.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:s.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Kn,{ref:g,value:N,onChange:W,showClearButton:N.trim().length>0,onClear:Ne})}),s.jsx("button",{onClick:he,className:"px-4 py-2 text-white text-sm font-medium hover:text-zinc-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${D?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 76px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsx("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(52px + env(safe-area-inset-top))"},children:s.jsx("div",{className:"pb-32 pt-4",children:b?s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):U?s.jsxs("div",{className:"space-y-8",children:[U.playlists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),s.jsx("div",{className:"space-y-0",children:U.playlists.map(B=>s.jsxs("button",{onClick:()=>q(B.Id),onContextMenu:pe=>{pe.preventDefault(),pe.stopPropagation(),te(B,"playlist","desktop",{x:pe.clientX,y:pe.clientY})},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:s.jsx("img",{src:L.getAlbumArtUrl(B.Id,96),alt:B.Name,className:"w-full h-full object-cover",loading:"lazy"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:B.Name}),s.jsx("div",{className:"text-xs text-gray-400 truncate",children:B.ChildCount?`${B.ChildCount} tracks`:"Playlist"})]})]},B.Id))})]}),U.artists.length>0&&s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),s.jsx("div",{className:"space-y-0",children:U.artists.slice(0,5).map(B=>s.jsx(Rv,{artist:B,onClick:me,onContextMenu:te,contextMenuItemId:(R==null?void 0:R.Id)||null},B.Id))})]}),U.albums.length>0&&s.jsxs("div",{className:"px-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),s.jsx("div",{className:"grid grid-cols-3 gap-4",children:U.albums.slice(0,12).map(B=>s.jsx(Lv,{album:B,onClick:ge,onContextMenu:te,contextMenuItemId:(R==null?void 0:R.Id)||null},B.Id))})]}),U.songs.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[s.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:ue,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:s.jsx(tt,{className:"w-5 h-5"})}),s.jsx("button",{type:"button",onClick:X,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:s.jsx($t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"space-y-0",children:U.songs.map((B,pe)=>s.jsx(zv,{song:B,onClick:Se,onContextMenu:te,contextMenuItemId:(R==null?void 0:R.Id)||null,showImage:pe<C},B.Id))})]}),U.playlists.length===0&&U.artists.length===0&&U.albums.length===0&&U.songs.length===0&&s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[s.jsx("div",{className:"text-lg mb-2",children:"No results found"}),s.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):s.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})})]})}),document.body),s.jsx(We,{item:R,itemType:ne,isOpen:I,onClose:()=>{E(!1),O(null),oe(null)},zIndex:99999,mode:F,position:K||void 0})]})}const Tu=45,Dv=45;function _v({track:e,index:t,tracks:n,onClick:r,onContextMenu:l,contextMenuItemId:o}){var f,y;const a=o===e.Id,c=Ct(),i=u.useRef(!1),d=w=>{const g=Math.floor(w/1e7),N=Math.floor(g/60),x=g%60;return`${N}:${x.toString().padStart(2,"0")}`},p=w=>{w.preventDefault(),w.stopPropagation(),i.current=!0,l(e,"desktop",{x:w.clientX,y:w.clientY}),setTimeout(()=>{i.current=!1},300)},h=Te({onLongPress:w=>{w.preventDefault(),i.current=!0,l(e,"mobile")},onClick:()=>{if(i.current){i.current=!1;return}r(e,n)}});return s.jsxs("button",{onClick:()=>{if(i.current){i.current=!1;return}r(e,n)},onContextMenu:p,...h,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${a?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:s.jsx(ct,{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(c==null?void 0:c.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),s.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((y=(f=e.ArtistItems)==null?void 0:f[0])==null?void 0:y.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:d(e.RunTimeTicks)})]})}function $v(){const{id:e}=ro(),t=Ve(),{playAlbum:n,playTrack:r,isPlaying:l}=ye(),o=Ct(),[a,c]=u.useState(null),[i,d]=u.useState([]),[p,h]=u.useState(!0),[f,y]=u.useState(!1),[w,g]=u.useState(null),[N,x]=u.useState("mobile"),[m,v]=u.useState(null),[S,j]=u.useState(!1),[b,k]=u.useState("mobile"),[I,E]=u.useState(null),[R,O]=u.useState(Tu),ne=ye(Z=>Z.isQueueSidebarOpen);u.useEffect(()=>{if(!e)return;(async()=>{h(!0);try{const K=await L.getAlbumTracks(e);d(K);const C=(await L.getPlaylists({limit:1e3})).Items.find($=>$.Id===e);C?c(C):K.length>0&&c({Id:e,Name:"Playlist",Type:"Playlist"})}catch(K){console.error("Failed to load playlist data:",K)}finally{h(!1)}})()},[e]),u.useEffect(()=>{O(Tu)},[i.length]),u.useEffect(()=>{const Z=()=>{const K=window.scrollY||document.documentElement.scrollTop,z=window.innerHeight||document.documentElement.clientHeight,C=document.documentElement.scrollHeight;K+z*1.5>=C&&O($=>Math.min($+Dv,i.length))};return window.addEventListener("scroll",Z,{passive:!0}),()=>window.removeEventListener("scroll",Z)},[i.length]);const oe=()=>{i.length>0&&n(i)},F=()=>!i.length||!o?!1:i.some(Z=>Z.Id===o.Id);return p?s.jsx("div",{className:"pb-20",children:s.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:s.jsx("p",{children:"Loading..."})})}):!a||i.length===0?s.jsx("div",{className:"pb-20",children:s.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:s.jsx("p",{children:"Playlist not found"})})}):s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${ne?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"flex items-center justify-between gap-4 px-4",style:{paddingTop:"calc(1rem + 8px)",paddingBottom:"1rem"},children:[s.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-zinc-300 transition-colors",children:s.jsx(Gn,{className:"w-6 h-6"})}),a&&s.jsx("button",{onClick:Z=>{const K=Z.currentTarget.getBoundingClientRect();k("desktop"),E({x:K.left+K.width/2,y:K.bottom+5}),j(!0)},className:"text-white hover:text-zinc-300 transition-colors",children:s.jsx(Qi,{className:"w-6 h-6"})})]})})}),s.jsxs("div",{className:"pt-20",children:[s.jsx("div",{className:"mb-6 px-4 pt-4",children:s.jsxs("div",{className:"w-full",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-0.5 text-left break-words",children:a.Name}),s.jsxs("div",{className:"flex items-center justify-between gap-4 mt-2",children:[s.jsxs("div",{className:"text-gray-400",children:[i.length," ",i.length===1?"track":"tracks"]}),s.jsx("button",{onClick:F()&&l?()=>ye.getState().pause():oe,className:"bg-white/10 hover:bg-white/20 text-white font-semibold py-1.5 px-3 rounded-full transition-all hover:scale-105 flex items-center gap-1.5 backdrop-blur-sm border border-white/20 flex-shrink-0",children:F()&&l?s.jsxs(s.Fragment,{children:[s.jsx(Mn,{className:"w-3.5 h-3.5"}),"Pause"]}):s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"w-3.5 h-3.5"}),"Play"]})})]})]})}),s.jsx("div",{children:s.jsx("div",{className:"space-y-0",children:i.slice(0,R).map((Z,K)=>s.jsx(_v,{track:Z,index:K,tracks:i,onClick:z=>r(z,i),onContextMenu:(z,C,$)=>{g(z),x(C||"mobile"),v($||null),y(!0)},contextMenuItemId:(w==null?void 0:w.Id)||null},Z.Id))})})]}),s.jsx(We,{item:w,itemType:"song",isOpen:f,onClose:()=>{y(!1),g(null)},mode:N,position:m||void 0}),s.jsx(We,{item:a,itemType:"playlist",isOpen:S,onClose:()=>{j(!1)},mode:b,position:I||void 0})]})}const Fv=[{name:"zinc",hex:"#71717a"},{name:"red",hex:"#ef4444"},{name:"orange",hex:"#f97316"},{name:"amber",hex:"#f59e0b"},{name:"yellow",hex:"#eab308"},{name:"lime",hex:"#84cc16"},{name:"green",hex:"#22c55e"},{name:"emerald",hex:"#10b981"},{name:"teal",hex:"#14b8a6"},{name:"cyan",hex:"#06b6d4"},{name:"sky",hex:"#0ea5e9"},{name:"blue",hex:"#3b82f6"},{name:"indigo",hex:"#6366f1"},{name:"violet",hex:"#8b5cf6"},{name:"purple",hex:"#a855f7"},{name:"fuchsia",hex:"#d946ef"},{name:"pink",hex:"#ec4899"},{name:"rose",hex:"#f43f5e"}];function Uv(){const e=Ve(),{pageVisibility:t,setPageVisibility:n,accentColor:r,setAccentColor:l}=Tt(),{logout:o,serverUrl:a}=Hi(),{setGenres:c,lastSyncCompleted:i,setLastSyncCompleted:d}=Ce(),{state:p,startSync:h,completeSync:f}=Or(),y=ye(E=>E.isQueueSidebarOpen),[w,g]=u.useState(!1),[N,x]=u.useState(!1),[m,v]=u.useState({scope:"incremental"}),S=()=>{x(!1),v({scope:"incremental"})},j=()=>{o(),e("/")},b=E=>{n({[E]:!t[E]})},k=async()=>{const E=(m.scope==="full","Syncing...");h("settings",E);try{await L.syncLibrary(m);const O=(await L.getGenres()||[]).sort((ne,oe)=>(ne.Name||"").localeCompare(oe.Name||""));c(O),d(Date.now()),f(!0,"Library synced successfully")}catch(R){f(!1,R instanceof Error?R.message:"Failed to sync library")}},I=async()=>{if(a)try{await navigator.clipboard.writeText(a),g(!0),setTimeout(()=>g(!1),1500)}catch{}};return s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${y?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"flex items-center gap-4 p-4",children:[s.jsx("button",{onClick:()=>e("/"),className:"text-white hover:text-zinc-300 transition-colors",children:s.jsx(Gn,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold flex-1",children:"Settings"})]})})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${y?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 5.5rem - 28px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsxs("div",{className:"p-4 space-y-8",style:{paddingTop:"calc(env(safe-area-inset-top) + 5.5rem + 24px)"},children:[s.jsxs("section",{children:[s.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Page Visibility"}),s.jsx("div",{className:"space-y-3",children:["artists","albums","songs","genres","playlists"].map(E=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-900 rounded-lg",children:[s.jsx("label",{className:"text-white capitalize font-medium",children:E}),s.jsx("button",{onClick:()=>b(E),className:`relative w-12 h-6 rounded-full transition-colors ${t[E]?"bg-[var(--accent-color)]":"bg-zinc-600"}`,children:s.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${t[E]?"translate-x-6":"translate-x-0"}`})})]},E))})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Accent Color"}),s.jsx("div",{className:"grid grid-cols-6 md:grid-cols-9 gap-3 mb-6",children:Fv.map(E=>s.jsx("button",{onClick:()=>l(E.name),className:`aspect-square rounded-lg transition-all ${r===E.name?"ring-2 ring-white ring-offset-2 ring-offset-black scale-110":"hover:scale-105"}`,style:{backgroundColor:E.hex},"aria-label":`Select ${E.name} color`},E.name))}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-white mb-3",children:"About Tunetuna"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("a",{href:"https://github.com/AlessioLaiso/tunetuna",target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-3 bg-transparent border border-[var(--accent-color)] text-white hover:bg-[var(--accent-color)]/10 font-semibold rounded-full transition-colors text-center flex items-center justify-center gap-2",children:[s.jsx(qx,{className:"w-5 h-5"}),s.jsx("span",{children:"GitHub"})]}),s.jsxs("a",{href:"https://www.paypal.com/donate/?hosted_button_id=XBVKHU3JV9W8N",target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-3 bg-transparent border border-[var(--accent-color)] text-white hover:bg-[var(--accent-color)]/10 font-semibold rounded-full transition-colors text-center flex items-center justify-center gap-2",children:[s.jsx(t0,{className:"w-5 h-5"}),s.jsx("span",{children:"Donate"})]})]})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-lg font-semibold text-white mb-1",children:"Jellyfin Library"}),s.jsxs("div",{className:"relative inline-block mb-2",children:[s.jsx("button",{type:"button",onClick:I,disabled:!a,className:`text-left text-xs break-all transition-colors ${a?"text-gray-400 hover:text-gray-200 cursor-pointer":"text-gray-600 cursor-not-allowed"}`,children:a?`Server: ${a}`:"Server: Not configured"}),w&&s.jsx("div",{className:"absolute left-0 mt-1 px-2 py-1 rounded bg-zinc-800 text-[10px] text-white shadow-lg",children:"Copied to clipboard"})]}),p==="idle"&&i&&s.jsxs("div",{className:"text-xs text-gray-400 mb-4",children:["Last synced: ",new Date(i).getFullYear()," ",new Date(i).toLocaleString("default",{month:"short"})," ",new Date(i).getDate().toString().padStart(2,"0")," at ",new Date(i).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>x(!0),disabled:p==="syncing",className:"flex-1 px-4 py-3 bg-transparent border border-[var(--accent-color)] text-white hover:bg-[var(--accent-color)]/10 disabled:opacity-50 disabled:cursor-not-allowed font-semibold rounded-full transition-colors flex items-center justify-center gap-2",children:p==="syncing"?s.jsxs(s.Fragment,{children:[s.jsx(ss,{className:"w-5 h-5 animate-spin"}),s.jsx("span",{children:"Syncing..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(ss,{className:"w-5 h-5"}),s.jsx("span",{children:"Sync"})]})}),s.jsxs("button",{onClick:j,className:"flex-1 px-4 py-3 bg-transparent border border-red-500 text-red-500 hover:bg-red-500/10 font-semibold rounded-full transition-colors flex items-center justify-center gap-2",children:[s.jsx(u0,{className:"w-5 h-5"}),s.jsx("span",{children:"Log Out"})]})]})]}),s.jsx(Ji,{isOpen:N,onClose:S,zIndex:10001,children:s.jsxs("div",{className:"pb-6",children:[s.jsxs("div",{className:"mb-6 pl-4 pr-4",children:[s.jsx("div",{className:"text-lg font-semibold text-white",children:"Sync"}),s.jsx("div",{className:"text-sm text-gray-400 mt-1",children:"Cache song metadata to speed up search and loading times"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>{v({scope:"incremental"}),x(!1),k()},disabled:p==="syncing",className:"w-full flex items-center gap-3 py-4 pr-4 pl-4 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed text-white text-left rounded-lg transition-colors",children:[s.jsx(v0,{className:"w-5 h-5 text-white flex-shrink-0"}),s.jsx("span",{className:"font-medium",children:"New and updated files"})]}),s.jsxs("button",{onClick:()=>{v({scope:"full"}),x(!1),k()},disabled:p==="syncing",className:"w-full flex items-center gap-3 py-4 pr-4 pl-4 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed text-white text-left rounded-lg transition-colors",children:[s.jsx(P0,{className:"w-5 h-5 text-white flex-shrink-0"}),s.jsx("span",{className:"font-medium",children:"All files (slower)"})]})]})]})})]})]})}const Ru=45,Bv=45,Lu=45,Hv=45;function Gv({album:e,year:t,onNavigate:n,onContextMenu:r,showImage:l=!0}){const[o,a]=u.useState(!1),c=u.useRef(!1),i=h=>{if(c.current){h.preventDefault(),h.stopPropagation(),c.current=!1;return}n(e.Id)},d=h=>{h.preventDefault(),h.stopPropagation(),c.current=!0,r(e,"desktop",{x:h.clientX,y:h.clientY}),setTimeout(()=>{c.current=!1},100)},p=Te({onLongPress:h=>{h.preventDefault(),c.current=!0,r(e,"mobile")},onClick:i});return s.jsxs("button",{onClick:i,onContextMenu:d,...p,className:"text-left group",children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-2 bg-zinc-900 flex items-center justify-center",children:o?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):l?s.jsx(ct,{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>a(!0)}):s.jsx("div",{className:"w-full h-full bg-zinc-900"})}),s.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.Name}),t&&s.jsx("div",{className:"text-xs text-gray-400 truncate",children:t})]})}function Vv({song:e,album:t,year:n,onClick:r,onContextMenu:l,contextMenuItemId:o,showImage:a=!0}){const c=o===e.Id,i=Ct(),d=h=>{const f=Math.floor(h/1e7),y=Math.floor(f/60),w=f%60;return`${y}:${w.toString().padStart(2,"0")}`},p=Te({onLongPress:h=>{h.preventDefault(),l(e,"mobile")},onClick:()=>r(e)});return s.jsxs("button",{onClick:()=>r(e),onContextMenu:h=>{h.preventDefault(),l(e,"desktop",{x:h.clientX,y:h.clientY})},...p,className:`w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3 ${c?"bg-white/10":""}`,children:[s.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center flex items-center justify-center",children:a?s.jsx(ct,{src:L.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm"}):s.jsx("div",{className:"w-full h-full bg-zinc-900"})}),s.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[s.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(i==null?void 0:i.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),(t||n)&&s.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1 min-w-0",children:[t&&s.jsx("span",{className:"truncate",children:t}),t&&n&&s.jsx("span",{className:"flex-shrink-0",children:""}),n&&s.jsx("span",{className:"flex-shrink-0",children:n})]})]}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:d(e.RunTimeTicks)})]})}function Qv(){var de;const{id:e}=ro(),t=Ve(),{playAlbum:n,playTrack:r,isPlaying:l,pause:o,addToQueue:a}=ye(),c=Ct(),[i,d]=u.useState(null),[p,h]=u.useState([]),[f,y]=u.useState([]),[w,g]=u.useState(!0),[N,x]=u.useState(!1),[m,v]=u.useState(!0),[S,j]=u.useState(!0),[b,k]=u.useState(!1),[I,E]=u.useState("mobile"),[R,O]=u.useState(null),[ne,oe]=u.useState(null),[F,Z]=u.useState(null),[K,z]=u.useState(!1),[C,$]=u.useState("mobile"),[D,ae]=u.useState(null),[W,Ne]=u.useState("Alphabetical"),[he,me]=u.useState(Ru),[ge,Se]=u.useState(Lu),ue=u.useRef(null),X=ye(T=>T.isQueueSidebarOpen);u.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[e]);const q=T=>T.toLowerCase().replace(/[_\*\-\.]/g,"").trim();u.useEffect(()=>{if(!e)return;(async()=>{var A;g(!0);try{let ee=await L.getArtistById(e);if(!ee){const Q=(await L.getArtists({limit:1e3})).Items.find(we=>we.Id===e);Q&&(ee=Q)}if(!ee){g(!1);return}d(ee),j(!0);const ie=await L.getArtistItems(e);if(ie.albums.length===0&&ie.songs.length===0&&ee.Name){const je=q(ee.Name),we=((A=(await L.search(ee.Name,50)).Artists)==null?void 0:A.Items)||[];for(const be of we)if(be.Id!==e&&q(be.Name)===je){const Ae=await L.getArtistItems(be.Id);if(Ae.albums.length>0||Ae.songs.length>0){t(`/artist/${be.Id}`,{replace:!0});return}}}const xe=[...ie.albums].sort((je,Q)=>{const we=je.ProductionYear||(je.PremiereDate?new Date(je.PremiereDate).getFullYear():0);return(Q.ProductionYear||(Q.PremiereDate?new Date(Q.PremiereDate).getFullYear():0))-we});h(xe),y(ie.songs)}catch(H){console.error("Failed to load artist data:",H)}finally{g(!1)}})()},[e,t]),u.useEffect(()=>{if(!(i!=null&&i.Overview))return;v(!0);let T=null,A=null,H=null,ee=!1;const ie=()=>{const Q=ue.current;if(!Q||!(i!=null&&i.Overview)){v(!1);return}const we=window.getComputedStyle(Q);let be=parseFloat(we.lineHeight||"0");if((!Number.isFinite(be)||be===0)&&(be=parseFloat(we.fontSize||"16")*1.5),be===0){v(!1);return}const Ae=Q.scrollHeight;if(Ae===0&&!ee){ee=!0,xe();return}const se=Math.round(Ae/be)>2;v(se)},xe=()=>{T!==null&&cancelAnimationFrame(T),A!==null&&clearTimeout(A),T=requestAnimationFrame(()=>{A=window.setTimeout(ie,0)}),H!==null&&clearTimeout(H),H=window.setTimeout(()=>{ee=!1,ie()},300)},je=()=>{ee=!1,xe()};return xe(),window.addEventListener("resize",je),()=>{T!==null&&cancelAnimationFrame(T),A!==null&&clearTimeout(A),H!==null&&clearTimeout(H),window.removeEventListener("resize",je)}},[i==null?void 0:i.Overview]),u.useEffect(()=>{me(Ru)},[p.length]),u.useEffect(()=>{Se(Lu)},[f.length]);const te=u.useCallback(()=>{const T=window.scrollY||document.documentElement.scrollTop,A=window.innerHeight||document.documentElement.clientHeight,H=document.documentElement.scrollHeight;T+A*1>=H&&Se(ee=>Math.min(ee+Hv,f.length))},[f.length]);u.useEffect(()=>(document.addEventListener("scroll",te,{passive:!0,capture:!0}),window.addEventListener("scroll",te,{passive:!0}),document.addEventListener("touchmove",te,{passive:!0}),document.addEventListener("touchend",te,{passive:!0}),()=>{document.removeEventListener("scroll",te,{capture:!0}),window.removeEventListener("scroll",te),document.removeEventListener("touchmove",te),document.removeEventListener("touchend",te)}),[te]);const U=u.useCallback(()=>{const T=window.pageYOffset||document.documentElement.scrollTop||window.scrollY||0,A=window.innerHeight||document.documentElement.clientHeight,H=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);T+A*1>=H&&me(ee=>Math.min(ee+Bv,p.length))},[p.length]);u.useEffect(()=>(document.addEventListener("scroll",U,{passive:!0,capture:!0}),window.addEventListener("scroll",U,{passive:!0}),document.addEventListener("touchmove",U,{passive:!0}),document.addEventListener("touchend",U,{passive:!0}),()=>{document.removeEventListener("scroll",U,{capture:!0}),window.removeEventListener("scroll",U),document.removeEventListener("touchmove",U),document.removeEventListener("touchend",U)}),[U]);const B=()=>{if(V.length>0){const T=[...V].sort(()=>Math.random()-.5);n(T)}},pe=T=>T.ProductionYear?T.ProductionYear.toString():T.PremiereDate?new Date(T.PremiereDate).getFullYear().toString():null,le=T=>{const A=T.Album||null;let H=null;if(T.AlbumId){const ee=p.find(ie=>ie.Id===T.AlbumId);ee&&(H=pe(ee))}return{album:A,year:H}},P=T=>{if(T.AlbumId){const A=p.find(H=>H.Id===T.AlbumId);if(A)return A.ProductionYear||(A.PremiereDate?new Date(A.PremiereDate).getFullYear():0)}return T.ProductionYear||(T.PremiereDate?new Date(T.PremiereDate).getFullYear():0)},V=u.useMemo(()=>{if(W==="Alphabetical")return[...f].sort((H,ee)=>{const ie=H.Name||"",xe=ee.Name||"";return ie.localeCompare(xe)});const T=(H,ee,ie)=>{const xe=P(H),je=P(ee),Q=H.AlbumId||"",we=ee.AlbumId||"";if(xe!==je)return ie?je-xe:xe-je;if(Q!==we)return Q.localeCompare(we);const be=H.IndexNumber||0,Ae=ee.IndexNumber||0;return be!==Ae?be-Ae:(H.Name||"").localeCompare(ee.Name||"")},A=W==="Newest";return[...f].sort((H,ee)=>T(H,ee,A))},[f,W,p]),G=T=>{T.preventDefault(),T.stopPropagation(),V.length>0&&n(V)},fe=T=>{T.preventDefault(),T.stopPropagation(),V.length>0&&a(V)},re=()=>{Ne(T=>T==="Alphabetical"?"Newest":T==="Newest"?"Oldest":"Alphabetical")};return w?s.jsx("div",{className:"pb-20",children:s.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:s.jsx(qt,{})})}):i?s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${X?"sidebar-open-right-offset":""}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"relative flex items-center justify-between gap-4 p-4",children:[s.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-zinc-300 transition-colors z-10",children:s.jsx(Gn,{className:"w-6 h-6"})}),i&&s.jsx("button",{onClick:T=>{const A=T.currentTarget.getBoundingClientRect();$("desktop"),ae({x:A.left+A.width/2,y:A.bottom+5}),z(!0)},className:"text-white hover:text-zinc-300 transition-colors z-10",children:s.jsx(Qi,{className:"w-6 h-6"})})]})})}),s.jsxs("div",{className:"relative z-30 w-screen",style:{marginTop:"calc(-1 * env(safe-area-inset-top))",marginLeft:"calc(50% - 50vw)",marginRight:"calc(50% - 50vw)"},children:[S&&s.jsxs("div",{className:"relative w-full min-h-64 md:min-h-80 bg-black",style:{paddingTop:"env(safe-area-inset-top)"},children:[s.jsx("div",{className:"w-full flex items-center justify-center md:hidden",children:s.jsx(ct,{src:L.getArtistImageUrl(i.Id),alt:i.Name,className:"w-full h-auto object-contain",onError:()=>j(!1)})}),s.jsx("div",{className:"hidden md:block w-full h-80",children:s.jsx("img",{src:L.getArtistBackdropUrl(i.Id),alt:i.Name,className:"w-full h-full object-cover",onError:()=>j(!1)})}),s.jsx("div",{className:"absolute inset-x-0 top-0 bottom-[-1px] bg-gradient-to-b from-transparent via-black/60 to-black pointer-events-none"})]}),s.jsx("div",{className:`left-0 right-0 ${S?"absolute":"relative"} ${S?"pt-16":"pt-12"}`,style:S?{bottom:"-28px",paddingBottom:"1.5rem"}:{},children:s.jsxs("div",{className:"max-w-[768px] mx-auto px-4 flex items-end gap-6 md:grid md:grid-cols-3 md:gap-4",children:[S&&s.jsx("div",{className:"hidden md:block md:col-span-1",children:s.jsx("div",{className:"aspect-square rounded overflow-hidden bg-zinc-900 flex items-center justify-center",children:s.jsx(ct,{src:L.getArtistImageUrl(i.Id),alt:i.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded"})})}),s.jsx("div",{className:`flex-1 min-w-0 pb-2 ${S?"md:col-span-2":"md:col-span-3"}`,children:s.jsxs("div",{className:"mb-4 mt-4",children:[s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-2 break-words",children:i.Name}),s.jsxs("div",{className:"flex items-center justify-between gap-4 mt-2",children:[s.jsxs("p",{className:"text-sm text-gray-300",children:[p.length," ",p.length===1?"album":"albums","  ",V.length," ",V.length===1?"song":"songs"]}),s.jsx("button",{onClick:()=>{var A;c&&l&&(((A=c.ArtistItems)==null?void 0:A.some(H=>H.Id===e))||c.AlbumArtist===(i==null?void 0:i.Name))?o():B()},className:"bg-white/10 hover:bg-white/20 text-white font-semibold py-1.5 px-3 rounded-full transition-all hover:scale-105 flex items-center gap-1.5 backdrop-blur-sm border border-white/20 flex-shrink-0",children:c&&l&&((de=c.ArtistItems)!=null&&de.some(T=>T.Id===e)||c.AlbumArtist===(i==null?void 0:i.Name))?s.jsxs(s.Fragment,{children:[s.jsx(Mn,{className:"w-3.5 h-3.5"}),"Pause"]}):s.jsxs(s.Fragment,{children:[s.jsx(rn,{className:"w-3.5 h-3.5"}),"Shuffle"]})})]})]})})]})})]}),s.jsxs("div",{className:"pt-3 md:pt-7",children:[i.Overview&&s.jsx("div",{className:"mb-6 -mt-4 px-4",children:s.jsxs("div",{className:"text-white relative",children:[s.jsx("p",{ref:ue,className:"text-sm text-gray-300 leading-relaxed absolute opacity-0 pointer-events-none -z-10",children:i.Overview}),!N&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>x(!0),className:"flex-1 text-left min-w-0",children:s.jsx("p",{className:"text-sm text-gray-300 leading-relaxed line-clamp-2",children:i.Overview})}),s.jsx("button",{onClick:()=>x(!0),className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors",children:s.jsx(Vi,{className:"w-4 h-4"})})]}),N&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-line",children:i.Overview}),s.jsxs("button",{onClick:()=>x(!1),className:"mt-2 flex items-center gap-1 text-sm text-gray-400 hover:text-white transition-colors ml-auto",children:["Show less",s.jsx(fm,{className:"w-4 h-4"})]})]})]})}),p.length>0&&s.jsxs("div",{className:"mb-10 px-4",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Albums (",p.length,")"]}),s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:p.map((T,A)=>{const H=pe(T);return s.jsx(Gv,{album:T,year:H,onNavigate:ee=>t(`/album/${ee}`),onContextMenu:(ee,ie,xe)=>{oe(ee),Z("album"),E(ie||"mobile"),O(xe||null),k(!0)},showImage:A<he},T.Id)})})]}),f.length>0&&s.jsxs("div",{id:"songs-section",children:[s.jsxs("div",{className:"px-4 mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Songs (",f.length,")"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:G,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:s.jsx(tt,{className:"w-5 h-5"})}),s.jsx("button",{type:"button",onClick:fe,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:s.jsx($t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"mt-1",children:s.jsxs("button",{type:"button",onClick:re,className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[W,s.jsx(zr,{className:"w-4 h-4"})]})})]}),s.jsx("div",{className:"space-y-0",children:V.map((T,A)=>{const{album:H,year:ee}=le(T);return s.jsx(Vv,{song:T,album:H,year:ee,onClick:r,onContextMenu:(ie,xe,je)=>{oe(ie),Z("song"),E(xe||"mobile"),O(je||null),k(!0)},contextMenuItemId:(ne==null?void 0:ne.Id)||null,showImage:A<ge},T.Id)})})]})]}),s.jsx(We,{item:ne,itemType:F,isOpen:b,onClose:()=>{k(!1),oe(null),Z(null)},zIndex:99999,mode:I,position:R||void 0}),s.jsx(We,{item:i,itemType:"artist",isOpen:K,onClose:()=>{z(!1)},mode:C,position:D||void 0})]}):s.jsx("div",{className:"pb-20",children:s.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:s.jsx("p",{children:"Artist not found on the Jellyfin server"})})})}function Yv({track:e,trackNumber:t,tracks:n,onClick:r,onContextMenu:l,contextMenuItemId:o}){const a=o===e.Id,c=Ct(),i=u.useRef(!1),d=f=>{const y=Math.floor(f/1e7),w=Math.floor(y/60),g=y%60;return`${w}:${g.toString().padStart(2,"0")}`},p=f=>{f.preventDefault(),f.stopPropagation(),i.current=!0,l(e,"desktop",{x:f.clientX,y:f.clientY}),setTimeout(()=>{i.current=!1},300)},h=Te({onLongPress:f=>{f.preventDefault(),i.current=!0,l(e,"mobile")},onClick:()=>{if(i.current){i.current=!1;return}r(e,n)}});return s.jsxs("button",{onClick:()=>{if(i.current){i.current=!1;return}r(e,n)},onContextMenu:p,...h,className:`w-full flex items-baseline hover:bg-white/10 transition-colors group py-3 ${a?"bg-white/10":""}`,children:[s.jsx("span",{className:`text-sm w-6 text-right flex-shrink-0 mr-4 ${(c==null?void 0:c.Id)===e.Id?"text-[var(--accent-color)]":"text-gray-500"}`,children:t&&t>0?t:"-"}),s.jsx("div",{className:"flex-1 min-w-0 text-left",children:s.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(c==null?void 0:c.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name})}),e.RunTimeTicks&&s.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right mr-4",children:d(e.RunTimeTicks)})]})}function Wv(){const{id:e}=ro(),t=Ve(),{playAlbum:n,playTrack:r,isPlaying:l,play:o,pause:a}=ye(),c=Ct(),[i,d]=u.useState(null),[p,h]=u.useState([]),[f,y]=u.useState(!0),[w,g]=u.useState(!1),[N,x]=u.useState(!0),[m,v]=u.useState(!1),[S,j]=u.useState("mobile"),[b,k]=u.useState(null),[I,E]=u.useState(null),[R,O]=u.useState(!1),[ne,oe]=u.useState("mobile"),[F,Z]=u.useState(null),[K,z]=u.useState(null),[C,$]=u.useState(!1),[D,ae]=u.useState(!1),[W,Ne]=u.useState(!1),he=u.useRef(!1),me=u.useRef(!1),[ge,Se]=u.useState(0),ue=u.useRef(0),X=u.useRef(null),q=u.useRef(0),te=u.useRef(!1),U=u.useRef(null),B=u.useRef(null),pe=ye(T=>T.isQueueSidebarOpen),le=u.useRef(!1);u.useEffect(()=>{if(!e)return;(async()=>{var A;y(!0);try{const H=await L.getAlbumTracks(e);h(H);let ie=await L.getAlbumById(e);if(!ie){const Q=(await L.getAlbums({limit:1})).Items.find(we=>we.Id===e);Q&&(ie=Q)}ie||H.length>0&&H[0].AlbumId===e&&(ie={Id:e,Name:H[0].Album||"Unknown Album",AlbumArtist:H[0].AlbumArtist}),ie&&(d(ie),x(!0));const xe=P(H,ie);if(xe)try{const je=await L.getArtistById(xe);(A=je==null?void 0:je.ImageTags)!=null&&A.Logo?(z(L.getImageUrl(xe,"Logo")),$(!0)):($(!1),z(null))}catch(je){console.warn("Failed to load artist logo:",je),$(!1),z(null)}else $(!1),z(null)}catch(H){console.error("Failed to load album data:",H)}finally{y(!1)}})()},[e]),u.useEffect(()=>{const T=(c==null?void 0:c.AlbumId)===(i==null?void 0:i.Id)&&l,A=(i==null?void 0:i.Id)||null,H=B.current!==null&&B.current!==A;if(le.current!==T&&(he.current=!1),le.current=T,!N){ae(!1),Ne(!1),B.current=A;return}T?((H||!te.current||!D)&&(ae(!0),Ne(!1),te.current=!0),me.current=window.innerWidth>=560,he.current||(he.current=!0,setTimeout(()=>{(c==null?void 0:c.AlbumId)===(i==null?void 0:i.Id)&&l&&Ne(!0)},500)),B.current=A):te.current&&D&&!T?(he.current||(he.current=!0,Ne(!1)),B.current=A):te.current?(ae(!1),Ne(!1),B.current=A):(ae(!1),Ne(!1),te.current=!0,B.current=A)},[c==null?void 0:c.AlbumId,i==null?void 0:i.Id,l,D,N,W]),u.useEffect(()=>{const T=()=>{if((c==null?void 0:c.AlbumId)===(i==null?void 0:i.Id)&&l&&D){const H=window.innerWidth>=560;me.current=H,W&&(Ne(!1),setTimeout(()=>Ne(!0),10))}};return window.addEventListener("resize",T),()=>window.removeEventListener("resize",T)},[c==null?void 0:c.AlbumId,i==null?void 0:i.Id,l,D,W]),u.useEffect(()=>{if((c==null?void 0:c.AlbumId)===(i==null?void 0:i.Id)&&l){const A=H=>{q.current===0&&(q.current=H);const ee=H-q.current,ie=360/1e4;ue.current=(ue.current+ie*ee)%360,Se(ue.current),q.current=H,X.current=requestAnimationFrame(A)};q.current=0,X.current=requestAnimationFrame(A)}else X.current&&(cancelAnimationFrame(X.current),X.current=null),q.current=0;return()=>{X.current&&cancelAnimationFrame(X.current)}},[c==null?void 0:c.AlbumId,i==null?void 0:i.Id,l]);const P=(T,A)=>T.length>0&&T[0].ArtistItems&&T[0].ArtistItems.length>0?T[0].ArtistItems[0].Id:A!=null&&A.ArtistItems&&A.ArtistItems.length>0?A.ArtistItems[0].Id:null,V=()=>{p.length>0&&n(p)},G=()=>{if(p.length>0){const T=p[0];if(T.ProductionYear&&T.ProductionYear>0)return T.ProductionYear.toString();if(T.PremiereDate){const A=new Date(T.PremiereDate).getFullYear();if(A>0)return A.toString()}}return null},fe=()=>p.length>0&&p[0].ArtistItems&&p[0].ArtistItems.length>0?p[0].ArtistItems[0].Id:i!=null&&i.ArtistItems&&i.ArtistItems.length>0?i.ArtistItems[0].Id:null,re=()=>{var T,A;return i.AlbumArtist||((A=(T=i.ArtistItems)==null?void 0:T[0])==null?void 0:A.Name)||null},de=()=>{const T=fe();T&&t(`/artist/${T}`)};return f?s.jsx("div",{className:"pb-20",children:s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx(qt,{})})}):!i||p.length===0?s.jsx("div",{className:"pb-20",children:s.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:s.jsx("p",{children:"Album not found"})})}):s.jsxs("div",{className:"pb-20",style:{overflowX:"hidden",maxWidth:"100vw",width:"100%"},children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 z-[55] pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)",background:"transparent"}}),s.jsx("div",{className:"fixed top-0 left-0 right-0 z-10 pointer-events-none",style:{height:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 4rem)",top:"var(--header-offset, 0px)",background:`linear-gradient(to bottom,
            #000000 0%,
            #000000 calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 0.5rem),
            rgba(0, 0, 0, 0.95) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 1rem),
            rgba(0, 0, 0, 0.85) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 1.5rem),
            rgba(0, 0, 0, 0.7) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 2rem),
            rgba(0, 0, 0, 0.5) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 2.5rem),
            rgba(0, 0, 0, 0.3) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 3rem),
            rgba(0, 0, 0, 0.15) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 3.5rem),
            rgba(0, 0, 0, 0) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 4rem)
          )`}}),s.jsx("div",{className:`fixed top-0 left-0 right-0 z-20 lg:left-16 transition-[left,right] duration-300 ${pe?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto relative",children:s.jsxs("div",{className:"flex items-center justify-between gap-4 p-4 relative z-10",children:[s.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-zinc-300 transition-colors",children:s.jsx(Gn,{className:"w-6 h-6"})}),i&&s.jsx("button",{onClick:T=>{const A=T.currentTarget.getBoundingClientRect();oe("desktop"),Z({x:A.left+A.width/2,y:A.bottom+5}),O(!0)},className:"text-white hover:text-zinc-300 transition-colors",children:s.jsx(Qi,{className:"w-6 h-6"})})]})})}),s.jsxs("div",{style:{paddingTop:"calc(5rem + 12px - 48px)"},children:[s.jsxs("div",{className:"mb-6 px-4 pt-4",style:{overflow:"visible"},children:[N&&s.jsx("div",{className:"flex justify-center mb-6 relative",style:{overflowX:"visible",overflowY:"visible",paddingLeft:"16px",paddingRight:"16px"},children:s.jsxs("div",{ref:U,className:"w-64 h-64 relative",style:{overflow:"visible"},children:[s.jsx("div",{className:"absolute inset-0 rounded-full overflow-hidden",style:{opacity:D?1:0,zIndex:1,transform:(c==null?void 0:c.AlbumId)===i.Id&&l&&me.current?"translateX(calc(50% + 8px))":"translateX(0)",transition:"transform 500ms ease-in-out, opacity 300ms ease-in-out"},children:s.jsxs("div",{className:"w-full h-full",style:{transformOrigin:"center center",transform:`rotate(${ge}deg)`},children:[s.jsx("img",{src:"/assets/vinyl.png",alt:"Vinyl Record",className:"w-full h-full object-cover",onError:T=>{console.error("Failed to load vinyl image"),T.currentTarget.style.display="none"}}),s.jsx("div",{className:"absolute top-1/2 left-1/2 rounded-full",style:{width:"52%",height:"52%",backgroundColor:"#a1a1aa",transform:"translate(-50%, -50%)",transformOrigin:"center center"}}),C&&K?s.jsx("div",{className:"absolute top-1/2 left-1/2 rounded-full overflow-hidden flex items-center justify-center",style:{width:"47%",height:"47%",transform:"translate(-50%, -50%)",transformOrigin:"center center"},children:s.jsx("img",{src:K,alt:"Artist Logo",className:"w-full h-full object-contain",onError:()=>{$(!1),z(null)}})}):N?s.jsx("div",{className:"absolute top-1/2 left-1/2 rounded-full overflow-hidden flex items-center justify-center",style:{width:"52%",height:"52%",transform:"translate(-50%, -50%)",transformOrigin:"center center"},children:s.jsx("img",{src:L.getAlbumArtUrl(i.Id),alt:i.Name,className:"w-full h-full object-cover"})}):null]})}),s.jsx("div",{className:"absolute inset-0 rounded overflow-hidden bg-zinc-900 transition-all duration-500",style:{transform:(c==null?void 0:c.AlbumId)===i.Id&&l||W?me.current?"translateX(calc(-50% - 8px))":"translateX(calc(-100% - 24px))":"translateX(0)",opacity:1,transitionProperty:"transform",transitionDuration:"500ms",transitionTimingFunction:"ease-in-out",zIndex:10},children:s.jsx(ct,{src:L.getAlbumArtUrl(i.Id),alt:i.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>x(!1)})})]})}),s.jsxs("div",{className:"w-full",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-0.5 text-left break-words",children:i.Name}),s.jsxs("div",{className:"flex items-center justify-between gap-4 mt-2",children:[s.jsxs("div",{className:"text-gray-400 flex items-center gap-1.5",children:[re()&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:de,className:`hover:text-white transition-colors ${fe()?"cursor-pointer":"cursor-default"}`,children:re()}),G()&&s.jsx("span",{children:""})]}),G()&&s.jsx("button",{onClick:()=>t(`/albums?year=${G()}`),className:"hover:text-white transition-colors cursor-pointer",children:G()})]}),s.jsx("button",{onClick:()=>{(c==null?void 0:c.AlbumId)===i.Id&&l?a():(c==null?void 0:c.AlbumId)===i.Id&&!l?o():V()},className:"bg-white/10 hover:bg-white/20 text-white font-semibold py-1.5 px-3 rounded-full transition-all hover:scale-105 flex items-center gap-1.5 backdrop-blur-sm border border-white/20 flex-shrink-0",children:(c==null?void 0:c.AlbumId)===i.Id&&l?s.jsxs(s.Fragment,{children:[s.jsx(Mn,{className:"w-3.5 h-3.5"}),"Pause"]}):s.jsxs(s.Fragment,{children:[s.jsx(tt,{className:"w-3.5 h-3.5"}),"Play"]})})]})]})]}),i.Overview&&s.jsx("div",{className:"mb-6 px-4",children:s.jsxs("div",{className:"text-white relative",children:[!w&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>g(!0),className:"flex-1 text-left min-w-0",children:s.jsx("p",{className:"text-sm text-gray-300 leading-relaxed line-clamp-2",children:i.Overview})}),s.jsx("button",{onClick:()=>g(!0),className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors",children:s.jsx(Vi,{className:"w-4 h-4"})})]}),w&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-line",children:i.Overview}),s.jsxs("button",{onClick:()=>g(!1),className:"mt-2 flex items-center gap-1 text-sm text-gray-400 hover:text-white transition-colors ml-auto",children:["Show less",s.jsx(fm,{className:"w-4 h-4"})]})]})]})}),s.jsx("div",{children:s.jsx("div",{className:"space-y-0",children:(()=>{const T=new Map;p.forEach(ee=>{const ie=ee.ParentIndexNumber??1;T.has(ie)||T.set(ie,[]),T.get(ie).push(ee)});const A=T.size>1;return Array.from(T.keys()).sort((ee,ie)=>ee-ie).map(ee=>{const ie=T.get(ee);return s.jsxs("div",{children:[A&&s.jsxs("div",{className:`px-4 py-2 text-xs font-medium text-gray-400 uppercase tracking-wider ${ee>1?"pt-4":""}`,children:["Disc ",ee]}),ie.map(xe=>s.jsx(Yv,{track:xe,trackNumber:xe.IndexNumber??null,tracks:p,onClick:je=>r(je,p),onContextMenu:(je,Q,we)=>{E(je),j(Q||"mobile"),k(we||null),v(!0)},contextMenuItemId:(I==null?void 0:I.Id)||null},xe.Id))]},ee)})})()})})]}),s.jsx(We,{item:I,itemType:"song",isOpen:m,onClose:()=>{v(!1),E(null)},mode:S,position:b||void 0}),s.jsx(We,{item:i,itemType:"album",isOpen:R,onClose:()=>{O(!1)},mode:ne,position:F||void 0})]})}const zu=45,Xv=45,tl=84,Ou=45,qv=45;function Kv({album:e,year:t,onNavigate:n,onContextMenu:r,showImage:l=!0}){const[o,a]=u.useState(!1),c=u.useRef(!1),i=p=>{p.preventDefault(),p.stopPropagation(),c.current=!0,r(e,"desktop",{x:p.clientX,y:p.clientY}),setTimeout(()=>{c.current=!1},300)},d=Te({onLongPress:p=>{p.preventDefault(),c.current=!0,r(e,"mobile")},onClick:()=>{if(c.current){c.current=!1;return}n(e.Id)}});return s.jsxs("button",{onClick:()=>{if(c.current){c.current=!1;return}n(e.Id)},onContextMenu:i,...d,className:"text-left group",children:[s.jsx("div",{className:"aspect-square rounded overflow-hidden mb-2 bg-zinc-900 flex items-center justify-center",children:o?s.jsx(Xe,{className:"w-12 h-12 text-gray-500"}):l?s.jsx(ct,{src:L.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>a(!0)}):s.jsx("div",{className:"w-full h-full bg-zinc-900"})}),s.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.Name}),t&&s.jsx("div",{className:"text-xs text-gray-400 truncate",children:t})]})}function Jv(){const{id:e}=ro(),t=Ve(),{playAlbum:n,toggleShuffle:r,isPlaying:l,pause:o,shuffleGenreSongs:a,addToQueue:c}=ye();Ct();const{genres:i,genreSongs:d,setGenreSongs:p}=Ce(),{state:h}=Or(),[f,y]=u.useState(null),[w,g]=u.useState([]),[N,x]=u.useState(!0),[m,v]=u.useState(!1),[S,j]=u.useState("mobile"),[b,k]=u.useState(null),[I,E]=u.useState(null),[R,O]=u.useState(null),[ne,oe]=u.useState(zu),[F,Z]=u.useState(Ou),[K,z]=u.useState(0),[C,$]=u.useState(!1),[D,ae]=u.useState("Alphabetical"),[W,Ne]=u.useState(0),he=ye(P=>P.isQueueSidebarOpen);u.useEffect(()=>{if(C){const P=setTimeout(()=>{$(!1)},1e4);return()=>clearTimeout(P)}},[C]),u.useEffect(()=>{h==="success"&&e&&z(P=>P+1)},[h,e]),u.useEffect(()=>{if(!e)return;(async()=>{const V=d[e];if(V&&V.length>0){let G=i;G.length===0&&(G=await L.getGenres());const fe=G.find(re=>re.Id===e);fe&&y(fe),g(V),x(!1);return}x(!0);try{let G=i;G.length===0&&(G=await L.getGenres());const fe=G.find(T=>T.Id===e);if(!fe){x(!1);return}y(fe);const re=fe.Name;if(!re){x(!1);return}const de=await L.getGenreSongs(e,re);p(e,de),g(de)}catch(G){console.error("Failed to load genre songs:",G)}finally{x(!1)}})()},[e,i,d,p,K]);const me=async()=>{if(w.length>0&&(f!=null&&f.Id)&&(f!=null&&f.Name)&&!C){const P=ye.getState(),{isShuffleAllActive:V,isShuffleGenreActive:G,shuffle:fe}=P;if(V||G)return;$(!0);try{await a(f.Id,f.Name)}catch(re){console.error("Failed to shuffle genre:",re)}finally{$(!1)}}},ge=u.useMemo(()=>{const P=new Map;return w.forEach(V=>{if(V.AlbumId&&V.Album&&!P.has(V.AlbumId)){const G={Id:V.AlbumId,Name:V.Album,AlbumArtist:V.AlbumArtist,ArtistItems:V.ArtistItems,ProductionYear:V.ProductionYear,PremiereDate:V.PremiereDate};P.set(V.AlbumId,G)}}),Array.from(P.values()).sort((V,G)=>{const fe=V.ProductionYear||(V.PremiereDate?new Date(V.PremiereDate).getFullYear():0),re=G.ProductionYear||(G.PremiereDate?new Date(G.PremiereDate).getFullYear():0);if(fe!==re)return re-fe;const de=V.Name||"",T=G.Name||"";return de.localeCompare(T)})},[w]),Se=ge.length>84,ue=u.useMemo(()=>{if(!Se)return ge;const P=W*tl,V=P+tl;return ge.slice(P,V)},[ge,W,Se]);u.useMemo(()=>{const P=new Map;w.forEach(G=>{var T,A;const fe=G.AlbumArtist||((A=(T=G.ArtistItems)==null?void 0:T[0])==null?void 0:A.Name)||"Unknown Artist",re=G.AlbumId||"no-album";P.has(fe)||P.set(fe,new Map);const de=P.get(fe);de.has(re)||de.set(re,[]),de.get(re).push(G)});const V=[];return P.forEach((G,fe)=>{const re=[];G.forEach((de,T)=>{var ee;const A=[...de].sort((ie,xe)=>{const je=ie.IndexNumber||0,Q=xe.IndexNumber||0;return je-Q}),H=((ee=A[0])==null?void 0:ee.Album)||"Unknown Album";re.push({albumId:T,albumName:H,songs:A})}),re.sort((de,T)=>{const A=de.songs[0],H=T.songs[0],ee=(A==null?void 0:A.ProductionYear)||(A!=null&&A.PremiereDate?new Date(A.PremiereDate).getFullYear():0),ie=(H==null?void 0:H.ProductionYear)||(H!=null&&H.PremiereDate?new Date(H.PremiereDate).getFullYear():0);return ee!==ie?ie-ee:de.albumName.localeCompare(T.albumName)}),V.push({artist:fe,albums:re})}),V.sort((G,fe)=>G.artist.localeCompare(fe.artist)),V},[w]);const X=(P,V)=>{const G=V.find(re=>re.Id===P.AlbumId);if(G){const re=G.ProductionYear||(G.PremiereDate?new Date(G.PremiereDate).getFullYear():0);return G.PremiereDate?new Date(G.PremiereDate).getTime():re*1e4}const fe=P.ProductionYear||(P.PremiereDate?new Date(P.PremiereDate).getFullYear():0);return P.PremiereDate?new Date(P.PremiereDate).getTime():fe*1e4},q=u.useMemo(()=>D==="Alphabetical"?[...w].sort((P,V)=>{const G=P.Name||"",fe=V.Name||"";return G.localeCompare(fe)}):[...w].sort((P,V)=>{const G=X(P,ge),fe=X(V,ge);if(G!==fe)return D==="Newest"?fe-G:G-fe;const re=P.Album||"",de=V.Album||"";if(re!==de)return re.localeCompare(de);const T=P.IndexNumber||0,A=V.IndexNumber||0;if(T!==A)return T-A;const H=P.Name||"",ee=V.Name||"";return H.localeCompare(ee)}),[w,D,ge]),te=()=>{ae(P=>P==="Alphabetical"?"Newest":P==="Newest"?"Oldest":"Alphabetical")},U=()=>{q.length>0&&n(q)},B=()=>{q.length>0&&c(q)};u.useEffect(()=>{Se||oe(zu)},[ge.length,Se]),u.useEffect(()=>{Ne(0)},[e]),u.useEffect(()=>{Z(Ou)},[q.length]),u.useEffect(()=>{},[F]);const pe=u.useCallback(()=>{const P=window.pageYOffset||document.documentElement.scrollTop||window.scrollY||0,V=window.innerHeight||document.documentElement.clientHeight,G=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);P+V*1>=G&&Z(fe=>Math.min(fe+qv,q.length))},[q.length]);u.useEffect(()=>(document.addEventListener("scroll",pe,{passive:!0,capture:!0}),window.addEventListener("scroll",pe,{passive:!0}),document.addEventListener("touchmove",pe,{passive:!0}),document.addEventListener("touchend",pe,{passive:!0}),()=>{document.removeEventListener("scroll",pe,{capture:!0}),window.removeEventListener("scroll",pe),document.removeEventListener("touchmove",pe),document.removeEventListener("touchend",pe)}),[pe]);const le=u.useCallback(()=>{const P=window.pageYOffset||document.documentElement.scrollTop||window.scrollY||0,V=window.innerHeight||document.documentElement.clientHeight,G=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);P+V*1>=G&&oe(fe=>Math.min(fe+Xv,ge.length))},[ge.length,Se]);return u.useEffect(()=>{if(!Se)return document.addEventListener("scroll",le,{passive:!0,capture:!0}),window.addEventListener("scroll",le,{passive:!0}),document.addEventListener("touchmove",le,{passive:!0}),document.addEventListener("touchend",le,{passive:!0}),()=>{document.removeEventListener("scroll",le,{capture:!0}),window.removeEventListener("scroll",le),document.removeEventListener("touchmove",le),document.removeEventListener("touchend",le)}},[le,Se]),N?s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${he?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"flex items-center gap-4 p-4",children:[s.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-zinc-300 transition-colors",children:s.jsx(Gn,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold flex-1 truncate",children:(f==null?void 0:f.Name)||""}),s.jsx("div",{className:"flex items-center",children:s.jsx(qt,{})})]})})}),s.jsx("div",{className:"pt-20",children:s.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400"})})]}):!f||w.length===0?s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${he?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"flex items-center gap-4 p-4",children:[s.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-zinc-300 transition-colors",children:s.jsx(Gn,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold flex-1 truncate",children:"Genre"})]})})}),s.jsx("div",{className:"pt-20",children:s.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:s.jsx("p",{children:"Genre not found or no songs available"})})})]}):s.jsxs("div",{className:"pb-20",children:[s.jsx("div",{className:`fixed top-0 left-0 right-0 bg-black z-10 lg:left-16 transition-[left,right] duration-300 ${he?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:s.jsx("div",{className:"max-w-[768px] mx-auto",children:s.jsxs("div",{className:"flex items-center gap-4 p-4",children:[s.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-zinc-300 transition-colors",children:s.jsx(Gn,{className:"w-6 h-6"})}),s.jsx("h1",{className:"text-xl font-bold flex-1 truncate",children:f.Name}),s.jsx("button",{onClick:me,disabled:C,className:"w-8 h-8 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors disabled:opacity-50","aria-label":"Shuffle genre songs",children:C?s.jsx("div",{className:"w-4 h-4 border-2 border-zinc-400 border-t-white rounded-full animate-spin"}):s.jsx(rn,{className:"w-5 h-5"})})]})})}),s.jsx("div",{className:`fixed left-0 right-0 z-[60] lg:left-16 transition-[left,right] duration-300 ${he?"sidebar-open-right-offset":"xl:right-0"}`,style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 5rem - 16px)",height:"24px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent)"}}),s.jsxs("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 5rem)"},children:[ge.length>0&&s.jsxs("div",{className:"mb-10 px-4 pt-4",children:[s.jsxs("h2",{className:"text-xl font-bold text-white mb-4",children:["Albums (",ge.length,")"]}),s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:(Se?ue:ge).map((P,V)=>{const G=P.ProductionYear||(P.PremiereDate?new Date(P.PremiereDate).getFullYear():null);return s.jsx(Kv,{album:P,year:G,onNavigate:fe=>t(`/album/${fe}`),onContextMenu:(fe,re,de)=>{E(fe),O("album"),j(re||"mobile"),k(de||null),v(!0)},showImage:Se?!0:V<ne},P.Id)})})]}),Se&&ge.length>0&&s.jsx("div",{className:"-mt-10 mb-10",children:s.jsx(oo,{currentPage:W,totalPages:Math.ceil(ge.length/tl),onPageChange:Ne,itemsPerPage:tl,totalItems:ge.length})}),w.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"px-4 mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Songs (",w.length,")"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{type:"button",onClick:U,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:s.jsx(tt,{className:"w-5 h-5"})}),s.jsx("button",{type:"button",onClick:B,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:s.jsx($t,{className:"w-5 h-5"})})]})]}),s.jsx("div",{className:"mt-1",children:s.jsxs("button",{type:"button",onClick:te,className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[D,s.jsx(zr,{className:"w-4 h-4"})]})})]}),s.jsx("div",{className:"space-y-0",children:q.map((P,V)=>{const G=V<F;return s.jsx(gm,{song:P,showImage:G},P.Id)})})]})]}),s.jsx(We,{item:I,itemType:R,isOpen:m,onClose:()=>{v(!1),E(null),O(null)},mode:S,position:b||void 0})]})}function Zv(){const{pathname:e}=dn();return u.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[e]),null}function ey(){const{isAuthenticated:e,logout:t}=Hi(),{pageVisibility:n}=Tt();return u.useEffect(()=>{e&&window.location.search.includes("logout=true")&&(t(),window.location.search="")},[e]),e?s.jsxs(Yg,{children:[s.jsx(Zv,{}),s.jsx(tv,{children:s.jsxs($g,{children:[s.jsx(wt,{path:"/",element:s.jsx(cv,{})}),s.jsx(wt,{path:"/settings",element:s.jsx(Uv,{})}),n.artists&&s.jsxs(s.Fragment,{children:[s.jsx(wt,{path:"/artists",element:s.jsx(gv,{})}),s.jsx(wt,{path:"/artist/:id",element:s.jsx(Qv,{})})]}),n.albums&&s.jsxs(s.Fragment,{children:[s.jsx(wt,{path:"/albums",element:s.jsx(jv,{})}),s.jsx(wt,{path:"/album/:id",element:s.jsx(Wv,{})})]}),n.songs&&s.jsx(wt,{path:"/songs",element:s.jsx(Ev,{})}),n.genres&&s.jsxs(s.Fragment,{children:[s.jsx(wt,{path:"/genres",element:s.jsx(Mv,{})}),s.jsx(wt,{path:"/genre/:id",element:s.jsx(Jv,{})})]}),n.playlists&&s.jsxs(s.Fragment,{children:[s.jsx(wt,{path:"/playlists",element:s.jsx(Ov,{})}),s.jsx(wt,{path:"/playlist/:id",element:s.jsx($v,{})})]}),s.jsx(wt,{path:"*",element:s.jsx(Dg,{to:"/",replace:!0})})]})})]}):s.jsx(Tx,{})}class ty extends u.Component{constructor(){super(...arguments);On(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Uncaught error:",n,r)}render(){var n;return this.state.hasError?s.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Something went wrong"}),s.jsx("p",{className:"text-gray-400 mb-4",children:(n=this.state.error)==null?void 0:n.message}),s.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},className:"bg-[var(--accent-color)] hover:brightness-90 text-white font-semibold py-2 px-4 rounded-lg transition-colors",children:"Clear Data & Reload"})]})}):this.props.children}}Qo.createRoot(document.getElementById("root")).render(s.jsx(Ya.StrictMode,{children:s.jsx(ty,{children:s.jsx(ey,{})})}));
