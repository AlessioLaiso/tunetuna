import{f as b,r as u,g as N,j as l,U as j}from"./index-BHM1sJpC.js";const i=new Map,f=new Map;async function C(t){if(i.has(t))return i.get(t)??null;if(f.has(t))return f.get(t);const e=(async()=>{try{const{albums:s,songs:o}=await b.getArtistItems(t),m=s[0],g=o.find(h=>h.AlbumId)||o[0],a=m||g,r=a?a.AlbumId||a.Id:null,c=r?b.getAlbumArtUrl(r,96):null;return i.set(t,c),c}catch(s){return console.error("Failed to load fallback album art for artist:",t,s),i.set(t,null),null}finally{f.delete(t)}})();return f.set(t,e),e}function P(t){return i.get(t)}const E=u.memo(function({artist:e,onClick:s,onContextMenu:o,contextMenuItemId:m}){var A;const[g,a]=u.useState(!1),r=u.useRef(!1),c=m===e.Id,[h,d]=u.useState(null);u.useEffect(()=>{var w;if((w=e.ImageTags)!=null&&w.Primary){d(null);return}const n=P(e.Id);if(n!==void 0){d(n);return}let v=!1;return C(e.Id).then(I=>{v||d(I)}),()=>{v=!0}},[e.Id,e.ImageTags]);const x=n=>{if(c||r.current){n.preventDefault(),n.stopPropagation(),r.current=!1;return}s(e.Id)},y=n=>{n.preventDefault(),n.stopPropagation(),r.current=!0,o(e,"artist","desktop",{x:n.clientX,y:n.clientY}),setTimeout(()=>{r.current=!1},300)},k=N({onLongPress:n=>{n.preventDefault(),r.current=!0,o(e,"artist","mobile")},onClick:x}),p=(A=e.ImageTags)!=null&&A.Primary?b.getArtistImageUrl(e.Id,96):h;return l.jsxs("button",{onClick:x,onContextMenu:y,...k,className:`w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left cursor-pointer px-4 h-[72px] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[var(--accent-color)] focus-visible:ring-inset ${c?"bg-white/10":""}`,"aria-label":`Go to artist ${e.Name}`,children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:g?l.jsx(j,{className:"w-6 h-6 text-gray-500"}):p?l.jsx("img",{src:p,alt:e.Name,className:"w-full h-full object-cover",onError:()=>a(!0),loading:"lazy"}):l.jsx(j,{className:"w-6 h-6 text-gray-500"})}),l.jsx("div",{className:"flex-1 min-w-0",children:l.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})});export{E as S};
