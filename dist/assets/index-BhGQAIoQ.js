var Jf=Object.defineProperty;var Zf=(e,t,n)=>t in e?Jf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var An=(e,t,n)=>Zf(e,typeof t!="symbol"?t+"":t,n);function em(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function xu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yu={exports:{}},Ml={},vu={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vs=Symbol.for("react.element"),tm=Symbol.for("react.portal"),nm=Symbol.for("react.fragment"),rm=Symbol.for("react.strict_mode"),sm=Symbol.for("react.profiler"),lm=Symbol.for("react.provider"),om=Symbol.for("react.context"),am=Symbol.for("react.forward_ref"),im=Symbol.for("react.suspense"),cm=Symbol.for("react.memo"),um=Symbol.for("react.lazy"),Fi=Symbol.iterator;function dm(e){return e===null||typeof e!="object"?null:(e=Fi&&e[Fi]||e["@@iterator"],typeof e=="function"?e:null)}var wu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nu=Object.assign,ju={};function Sr(e,t,n){this.props=e,this.context=t,this.refs=ju,this.updater=n||wu}Sr.prototype.isReactComponent={};Sr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Sr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Iu(){}Iu.prototype=Sr.prototype;function La(e,t,n){this.props=e,this.context=t,this.refs=ju,this.updater=n||wu}var _a=La.prototype=new Iu;_a.constructor=La;Nu(_a,Sr.prototype);_a.isPureReactComponent=!0;var Ui=Array.isArray,Su=Object.prototype.hasOwnProperty,za={current:null},ku={key:!0,ref:!0,__self:!0,__source:!0};function bu(e,t,n){var r,s={},o=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)Su.call(t,r)&&!ku.hasOwnProperty(r)&&(s[r]=t[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var i=Array(c),u=0;u<c;u++)i[u]=arguments[u+2];s.children=i}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:vs,type:e,key:o,ref:a,props:s,_owner:za.current}}function fm(e,t){return{$$typeof:vs,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Da(e){return typeof e=="object"&&e!==null&&e.$$typeof===vs}function mm(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Bi=/\/+/g;function to(e,t){return typeof e=="object"&&e!==null&&e.key!=null?mm(""+e.key):t.toString(36)}function qs(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case vs:case tm:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+to(a,0):r,Ui(s)?(n="",e!=null&&(n=e.replace(Bi,"$&/")+"/"),qs(s,t,n,"",function(u){return u})):s!=null&&(Da(s)&&(s=fm(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Bi,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",Ui(e))for(var c=0;c<e.length;c++){o=e[c];var i=r+to(o,c);a+=qs(o,t,n,i,s)}else if(i=dm(e),typeof i=="function")for(e=i.call(e),c=0;!(o=e.next()).done;)o=o.value,i=r+to(o,c++),a+=qs(o,t,n,i,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Es(e,t,n){if(e==null)return e;var r=[],s=0;return qs(e,r,"","",function(o){return t.call(n,o,s++)}),r}function hm(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ot={current:null},Ks={transition:null},pm={ReactCurrentDispatcher:ot,ReactCurrentBatchConfig:Ks,ReactCurrentOwner:za};function Cu(){throw Error("act(...) is not supported in production builds of React.")}ye.Children={map:Es,forEach:function(e,t,n){Es(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Es(e,function(){t++}),t},toArray:function(e){return Es(e,function(t){return t})||[]},only:function(e){if(!Da(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ye.Component=Sr;ye.Fragment=nm;ye.Profiler=sm;ye.PureComponent=La;ye.StrictMode=rm;ye.Suspense=im;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pm;ye.act=Cu;ye.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Nu({},e.props),s=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=za.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(i in t)Su.call(t,i)&&!ku.hasOwnProperty(i)&&(r[i]=t[i]===void 0&&c!==void 0?c[i]:t[i])}var i=arguments.length-2;if(i===1)r.children=n;else if(1<i){c=Array(i);for(var u=0;u<i;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:vs,type:e.type,key:s,ref:o,props:r,_owner:a}};ye.createContext=function(e){return e={$$typeof:om,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:lm,_context:e},e.Consumer=e};ye.createElement=bu;ye.createFactory=function(e){var t=bu.bind(null,e);return t.type=e,t};ye.createRef=function(){return{current:null}};ye.forwardRef=function(e){return{$$typeof:am,render:e}};ye.isValidElement=Da;ye.lazy=function(e){return{$$typeof:um,_payload:{_status:-1,_result:e},_init:hm}};ye.memo=function(e,t){return{$$typeof:cm,type:e,compare:t===void 0?null:t}};ye.startTransition=function(e){var t=Ks.transition;Ks.transition={};try{e()}finally{Ks.transition=t}};ye.unstable_act=Cu;ye.useCallback=function(e,t){return ot.current.useCallback(e,t)};ye.useContext=function(e){return ot.current.useContext(e)};ye.useDebugValue=function(){};ye.useDeferredValue=function(e){return ot.current.useDeferredValue(e)};ye.useEffect=function(e,t){return ot.current.useEffect(e,t)};ye.useId=function(){return ot.current.useId()};ye.useImperativeHandle=function(e,t,n){return ot.current.useImperativeHandle(e,t,n)};ye.useInsertionEffect=function(e,t){return ot.current.useInsertionEffect(e,t)};ye.useLayoutEffect=function(e,t){return ot.current.useLayoutEffect(e,t)};ye.useMemo=function(e,t){return ot.current.useMemo(e,t)};ye.useReducer=function(e,t,n){return ot.current.useReducer(e,t,n)};ye.useRef=function(e){return ot.current.useRef(e)};ye.useState=function(e){return ot.current.useState(e)};ye.useSyncExternalStore=function(e,t,n){return ot.current.useSyncExternalStore(e,t,n)};ye.useTransition=function(){return ot.current.useTransition()};ye.version="18.3.1";vu.exports=ye;var p=vu.exports;const Oa=xu(p),gm=em({__proto__:null,default:Oa},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xm=p,ym=Symbol.for("react.element"),vm=Symbol.for("react.fragment"),wm=Object.prototype.hasOwnProperty,Nm=xm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jm={key:!0,ref:!0,__self:!0,__source:!0};function Au(e,t,n){var r,s={},o=null,a=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)wm.call(t,r)&&!jm.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:ym,type:e,key:o,ref:a,props:s,_owner:Nm.current}}Ml.Fragment=vm;Ml.jsx=Au;Ml.jsxs=Au;yu.exports=Ml;var l=yu.exports,Do={},Eu={exports:{}},yt={},Pu={exports:{}},Tu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(T,Q){var L=T.length;T.push(Q);e:for(;0<L;){var le=L-1>>>1,re=T[le];if(0<s(re,Q))T[le]=Q,T[L]=re,L=le;else break e}}function n(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var Q=T[0],L=T.pop();if(L!==Q){T[0]=L;e:for(var le=0,re=T.length,fe=re>>>1;le<fe;){var xe=2*(le+1)-1,me=T[xe],he=xe+1,G=T[he];if(0>s(me,L))he<re&&0>s(G,me)?(T[le]=G,T[he]=L,le=he):(T[le]=me,T[xe]=L,le=xe);else if(he<re&&0>s(G,L))T[le]=G,T[he]=L,le=he;else break e}}return Q}function s(T,Q){var L=T.sortIndex-Q.sortIndex;return L!==0?L:T.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var a=Date,c=a.now();e.unstable_now=function(){return a.now()-c}}var i=[],u=[],m=1,h=null,f=3,d=!1,v=!1,x=!1,N=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(T){for(var Q=n(u);Q!==null;){if(Q.callback===null)r(u);else if(Q.startTime<=T)r(u),Q.sortIndex=Q.expirationTime,t(i,Q);else break;Q=n(u)}}function j(T){if(x=!1,w(T),!v)if(n(i)!==null)v=!0,Z(S);else{var Q=n(u);Q!==null&&H(j,Q.startTime-T)}}function S(T,Q){v=!1,x&&(x=!1,y(A),A=-1),d=!0;var L=f;try{for(w(Q),h=n(i);h!==null&&(!(h.expirationTime>Q)||T&&!U());){var le=h.callback;if(typeof le=="function"){h.callback=null,f=h.priorityLevel;var re=le(h.expirationTime<=Q);Q=e.unstable_now(),typeof re=="function"?h.callback=re:h===n(i)&&r(i),w(Q)}else r(i);h=n(i)}if(h!==null)var fe=!0;else{var xe=n(u);xe!==null&&H(j,xe.startTime-Q),fe=!1}return fe}finally{h=null,f=L,d=!1}}var C=!1,k=null,A=-1,E=5,M=-1;function U(){return!(e.unstable_now()-M<E)}function q(){if(k!==null){var T=e.unstable_now();M=T;var Q=!0;try{Q=k(!0,T)}finally{Q?se():(C=!1,k=null)}}else C=!1}var se;if(typeof g=="function")se=function(){g(q)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,F=X.port2;X.port1.onmessage=q,se=function(){F.postMessage(null)}}else se=function(){N(q,0)};function Z(T){k=T,C||(C=!0,se())}function H(T,Q){A=N(function(){T(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_continueExecution=function(){v||d||(v=!0,Z(S))},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(i)},e.unstable_next=function(T){switch(f){case 1:case 2:case 3:var Q=3;break;default:Q=f}var L=f;f=Q;try{return T()}finally{f=L}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(T,Q){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var L=f;f=T;try{return Q()}finally{f=L}},e.unstable_scheduleCallback=function(T,Q,L){var le=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?le+L:le):L=le,T){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=L+re,T={id:m++,callback:Q,priorityLevel:T,startTime:L,expirationTime:re,sortIndex:-1},L>le?(T.sortIndex=L,t(u,T),n(i)===null&&T===n(u)&&(x?(y(A),A=-1):x=!0,H(j,L-le))):(T.sortIndex=re,t(i,T),v||d||(v=!0,Z(S))),T},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(T){var Q=f;return function(){var L=f;f=Q;try{return T.apply(this,arguments)}finally{f=L}}}})(Tu);Pu.exports=Tu;var Im=Pu.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sm=p,xt=Im;function V(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ru=new Set,Jr={};function Vn(e,t){gr(e,t),gr(e+"Capture",t)}function gr(e,t){for(Jr[e]=t,e=0;e<t.length;e++)Ru.add(t[e])}var Yt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oo=Object.prototype.hasOwnProperty,km=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gi={},Hi={};function bm(e){return Oo.call(Hi,e)?!0:Oo.call(Gi,e)?!1:km.test(e)?Hi[e]=!0:(Gi[e]=!0,!1)}function Cm(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Am(e,t,n,r){if(t===null||typeof t>"u"||Cm(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function at(e,t,n,r,s,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var qe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qe[e]=new at(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];qe[t]=new at(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qe[e]=new at(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qe[e]=new at(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qe[e]=new at(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qe[e]=new at(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qe[e]=new at(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qe[e]=new at(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qe[e]=new at(e,5,!1,e.toLowerCase(),null,!1,!1)});var $a=/[\-:]([a-z])/g;function Fa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($a,Fa);qe[t]=new at(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($a,Fa);qe[t]=new at(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($a,Fa);qe[t]=new at(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qe[e]=new at(e,1,!1,e.toLowerCase(),null,!1,!1)});qe.xlinkHref=new at("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qe[e]=new at(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ua(e,t,n,r){var s=qe.hasOwnProperty(t)?qe[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Am(t,n,s,r)&&(n=null),r||s===null?bm(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Jt=Sm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ps=Symbol.for("react.element"),Xn=Symbol.for("react.portal"),Jn=Symbol.for("react.fragment"),Ba=Symbol.for("react.strict_mode"),$o=Symbol.for("react.profiler"),Mu=Symbol.for("react.provider"),Lu=Symbol.for("react.context"),Ga=Symbol.for("react.forward_ref"),Fo=Symbol.for("react.suspense"),Uo=Symbol.for("react.suspense_list"),Ha=Symbol.for("react.memo"),rn=Symbol.for("react.lazy"),_u=Symbol.for("react.offscreen"),Qi=Symbol.iterator;function Er(e){return e===null||typeof e!="object"?null:(e=Qi&&e[Qi]||e["@@iterator"],typeof e=="function"?e:null)}var Le=Object.assign,no;function Or(e){if(no===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);no=t&&t[1]||""}return`
`+no+e}var ro=!1;function so(e,t){if(!e||ro)return"";ro=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),a=s.length-1,c=o.length-1;1<=a&&0<=c&&s[a]!==o[c];)c--;for(;1<=a&&0<=c;a--,c--)if(s[a]!==o[c]){if(a!==1||c!==1)do if(a--,c--,0>c||s[a]!==o[c]){var i=`
`+s[a].replace(" at new "," at ");return e.displayName&&i.includes("<anonymous>")&&(i=i.replace("<anonymous>",e.displayName)),i}while(1<=a&&0<=c);break}}}finally{ro=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Or(e):""}function Em(e){switch(e.tag){case 5:return Or(e.type);case 16:return Or("Lazy");case 13:return Or("Suspense");case 19:return Or("SuspenseList");case 0:case 2:case 15:return e=so(e.type,!1),e;case 11:return e=so(e.type.render,!1),e;case 1:return e=so(e.type,!0),e;default:return""}}function Bo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Jn:return"Fragment";case Xn:return"Portal";case $o:return"Profiler";case Ba:return"StrictMode";case Fo:return"Suspense";case Uo:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lu:return(e.displayName||"Context")+".Consumer";case Mu:return(e._context.displayName||"Context")+".Provider";case Ga:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ha:return t=e.displayName||null,t!==null?t:Bo(e.type)||"Memo";case rn:t=e._payload,e=e._init;try{return Bo(e(t))}catch{}}return null}function Pm(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bo(t);case 8:return t===Ba?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function wn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zu(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Tm(e){var t=zu(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ts(e){e._valueTracker||(e._valueTracker=Tm(e))}function Du(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=zu(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function il(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Go(e,t){var n=t.checked;return Le({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Vi(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=wn(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ou(e,t){t=t.checked,t!=null&&Ua(e,"checked",t,!1)}function Ho(e,t){Ou(e,t);var n=wn(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Qo(e,t.type,n):t.hasOwnProperty("defaultValue")&&Qo(e,t.type,wn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Wi(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Qo(e,t,n){(t!=="number"||il(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var $r=Array.isArray;function cr(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+wn(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Vo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(V(91));return Le({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Yi(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(V(92));if($r(n)){if(1<n.length)throw Error(V(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:wn(n)}}function $u(e,t){var n=wn(t.value),r=wn(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function qi(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Fu(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Fu(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Rs,Uu=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Rs=Rs||document.createElement("div"),Rs.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Rs.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Zr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Br={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Rm=["Webkit","ms","Moz","O"];Object.keys(Br).forEach(function(e){Rm.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Br[t]=Br[e]})});function Bu(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Br.hasOwnProperty(e)&&Br[e]?(""+t).trim():t+"px"}function Gu(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Bu(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Mm=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yo(e,t){if(t){if(Mm[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(V(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(V(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(V(61))}if(t.style!=null&&typeof t.style!="object")throw Error(V(62))}}function qo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ko=null;function Qa(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Xo=null,ur=null,dr=null;function Ki(e){if(e=js(e)){if(typeof Xo!="function")throw Error(V(280));var t=e.stateNode;t&&(t=Ol(t),Xo(e.stateNode,e.type,t))}}function Hu(e){ur?dr?dr.push(e):dr=[e]:ur=e}function Qu(){if(ur){var e=ur,t=dr;if(dr=ur=null,Ki(e),t)for(e=0;e<t.length;e++)Ki(t[e])}}function Vu(e,t){return e(t)}function Wu(){}var lo=!1;function Yu(e,t,n){if(lo)return e(t,n);lo=!0;try{return Vu(e,t,n)}finally{lo=!1,(ur!==null||dr!==null)&&(Wu(),Qu())}}function es(e,t){var n=e.stateNode;if(n===null)return null;var r=Ol(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(V(231,t,typeof n));return n}var Jo=!1;if(Yt)try{var Pr={};Object.defineProperty(Pr,"passive",{get:function(){Jo=!0}}),window.addEventListener("test",Pr,Pr),window.removeEventListener("test",Pr,Pr)}catch{Jo=!1}function Lm(e,t,n,r,s,o,a,c,i){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(m){this.onError(m)}}var Gr=!1,cl=null,ul=!1,Zo=null,_m={onError:function(e){Gr=!0,cl=e}};function zm(e,t,n,r,s,o,a,c,i){Gr=!1,cl=null,Lm.apply(_m,arguments)}function Dm(e,t,n,r,s,o,a,c,i){if(zm.apply(this,arguments),Gr){if(Gr){var u=cl;Gr=!1,cl=null}else throw Error(V(198));ul||(ul=!0,Zo=u)}}function Wn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function qu(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Xi(e){if(Wn(e)!==e)throw Error(V(188))}function Om(e){var t=e.alternate;if(!t){if(t=Wn(e),t===null)throw Error(V(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return Xi(s),e;if(o===r)return Xi(s),t;o=o.sibling}throw Error(V(188))}if(n.return!==r.return)n=s,r=o;else{for(var a=!1,c=s.child;c;){if(c===n){a=!0,n=s,r=o;break}if(c===r){a=!0,r=s,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=s;break}if(c===r){a=!0,r=o,n=s;break}c=c.sibling}if(!a)throw Error(V(189))}}if(n.alternate!==r)throw Error(V(190))}if(n.tag!==3)throw Error(V(188));return n.stateNode.current===n?e:t}function Ku(e){return e=Om(e),e!==null?Xu(e):null}function Xu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Xu(e);if(t!==null)return t;e=e.sibling}return null}var Ju=xt.unstable_scheduleCallback,Ji=xt.unstable_cancelCallback,$m=xt.unstable_shouldYield,Fm=xt.unstable_requestPaint,ze=xt.unstable_now,Um=xt.unstable_getCurrentPriorityLevel,Va=xt.unstable_ImmediatePriority,Zu=xt.unstable_UserBlockingPriority,dl=xt.unstable_NormalPriority,Bm=xt.unstable_LowPriority,ed=xt.unstable_IdlePriority,Ll=null,Ot=null;function Gm(e){if(Ot&&typeof Ot.onCommitFiberRoot=="function")try{Ot.onCommitFiberRoot(Ll,e,void 0,(e.current.flags&128)===128)}catch{}}var Pt=Math.clz32?Math.clz32:Vm,Hm=Math.log,Qm=Math.LN2;function Vm(e){return e>>>=0,e===0?32:31-(Hm(e)/Qm|0)|0}var Ms=64,Ls=4194304;function Fr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function fl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,a=n&268435455;if(a!==0){var c=a&~s;c!==0?r=Fr(c):(o&=a,o!==0&&(r=Fr(o)))}else a=n&~s,a!==0?r=Fr(a):o!==0&&(r=Fr(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Pt(t),s=1<<n,r|=e[n],t&=~s;return r}function Wm(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ym(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-Pt(o),c=1<<a,i=s[a];i===-1?(!(c&n)||c&r)&&(s[a]=Wm(c,t)):i<=t&&(e.expiredLanes|=c),o&=~c}}function ea(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function td(){var e=Ms;return Ms<<=1,!(Ms&4194240)&&(Ms=64),e}function oo(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ws(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pt(t),e[t]=n}function qm(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Pt(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function Wa(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Pt(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Se=0;function nd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var rd,Ya,sd,ld,od,ta=!1,_s=[],dn=null,fn=null,mn=null,ts=new Map,ns=new Map,ln=[],Km="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zi(e,t){switch(e){case"focusin":case"focusout":dn=null;break;case"dragenter":case"dragleave":fn=null;break;case"mouseover":case"mouseout":mn=null;break;case"pointerover":case"pointerout":ts.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ns.delete(t.pointerId)}}function Tr(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=js(t),t!==null&&Ya(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Xm(e,t,n,r,s){switch(t){case"focusin":return dn=Tr(dn,e,t,n,r,s),!0;case"dragenter":return fn=Tr(fn,e,t,n,r,s),!0;case"mouseover":return mn=Tr(mn,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return ts.set(o,Tr(ts.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,ns.set(o,Tr(ns.get(o)||null,e,t,n,r,s)),!0}return!1}function ad(e){var t=Tn(e.target);if(t!==null){var n=Wn(t);if(n!==null){if(t=n.tag,t===13){if(t=qu(n),t!==null){e.blockedOn=t,od(e.priority,function(){sd(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=na(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ko=r,n.target.dispatchEvent(r),Ko=null}else return t=js(n),t!==null&&Ya(t),e.blockedOn=n,!1;t.shift()}return!0}function ec(e,t,n){Xs(e)&&n.delete(t)}function Jm(){ta=!1,dn!==null&&Xs(dn)&&(dn=null),fn!==null&&Xs(fn)&&(fn=null),mn!==null&&Xs(mn)&&(mn=null),ts.forEach(ec),ns.forEach(ec)}function Rr(e,t){e.blockedOn===t&&(e.blockedOn=null,ta||(ta=!0,xt.unstable_scheduleCallback(xt.unstable_NormalPriority,Jm)))}function rs(e){function t(s){return Rr(s,e)}if(0<_s.length){Rr(_s[0],e);for(var n=1;n<_s.length;n++){var r=_s[n];r.blockedOn===e&&(r.blockedOn=null)}}for(dn!==null&&Rr(dn,e),fn!==null&&Rr(fn,e),mn!==null&&Rr(mn,e),ts.forEach(t),ns.forEach(t),n=0;n<ln.length;n++)r=ln[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<ln.length&&(n=ln[0],n.blockedOn===null);)ad(n),n.blockedOn===null&&ln.shift()}var fr=Jt.ReactCurrentBatchConfig,ml=!0;function Zm(e,t,n,r){var s=Se,o=fr.transition;fr.transition=null;try{Se=1,qa(e,t,n,r)}finally{Se=s,fr.transition=o}}function eh(e,t,n,r){var s=Se,o=fr.transition;fr.transition=null;try{Se=4,qa(e,t,n,r)}finally{Se=s,fr.transition=o}}function qa(e,t,n,r){if(ml){var s=na(e,t,n,r);if(s===null)xo(e,t,r,hl,n),Zi(e,r);else if(Xm(s,e,t,n,r))r.stopPropagation();else if(Zi(e,r),t&4&&-1<Km.indexOf(e)){for(;s!==null;){var o=js(s);if(o!==null&&rd(o),o=na(e,t,n,r),o===null&&xo(e,t,r,hl,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else xo(e,t,r,null,n)}}var hl=null;function na(e,t,n,r){if(hl=null,e=Qa(r),e=Tn(e),e!==null)if(t=Wn(e),t===null)e=null;else if(n=t.tag,n===13){if(e=qu(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return hl=e,null}function id(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Um()){case Va:return 1;case Zu:return 4;case dl:case Bm:return 16;case ed:return 536870912;default:return 16}default:return 16}}var an=null,Ka=null,Js=null;function cd(){if(Js)return Js;var e,t=Ka,n=t.length,r,s="value"in an?an.value:an.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[o-r];r++);return Js=s.slice(e,1<r?1-r:void 0)}function Zs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function zs(){return!0}function tc(){return!1}function vt(e){function t(n,r,s,o,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?zs:tc,this.isPropagationStopped=tc,this}return Le(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zs)},persist:function(){},isPersistent:zs}),t}var kr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xa=vt(kr),Ns=Le({},kr,{view:0,detail:0}),th=vt(Ns),ao,io,Mr,_l=Le({},Ns,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ja,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Mr&&(Mr&&e.type==="mousemove"?(ao=e.screenX-Mr.screenX,io=e.screenY-Mr.screenY):io=ao=0,Mr=e),ao)},movementY:function(e){return"movementY"in e?e.movementY:io}}),nc=vt(_l),nh=Le({},_l,{dataTransfer:0}),rh=vt(nh),sh=Le({},Ns,{relatedTarget:0}),co=vt(sh),lh=Le({},kr,{animationName:0,elapsedTime:0,pseudoElement:0}),oh=vt(lh),ah=Le({},kr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ih=vt(ah),ch=Le({},kr,{data:0}),rc=vt(ch),uh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mh(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=fh[e])?!!t[e]:!1}function Ja(){return mh}var hh=Le({},Ns,{key:function(e){if(e.key){var t=uh[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?dh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ja,charCode:function(e){return e.type==="keypress"?Zs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ph=vt(hh),gh=Le({},_l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sc=vt(gh),xh=Le({},Ns,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ja}),yh=vt(xh),vh=Le({},kr,{propertyName:0,elapsedTime:0,pseudoElement:0}),wh=vt(vh),Nh=Le({},_l,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),jh=vt(Nh),Ih=[9,13,27,32],Za=Yt&&"CompositionEvent"in window,Hr=null;Yt&&"documentMode"in document&&(Hr=document.documentMode);var Sh=Yt&&"TextEvent"in window&&!Hr,ud=Yt&&(!Za||Hr&&8<Hr&&11>=Hr),lc=" ",oc=!1;function dd(e,t){switch(e){case"keyup":return Ih.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zn=!1;function kh(e,t){switch(e){case"compositionend":return fd(t);case"keypress":return t.which!==32?null:(oc=!0,lc);case"textInput":return e=t.data,e===lc&&oc?null:e;default:return null}}function bh(e,t){if(Zn)return e==="compositionend"||!Za&&dd(e,t)?(e=cd(),Js=Ka=an=null,Zn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ud&&t.locale!=="ko"?null:t.data;default:return null}}var Ch={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ac(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ch[e.type]:t==="textarea"}function md(e,t,n,r){Hu(r),t=pl(t,"onChange"),0<t.length&&(n=new Xa("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Qr=null,ss=null;function Ah(e){Sd(e,0)}function zl(e){var t=nr(e);if(Du(t))return e}function Eh(e,t){if(e==="change")return t}var hd=!1;if(Yt){var uo;if(Yt){var fo="oninput"in document;if(!fo){var ic=document.createElement("div");ic.setAttribute("oninput","return;"),fo=typeof ic.oninput=="function"}uo=fo}else uo=!1;hd=uo&&(!document.documentMode||9<document.documentMode)}function cc(){Qr&&(Qr.detachEvent("onpropertychange",pd),ss=Qr=null)}function pd(e){if(e.propertyName==="value"&&zl(ss)){var t=[];md(t,ss,e,Qa(e)),Yu(Ah,t)}}function Ph(e,t,n){e==="focusin"?(cc(),Qr=t,ss=n,Qr.attachEvent("onpropertychange",pd)):e==="focusout"&&cc()}function Th(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zl(ss)}function Rh(e,t){if(e==="click")return zl(t)}function Mh(e,t){if(e==="input"||e==="change")return zl(t)}function Lh(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rt=typeof Object.is=="function"?Object.is:Lh;function ls(e,t){if(Rt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Oo.call(t,s)||!Rt(e[s],t[s]))return!1}return!0}function uc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dc(e,t){var n=uc(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=uc(n)}}function gd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?gd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xd(){for(var e=window,t=il();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=il(e.document)}return t}function ei(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function _h(e){var t=xd(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&gd(n.ownerDocument.documentElement,n)){if(r!==null&&ei(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=dc(n,o);var a=dc(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var zh=Yt&&"documentMode"in document&&11>=document.documentMode,er=null,ra=null,Vr=null,sa=!1;function fc(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sa||er==null||er!==il(r)||(r=er,"selectionStart"in r&&ei(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Vr&&ls(Vr,r)||(Vr=r,r=pl(ra,"onSelect"),0<r.length&&(t=new Xa("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=er)))}function Ds(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var tr={animationend:Ds("Animation","AnimationEnd"),animationiteration:Ds("Animation","AnimationIteration"),animationstart:Ds("Animation","AnimationStart"),transitionend:Ds("Transition","TransitionEnd")},mo={},yd={};Yt&&(yd=document.createElement("div").style,"AnimationEvent"in window||(delete tr.animationend.animation,delete tr.animationiteration.animation,delete tr.animationstart.animation),"TransitionEvent"in window||delete tr.transitionend.transition);function Dl(e){if(mo[e])return mo[e];if(!tr[e])return e;var t=tr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in yd)return mo[e]=t[n];return e}var vd=Dl("animationend"),wd=Dl("animationiteration"),Nd=Dl("animationstart"),jd=Dl("transitionend"),Id=new Map,mc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jn(e,t){Id.set(e,t),Vn(t,[e])}for(var ho=0;ho<mc.length;ho++){var po=mc[ho],Dh=po.toLowerCase(),Oh=po[0].toUpperCase()+po.slice(1);jn(Dh,"on"+Oh)}jn(vd,"onAnimationEnd");jn(wd,"onAnimationIteration");jn(Nd,"onAnimationStart");jn("dblclick","onDoubleClick");jn("focusin","onFocus");jn("focusout","onBlur");jn(jd,"onTransitionEnd");gr("onMouseEnter",["mouseout","mouseover"]);gr("onMouseLeave",["mouseout","mouseover"]);gr("onPointerEnter",["pointerout","pointerover"]);gr("onPointerLeave",["pointerout","pointerover"]);Vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ur="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$h=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ur));function hc(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Dm(r,t,void 0,e),e.currentTarget=null}function Sd(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var c=r[a],i=c.instance,u=c.currentTarget;if(c=c.listener,i!==o&&s.isPropagationStopped())break e;hc(s,c,u),o=i}else for(a=0;a<r.length;a++){if(c=r[a],i=c.instance,u=c.currentTarget,c=c.listener,i!==o&&s.isPropagationStopped())break e;hc(s,c,u),o=i}}}if(ul)throw e=Zo,ul=!1,Zo=null,e}function Ae(e,t){var n=t[ca];n===void 0&&(n=t[ca]=new Set);var r=e+"__bubble";n.has(r)||(kd(t,e,2,!1),n.add(r))}function go(e,t,n){var r=0;t&&(r|=4),kd(n,e,r,t)}var Os="_reactListening"+Math.random().toString(36).slice(2);function os(e){if(!e[Os]){e[Os]=!0,Ru.forEach(function(n){n!=="selectionchange"&&($h.has(n)||go(n,!1,e),go(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Os]||(t[Os]=!0,go("selectionchange",!1,t))}}function kd(e,t,n,r){switch(id(t)){case 1:var s=Zm;break;case 4:s=eh;break;default:s=qa}n=s.bind(null,t,n,e),s=void 0,!Jo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function xo(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var i=a.tag;if((i===3||i===4)&&(i=a.stateNode.containerInfo,i===s||i.nodeType===8&&i.parentNode===s))return;a=a.return}for(;c!==null;){if(a=Tn(c),a===null)return;if(i=a.tag,i===5||i===6){r=o=a;continue e}c=c.parentNode}}r=r.return}Yu(function(){var u=o,m=Qa(n),h=[];e:{var f=Id.get(e);if(f!==void 0){var d=Xa,v=e;switch(e){case"keypress":if(Zs(n)===0)break e;case"keydown":case"keyup":d=ph;break;case"focusin":v="focus",d=co;break;case"focusout":v="blur",d=co;break;case"beforeblur":case"afterblur":d=co;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=nc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=rh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=yh;break;case vd:case wd:case Nd:d=oh;break;case jd:d=wh;break;case"scroll":d=th;break;case"wheel":d=jh;break;case"copy":case"cut":case"paste":d=ih;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=sc}var x=(t&4)!==0,N=!x&&e==="scroll",y=x?f!==null?f+"Capture":null:f;x=[];for(var g=u,w;g!==null;){w=g;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,y!==null&&(j=es(g,y),j!=null&&x.push(as(g,j,w)))),N)break;g=g.return}0<x.length&&(f=new d(f,v,null,n,m),h.push({event:f,listeners:x}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",f&&n!==Ko&&(v=n.relatedTarget||n.fromElement)&&(Tn(v)||v[qt]))break e;if((d||f)&&(f=m.window===m?m:(f=m.ownerDocument)?f.defaultView||f.parentWindow:window,d?(v=n.relatedTarget||n.toElement,d=u,v=v?Tn(v):null,v!==null&&(N=Wn(v),v!==N||v.tag!==5&&v.tag!==6)&&(v=null)):(d=null,v=u),d!==v)){if(x=nc,j="onMouseLeave",y="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(x=sc,j="onPointerLeave",y="onPointerEnter",g="pointer"),N=d==null?f:nr(d),w=v==null?f:nr(v),f=new x(j,g+"leave",d,n,m),f.target=N,f.relatedTarget=w,j=null,Tn(m)===u&&(x=new x(y,g+"enter",v,n,m),x.target=w,x.relatedTarget=N,j=x),N=j,d&&v)t:{for(x=d,y=v,g=0,w=x;w;w=qn(w))g++;for(w=0,j=y;j;j=qn(j))w++;for(;0<g-w;)x=qn(x),g--;for(;0<w-g;)y=qn(y),w--;for(;g--;){if(x===y||y!==null&&x===y.alternate)break t;x=qn(x),y=qn(y)}x=null}else x=null;d!==null&&pc(h,f,d,x,!1),v!==null&&N!==null&&pc(h,N,v,x,!0)}}e:{if(f=u?nr(u):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var S=Eh;else if(ac(f))if(hd)S=Mh;else{S=Th;var C=Ph}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=Rh);if(S&&(S=S(e,u))){md(h,S,n,m);break e}C&&C(e,f,u),e==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Qo(f,"number",f.value)}switch(C=u?nr(u):window,e){case"focusin":(ac(C)||C.contentEditable==="true")&&(er=C,ra=u,Vr=null);break;case"focusout":Vr=ra=er=null;break;case"mousedown":sa=!0;break;case"contextmenu":case"mouseup":case"dragend":sa=!1,fc(h,n,m);break;case"selectionchange":if(zh)break;case"keydown":case"keyup":fc(h,n,m)}var k;if(Za)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Zn?dd(e,n)&&(A="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(ud&&n.locale!=="ko"&&(Zn||A!=="onCompositionStart"?A==="onCompositionEnd"&&Zn&&(k=cd()):(an=m,Ka="value"in an?an.value:an.textContent,Zn=!0)),C=pl(u,A),0<C.length&&(A=new rc(A,e,null,n,m),h.push({event:A,listeners:C}),k?A.data=k:(k=fd(n),k!==null&&(A.data=k)))),(k=Sh?kh(e,n):bh(e,n))&&(u=pl(u,"onBeforeInput"),0<u.length&&(m=new rc("onBeforeInput","beforeinput",null,n,m),h.push({event:m,listeners:u}),m.data=k))}Sd(h,t)})}function as(e,t,n){return{instance:e,listener:t,currentTarget:n}}function pl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=es(e,n),o!=null&&r.unshift(as(e,o,s)),o=es(e,t),o!=null&&r.push(as(e,o,s))),e=e.return}return r}function qn(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pc(e,t,n,r,s){for(var o=t._reactName,a=[];n!==null&&n!==r;){var c=n,i=c.alternate,u=c.stateNode;if(i!==null&&i===r)break;c.tag===5&&u!==null&&(c=u,s?(i=es(n,o),i!=null&&a.unshift(as(n,i,c))):s||(i=es(n,o),i!=null&&a.push(as(n,i,c)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var Fh=/\r\n?/g,Uh=/\u0000|\uFFFD/g;function gc(e){return(typeof e=="string"?e:""+e).replace(Fh,`
`).replace(Uh,"")}function $s(e,t,n){if(t=gc(t),gc(e)!==t&&n)throw Error(V(425))}function gl(){}var la=null,oa=null;function aa(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ia=typeof setTimeout=="function"?setTimeout:void 0,Bh=typeof clearTimeout=="function"?clearTimeout:void 0,xc=typeof Promise=="function"?Promise:void 0,Gh=typeof queueMicrotask=="function"?queueMicrotask:typeof xc<"u"?function(e){return xc.resolve(null).then(e).catch(Hh)}:ia;function Hh(e){setTimeout(function(){throw e})}function yo(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),rs(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);rs(t)}function hn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function yc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var br=Math.random().toString(36).slice(2),zt="__reactFiber$"+br,is="__reactProps$"+br,qt="__reactContainer$"+br,ca="__reactEvents$"+br,Qh="__reactListeners$"+br,Vh="__reactHandles$"+br;function Tn(e){var t=e[zt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[qt]||n[zt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=yc(e);e!==null;){if(n=e[zt])return n;e=yc(e)}return t}e=n,n=e.parentNode}return null}function js(e){return e=e[zt]||e[qt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function nr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(V(33))}function Ol(e){return e[is]||null}var ua=[],rr=-1;function In(e){return{current:e}}function Ee(e){0>rr||(e.current=ua[rr],ua[rr]=null,rr--)}function Ce(e,t){rr++,ua[rr]=e.current,e.current=t}var Nn={},et=In(Nn),ut=In(!1),On=Nn;function xr(e,t){var n=e.type.contextTypes;if(!n)return Nn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function dt(e){return e=e.childContextTypes,e!=null}function xl(){Ee(ut),Ee(et)}function vc(e,t,n){if(et.current!==Nn)throw Error(V(168));Ce(et,t),Ce(ut,n)}function bd(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(V(108,Pm(e)||"Unknown",s));return Le({},n,r)}function yl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nn,On=et.current,Ce(et,e),Ce(ut,ut.current),!0}function wc(e,t,n){var r=e.stateNode;if(!r)throw Error(V(169));n?(e=bd(e,t,On),r.__reactInternalMemoizedMergedChildContext=e,Ee(ut),Ee(et),Ce(et,e)):Ee(ut),Ce(ut,n)}var Gt=null,$l=!1,vo=!1;function Cd(e){Gt===null?Gt=[e]:Gt.push(e)}function Wh(e){$l=!0,Cd(e)}function Sn(){if(!vo&&Gt!==null){vo=!0;var e=0,t=Se;try{var n=Gt;for(Se=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Gt=null,$l=!1}catch(s){throw Gt!==null&&(Gt=Gt.slice(e+1)),Ju(Va,Sn),s}finally{Se=t,vo=!1}}return null}var sr=[],lr=0,vl=null,wl=0,wt=[],Nt=0,$n=null,Ht=1,Qt="";function En(e,t){sr[lr++]=wl,sr[lr++]=vl,vl=e,wl=t}function Ad(e,t,n){wt[Nt++]=Ht,wt[Nt++]=Qt,wt[Nt++]=$n,$n=e;var r=Ht;e=Qt;var s=32-Pt(r)-1;r&=~(1<<s),n+=1;var o=32-Pt(t)+s;if(30<o){var a=s-s%5;o=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Ht=1<<32-Pt(t)+s|n<<s|r,Qt=o+e}else Ht=1<<o|n<<s|r,Qt=e}function ti(e){e.return!==null&&(En(e,1),Ad(e,1,0))}function ni(e){for(;e===vl;)vl=sr[--lr],sr[lr]=null,wl=sr[--lr],sr[lr]=null;for(;e===$n;)$n=wt[--Nt],wt[Nt]=null,Qt=wt[--Nt],wt[Nt]=null,Ht=wt[--Nt],wt[Nt]=null}var gt=null,pt=null,Te=!1,Et=null;function Ed(e,t){var n=jt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Nc(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,gt=e,pt=hn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,gt=e,pt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=$n!==null?{id:Ht,overflow:Qt}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=jt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,gt=e,pt=null,!0):!1;default:return!1}}function da(e){return(e.mode&1)!==0&&(e.flags&128)===0}function fa(e){if(Te){var t=pt;if(t){var n=t;if(!Nc(e,t)){if(da(e))throw Error(V(418));t=hn(n.nextSibling);var r=gt;t&&Nc(e,t)?Ed(r,n):(e.flags=e.flags&-4097|2,Te=!1,gt=e)}}else{if(da(e))throw Error(V(418));e.flags=e.flags&-4097|2,Te=!1,gt=e}}}function jc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;gt=e}function Fs(e){if(e!==gt)return!1;if(!Te)return jc(e),Te=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!aa(e.type,e.memoizedProps)),t&&(t=pt)){if(da(e))throw Pd(),Error(V(418));for(;t;)Ed(e,t),t=hn(t.nextSibling)}if(jc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(V(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){pt=hn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}pt=null}}else pt=gt?hn(e.stateNode.nextSibling):null;return!0}function Pd(){for(var e=pt;e;)e=hn(e.nextSibling)}function yr(){pt=gt=null,Te=!1}function ri(e){Et===null?Et=[e]:Et.push(e)}var Yh=Jt.ReactCurrentBatchConfig;function Lr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(V(309));var r=n.stateNode}if(!r)throw Error(V(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var c=s.refs;a===null?delete c[o]:c[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error(V(284));if(!n._owner)throw Error(V(290,e))}return e}function Us(e,t){throw e=Object.prototype.toString.call(t),Error(V(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ic(e){var t=e._init;return t(e._payload)}function Td(e){function t(y,g){if(e){var w=y.deletions;w===null?(y.deletions=[g],y.flags|=16):w.push(g)}}function n(y,g){if(!e)return null;for(;g!==null;)t(y,g),g=g.sibling;return null}function r(y,g){for(y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function s(y,g){return y=yn(y,g),y.index=0,y.sibling=null,y}function o(y,g,w){return y.index=w,e?(w=y.alternate,w!==null?(w=w.index,w<g?(y.flags|=2,g):w):(y.flags|=2,g)):(y.flags|=1048576,g)}function a(y){return e&&y.alternate===null&&(y.flags|=2),y}function c(y,g,w,j){return g===null||g.tag!==6?(g=bo(w,y.mode,j),g.return=y,g):(g=s(g,w),g.return=y,g)}function i(y,g,w,j){var S=w.type;return S===Jn?m(y,g,w.props.children,j,w.key):g!==null&&(g.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===rn&&Ic(S)===g.type)?(j=s(g,w.props),j.ref=Lr(y,g,w),j.return=y,j):(j=ol(w.type,w.key,w.props,null,y.mode,j),j.ref=Lr(y,g,w),j.return=y,j)}function u(y,g,w,j){return g===null||g.tag!==4||g.stateNode.containerInfo!==w.containerInfo||g.stateNode.implementation!==w.implementation?(g=Co(w,y.mode,j),g.return=y,g):(g=s(g,w.children||[]),g.return=y,g)}function m(y,g,w,j,S){return g===null||g.tag!==7?(g=_n(w,y.mode,j,S),g.return=y,g):(g=s(g,w),g.return=y,g)}function h(y,g,w){if(typeof g=="string"&&g!==""||typeof g=="number")return g=bo(""+g,y.mode,w),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Ps:return w=ol(g.type,g.key,g.props,null,y.mode,w),w.ref=Lr(y,null,g),w.return=y,w;case Xn:return g=Co(g,y.mode,w),g.return=y,g;case rn:var j=g._init;return h(y,j(g._payload),w)}if($r(g)||Er(g))return g=_n(g,y.mode,w,null),g.return=y,g;Us(y,g)}return null}function f(y,g,w,j){var S=g!==null?g.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:c(y,g,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ps:return w.key===S?i(y,g,w,j):null;case Xn:return w.key===S?u(y,g,w,j):null;case rn:return S=w._init,f(y,g,S(w._payload),j)}if($r(w)||Er(w))return S!==null?null:m(y,g,w,j,null);Us(y,w)}return null}function d(y,g,w,j,S){if(typeof j=="string"&&j!==""||typeof j=="number")return y=y.get(w)||null,c(g,y,""+j,S);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Ps:return y=y.get(j.key===null?w:j.key)||null,i(g,y,j,S);case Xn:return y=y.get(j.key===null?w:j.key)||null,u(g,y,j,S);case rn:var C=j._init;return d(y,g,w,C(j._payload),S)}if($r(j)||Er(j))return y=y.get(w)||null,m(g,y,j,S,null);Us(g,j)}return null}function v(y,g,w,j){for(var S=null,C=null,k=g,A=g=0,E=null;k!==null&&A<w.length;A++){k.index>A?(E=k,k=null):E=k.sibling;var M=f(y,k,w[A],j);if(M===null){k===null&&(k=E);break}e&&k&&M.alternate===null&&t(y,k),g=o(M,g,A),C===null?S=M:C.sibling=M,C=M,k=E}if(A===w.length)return n(y,k),Te&&En(y,A),S;if(k===null){for(;A<w.length;A++)k=h(y,w[A],j),k!==null&&(g=o(k,g,A),C===null?S=k:C.sibling=k,C=k);return Te&&En(y,A),S}for(k=r(y,k);A<w.length;A++)E=d(k,y,A,w[A],j),E!==null&&(e&&E.alternate!==null&&k.delete(E.key===null?A:E.key),g=o(E,g,A),C===null?S=E:C.sibling=E,C=E);return e&&k.forEach(function(U){return t(y,U)}),Te&&En(y,A),S}function x(y,g,w,j){var S=Er(w);if(typeof S!="function")throw Error(V(150));if(w=S.call(w),w==null)throw Error(V(151));for(var C=S=null,k=g,A=g=0,E=null,M=w.next();k!==null&&!M.done;A++,M=w.next()){k.index>A?(E=k,k=null):E=k.sibling;var U=f(y,k,M.value,j);if(U===null){k===null&&(k=E);break}e&&k&&U.alternate===null&&t(y,k),g=o(U,g,A),C===null?S=U:C.sibling=U,C=U,k=E}if(M.done)return n(y,k),Te&&En(y,A),S;if(k===null){for(;!M.done;A++,M=w.next())M=h(y,M.value,j),M!==null&&(g=o(M,g,A),C===null?S=M:C.sibling=M,C=M);return Te&&En(y,A),S}for(k=r(y,k);!M.done;A++,M=w.next())M=d(k,y,A,M.value,j),M!==null&&(e&&M.alternate!==null&&k.delete(M.key===null?A:M.key),g=o(M,g,A),C===null?S=M:C.sibling=M,C=M);return e&&k.forEach(function(q){return t(y,q)}),Te&&En(y,A),S}function N(y,g,w,j){if(typeof w=="object"&&w!==null&&w.type===Jn&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Ps:e:{for(var S=w.key,C=g;C!==null;){if(C.key===S){if(S=w.type,S===Jn){if(C.tag===7){n(y,C.sibling),g=s(C,w.props.children),g.return=y,y=g;break e}}else if(C.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===rn&&Ic(S)===C.type){n(y,C.sibling),g=s(C,w.props),g.ref=Lr(y,C,w),g.return=y,y=g;break e}n(y,C);break}else t(y,C);C=C.sibling}w.type===Jn?(g=_n(w.props.children,y.mode,j,w.key),g.return=y,y=g):(j=ol(w.type,w.key,w.props,null,y.mode,j),j.ref=Lr(y,g,w),j.return=y,y=j)}return a(y);case Xn:e:{for(C=w.key;g!==null;){if(g.key===C)if(g.tag===4&&g.stateNode.containerInfo===w.containerInfo&&g.stateNode.implementation===w.implementation){n(y,g.sibling),g=s(g,w.children||[]),g.return=y,y=g;break e}else{n(y,g);break}else t(y,g);g=g.sibling}g=Co(w,y.mode,j),g.return=y,y=g}return a(y);case rn:return C=w._init,N(y,g,C(w._payload),j)}if($r(w))return v(y,g,w,j);if(Er(w))return x(y,g,w,j);Us(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,g!==null&&g.tag===6?(n(y,g.sibling),g=s(g,w),g.return=y,y=g):(n(y,g),g=bo(w,y.mode,j),g.return=y,y=g),a(y)):n(y,g)}return N}var vr=Td(!0),Rd=Td(!1),Nl=In(null),jl=null,or=null,si=null;function li(){si=or=jl=null}function oi(e){var t=Nl.current;Ee(Nl),e._currentValue=t}function ma(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function mr(e,t){jl=e,si=or=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ct=!0),e.firstContext=null)}function St(e){var t=e._currentValue;if(si!==e)if(e={context:e,memoizedValue:t,next:null},or===null){if(jl===null)throw Error(V(308));or=e,jl.dependencies={lanes:0,firstContext:e}}else or=or.next=e;return t}var Rn=null;function ai(e){Rn===null?Rn=[e]:Rn.push(e)}function Md(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,ai(t)):(n.next=s.next,s.next=n),t.interleaved=n,Kt(e,r)}function Kt(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var sn=!1;function ii(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ld(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Wt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function pn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Kt(e,n)}return s=r.interleaved,s===null?(t.next=t,ai(r)):(t.next=s.next,s.next=t),r.interleaved=t,Kt(e,n)}function el(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Wa(e,n)}}function Sc(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Il(e,t,n,r){var s=e.updateQueue;sn=!1;var o=s.firstBaseUpdate,a=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var i=c,u=i.next;i.next=null,a===null?o=u:a.next=u,a=i;var m=e.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==a&&(c===null?m.firstBaseUpdate=u:c.next=u,m.lastBaseUpdate=i))}if(o!==null){var h=s.baseState;a=0,m=u=i=null,c=o;do{var f=c.lane,d=c.eventTime;if((r&f)===f){m!==null&&(m=m.next={eventTime:d,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var v=e,x=c;switch(f=t,d=n,x.tag){case 1:if(v=x.payload,typeof v=="function"){h=v.call(d,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,f=typeof v=="function"?v.call(d,h,f):v,f==null)break e;h=Le({},h,f);break e;case 2:sn=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[c]:f.push(c))}else d={eventTime:d,lane:f,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(u=m=d,i=h):m=m.next=d,a|=f;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;f=c,c=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(m===null&&(i=h),s.baseState=i,s.firstBaseUpdate=u,s.lastBaseUpdate=m,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);Un|=a,e.lanes=a,e.memoizedState=h}}function kc(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(V(191,s));s.call(r)}}}var Is={},$t=In(Is),cs=In(Is),us=In(Is);function Mn(e){if(e===Is)throw Error(V(174));return e}function ci(e,t){switch(Ce(us,t),Ce(cs,e),Ce($t,Is),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Wo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Wo(t,e)}Ee($t),Ce($t,t)}function wr(){Ee($t),Ee(cs),Ee(us)}function _d(e){Mn(us.current);var t=Mn($t.current),n=Wo(t,e.type);t!==n&&(Ce(cs,e),Ce($t,n))}function ui(e){cs.current===e&&(Ee($t),Ee(cs))}var Re=In(0);function Sl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wo=[];function di(){for(var e=0;e<wo.length;e++)wo[e]._workInProgressVersionPrimary=null;wo.length=0}var tl=Jt.ReactCurrentDispatcher,No=Jt.ReactCurrentBatchConfig,Fn=0,Me=null,Fe=null,He=null,kl=!1,Wr=!1,ds=0,qh=0;function Xe(){throw Error(V(321))}function fi(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Rt(e[n],t[n]))return!1;return!0}function mi(e,t,n,r,s,o){if(Fn=o,Me=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,tl.current=e===null||e.memoizedState===null?Zh:ep,e=n(r,s),Wr){o=0;do{if(Wr=!1,ds=0,25<=o)throw Error(V(301));o+=1,He=Fe=null,t.updateQueue=null,tl.current=tp,e=n(r,s)}while(Wr)}if(tl.current=bl,t=Fe!==null&&Fe.next!==null,Fn=0,He=Fe=Me=null,kl=!1,t)throw Error(V(300));return e}function hi(){var e=ds!==0;return ds=0,e}function _t(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return He===null?Me.memoizedState=He=e:He=He.next=e,He}function kt(){if(Fe===null){var e=Me.alternate;e=e!==null?e.memoizedState:null}else e=Fe.next;var t=He===null?Me.memoizedState:He.next;if(t!==null)He=t,Fe=e;else{if(e===null)throw Error(V(310));Fe=e,e={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},He===null?Me.memoizedState=He=e:He=He.next=e}return He}function fs(e,t){return typeof t=="function"?t(e):t}function jo(e){var t=kt(),n=t.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=e;var r=Fe,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var c=a=null,i=null,u=o;do{var m=u.lane;if((Fn&m)===m)i!==null&&(i=i.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:m,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};i===null?(c=i=h,a=r):i=i.next=h,Me.lanes|=m,Un|=m}u=u.next}while(u!==null&&u!==o);i===null?a=r:i.next=c,Rt(r,t.memoizedState)||(ct=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=i,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,Me.lanes|=o,Un|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Io(e){var t=kt(),n=t.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do o=e(o,a.action),a=a.next;while(a!==s);Rt(o,t.memoizedState)||(ct=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function zd(){}function Dd(e,t){var n=Me,r=kt(),s=t(),o=!Rt(r.memoizedState,s);if(o&&(r.memoizedState=s,ct=!0),r=r.queue,pi(Fd.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||He!==null&&He.memoizedState.tag&1){if(n.flags|=2048,ms(9,$d.bind(null,n,r,s,t),void 0,null),Qe===null)throw Error(V(349));Fn&30||Od(n,t,s)}return s}function Od(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Me.updateQueue,t===null?(t={lastEffect:null,stores:null},Me.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $d(e,t,n,r){t.value=n,t.getSnapshot=r,Ud(t)&&Bd(e)}function Fd(e,t,n){return n(function(){Ud(t)&&Bd(e)})}function Ud(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Rt(e,n)}catch{return!0}}function Bd(e){var t=Kt(e,1);t!==null&&Tt(t,e,1,-1)}function bc(e){var t=_t();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:e},t.queue=e,e=e.dispatch=Jh.bind(null,Me,e),[t.memoizedState,e]}function ms(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Me.updateQueue,t===null?(t={lastEffect:null,stores:null},Me.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Gd(){return kt().memoizedState}function nl(e,t,n,r){var s=_t();Me.flags|=e,s.memoizedState=ms(1|t,n,void 0,r===void 0?null:r)}function Fl(e,t,n,r){var s=kt();r=r===void 0?null:r;var o=void 0;if(Fe!==null){var a=Fe.memoizedState;if(o=a.destroy,r!==null&&fi(r,a.deps)){s.memoizedState=ms(t,n,o,r);return}}Me.flags|=e,s.memoizedState=ms(1|t,n,o,r)}function Cc(e,t){return nl(8390656,8,e,t)}function pi(e,t){return Fl(2048,8,e,t)}function Hd(e,t){return Fl(4,2,e,t)}function Qd(e,t){return Fl(4,4,e,t)}function Vd(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Wd(e,t,n){return n=n!=null?n.concat([e]):null,Fl(4,4,Vd.bind(null,t,e),n)}function gi(){}function Yd(e,t){var n=kt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&fi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qd(e,t){var n=kt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&fi(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Kd(e,t,n){return Fn&21?(Rt(n,t)||(n=td(),Me.lanes|=n,Un|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ct=!0),e.memoizedState=n)}function Kh(e,t){var n=Se;Se=n!==0&&4>n?n:4,e(!0);var r=No.transition;No.transition={};try{e(!1),t()}finally{Se=n,No.transition=r}}function Xd(){return kt().memoizedState}function Xh(e,t,n){var r=xn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Jd(e))Zd(t,n);else if(n=Md(e,t,n,r),n!==null){var s=rt();Tt(n,e,r,s),ef(n,t,r)}}function Jh(e,t,n){var r=xn(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Jd(e))Zd(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,c=o(a,n);if(s.hasEagerState=!0,s.eagerState=c,Rt(c,a)){var i=t.interleaved;i===null?(s.next=s,ai(t)):(s.next=i.next,i.next=s),t.interleaved=s;return}}catch{}finally{}n=Md(e,t,s,r),n!==null&&(s=rt(),Tt(n,e,r,s),ef(n,t,r))}}function Jd(e){var t=e.alternate;return e===Me||t!==null&&t===Me}function Zd(e,t){Wr=kl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ef(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Wa(e,n)}}var bl={readContext:St,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useInsertionEffect:Xe,useLayoutEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useMutableSource:Xe,useSyncExternalStore:Xe,useId:Xe,unstable_isNewReconciler:!1},Zh={readContext:St,useCallback:function(e,t){return _t().memoizedState=[e,t===void 0?null:t],e},useContext:St,useEffect:Cc,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,nl(4194308,4,Vd.bind(null,t,e),n)},useLayoutEffect:function(e,t){return nl(4194308,4,e,t)},useInsertionEffect:function(e,t){return nl(4,2,e,t)},useMemo:function(e,t){var n=_t();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_t();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Xh.bind(null,Me,e),[r.memoizedState,e]},useRef:function(e){var t=_t();return e={current:e},t.memoizedState=e},useState:bc,useDebugValue:gi,useDeferredValue:function(e){return _t().memoizedState=e},useTransition:function(){var e=bc(!1),t=e[0];return e=Kh.bind(null,e[1]),_t().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Me,s=_t();if(Te){if(n===void 0)throw Error(V(407));n=n()}else{if(n=t(),Qe===null)throw Error(V(349));Fn&30||Od(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,Cc(Fd.bind(null,r,o,e),[e]),r.flags|=2048,ms(9,$d.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=_t(),t=Qe.identifierPrefix;if(Te){var n=Qt,r=Ht;n=(r&~(1<<32-Pt(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ds++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=qh++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ep={readContext:St,useCallback:Yd,useContext:St,useEffect:pi,useImperativeHandle:Wd,useInsertionEffect:Hd,useLayoutEffect:Qd,useMemo:qd,useReducer:jo,useRef:Gd,useState:function(){return jo(fs)},useDebugValue:gi,useDeferredValue:function(e){var t=kt();return Kd(t,Fe.memoizedState,e)},useTransition:function(){var e=jo(fs)[0],t=kt().memoizedState;return[e,t]},useMutableSource:zd,useSyncExternalStore:Dd,useId:Xd,unstable_isNewReconciler:!1},tp={readContext:St,useCallback:Yd,useContext:St,useEffect:pi,useImperativeHandle:Wd,useInsertionEffect:Hd,useLayoutEffect:Qd,useMemo:qd,useReducer:Io,useRef:Gd,useState:function(){return Io(fs)},useDebugValue:gi,useDeferredValue:function(e){var t=kt();return Fe===null?t.memoizedState=e:Kd(t,Fe.memoizedState,e)},useTransition:function(){var e=Io(fs)[0],t=kt().memoizedState;return[e,t]},useMutableSource:zd,useSyncExternalStore:Dd,useId:Xd,unstable_isNewReconciler:!1};function Ct(e,t){if(e&&e.defaultProps){t=Le({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ha(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Le({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ul={isMounted:function(e){return(e=e._reactInternals)?Wn(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=rt(),s=xn(e),o=Wt(r,s);o.payload=t,n!=null&&(o.callback=n),t=pn(e,o,s),t!==null&&(Tt(t,e,s,r),el(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=rt(),s=xn(e),o=Wt(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=pn(e,o,s),t!==null&&(Tt(t,e,s,r),el(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=rt(),r=xn(e),s=Wt(n,r);s.tag=2,t!=null&&(s.callback=t),t=pn(e,s,r),t!==null&&(Tt(t,e,r,n),el(t,e,r))}};function Ac(e,t,n,r,s,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,a):t.prototype&&t.prototype.isPureReactComponent?!ls(n,r)||!ls(s,o):!0}function tf(e,t,n){var r=!1,s=Nn,o=t.contextType;return typeof o=="object"&&o!==null?o=St(o):(s=dt(t)?On:et.current,r=t.contextTypes,o=(r=r!=null)?xr(e,s):Nn),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ul,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ec(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ul.enqueueReplaceState(t,t.state,null)}function pa(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},ii(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=St(o):(o=dt(t)?On:et.current,s.context=xr(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(ha(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Ul.enqueueReplaceState(s,s.state,null),Il(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Nr(e,t){try{var n="",r=t;do n+=Em(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function So(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ga(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var np=typeof WeakMap=="function"?WeakMap:Map;function nf(e,t,n){n=Wt(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Al||(Al=!0,ba=r),ga(e,t)},n}function rf(e,t,n){n=Wt(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){ga(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){ga(e,t),typeof r!="function"&&(gn===null?gn=new Set([this]):gn.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Pc(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new np;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=gp.bind(null,e,t,n),t.then(e,e))}function Tc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Rc(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Wt(-1,1),t.tag=2,pn(n,t,1))),n.lanes|=1),e)}var rp=Jt.ReactCurrentOwner,ct=!1;function nt(e,t,n,r){t.child=e===null?Rd(t,null,n,r):vr(t,e.child,n,r)}function Mc(e,t,n,r,s){n=n.render;var o=t.ref;return mr(t,s),r=mi(e,t,n,r,o,s),n=hi(),e!==null&&!ct?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Xt(e,t,s)):(Te&&n&&ti(t),t.flags|=1,nt(e,t,r,s),t.child)}function Lc(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!Si(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,sf(e,t,o,r,s)):(e=ol(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:ls,n(a,r)&&e.ref===t.ref)return Xt(e,t,s)}return t.flags|=1,e=yn(o,r),e.ref=t.ref,e.return=t,t.child=e}function sf(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(ls(o,r)&&e.ref===t.ref)if(ct=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(ct=!0);else return t.lanes=e.lanes,Xt(e,t,s)}return xa(e,t,n,r,s)}function lf(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(ir,ht),ht|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ce(ir,ht),ht|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Ce(ir,ht),ht|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ce(ir,ht),ht|=r;return nt(e,t,s,n),t.child}function of(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function xa(e,t,n,r,s){var o=dt(n)?On:et.current;return o=xr(t,o),mr(t,s),n=mi(e,t,n,r,o,s),r=hi(),e!==null&&!ct?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Xt(e,t,s)):(Te&&r&&ti(t),t.flags|=1,nt(e,t,n,s),t.child)}function _c(e,t,n,r,s){if(dt(n)){var o=!0;yl(t)}else o=!1;if(mr(t,s),t.stateNode===null)rl(e,t),tf(t,n,r),pa(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,c=t.memoizedProps;a.props=c;var i=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=St(u):(u=dt(n)?On:et.current,u=xr(t,u));var m=n.getDerivedStateFromProps,h=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==r||i!==u)&&Ec(t,a,r,u),sn=!1;var f=t.memoizedState;a.state=f,Il(t,r,a,s),i=t.memoizedState,c!==r||f!==i||ut.current||sn?(typeof m=="function"&&(ha(t,n,m,r),i=t.memoizedState),(c=sn||Ac(t,n,c,r,f,i,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=i),a.props=r,a.state=i,a.context=u,r=c):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ld(e,t),c=t.memoizedProps,u=t.type===t.elementType?c:Ct(t.type,c),a.props=u,h=t.pendingProps,f=a.context,i=n.contextType,typeof i=="object"&&i!==null?i=St(i):(i=dt(n)?On:et.current,i=xr(t,i));var d=n.getDerivedStateFromProps;(m=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(c!==h||f!==i)&&Ec(t,a,r,i),sn=!1,f=t.memoizedState,a.state=f,Il(t,r,a,s);var v=t.memoizedState;c!==h||f!==v||ut.current||sn?(typeof d=="function"&&(ha(t,n,d,r),v=t.memoizedState),(u=sn||Ac(t,n,u,r,f,v,i)||!1)?(m||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,i),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,i)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),a.props=r,a.state=v,a.context=i,r=u):(typeof a.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return ya(e,t,n,r,o,s)}function ya(e,t,n,r,s,o){of(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&wc(t,n,!1),Xt(e,t,o);r=t.stateNode,rp.current=t;var c=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=vr(t,e.child,null,o),t.child=vr(t,null,c,o)):nt(e,t,c,o),t.memoizedState=r.state,s&&wc(t,n,!0),t.child}function af(e){var t=e.stateNode;t.pendingContext?vc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&vc(e,t.context,!1),ci(e,t.containerInfo)}function zc(e,t,n,r,s){return yr(),ri(s),t.flags|=256,nt(e,t,n,r),t.child}var va={dehydrated:null,treeContext:null,retryLane:0};function wa(e){return{baseLanes:e,cachePool:null,transitions:null}}function cf(e,t,n){var r=t.pendingProps,s=Re.current,o=!1,a=(t.flags&128)!==0,c;if((c=a)||(c=e!==null&&e.memoizedState===null?!1:(s&2)!==0),c?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ce(Re,s&1),e===null)return fa(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,o?(r=t.mode,o=t.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Hl(a,r,0,null),e=_n(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=wa(n),t.memoizedState=va,e):xi(t,a));if(s=e.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return sp(e,t,a,r,c,s,n);if(o){o=r.fallback,a=t.mode,s=e.child,c=s.sibling;var i={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=i,t.deletions=null):(r=yn(s,i),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?o=yn(c,o):(o=_n(o,a,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,a=e.child.memoizedState,a=a===null?wa(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~n,t.memoizedState=va,r}return o=e.child,e=o.sibling,r=yn(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function xi(e,t){return t=Hl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Bs(e,t,n,r){return r!==null&&ri(r),vr(t,e.child,null,n),e=xi(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function sp(e,t,n,r,s,o,a){if(n)return t.flags&256?(t.flags&=-257,r=So(Error(V(422))),Bs(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=Hl({mode:"visible",children:r.children},s,0,null),o=_n(o,s,a,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&vr(t,e.child,null,a),t.child.memoizedState=wa(a),t.memoizedState=va,o);if(!(t.mode&1))return Bs(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,o=Error(V(419)),r=So(o,r,void 0),Bs(e,t,a,r)}if(c=(a&e.childLanes)!==0,ct||c){if(r=Qe,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Kt(e,s),Tt(r,e,s,-1))}return Ii(),r=So(Error(V(421))),Bs(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=xp.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,pt=hn(s.nextSibling),gt=t,Te=!0,Et=null,e!==null&&(wt[Nt++]=Ht,wt[Nt++]=Qt,wt[Nt++]=$n,Ht=e.id,Qt=e.overflow,$n=t),t=xi(t,r.children),t.flags|=4096,t)}function Dc(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ma(e.return,t,n)}function ko(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function uf(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(nt(e,t,r.children,n),r=Re.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dc(e,n,t);else if(e.tag===19)Dc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ce(Re,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Sl(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),ko(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Sl(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}ko(t,!0,n,null,o);break;case"together":ko(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xt(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Un|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(V(153));if(t.child!==null){for(e=t.child,n=yn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=yn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function lp(e,t,n){switch(t.tag){case 3:af(t),yr();break;case 5:_d(t);break;case 1:dt(t.type)&&yl(t);break;case 4:ci(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ce(Nl,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ce(Re,Re.current&1),t.flags|=128,null):n&t.child.childLanes?cf(e,t,n):(Ce(Re,Re.current&1),e=Xt(e,t,n),e!==null?e.sibling:null);Ce(Re,Re.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return uf(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ce(Re,Re.current),r)break;return null;case 22:case 23:return t.lanes=0,lf(e,t,n)}return Xt(e,t,n)}var df,Na,ff,mf;df=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Na=function(){};ff=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Mn($t.current);var o=null;switch(n){case"input":s=Go(e,s),r=Go(e,r),o=[];break;case"select":s=Le({},s,{value:void 0}),r=Le({},r,{value:void 0}),o=[];break;case"textarea":s=Vo(e,s),r=Vo(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=gl)}Yo(n,r);var a;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var c=s[u];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Jr.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var i=r[u];if(c=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&i!==c&&(i!=null||c!=null))if(u==="style")if(c){for(a in c)!c.hasOwnProperty(a)||i&&i.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in i)i.hasOwnProperty(a)&&c[a]!==i[a]&&(n||(n={}),n[a]=i[a])}else n||(o||(o=[]),o.push(u,n)),n=i;else u==="dangerouslySetInnerHTML"?(i=i?i.__html:void 0,c=c?c.__html:void 0,i!=null&&c!==i&&(o=o||[]).push(u,i)):u==="children"?typeof i!="string"&&typeof i!="number"||(o=o||[]).push(u,""+i):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Jr.hasOwnProperty(u)?(i!=null&&u==="onScroll"&&Ae("scroll",e),o||c===i||(o=[])):(o=o||[]).push(u,i))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}};mf=function(e,t,n,r){n!==r&&(t.flags|=4)};function _r(e,t){if(!Te)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Je(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function op(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Je(t),null;case 1:return dt(t.type)&&xl(),Je(t),null;case 3:return r=t.stateNode,wr(),Ee(ut),Ee(et),di(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Fs(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Et!==null&&(Ea(Et),Et=null))),Na(e,t),Je(t),null;case 5:ui(t);var s=Mn(us.current);if(n=t.type,e!==null&&t.stateNode!=null)ff(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(V(166));return Je(t),null}if(e=Mn($t.current),Fs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[zt]=t,r[is]=o,e=(t.mode&1)!==0,n){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(s=0;s<Ur.length;s++)Ae(Ur[s],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":Vi(r,o),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ae("invalid",r);break;case"textarea":Yi(r,o),Ae("invalid",r)}Yo(n,o),s=null;for(var a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="children"?typeof c=="string"?r.textContent!==c&&(o.suppressHydrationWarning!==!0&&$s(r.textContent,c,e),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&$s(r.textContent,c,e),s=["children",""+c]):Jr.hasOwnProperty(a)&&c!=null&&a==="onScroll"&&Ae("scroll",r)}switch(n){case"input":Ts(r),Wi(r,o,!0);break;case"textarea":Ts(r),qi(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=gl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Fu(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[zt]=t,e[is]=r,df(e,t,!1,!1),t.stateNode=e;e:{switch(a=qo(n,r),n){case"dialog":Ae("cancel",e),Ae("close",e),s=r;break;case"iframe":case"object":case"embed":Ae("load",e),s=r;break;case"video":case"audio":for(s=0;s<Ur.length;s++)Ae(Ur[s],e);s=r;break;case"source":Ae("error",e),s=r;break;case"img":case"image":case"link":Ae("error",e),Ae("load",e),s=r;break;case"details":Ae("toggle",e),s=r;break;case"input":Vi(e,r),s=Go(e,r),Ae("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Le({},r,{value:void 0}),Ae("invalid",e);break;case"textarea":Yi(e,r),s=Vo(e,r),Ae("invalid",e);break;default:s=r}Yo(n,s),c=s;for(o in c)if(c.hasOwnProperty(o)){var i=c[o];o==="style"?Gu(e,i):o==="dangerouslySetInnerHTML"?(i=i?i.__html:void 0,i!=null&&Uu(e,i)):o==="children"?typeof i=="string"?(n!=="textarea"||i!=="")&&Zr(e,i):typeof i=="number"&&Zr(e,""+i):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Jr.hasOwnProperty(o)?i!=null&&o==="onScroll"&&Ae("scroll",e):i!=null&&Ua(e,o,i,a))}switch(n){case"input":Ts(e),Wi(e,r,!1);break;case"textarea":Ts(e),qi(e);break;case"option":r.value!=null&&e.setAttribute("value",""+wn(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?cr(e,!!r.multiple,o,!1):r.defaultValue!=null&&cr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=gl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Je(t),null;case 6:if(e&&t.stateNode!=null)mf(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(V(166));if(n=Mn(us.current),Mn($t.current),Fs(t)){if(r=t.stateNode,n=t.memoizedProps,r[zt]=t,(o=r.nodeValue!==n)&&(e=gt,e!==null))switch(e.tag){case 3:$s(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$s(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[zt]=t,t.stateNode=r}return Je(t),null;case 13:if(Ee(Re),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Te&&pt!==null&&t.mode&1&&!(t.flags&128))Pd(),yr(),t.flags|=98560,o=!1;else if(o=Fs(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(V(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(V(317));o[zt]=t}else yr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Je(t),o=!1}else Et!==null&&(Ea(Et),Et=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Re.current&1?Ue===0&&(Ue=3):Ii())),t.updateQueue!==null&&(t.flags|=4),Je(t),null);case 4:return wr(),Na(e,t),e===null&&os(t.stateNode.containerInfo),Je(t),null;case 10:return oi(t.type._context),Je(t),null;case 17:return dt(t.type)&&xl(),Je(t),null;case 19:if(Ee(Re),o=t.memoizedState,o===null)return Je(t),null;if(r=(t.flags&128)!==0,a=o.rendering,a===null)if(r)_r(o,!1);else{if(Ue!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Sl(e),a!==null){for(t.flags|=128,_r(o,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ce(Re,Re.current&1|2),t.child}e=e.sibling}o.tail!==null&&ze()>jr&&(t.flags|=128,r=!0,_r(o,!1),t.lanes=4194304)}else{if(!r)if(e=Sl(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),_r(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!Te)return Je(t),null}else 2*ze()-o.renderingStartTime>jr&&n!==1073741824&&(t.flags|=128,r=!0,_r(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(n=o.last,n!==null?n.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=ze(),t.sibling=null,n=Re.current,Ce(Re,r?n&1|2:n&1),t):(Je(t),null);case 22:case 23:return ji(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?ht&1073741824&&(Je(t),t.subtreeFlags&6&&(t.flags|=8192)):Je(t),null;case 24:return null;case 25:return null}throw Error(V(156,t.tag))}function ap(e,t){switch(ni(t),t.tag){case 1:return dt(t.type)&&xl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return wr(),Ee(ut),Ee(et),di(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ui(t),null;case 13:if(Ee(Re),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(V(340));yr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ee(Re),null;case 4:return wr(),null;case 10:return oi(t.type._context),null;case 22:case 23:return ji(),null;case 24:return null;default:return null}}var Gs=!1,Ze=!1,ip=typeof WeakSet=="function"?WeakSet:Set,ae=null;function ar(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){_e(e,t,r)}else n.current=null}function ja(e,t,n){try{n()}catch(r){_e(e,t,r)}}var Oc=!1;function cp(e,t){if(la=ml,e=xd(),ei(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,c=-1,i=-1,u=0,m=0,h=e,f=null;t:for(;;){for(var d;h!==n||s!==0&&h.nodeType!==3||(c=a+s),h!==o||r!==0&&h.nodeType!==3||(i=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===e)break t;if(f===n&&++u===s&&(c=a),f===o&&++m===r&&(i=a),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}n=c===-1||i===-1?null:{start:c,end:i}}else n=null}n=n||{start:0,end:0}}else n=null;for(oa={focusedElem:e,selectionRange:n},ml=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,N=v.memoizedState,y=t.stateNode,g=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:Ct(t.type,x),N);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(j){_e(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return v=Oc,Oc=!1,v}function Yr(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&ja(t,n,o)}s=s.next}while(s!==r)}}function Bl(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ia(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function hf(e){var t=e.alternate;t!==null&&(e.alternate=null,hf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zt],delete t[is],delete t[ca],delete t[Qh],delete t[Vh])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pf(e){return e.tag===5||e.tag===3||e.tag===4}function $c(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Sa(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=gl));else if(r!==4&&(e=e.child,e!==null))for(Sa(e,t,n),e=e.sibling;e!==null;)Sa(e,t,n),e=e.sibling}function ka(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ka(e,t,n),e=e.sibling;e!==null;)ka(e,t,n),e=e.sibling}var We=null,At=!1;function nn(e,t,n){for(n=n.child;n!==null;)gf(e,t,n),n=n.sibling}function gf(e,t,n){if(Ot&&typeof Ot.onCommitFiberUnmount=="function")try{Ot.onCommitFiberUnmount(Ll,n)}catch{}switch(n.tag){case 5:Ze||ar(n,t);case 6:var r=We,s=At;We=null,nn(e,t,n),We=r,At=s,We!==null&&(At?(e=We,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):We.removeChild(n.stateNode));break;case 18:We!==null&&(At?(e=We,n=n.stateNode,e.nodeType===8?yo(e.parentNode,n):e.nodeType===1&&yo(e,n),rs(e)):yo(We,n.stateNode));break;case 4:r=We,s=At,We=n.stateNode.containerInfo,At=!0,nn(e,t,n),We=r,At=s;break;case 0:case 11:case 14:case 15:if(!Ze&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&ja(n,t,a),s=s.next}while(s!==r)}nn(e,t,n);break;case 1:if(!Ze&&(ar(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){_e(n,t,c)}nn(e,t,n);break;case 21:nn(e,t,n);break;case 22:n.mode&1?(Ze=(r=Ze)||n.memoizedState!==null,nn(e,t,n),Ze=r):nn(e,t,n);break;default:nn(e,t,n)}}function Fc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new ip),t.forEach(function(r){var s=yp.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function bt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,a=t,c=a;e:for(;c!==null;){switch(c.tag){case 5:We=c.stateNode,At=!1;break e;case 3:We=c.stateNode.containerInfo,At=!0;break e;case 4:We=c.stateNode.containerInfo,At=!0;break e}c=c.return}if(We===null)throw Error(V(160));gf(o,a,s),We=null,At=!1;var i=s.alternate;i!==null&&(i.return=null),s.return=null}catch(u){_e(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)xf(t,e),t=t.sibling}function xf(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bt(t,e),Mt(e),r&4){try{Yr(3,e,e.return),Bl(3,e)}catch(x){_e(e,e.return,x)}try{Yr(5,e,e.return)}catch(x){_e(e,e.return,x)}}break;case 1:bt(t,e),Mt(e),r&512&&n!==null&&ar(n,n.return);break;case 5:if(bt(t,e),Mt(e),r&512&&n!==null&&ar(n,n.return),e.flags&32){var s=e.stateNode;try{Zr(s,"")}catch(x){_e(e,e.return,x)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,a=n!==null?n.memoizedProps:o,c=e.type,i=e.updateQueue;if(e.updateQueue=null,i!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&Ou(s,o),qo(c,a);var u=qo(c,o);for(a=0;a<i.length;a+=2){var m=i[a],h=i[a+1];m==="style"?Gu(s,h):m==="dangerouslySetInnerHTML"?Uu(s,h):m==="children"?Zr(s,h):Ua(s,m,h,u)}switch(c){case"input":Ho(s,o);break;case"textarea":$u(s,o);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var d=o.value;d!=null?cr(s,!!o.multiple,d,!1):f!==!!o.multiple&&(o.defaultValue!=null?cr(s,!!o.multiple,o.defaultValue,!0):cr(s,!!o.multiple,o.multiple?[]:"",!1))}s[is]=o}catch(x){_e(e,e.return,x)}}break;case 6:if(bt(t,e),Mt(e),r&4){if(e.stateNode===null)throw Error(V(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(x){_e(e,e.return,x)}}break;case 3:if(bt(t,e),Mt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{rs(t.containerInfo)}catch(x){_e(e,e.return,x)}break;case 4:bt(t,e),Mt(e);break;case 13:bt(t,e),Mt(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(wi=ze())),r&4&&Fc(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(Ze=(u=Ze)||m,bt(t,e),Ze=u):bt(t,e),Mt(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!m&&e.mode&1)for(ae=e,m=e.child;m!==null;){for(h=ae=m;ae!==null;){switch(f=ae,d=f.child,f.tag){case 0:case 11:case 14:case 15:Yr(4,f,f.return);break;case 1:ar(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){_e(r,n,x)}}break;case 5:ar(f,f.return);break;case 22:if(f.memoizedState!==null){Bc(h);continue}}d!==null?(d.return=f,ae=d):Bc(h)}m=m.sibling}e:for(m=null,h=e;;){if(h.tag===5){if(m===null){m=h;try{s=h.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=h.stateNode,i=h.memoizedProps.style,a=i!=null&&i.hasOwnProperty("display")?i.display:null,c.style.display=Bu("display",a))}catch(x){_e(e,e.return,x)}}}else if(h.tag===6){if(m===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){_e(e,e.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;m===h&&(m=null),h=h.return}m===h&&(m=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:bt(t,e),Mt(e),r&4&&Fc(e);break;case 21:break;default:bt(t,e),Mt(e)}}function Mt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(pf(n)){var r=n;break e}n=n.return}throw Error(V(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Zr(s,""),r.flags&=-33);var o=$c(e);ka(e,o,s);break;case 3:case 4:var a=r.stateNode.containerInfo,c=$c(e);Sa(e,c,a);break;default:throw Error(V(161))}}catch(i){_e(e,e.return,i)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function up(e,t,n){ae=e,yf(e)}function yf(e,t,n){for(var r=(e.mode&1)!==0;ae!==null;){var s=ae,o=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Gs;if(!a){var c=s.alternate,i=c!==null&&c.memoizedState!==null||Ze;c=Gs;var u=Ze;if(Gs=a,(Ze=i)&&!u)for(ae=s;ae!==null;)a=ae,i=a.child,a.tag===22&&a.memoizedState!==null?Gc(s):i!==null?(i.return=a,ae=i):Gc(s);for(;o!==null;)ae=o,yf(o),o=o.sibling;ae=s,Gs=c,Ze=u}Uc(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,ae=o):Uc(e)}}function Uc(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ze||Bl(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ze)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Ct(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&kc(t,o,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}kc(t,a,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var i=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":i.autoFocus&&n.focus();break;case"img":i.src&&(n.src=i.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var h=m.dehydrated;h!==null&&rs(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}Ze||t.flags&512&&Ia(t)}catch(f){_e(t,t.return,f)}}if(t===e){ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,ae=n;break}ae=t.return}}function Bc(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ae=n;break}ae=t.return}}function Gc(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Bl(4,t)}catch(i){_e(t,n,i)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(i){_e(t,s,i)}}var o=t.return;try{Ia(t)}catch(i){_e(t,o,i)}break;case 5:var a=t.return;try{Ia(t)}catch(i){_e(t,a,i)}}}catch(i){_e(t,t.return,i)}if(t===e){ae=null;break}var c=t.sibling;if(c!==null){c.return=t.return,ae=c;break}ae=t.return}}var dp=Math.ceil,Cl=Jt.ReactCurrentDispatcher,yi=Jt.ReactCurrentOwner,It=Jt.ReactCurrentBatchConfig,ve=0,Qe=null,Oe=null,Ye=0,ht=0,ir=In(0),Ue=0,hs=null,Un=0,Gl=0,vi=0,qr=null,it=null,wi=0,jr=1/0,Bt=null,Al=!1,ba=null,gn=null,Hs=!1,cn=null,El=0,Kr=0,Ca=null,sl=-1,ll=0;function rt(){return ve&6?ze():sl!==-1?sl:sl=ze()}function xn(e){return e.mode&1?ve&2&&Ye!==0?Ye&-Ye:Yh.transition!==null?(ll===0&&(ll=td()),ll):(e=Se,e!==0||(e=window.event,e=e===void 0?16:id(e.type)),e):1}function Tt(e,t,n,r){if(50<Kr)throw Kr=0,Ca=null,Error(V(185));ws(e,n,r),(!(ve&2)||e!==Qe)&&(e===Qe&&(!(ve&2)&&(Gl|=n),Ue===4&&on(e,Ye)),ft(e,r),n===1&&ve===0&&!(t.mode&1)&&(jr=ze()+500,$l&&Sn()))}function ft(e,t){var n=e.callbackNode;Ym(e,t);var r=fl(e,e===Qe?Ye:0);if(r===0)n!==null&&Ji(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Ji(n),t===1)e.tag===0?Wh(Hc.bind(null,e)):Cd(Hc.bind(null,e)),Gh(function(){!(ve&6)&&Sn()}),n=null;else{switch(nd(r)){case 1:n=Va;break;case 4:n=Zu;break;case 16:n=dl;break;case 536870912:n=ed;break;default:n=dl}n=bf(n,vf.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function vf(e,t){if(sl=-1,ll=0,ve&6)throw Error(V(327));var n=e.callbackNode;if(hr()&&e.callbackNode!==n)return null;var r=fl(e,e===Qe?Ye:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Pl(e,r);else{t=r;var s=ve;ve|=2;var o=Nf();(Qe!==e||Ye!==t)&&(Bt=null,jr=ze()+500,Ln(e,t));do try{hp();break}catch(c){wf(e,c)}while(!0);li(),Cl.current=o,ve=s,Oe!==null?t=0:(Qe=null,Ye=0,t=Ue)}if(t!==0){if(t===2&&(s=ea(e),s!==0&&(r=s,t=Aa(e,s))),t===1)throw n=hs,Ln(e,0),on(e,r),ft(e,ze()),n;if(t===6)on(e,r);else{if(s=e.current.alternate,!(r&30)&&!fp(s)&&(t=Pl(e,r),t===2&&(o=ea(e),o!==0&&(r=o,t=Aa(e,o))),t===1))throw n=hs,Ln(e,0),on(e,r),ft(e,ze()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(V(345));case 2:Pn(e,it,Bt);break;case 3:if(on(e,r),(r&130023424)===r&&(t=wi+500-ze(),10<t)){if(fl(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){rt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ia(Pn.bind(null,e,it,Bt),t);break}Pn(e,it,Bt);break;case 4:if(on(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Pt(r);o=1<<a,a=t[a],a>s&&(s=a),r&=~o}if(r=s,r=ze()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*dp(r/1960))-r,10<r){e.timeoutHandle=ia(Pn.bind(null,e,it,Bt),r);break}Pn(e,it,Bt);break;case 5:Pn(e,it,Bt);break;default:throw Error(V(329))}}}return ft(e,ze()),e.callbackNode===n?vf.bind(null,e):null}function Aa(e,t){var n=qr;return e.current.memoizedState.isDehydrated&&(Ln(e,t).flags|=256),e=Pl(e,t),e!==2&&(t=it,it=n,t!==null&&Ea(t)),e}function Ea(e){it===null?it=e:it.push.apply(it,e)}function fp(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!Rt(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function on(e,t){for(t&=~vi,t&=~Gl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Pt(t),r=1<<n;e[n]=-1,t&=~r}}function Hc(e){if(ve&6)throw Error(V(327));hr();var t=fl(e,0);if(!(t&1))return ft(e,ze()),null;var n=Pl(e,t);if(e.tag!==0&&n===2){var r=ea(e);r!==0&&(t=r,n=Aa(e,r))}if(n===1)throw n=hs,Ln(e,0),on(e,t),ft(e,ze()),n;if(n===6)throw Error(V(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Pn(e,it,Bt),ft(e,ze()),null}function Ni(e,t){var n=ve;ve|=1;try{return e(t)}finally{ve=n,ve===0&&(jr=ze()+500,$l&&Sn())}}function Bn(e){cn!==null&&cn.tag===0&&!(ve&6)&&hr();var t=ve;ve|=1;var n=It.transition,r=Se;try{if(It.transition=null,Se=1,e)return e()}finally{Se=r,It.transition=n,ve=t,!(ve&6)&&Sn()}}function ji(){ht=ir.current,Ee(ir)}function Ln(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Bh(n)),Oe!==null)for(n=Oe.return;n!==null;){var r=n;switch(ni(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&xl();break;case 3:wr(),Ee(ut),Ee(et),di();break;case 5:ui(r);break;case 4:wr();break;case 13:Ee(Re);break;case 19:Ee(Re);break;case 10:oi(r.type._context);break;case 22:case 23:ji()}n=n.return}if(Qe=e,Oe=e=yn(e.current,null),Ye=ht=t,Ue=0,hs=null,vi=Gl=Un=0,it=qr=null,Rn!==null){for(t=0;t<Rn.length;t++)if(n=Rn[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=s,r.next=a}n.pending=r}Rn=null}return e}function wf(e,t){do{var n=Oe;try{if(li(),tl.current=bl,kl){for(var r=Me.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}kl=!1}if(Fn=0,He=Fe=Me=null,Wr=!1,ds=0,yi.current=null,n===null||n.return===null){Ue=1,hs=t,Oe=null;break}e:{var o=e,a=n.return,c=n,i=t;if(t=Ye,c.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){var u=i,m=c,h=m.tag;if(!(m.mode&1)&&(h===0||h===11||h===15)){var f=m.alternate;f?(m.updateQueue=f.updateQueue,m.memoizedState=f.memoizedState,m.lanes=f.lanes):(m.updateQueue=null,m.memoizedState=null)}var d=Tc(a);if(d!==null){d.flags&=-257,Rc(d,a,c,o,t),d.mode&1&&Pc(o,u,t),t=d,i=u;var v=t.updateQueue;if(v===null){var x=new Set;x.add(i),t.updateQueue=x}else v.add(i);break e}else{if(!(t&1)){Pc(o,u,t),Ii();break e}i=Error(V(426))}}else if(Te&&c.mode&1){var N=Tc(a);if(N!==null){!(N.flags&65536)&&(N.flags|=256),Rc(N,a,c,o,t),ri(Nr(i,c));break e}}o=i=Nr(i,c),Ue!==4&&(Ue=2),qr===null?qr=[o]:qr.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var y=nf(o,i,t);Sc(o,y);break e;case 1:c=i;var g=o.type,w=o.stateNode;if(!(o.flags&128)&&(typeof g.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(gn===null||!gn.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t;var j=rf(o,c,t);Sc(o,j);break e}}o=o.return}while(o!==null)}If(n)}catch(S){t=S,Oe===n&&n!==null&&(Oe=n=n.return);continue}break}while(!0)}function Nf(){var e=Cl.current;return Cl.current=bl,e===null?bl:e}function Ii(){(Ue===0||Ue===3||Ue===2)&&(Ue=4),Qe===null||!(Un&268435455)&&!(Gl&268435455)||on(Qe,Ye)}function Pl(e,t){var n=ve;ve|=2;var r=Nf();(Qe!==e||Ye!==t)&&(Bt=null,Ln(e,t));do try{mp();break}catch(s){wf(e,s)}while(!0);if(li(),ve=n,Cl.current=r,Oe!==null)throw Error(V(261));return Qe=null,Ye=0,Ue}function mp(){for(;Oe!==null;)jf(Oe)}function hp(){for(;Oe!==null&&!$m();)jf(Oe)}function jf(e){var t=kf(e.alternate,e,ht);e.memoizedProps=e.pendingProps,t===null?If(e):Oe=t,yi.current=null}function If(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=ap(n,t),n!==null){n.flags&=32767,Oe=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ue=6,Oe=null;return}}else if(n=op(n,t,ht),n!==null){Oe=n;return}if(t=t.sibling,t!==null){Oe=t;return}Oe=t=e}while(t!==null);Ue===0&&(Ue=5)}function Pn(e,t,n){var r=Se,s=It.transition;try{It.transition=null,Se=1,pp(e,t,n,r)}finally{It.transition=s,Se=r}return null}function pp(e,t,n,r){do hr();while(cn!==null);if(ve&6)throw Error(V(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(V(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(qm(e,o),e===Qe&&(Oe=Qe=null,Ye=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Hs||(Hs=!0,bf(dl,function(){return hr(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=It.transition,It.transition=null;var a=Se;Se=1;var c=ve;ve|=4,yi.current=null,cp(e,n),xf(n,e),_h(oa),ml=!!la,oa=la=null,e.current=n,up(n),Fm(),ve=c,Se=a,It.transition=o}else e.current=n;if(Hs&&(Hs=!1,cn=e,El=s),o=e.pendingLanes,o===0&&(gn=null),Gm(n.stateNode),ft(e,ze()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Al)throw Al=!1,e=ba,ba=null,e;return El&1&&e.tag!==0&&hr(),o=e.pendingLanes,o&1?e===Ca?Kr++:(Kr=0,Ca=e):Kr=0,Sn(),null}function hr(){if(cn!==null){var e=nd(El),t=It.transition,n=Se;try{if(It.transition=null,Se=16>e?16:e,cn===null)var r=!1;else{if(e=cn,cn=null,El=0,ve&6)throw Error(V(331));var s=ve;for(ve|=4,ae=e.current;ae!==null;){var o=ae,a=o.child;if(ae.flags&16){var c=o.deletions;if(c!==null){for(var i=0;i<c.length;i++){var u=c[i];for(ae=u;ae!==null;){var m=ae;switch(m.tag){case 0:case 11:case 15:Yr(8,m,o)}var h=m.child;if(h!==null)h.return=m,ae=h;else for(;ae!==null;){m=ae;var f=m.sibling,d=m.return;if(hf(m),m===u){ae=null;break}if(f!==null){f.return=d,ae=f;break}ae=d}}}var v=o.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var N=x.sibling;x.sibling=null,x=N}while(x!==null)}}ae=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,ae=a;else e:for(;ae!==null;){if(o=ae,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Yr(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,ae=y;break e}ae=o.return}}var g=e.current;for(ae=g;ae!==null;){a=ae;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,ae=w;else e:for(a=g;ae!==null;){if(c=ae,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Bl(9,c)}}catch(S){_e(c,c.return,S)}if(c===a){ae=null;break e}var j=c.sibling;if(j!==null){j.return=c.return,ae=j;break e}ae=c.return}}if(ve=s,Sn(),Ot&&typeof Ot.onPostCommitFiberRoot=="function")try{Ot.onPostCommitFiberRoot(Ll,e)}catch{}r=!0}return r}finally{Se=n,It.transition=t}}return!1}function Qc(e,t,n){t=Nr(n,t),t=nf(e,t,1),e=pn(e,t,1),t=rt(),e!==null&&(ws(e,1,t),ft(e,t))}function _e(e,t,n){if(e.tag===3)Qc(e,e,n);else for(;t!==null;){if(t.tag===3){Qc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gn===null||!gn.has(r))){e=Nr(n,e),e=rf(t,e,1),t=pn(t,e,1),e=rt(),t!==null&&(ws(t,1,e),ft(t,e));break}}t=t.return}}function gp(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=rt(),e.pingedLanes|=e.suspendedLanes&n,Qe===e&&(Ye&n)===n&&(Ue===4||Ue===3&&(Ye&130023424)===Ye&&500>ze()-wi?Ln(e,0):vi|=n),ft(e,t)}function Sf(e,t){t===0&&(e.mode&1?(t=Ls,Ls<<=1,!(Ls&130023424)&&(Ls=4194304)):t=1);var n=rt();e=Kt(e,t),e!==null&&(ws(e,t,n),ft(e,n))}function xp(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Sf(e,n)}function yp(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(V(314))}r!==null&&r.delete(t),Sf(e,n)}var kf;kf=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ut.current)ct=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return ct=!1,lp(e,t,n);ct=!!(e.flags&131072)}else ct=!1,Te&&t.flags&1048576&&Ad(t,wl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;rl(e,t),e=t.pendingProps;var s=xr(t,et.current);mr(t,n),s=mi(null,t,r,e,s,n);var o=hi();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dt(r)?(o=!0,yl(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ii(t),s.updater=Ul,t.stateNode=s,s._reactInternals=t,pa(t,r,e,n),t=ya(null,t,r,!0,o,n)):(t.tag=0,Te&&o&&ti(t),nt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(rl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=wp(r),e=Ct(r,e),s){case 0:t=xa(null,t,r,e,n);break e;case 1:t=_c(null,t,r,e,n);break e;case 11:t=Mc(null,t,r,e,n);break e;case 14:t=Lc(null,t,r,Ct(r.type,e),n);break e}throw Error(V(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ct(r,s),xa(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ct(r,s),_c(e,t,r,s,n);case 3:e:{if(af(t),e===null)throw Error(V(387));r=t.pendingProps,o=t.memoizedState,s=o.element,Ld(e,t),Il(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Nr(Error(V(423)),t),t=zc(e,t,r,n,s);break e}else if(r!==s){s=Nr(Error(V(424)),t),t=zc(e,t,r,n,s);break e}else for(pt=hn(t.stateNode.containerInfo.firstChild),gt=t,Te=!0,Et=null,n=Rd(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(yr(),r===s){t=Xt(e,t,n);break e}nt(e,t,r,n)}t=t.child}return t;case 5:return _d(t),e===null&&fa(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,a=s.children,aa(r,s)?a=null:o!==null&&aa(r,o)&&(t.flags|=32),of(e,t),nt(e,t,a,n),t.child;case 6:return e===null&&fa(t),null;case 13:return cf(e,t,n);case 4:return ci(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=vr(t,null,r,n):nt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ct(r,s),Mc(e,t,r,s,n);case 7:return nt(e,t,t.pendingProps,n),t.child;case 8:return nt(e,t,t.pendingProps.children,n),t.child;case 12:return nt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,a=s.value,Ce(Nl,r._currentValue),r._currentValue=a,o!==null)if(Rt(o.value,a)){if(o.children===s.children&&!ut.current){t=Xt(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var c=o.dependencies;if(c!==null){a=o.child;for(var i=c.firstContext;i!==null;){if(i.context===r){if(o.tag===1){i=Wt(-1,n&-n),i.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var m=u.pending;m===null?i.next=i:(i.next=m.next,m.next=i),u.pending=i}}o.lanes|=n,i=o.alternate,i!==null&&(i.lanes|=n),ma(o.return,n,t),c.lanes|=n;break}i=i.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(V(341));a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),ma(a,n,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}nt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,mr(t,n),s=St(s),r=r(s),t.flags|=1,nt(e,t,r,n),t.child;case 14:return r=t.type,s=Ct(r,t.pendingProps),s=Ct(r.type,s),Lc(e,t,r,s,n);case 15:return sf(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ct(r,s),rl(e,t),t.tag=1,dt(r)?(e=!0,yl(t)):e=!1,mr(t,n),tf(t,r,s),pa(t,r,s,n),ya(null,t,r,!0,e,n);case 19:return uf(e,t,n);case 22:return lf(e,t,n)}throw Error(V(156,t.tag))};function bf(e,t){return Ju(e,t)}function vp(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jt(e,t,n,r){return new vp(e,t,n,r)}function Si(e){return e=e.prototype,!(!e||!e.isReactComponent)}function wp(e){if(typeof e=="function")return Si(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ga)return 11;if(e===Ha)return 14}return 2}function yn(e,t){var n=e.alternate;return n===null?(n=jt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ol(e,t,n,r,s,o){var a=2;if(r=e,typeof e=="function")Si(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Jn:return _n(n.children,s,o,t);case Ba:a=8,s|=8;break;case $o:return e=jt(12,n,t,s|2),e.elementType=$o,e.lanes=o,e;case Fo:return e=jt(13,n,t,s),e.elementType=Fo,e.lanes=o,e;case Uo:return e=jt(19,n,t,s),e.elementType=Uo,e.lanes=o,e;case _u:return Hl(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Mu:a=10;break e;case Lu:a=9;break e;case Ga:a=11;break e;case Ha:a=14;break e;case rn:a=16,r=null;break e}throw Error(V(130,e==null?e:typeof e,""))}return t=jt(a,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function _n(e,t,n,r){return e=jt(7,e,r,t),e.lanes=n,e}function Hl(e,t,n,r){return e=jt(22,e,r,t),e.elementType=_u,e.lanes=n,e.stateNode={isHidden:!1},e}function bo(e,t,n){return e=jt(6,e,null,t),e.lanes=n,e}function Co(e,t,n){return t=jt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Np(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oo(0),this.expirationTimes=oo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oo(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function ki(e,t,n,r,s,o,a,c,i){return e=new Np(e,t,n,c,i),t===1?(t=1,o===!0&&(t|=8)):t=0,o=jt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ii(o),e}function jp(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xn,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Cf(e){if(!e)return Nn;e=e._reactInternals;e:{if(Wn(e)!==e||e.tag!==1)throw Error(V(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(V(171))}if(e.tag===1){var n=e.type;if(dt(n))return bd(e,n,t)}return t}function Af(e,t,n,r,s,o,a,c,i){return e=ki(n,r,!0,e,s,o,a,c,i),e.context=Cf(null),n=e.current,r=rt(),s=xn(n),o=Wt(r,s),o.callback=t??null,pn(n,o,s),e.current.lanes=s,ws(e,s,r),ft(e,r),e}function Ql(e,t,n,r){var s=t.current,o=rt(),a=xn(s);return n=Cf(n),t.context===null?t.context=n:t.pendingContext=n,t=Wt(o,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=pn(s,t,a),e!==null&&(Tt(e,s,a,o),el(e,s,a)),a}function Tl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function bi(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}function Ip(){return null}var Ef=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ci(e){this._internalRoot=e}Vl.prototype.render=Ci.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(V(409));Ql(e,t,null,null)};Vl.prototype.unmount=Ci.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Bn(function(){Ql(null,e,null,null)}),t[qt]=null}};function Vl(e){this._internalRoot=e}Vl.prototype.unstable_scheduleHydration=function(e){if(e){var t=ld();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ln.length&&t!==0&&t<ln[n].priority;n++);ln.splice(n,0,e),n===0&&ad(e)}};function Ai(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Wl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Wc(){}function Sp(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=Tl(a);o.call(u)}}var a=Af(t,r,e,0,null,!1,!1,"",Wc);return e._reactRootContainer=a,e[qt]=a.current,os(e.nodeType===8?e.parentNode:e),Bn(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var u=Tl(i);c.call(u)}}var i=ki(e,0,!1,null,null,!1,!1,"",Wc);return e._reactRootContainer=i,e[qt]=i.current,os(e.nodeType===8?e.parentNode:e),Bn(function(){Ql(t,i,n,r)}),i}function Yl(e,t,n,r,s){var o=n._reactRootContainer;if(o){var a=o;if(typeof s=="function"){var c=s;s=function(){var i=Tl(a);c.call(i)}}Ql(t,a,e,s)}else a=Sp(n,t,e,s,r);return Tl(a)}rd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Fr(t.pendingLanes);n!==0&&(Wa(t,n|1),ft(t,ze()),!(ve&6)&&(jr=ze()+500,Sn()))}break;case 13:Bn(function(){var r=Kt(e,1);if(r!==null){var s=rt();Tt(r,e,1,s)}}),bi(e,1)}};Ya=function(e){if(e.tag===13){var t=Kt(e,134217728);if(t!==null){var n=rt();Tt(t,e,134217728,n)}bi(e,134217728)}};sd=function(e){if(e.tag===13){var t=xn(e),n=Kt(e,t);if(n!==null){var r=rt();Tt(n,e,t,r)}bi(e,t)}};ld=function(){return Se};od=function(e,t){var n=Se;try{return Se=e,t()}finally{Se=n}};Xo=function(e,t,n){switch(t){case"input":if(Ho(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Ol(r);if(!s)throw Error(V(90));Du(r),Ho(r,s)}}}break;case"textarea":$u(e,n);break;case"select":t=n.value,t!=null&&cr(e,!!n.multiple,t,!1)}};Vu=Ni;Wu=Bn;var kp={usingClientEntryPoint:!1,Events:[js,nr,Ol,Hu,Qu,Ni]},zr={findFiberByHostInstance:Tn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bp={bundleType:zr.bundleType,version:zr.version,rendererPackageName:zr.rendererPackageName,rendererConfig:zr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jt.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ku(e),e===null?null:e.stateNode},findFiberByHostInstance:zr.findFiberByHostInstance||Ip,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qs.isDisabled&&Qs.supportsFiber)try{Ll=Qs.inject(bp),Ot=Qs}catch{}}yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kp;yt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ai(t))throw Error(V(200));return jp(e,t,null,n)};yt.createRoot=function(e,t){if(!Ai(e))throw Error(V(299));var n=!1,r="",s=Ef;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=ki(e,1,!1,null,null,n,!1,r,s),e[qt]=t.current,os(e.nodeType===8?e.parentNode:e),new Ci(t)};yt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(V(188)):(e=Object.keys(e).join(","),Error(V(268,e)));return e=Ku(t),e=e===null?null:e.stateNode,e};yt.flushSync=function(e){return Bn(e)};yt.hydrate=function(e,t,n){if(!Wl(t))throw Error(V(200));return Yl(null,e,t,!0,n)};yt.hydrateRoot=function(e,t,n){if(!Ai(e))throw Error(V(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",a=Ef;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Af(t,null,e,1,n??null,s,!1,o,a),e[qt]=t.current,os(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Vl(t)};yt.render=function(e,t,n){if(!Wl(t))throw Error(V(200));return Yl(null,e,t,!1,n)};yt.unmountComponentAtNode=function(e){if(!Wl(e))throw Error(V(40));return e._reactRootContainer?(Bn(function(){Yl(null,null,e,!1,function(){e._reactRootContainer=null,e[qt]=null})}),!0):!1};yt.unstable_batchedUpdates=Ni;yt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Wl(n))throw Error(V(200));if(e==null||e._reactInternals===void 0)throw Error(V(38));return Yl(e,t,n,!1,r)};yt.version="18.3.1-next-f1338f8080-20240426";function Pf(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pf)}catch(e){console.error(e)}}Pf(),Eu.exports=yt;var Yn=Eu.exports,Yc=Yn;Do.createRoot=Yc.createRoot,Do.hydrateRoot=Yc.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ps(){return ps=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ps.apply(this,arguments)}var un;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(un||(un={}));const qc="popstate";function Cp(e){e===void 0&&(e={});function t(r,s){let{pathname:o,search:a,hash:c}=r.location;return Pa("",{pathname:o,search:a,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Rl(s)}return Ep(t,n,null,e)}function De(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Ei(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Ap(){return Math.random().toString(36).substr(2,8)}function Kc(e,t){return{usr:e.state,key:e.key,idx:t}}function Pa(e,t,n,r){return n===void 0&&(n=null),ps({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Cr(t):t,{state:n,key:t&&t.key||r||Ap()})}function Rl(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Cr(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Ep(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,a=s.history,c=un.Pop,i=null,u=m();u==null&&(u=0,a.replaceState(ps({},a.state,{idx:u}),""));function m(){return(a.state||{idx:null}).idx}function h(){c=un.Pop;let N=m(),y=N==null?null:N-u;u=N,i&&i({action:c,location:x.location,delta:y})}function f(N,y){c=un.Push;let g=Pa(x.location,N,y);u=m()+1;let w=Kc(g,u),j=x.createHref(g);try{a.pushState(w,"",j)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(j)}o&&i&&i({action:c,location:x.location,delta:1})}function d(N,y){c=un.Replace;let g=Pa(x.location,N,y);u=m();let w=Kc(g,u),j=x.createHref(g);a.replaceState(w,"",j),o&&i&&i({action:c,location:x.location,delta:0})}function v(N){let y=s.location.origin!=="null"?s.location.origin:s.location.href,g=typeof N=="string"?N:Rl(N);return g=g.replace(/ $/,"%20"),De(y,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,y)}let x={get action(){return c},get location(){return e(s,a)},listen(N){if(i)throw new Error("A history only accepts one active listener");return s.addEventListener(qc,h),i=N,()=>{s.removeEventListener(qc,h),i=null}},createHref(N){return t(s,N)},createURL:v,encodeLocation(N){let y=v(N);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:d,go(N){return a.go(N)}};return x}var Xc;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Xc||(Xc={}));function Pp(e,t,n){return n===void 0&&(n="/"),Tp(e,t,n)}function Tp(e,t,n,r){let s=typeof t=="string"?Cr(t):t,o=Pi(s.pathname||"/",n);if(o==null)return null;let a=Tf(e);Rp(a);let c=null;for(let i=0;c==null&&i<a.length;++i){let u=Hp(o);c=Up(a[i],u)}return c}function Tf(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,a,c)=>{let i={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};i.relativePath.startsWith("/")&&(De(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),i.relativePath=i.relativePath.slice(r.length));let u=vn([r,i.relativePath]),m=n.concat(i);o.children&&o.children.length>0&&(De(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Tf(o.children,t,m,u)),!(o.path==null&&!o.index)&&t.push({path:u,score:$p(u,o.index),routesMeta:m})};return e.forEach((o,a)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))s(o,a);else for(let i of Rf(o.path))s(o,a,i)}),t}function Rf(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let a=Rf(r.join("/")),c=[];return c.push(...a.map(i=>i===""?o:[o,i].join("/"))),s&&c.push(...a),c.map(i=>e.startsWith("/")&&i===""?"/":i)}function Rp(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Fp(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Mp=/^:[\w-]+$/,Lp=3,_p=2,zp=1,Dp=10,Op=-2,Jc=e=>e==="*";function $p(e,t){let n=e.split("/"),r=n.length;return n.some(Jc)&&(r+=Op),t&&(r+=_p),n.filter(s=>!Jc(s)).reduce((s,o)=>s+(Mp.test(o)?Lp:o===""?zp:Dp),r)}function Fp(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function Up(e,t,n){let{routesMeta:r}=e,s={},o="/",a=[];for(let c=0;c<r.length;++c){let i=r[c],u=c===r.length-1,m=o==="/"?t:t.slice(o.length)||"/",h=Bp({path:i.relativePath,caseSensitive:i.caseSensitive,end:u},m),f=i.route;if(!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:vn([o,h.pathname]),pathnameBase:qp(vn([o,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(o=vn([o,h.pathnameBase]))}return a}function Bp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Gp(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let o=s[0],a=o.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:r.reduce((u,m,h)=>{let{paramName:f,isOptional:d}=m;if(f==="*"){let x=c[h]||"";a=o.slice(0,o.length-x.length).replace(/(.)\/+$/,"$1")}const v=c[h];return d&&!v?u[f]=void 0:u[f]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:a,pattern:e}}function Gp(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),Ei(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,c,i)=>(r.push({paramName:c,isOptional:i!=null}),i?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function Hp(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ei(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Pi(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const Qp=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vp=e=>Qp.test(e);function Wp(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?Cr(e):e,o;if(n)if(Vp(n))o=n;else{if(n.includes("//")){let a=n;n=n.replace(/\/\/+/g,"/"),Ei(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+n))}n.startsWith("/")?o=Zc(n.substring(1),"/"):o=Zc(n,t)}else o=t;return{pathname:o,search:Kp(r),hash:Xp(s)}}function Zc(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Ao(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Yp(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Ti(e,t){let n=Yp(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Ri(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Cr(e):(s=ps({},e),De(!s.pathname||!s.pathname.includes("?"),Ao("?","pathname","search",s)),De(!s.pathname||!s.pathname.includes("#"),Ao("#","pathname","hash",s)),De(!s.search||!s.search.includes("#"),Ao("#","search","hash",s)));let o=e===""||s.pathname==="",a=o?"/":s.pathname,c;if(a==null)c=n;else{let h=t.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}c=h>=0?t[h]:"/"}let i=Wp(s,c),u=a&&a!=="/"&&a.endsWith("/"),m=(o||a===".")&&n.endsWith("/");return!i.pathname.endsWith("/")&&(u||m)&&(i.pathname+="/"),i}const vn=e=>e.join("/").replace(/\/\/+/g,"/"),qp=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Kp=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Xp=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Jp(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Mf=["post","put","patch","delete"];new Set(Mf);const Zp=["get",...Mf];new Set(Zp);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gs(){return gs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gs.apply(this,arguments)}const Mi=p.createContext(null),eg=p.createContext(null),kn=p.createContext(null),ql=p.createContext(null),Zt=p.createContext({outlet:null,matches:[],isDataRoute:!1}),Lf=p.createContext(null);function tg(e,t){let{relative:n}=t===void 0?{}:t;Ar()||De(!1);let{basename:r,navigator:s}=p.useContext(kn),{hash:o,pathname:a,search:c}=zf(e,{relative:n}),i=a;return r!=="/"&&(i=a==="/"?r:vn([r,a])),s.createHref({pathname:i,search:c,hash:o})}function Ar(){return p.useContext(ql)!=null}function en(){return Ar()||De(!1),p.useContext(ql).location}function _f(e){p.useContext(kn).static||p.useLayoutEffect(e)}function $e(){let{isDataRoute:e}=p.useContext(Zt);return e?hg():ng()}function ng(){Ar()||De(!1);let e=p.useContext(Mi),{basename:t,future:n,navigator:r}=p.useContext(kn),{matches:s}=p.useContext(Zt),{pathname:o}=en(),a=JSON.stringify(Ti(s,n.v7_relativeSplatPath)),c=p.useRef(!1);return _f(()=>{c.current=!0}),p.useCallback(function(u,m){if(m===void 0&&(m={}),!c.current)return;if(typeof u=="number"){r.go(u);return}let h=Ri(u,JSON.parse(a),o,m.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:vn([t,h.pathname])),(m.replace?r.replace:r.push)(h,m.state,m)},[t,r,a,o,e])}function Kl(){let{matches:e}=p.useContext(Zt),t=e[e.length-1];return t?t.params:{}}function zf(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=p.useContext(kn),{matches:s}=p.useContext(Zt),{pathname:o}=en(),a=JSON.stringify(Ti(s,r.v7_relativeSplatPath));return p.useMemo(()=>Ri(e,JSON.parse(a),o,n==="path"),[e,a,o,n])}function rg(e,t){return sg(e,t)}function sg(e,t,n,r){Ar()||De(!1);let{navigator:s}=p.useContext(kn),{matches:o}=p.useContext(Zt),a=o[o.length-1],c=a?a.params:{};a&&a.pathname;let i=a?a.pathnameBase:"/";a&&a.route;let u=en(),m;if(t){var h;let N=typeof t=="string"?Cr(t):t;i==="/"||(h=N.pathname)!=null&&h.startsWith(i)||De(!1),m=N}else m=u;let f=m.pathname||"/",d=f;if(i!=="/"){let N=i.replace(/^\//,"").split("/");d="/"+f.replace(/^\//,"").split("/").slice(N.length).join("/")}let v=Pp(e,{pathname:d}),x=cg(v&&v.map(N=>Object.assign({},N,{params:Object.assign({},c,N.params),pathname:vn([i,s.encodeLocation?s.encodeLocation(N.pathname).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?i:vn([i,s.encodeLocation?s.encodeLocation(N.pathnameBase).pathname:N.pathnameBase])})),o,n,r);return t&&x?p.createElement(ql.Provider,{value:{location:gs({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:un.Pop}},x):x}function lg(){let e=mg(),t=Jp(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),n?p.createElement("pre",{style:s},n):null,null)}const og=p.createElement(lg,null);class ag extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?p.createElement(Zt.Provider,{value:this.props.routeContext},p.createElement(Lf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ig(e){let{routeContext:t,match:n,children:r}=e,s=p.useContext(Mi);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(Zt.Provider,{value:t},r)}function cg(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,c=(s=n)==null?void 0:s.errors;if(c!=null){let m=a.findIndex(h=>h.route.id&&(c==null?void 0:c[h.route.id])!==void 0);m>=0||De(!1),a=a.slice(0,Math.min(a.length,m+1))}let i=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<a.length;m++){let h=a[m];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=m),h.route.id){let{loaderData:f,errors:d}=n,v=h.route.loader&&f[h.route.id]===void 0&&(!d||d[h.route.id]===void 0);if(h.route.lazy||v){i=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((m,h,f)=>{let d,v=!1,x=null,N=null;n&&(d=c&&h.route.id?c[h.route.id]:void 0,x=h.route.errorElement||og,i&&(u<0&&f===0?(pg("route-fallback"),v=!0,N=null):u===f&&(v=!0,N=h.route.hydrateFallbackElement||null)));let y=t.concat(a.slice(0,f+1)),g=()=>{let w;return d?w=x:v?w=N:h.route.Component?w=p.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=m,p.createElement(ig,{match:h,routeContext:{outlet:m,matches:y,isDataRoute:n!=null},children:w})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?p.createElement(ag,{location:n.location,revalidation:n.revalidation,component:x,error:d,children:g(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):g()},null)}var Df=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Df||{}),Of=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Of||{});function ug(e){let t=p.useContext(Mi);return t||De(!1),t}function dg(e){let t=p.useContext(eg);return t||De(!1),t}function fg(e){let t=p.useContext(Zt);return t||De(!1),t}function $f(e){let t=fg(),n=t.matches[t.matches.length-1];return n.route.id||De(!1),n.route.id}function mg(){var e;let t=p.useContext(Lf),n=dg(),r=$f();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function hg(){let{router:e}=ug(Df.UseNavigateStable),t=$f(Of.UseNavigateStable),n=p.useRef(!1);return _f(()=>{n.current=!0}),p.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,gs({fromRouteId:t},o)))},[e,t])}const eu={};function pg(e,t,n){eu[e]||(eu[e]=!0)}function gg(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function xg(e){let{to:t,replace:n,state:r,relative:s}=e;Ar()||De(!1);let{future:o,static:a}=p.useContext(kn),{matches:c}=p.useContext(Zt),{pathname:i}=en(),u=$e(),m=Ri(t,Ti(c,o.v7_relativeSplatPath),i,s==="path"),h=JSON.stringify(m);return p.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:s}),[u,h,s,n,r]),null}function mt(e){De(!1)}function yg(e){let{basename:t="/",children:n=null,location:r,navigationType:s=un.Pop,navigator:o,static:a=!1,future:c}=e;Ar()&&De(!1);let i=t.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:i,navigator:o,static:a,future:gs({v7_relativeSplatPath:!1},c)}),[i,c,o,a]);typeof r=="string"&&(r=Cr(r));let{pathname:m="/",search:h="",hash:f="",state:d=null,key:v="default"}=r,x=p.useMemo(()=>{let N=Pi(m,i);return N==null?null:{location:{pathname:N,search:h,hash:f,state:d,key:v},navigationType:s}},[i,m,h,f,d,v,s]);return x==null?null:p.createElement(kn.Provider,{value:u},p.createElement(ql.Provider,{children:n,value:x}))}function vg(e){let{children:t,location:n}=e;return rg(Ta(t),n)}new Promise(()=>{});function Ta(e,t){t===void 0&&(t=[]);let n=[];return p.Children.forEach(e,(r,s)=>{if(!p.isValidElement(r))return;let o=[...t,s];if(r.type===p.Fragment){n.push.apply(n,Ta(r.props.children,o));return}r.type!==mt&&De(!1),!r.props.index||!r.props.children||De(!1);let a={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Ta(r.props.children,o)),n.push(a)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ra(){return Ra=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ra.apply(this,arguments)}function wg(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,o;for(o=0;o<r.length;o++)s=r[o],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Ng(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jg(e,t){return e.button===0&&(!t||t==="_self")&&!Ng(e)}function Ma(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function Ig(e,t){let n=Ma(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(o=>{n.append(s,o)})}),n}const Sg=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kg="6";try{window.__reactRouterVersion=kg}catch{}const bg="startTransition",tu=gm[bg];function Cg(e){let{basename:t,children:n,future:r,window:s}=e,o=p.useRef();o.current==null&&(o.current=Cp({window:s,v5Compat:!0}));let a=o.current,[c,i]=p.useState({action:a.action,location:a.location}),{v7_startTransition:u}=r||{},m=p.useCallback(h=>{u&&tu?tu(()=>i(h)):i(h)},[i,u]);return p.useLayoutEffect(()=>a.listen(m),[a,m]),p.useEffect(()=>gg(r),[r]),p.createElement(yg,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:a,future:r})}const Ag=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Eg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pg=p.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:o,replace:a,state:c,target:i,to:u,preventScrollReset:m,viewTransition:h}=t,f=wg(t,Sg),{basename:d}=p.useContext(kn),v,x=!1;if(typeof u=="string"&&Eg.test(u)&&(v=u,Ag))try{let w=new URL(window.location.href),j=u.startsWith("//")?new URL(w.protocol+u):new URL(u),S=Pi(j.pathname,d);j.origin===w.origin&&S!=null?u=S+j.search+j.hash:x=!0}catch{}let N=tg(u,{relative:s}),y=Tg(u,{replace:a,state:c,target:i,preventScrollReset:m,relative:s,viewTransition:h});function g(w){r&&r(w),w.defaultPrevented||y(w)}return p.createElement("a",Ra({},f,{href:v||N,onClick:x||o?r:g,ref:n,target:i}))});var nu;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(nu||(nu={}));var ru;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ru||(ru={}));function Tg(e,t){let{target:n,replace:r,state:s,preventScrollReset:o,relative:a,viewTransition:c}=t===void 0?{}:t,i=$e(),u=en(),m=zf(e,{relative:a});return p.useCallback(h=>{if(jg(h,n)){h.preventDefault();let f=r!==void 0?r:Rl(u)===Rl(m);i(e,{replace:f,state:s,preventScrollReset:o,relative:a,viewTransition:c})}},[u,i,m,r,s,n,e,o,a,c])}function Rg(e){let t=p.useRef(Ma(e)),n=p.useRef(!1),r=en(),s=p.useMemo(()=>Ig(r.search,n.current?null:t.current),[r.search]),o=$e(),a=p.useCallback((c,i)=>{const u=Ma(typeof c=="function"?c(s):c);n.current=!0,o("?"+u,i)},[o,s]);return[s,a]}const Mg={},su=e=>{let t;const n=new Set,r=(m,h)=>{const f=typeof m=="function"?m(t):m;if(!Object.is(f,t)){const d=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(v=>v(t,d))}},s=()=>t,i={setState:r,getState:s,getInitialState:()=>u,subscribe:m=>(n.add(m),()=>n.delete(m)),destroy:()=>{(Mg?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,s,i);return i},Lg=e=>e?su(e):su;var Ff={exports:{}},Uf={},Bf={exports:{}},Gf={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ir=p;function _g(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var zg=typeof Object.is=="function"?Object.is:_g,Dg=Ir.useState,Og=Ir.useEffect,$g=Ir.useLayoutEffect,Fg=Ir.useDebugValue;function Ug(e,t){var n=t(),r=Dg({inst:{value:n,getSnapshot:t}}),s=r[0].inst,o=r[1];return $g(function(){s.value=n,s.getSnapshot=t,Eo(s)&&o({inst:s})},[e,n,t]),Og(function(){return Eo(s)&&o({inst:s}),e(function(){Eo(s)&&o({inst:s})})},[e]),Fg(n),n}function Eo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!zg(e,n)}catch{return!0}}function Bg(e,t){return t()}var Gg=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Bg:Ug;Gf.useSyncExternalStore=Ir.useSyncExternalStore!==void 0?Ir.useSyncExternalStore:Gg;Bf.exports=Gf;var Hg=Bf.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xl=p,Qg=Hg;function Vg(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Wg=typeof Object.is=="function"?Object.is:Vg,Yg=Qg.useSyncExternalStore,qg=Xl.useRef,Kg=Xl.useEffect,Xg=Xl.useMemo,Jg=Xl.useDebugValue;Uf.useSyncExternalStoreWithSelector=function(e,t,n,r,s){var o=qg(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=Xg(function(){function i(d){if(!u){if(u=!0,m=d,d=r(d),s!==void 0&&a.hasValue){var v=a.value;if(s(v,d))return h=v}return h=d}if(v=h,Wg(m,d))return v;var x=r(d);return s!==void 0&&s(v,x)?(m=d,v):(m=d,h=x)}var u=!1,m,h,f=n===void 0?null:n;return[function(){return i(t())},f===null?void 0:function(){return i(f())}]},[t,n,r,s]);var c=Yg(e,o[0],o[1]);return Kg(function(){a.hasValue=!0,a.value=c},[c]),Jg(c),c};Ff.exports=Uf;var Zg=Ff.exports;const ex=xu(Zg),Hf={},{useDebugValue:tx}=Oa,{useSyncExternalStoreWithSelector:nx}=ex;let lu=!1;const rx=e=>e;function sx(e,t=rx,n){(Hf?"production":void 0)!=="production"&&n&&!lu&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),lu=!0);const r=nx(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return tx(r),r}const ou=e=>{(Hf?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Lg(e):e,n=(r,s)=>sx(t,r,s);return Object.assign(n,t),n},Ss=e=>e?ou(e):ou,lx={};function ox(e,t){let n;try{n=e()}catch{return}return{getItem:s=>{var o;const a=i=>i===null?null:JSON.parse(i,void 0),c=(o=n.getItem(s))!=null?o:null;return c instanceof Promise?c.then(a):a(c)},setItem:(s,o)=>n.setItem(s,JSON.stringify(o,void 0)),removeItem:s=>n.removeItem(s)}}const xs=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return xs(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return xs(r)(n)}}}},ax=(e,t)=>(n,r,s)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:N=>N,version:0,merge:(N,y)=>({...y,...N}),...t},a=!1;const c=new Set,i=new Set;let u;try{u=o.getStorage()}catch{}if(!u)return e((...N)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...N)},r,s);const m=xs(o.serialize),h=()=>{const N=o.partialize({...r()});let y;const g=m({state:N,version:o.version}).then(w=>u.setItem(o.name,w)).catch(w=>{y=w});if(y)throw y;return g},f=s.setState;s.setState=(N,y)=>{f(N,y),h()};const d=e((...N)=>{n(...N),h()},r,s);let v;const x=()=>{var N;if(!u)return;a=!1,c.forEach(g=>g(r()));const y=((N=o.onRehydrateStorage)==null?void 0:N.call(o,r()))||void 0;return xs(u.getItem.bind(u))(o.name).then(g=>{if(g)return o.deserialize(g)}).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==o.version){if(o.migrate)return o.migrate(g.state,g.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return g.state}).then(g=>{var w;return v=o.merge(g,(w=r())!=null?w:d),n(v,!0),h()}).then(()=>{y==null||y(v,void 0),a=!0,i.forEach(g=>g(v))}).catch(g=>{y==null||y(void 0,g)})};return s.persist={setOptions:N=>{o={...o,...N},N.getStorage&&(u=N.getStorage())},clearStorage:()=>{u==null||u.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>x(),hasHydrated:()=>a,onHydrate:N=>(c.add(N),()=>{c.delete(N)}),onFinishHydration:N=>(i.add(N),()=>{i.delete(N)})},x(),v||d},ix=(e,t)=>(n,r,s)=>{let o={storage:ox(()=>localStorage),partialize:x=>x,version:0,merge:(x,N)=>({...N,...x}),...t},a=!1;const c=new Set,i=new Set;let u=o.storage;if(!u)return e((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...x)},r,s);const m=()=>{const x=o.partialize({...r()});return u.setItem(o.name,{state:x,version:o.version})},h=s.setState;s.setState=(x,N)=>{h(x,N),m()};const f=e((...x)=>{n(...x),m()},r,s);s.getInitialState=()=>f;let d;const v=()=>{var x,N;if(!u)return;a=!1,c.forEach(g=>{var w;return g((w=r())!=null?w:f)});const y=((N=o.onRehydrateStorage)==null?void 0:N.call(o,(x=r())!=null?x:f))||void 0;return xs(u.getItem.bind(u))(o.name).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==o.version){if(o.migrate)return[!0,o.migrate(g.state,g.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,g.state];return[!1,void 0]}).then(g=>{var w;const[j,S]=g;if(d=o.merge(S,(w=r())!=null?w:f),n(d,!0),j)return m()}).then(()=>{y==null||y(d,void 0),d=r(),a=!0,i.forEach(g=>g(d))}).catch(g=>{y==null||y(void 0,g)})};return s.persist={setOptions:x=>{o={...o,...x},x.storage&&(u=x.storage)},clearStorage:()=>{u==null||u.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:x=>(c.add(x),()=>{c.delete(x)}),onFinishHydration:x=>(i.add(x),()=>{i.delete(x)})},o.skipHydration||v(),d||f},cx=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((lx?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),ax(e,t)):ix(e,t),Jl=cx,ys={get(e){try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}},set(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(n){console.error("Failed to save to localStorage:",n)}},remove(e){try{localStorage.removeItem(e)}catch(t){console.error("Failed to remove from localStorage:",t)}},clear(){try{localStorage.clear()}catch(e){console.error("Failed to clear localStorage:",e)}}};function ux(){if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;const t=Array.from(e).map(n=>n.toString(16).padStart(2,"0")).join("");return[t.slice(0,8),t.slice(8,12),t.slice(12,16),t.slice(16,20),t.slice(20,32)].join("-")}const Ie=Ss()(Jl(e=>({artists:[],albums:[],songs:[],genres:[],genresLastUpdated:null,genresLastChecked:null,genreSongs:{},years:[],yearsLastUpdated:null,yearsLastChecked:null,groupings:[],groupingsLastUpdated:null,groupingsLastChecked:null,recentlyAdded:[],recentlyPlayed:[],loading:{artists:!1,albums:!1,songs:!1,genres:!1,recentlyAdded:!1,recentlyPlayed:!1},sortPreferences:{artists:"RecentlyAdded",albums:"RecentlyAdded",songs:"RecentlyAdded",playlists:"RecentlyAdded"},setArtists:t=>e({artists:t}),setAlbums:t=>e({albums:t}),setSongs:t=>e({songs:t}),setGenres:t=>e({genres:t}),setGenreSongs:(t,n)=>e(r=>({genreSongs:{...r.genreSongs,[t]:n}})),clearGenreSongs:()=>e({genreSongs:{}}),clearGenreSongsForGenre:t=>e(n=>{const r={...n.genreSongs};return delete r[t],{genreSongs:r}}),setYears:t=>e({years:t}),setGroupings:t=>e({groupings:t}),setRecentlyAdded:t=>e({recentlyAdded:t}),setRecentlyPlayed:t=>e({recentlyPlayed:t}),addToRecentlyPlayed:t=>e(n=>{const r=n.recentlyPlayed.filter(o=>o.Id!==t.Id);return{recentlyPlayed:[t,...r].slice(0,10)}}),setLoading:(t,n)=>e(r=>({loading:{...r.loading,[t]:n}})),setSortPreference:(t,n)=>e(r=>({sortPreferences:{...r.sortPreferences,[t]:n}}))}),{name:"music-storage",partialize:e=>({genres:e.genres,genresLastUpdated:e.genresLastUpdated,genresLastChecked:e.genresLastChecked,genreSongs:e.genreSongs,years:e.years,yearsLastUpdated:e.yearsLastUpdated,yearsLastChecked:e.yearsLastChecked,groupings:e.groupings,groupingsLastUpdated:e.groupingsLastUpdated,groupingsLastChecked:e.groupingsLastChecked,recentlyPlayed:e.recentlyPlayed})}));function al(e){return e&&e.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/[\u2032\u2033]/g,"'")}function Lt(e){return e&&al(e).replace(/'/g,"")}class dx{constructor(){An(this,"baseUrl","");An(this,"accessToken","");An(this,"userId","");An(this,"genresCache",null);An(this,"isPreloading",!1)}get serverBaseUrl(){return this.baseUrl}setCredentials(t,n,r){this.baseUrl=t.replace(/\/$/,""),this.accessToken=n,this.userId=r,this.genresCache=null}clearGenresCache(){this.genresCache=null}getHeaders(){return{Authorization:`MediaBrowser Token="${this.accessToken}"`,"Content-Type":"application/json","X-Emby-Authorization":`MediaBrowser Client="Tunetuna", Device="Web", DeviceId="${this.getDeviceId()}", Version="1.0.0"`}}getDeviceId(){let t=ys.get("deviceId");return t||(t=ux(),ys.set("deviceId",t)),t}async request(t,n={}){const r=`${this.baseUrl}${t}`,s=await fetch(r,{...n,headers:{...this.getHeaders(),...n.headers}});if(!s.ok)throw s.status===401?new Error("Unauthorized - please login again"):new Error(`API request failed: ${s.statusText}`);return s.json()}async authenticate(t,n,r){const s=t.replace(/\/$/,"")+"/Users/authenticatebyname",o=new AbortController,a=setTimeout(()=>{console.warn("Authentication request timed out after 30 seconds"),o.abort()},3e4);let c;try{c=await fetch(s,{method:"POST",signal:o.signal,headers:{"Content-Type":"application/json","X-Emby-Authorization":`MediaBrowser Client="Tunetuna", Device="Web", DeviceId="${this.getDeviceId()}", Version="1.0.0"`},body:JSON.stringify({Username:n,Pw:r})}),clearTimeout(a)}catch(u){if(clearTimeout(a),u instanceof Error&&u.name==="AbortError"){const h=/^https?:\/\/100\.\d+\.\d+\.\d+/.test(t)?`
  VPN/Tailscale IP detected (100.x.x.x). Your phone may not be on the same VPN network.
   Try using your local network IP instead (e.g., http://192.168.1.x:8096)
`:"";throw new Error(`Request timeout - server did not respond within 30 seconds.

Possible issues:
- Server URL may be incorrect: ${s}
- Server may be down or unreachable${h}- CORS may be blocking the request (check browser console/Network tab)
- Network connectivity issues

If this was working earlier, check:
- Is the Jellyfin server still running?
- Are there any CORS errors in the browser console?
- Try accessing ${s} directly in your browser
- If using VPN/Tailscale IP, ensure your phone is on the same network`)}if(u instanceof TypeError){const m=u.message.toLowerCase();if(m.includes("failed to fetch")||m.includes("networkerror")){const f=/^https?:\/\/100\.\d+\.\d+\.\d+/.test(t)?`
  VPN/Tailscale IP detected. Your phone may not be able to access this IP.
   Try using your local network IP instead (e.g., http://192.168.1.x:8096)
`:"";throw new Error(`Network error - unable to reach server at ${s}

Possible issues:
- CORS is blocking the request (check Jellyfin server CORS settings)${f}- Server is not accessible from this network
- Invalid server URL

Check browser console for detailed error information.`)}throw new Error(`Network error: ${u.message}`)}throw u}if(!c.ok){const u=await c.text().catch(()=>"");throw new Error(u||`Authentication failed (${c.status})`)}const i=await c.json();return this.setCredentials(t,i.AccessToken,i.User.Id),i}getImageUrl(t,n="Primary",r){if(!this.baseUrl||!t)return"";const s=r??300,c=[`quality=${s<=128?75:90}`,`fillHeight=${s}`,`fillWidth=${s}`];return r&&c.push(`maxWidth=${r}`),`${this.baseUrl}/Items/${t}/Images/${n}?${c.join("&")}`}getArtistImageUrl(t,n){return this.getImageUrl(t,"Primary",n)}getArtistBackdropUrl(t,n){return this.getImageUrl(t,"Backdrop",n)}getAlbumArtUrl(t,n){return this.getImageUrl(t,"Primary",n)}buildQueryString(t,n=!1){const r=new URLSearchParams;return t.sortBy&&t.sortBy.forEach(s=>r.append("SortBy",s)),t.sortOrder&&r.append("SortOrder",t.sortOrder),t.limit&&r.append("Limit",t.limit.toString()),t.startIndex&&r.append("StartIndex",t.startIndex.toString()),t.includeItemTypes&&t.includeItemTypes.forEach(s=>r.append("IncludeItemTypes",s)),t.recursive!==void 0&&r.append("Recursive",t.recursive.toString()),t.parentId&&r.append("ParentId",t.parentId),t.searchTerm&&t.searchTerm.trim().length>0&&r.append("SearchTerm",t.searchTerm.trim()),t.genreIds&&t.genreIds.forEach(s=>r.append("GenreIds",s)),t.artistIds&&t.artistIds.forEach(s=>r.append("ArtistIds",s)),t.albumIds&&t.albumIds.forEach(s=>r.append("AlbumIds",s)),t.years&&t.years.forEach(s=>r.append("Years",s.toString())),r.append("UserId",this.userId),r.append("Fields","PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount,Grouping,Genres,ProductionYear"),n&&r.append("_t",Date.now().toString()),r.toString()}async getArtistById(t){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=new URLSearchParams({UserId:this.userId,Fields:"PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount,Grouping,Genres,Overview"});try{return await this.request(`/Items/${t}?${n}`)}catch(r){return console.error("Failed to get artist by ID:",r),null}}async getArtists(t={}){var s;if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=this.buildQueryString({...t,includeItemTypes:["MusicArtist"],recursive:!0});let r=await this.request(`/Artists?${n}`);return(((s=r.Items)==null?void 0:s.length)||0)===0&&(r.TotalRecordCount||0)===0&&(r=await this.request(`/Items?${n}`)),{Items:r.Items||[],TotalRecordCount:r.TotalRecordCount||0,StartIndex:r.StartIndex||0}}async getAlbumById(t){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=new URLSearchParams({UserId:this.userId,Fields:"PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount,Grouping,Genres,Overview"});try{return await this.request(`/Items/${t}?${n}`)}catch(r){return console.error("Failed to get album by ID:",r),null}}async getSongById(t){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=new URLSearchParams({UserId:this.userId,Fields:"PrimaryImageAspectRatio,BasicSyncInfo,CanDelete,MediaSourceCount,Grouping,Genres"});try{return await this.request(`/Items/${t}?${n}`)}catch(r){return console.error("Failed to get song by ID:",r),null}}async getAlbums(t={}){const n=this.buildQueryString({...t,includeItemTypes:["MusicAlbum"],recursive:!0});return this.request(`/Items?${n}`)}async getSongs(t={},n=!1){const r=this.buildQueryString({...t,includeItemTypes:["Audio"],recursive:!0},n);return this.request(`/Items?${r}`)}async getGenres(t=!1){if(this.genresCache&&!t)return this.genresCache;if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=Ie.getState(),r=30*60*1e3;if(!t&&n.genres.length>0&&n.genresLastUpdated){const s=Date.now(),o=n.genresLastChecked||0;if(!(s-o>=r))return this.genresCache=n.genres,n.genres;try{const i=(await this.getRecentlyAdded(50)).Items||[];let u=0;for(const m of i)if(m.DateCreated){const h=new Date(m.DateCreated).getTime();h>u&&(u=h)}if(Ie.setState({genresLastChecked:s}),u<=n.genresLastUpdated)return this.genresCache=n.genres,n.genres}catch(c){return console.warn("[getGenres] Failed to check for new tracks, using cached genres:",c),this.genresCache=n.genres,n.genres}}try{const s=new Map;let o=0;const a=200;let c=!0;for(;c;){const y=(await this.getAlbums({limit:a,startIndex:o})).Items||[];if(y.forEach(g=>{g.Genres&&g.Genres.forEach(w=>{const j=w.toLowerCase();s.has(j)||s.set(j,w)})}),c=y.length===a,o+=a,o>1e4)break}const i=new Set;let u=0,m=!0;for(;m;){const y=(await this.getSongs({limit:200,startIndex:u})).Items||[];if(y.forEach(g=>{g.Genres&&g.Genres.forEach(w=>{i.add(w.toLowerCase())})}),m=y.length===200,u+=200,u>1e4)break}const h=new Map,f=new Map;try{const N=new URLSearchParams({UserId:this.userId,Recursive:"true"}),y=await this.request(`/Genres?${N}`);let g=[];Array.isArray(y)?g=y:y&&typeof y=="object"&&"Items"in y&&(g=y.Items||[]),g.forEach(w=>{if(w.Name){const j=w.Name.toLowerCase();s.has(j)&&(h.set(j,w.Id),f.set(w.Id,w))}})}catch(N){console.warn("[getGenres] Failed to get genre IDs from API, will use synthetic IDs:",N)}const d=[],v=new Set;for(const[N,y]of s){if(v.has(N)||!i.has(N))continue;const g=h.get(N);if(g){const w=f.get(g);w&&(d.push(w),v.add(N))}else d.push({Id:`synthetic-${N.replace(/\s+/g,"-")}`,Name:y,Type:"Genre"}),v.add(N)}const x=Date.now();return Ie.getState().setGenres(d),Ie.setState({genresLastUpdated:x,genresLastChecked:x}),this.genresCache=d,d}catch(s){return console.error("[getGenres] Failed to build music genres:",s),n.genres.length>0?(this.genresCache=n.genres,n.genres):(this.genresCache=[],[])}}async getYears(t=!1){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=Ie.getState(),r=30*60*1e3;if(!t&&n.years.length>0&&n.yearsLastUpdated){const s=Date.now(),o=n.yearsLastChecked||0;if(!(s-o>=r))return n.years;try{const i=(await this.getRecentlyAdded(50)).Items||[];let u=0;for(const m of i)if(m.DateCreated){const h=new Date(m.DateCreated).getTime();h>u&&(u=h)}if(Ie.setState({yearsLastChecked:s}),u<=n.yearsLastUpdated)return n.years}catch(c){return console.warn("[getYears] Failed to check for new tracks, using cached years:",c),n.years}}try{const s=new Set;let o=0;const a=200;let c=!0;for(;c;){const h=(await this.getSongs({limit:a,startIndex:o})).Items||[];if(h.forEach(f=>{f.ProductionYear&&f.ProductionYear>0&&s.add(f.ProductionYear)}),c=h.length===a,o+=a,o>1e4)break}const i=Array.from(s).sort((m,h)=>m-h),u=Date.now();return Ie.getState().setYears(i),Ie.setState({yearsLastUpdated:u,yearsLastChecked:u}),i}catch(s){return console.error("[getYears] Failed to extract years:",s),n.years.length>0?n.years:[]}}async getGroupings(t=!1){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=Ie.getState(),r=30*60*1e3;if(!t&&n.groupings.length>0&&n.groupingsLastUpdated){const s=Date.now(),o=n.groupingsLastChecked||0;if(!(s-o>=r))return n.groupings;try{const i=(await this.getRecentlyAdded(50)).Items||[];let u=0;for(const m of i)if(m.DateCreated){const h=new Date(m.DateCreated).getTime();h>u&&(u=h)}if(Ie.setState({groupingsLastChecked:s}),u<=n.groupingsLastUpdated)return n.groupings}catch(c){return console.warn("[getGroupings] Failed to check for new tracks, using cached groupings:",c),n.groupings}}try{const s=new Set;let o=0;const a=200;let c=!0;for(;c;){const h=(await this.getSongs({limit:a,startIndex:o})).Items||[];if(h.forEach(f=>{f.Grouping&&f.Grouping.trim()&&s.add(f.Grouping.trim())}),c=h.length===a,o+=a,o>1e4)break}const i=Array.from(s).sort((m,h)=>m.localeCompare(h)),u=Date.now();return Ie.getState().setGroupings(i),Ie.setState({groupingsLastUpdated:u,groupingsLastChecked:u}),i}catch(s){return console.error("[getGroupings] Failed to extract groupings:",s),n.groupings.length>0?n.groupings:[]}}async getGenreSongs(t,n,r=!1){let s=[];if(t.startsWith("synthetic-")||r){let a=0;const c=200;let i=!0;for(;i;){const m=(await this.getSongs({limit:c,startIndex:a},!0)).Items||[];if(s.push(...m),i=m.length===c,a+=c,a>5e4)break}}else{let a=0;const c=200;let i=!0;for(;i;){const m=(await this.getSongs({genreIds:[t],limit:c,startIndex:a})).Items||[];if(s.push(...m),i=m.length===c,a+=c,a>5e4)break}}return s.filter(a=>{var i;return(i=a.Genres)==null?void 0:i.some(u=>u.toLowerCase()===n.toLowerCase())})}async syncLibrary(){this.clearGenresCache();const t=Ie.getState();t.clearGenreSongs();const r=(await this.getGenres(!0)).map(async s=>{if(!(!s.Name||!s.Id))try{const o=await this.getGenreSongs(s.Id,s.Name);t.setGenreSongs(s.Id,o)}catch(o){console.warn(`[syncLibrary] Failed to load songs for genre ${s.Name}:`,o)}});await Promise.all(r)}async search(t,n=20){const r=t?al(t.trim()):"",s=r.length>0,o=r.length,a=s&&o<3,c={limit:n,includeItemTypes:["MusicAlbum","Playlist","Audio"],recursive:!0};s&&(c.searchTerm=r,o>=3&&(c.includeItemTypes=["MusicArtist","MusicAlbum","Playlist","Audio"]));const i=this.buildQueryString(c),u=await this.request(`/Items?${i}`);let m=[];const h=[],f=[],d=[],v=new Set;if(u.Items.forEach(x=>{x.Type==="MusicArtist"?m.push(x):x.Type==="MusicAlbum"?h.push(x):x.Type==="Playlist"?f.push(x):x.Type==="Audio"&&(d.push(x),v.add(x.Id))}),a)try{const x=await this.getArtists({limit:1e3}),N=r.toLowerCase();m=(x.Items||[]).filter(y=>al(y.Name||"").toLowerCase().includes(N))}catch(x){console.error("Failed to fetch all artists for short query:",x)}if(s&&m.length>0){const x=r.toLowerCase(),y=m.filter(w=>al(w.Name||"").toLowerCase().includes(x)).map(w=>this.getArtistItems(w.Id).catch(j=>(console.error(`Failed to fetch songs for artist ${w.Id}:`,j),{albums:[],songs:[]})));(await Promise.all(y)).forEach(({songs:w})=>{w.forEach(j=>{v.has(j.Id)||(d.push(j),v.add(j.Id))})})}return{Artists:{Items:m,TotalRecordCount:m.length,StartIndex:0},Albums:{Items:h,TotalRecordCount:h.length,StartIndex:0},Playlists:{Items:f,TotalRecordCount:f.length,StartIndex:0},Songs:{Items:d,TotalRecordCount:d.length,StartIndex:0}}}async getRecentlyAdded(t=20){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=this.buildQueryString({limit:t,includeItemTypes:["MusicAlbum"],recursive:!0,sortBy:["DateCreated"],sortOrder:"Descending"});return await this.request(`/Items?${n}`)}async getRecentlyPlayed(t=20){if(!this.userId||!this.baseUrl)throw new Error("Not authenticated");const n=new URLSearchParams({Limit:t.toString(),IncludeItemTypes:"Audio",Recursive:"true",SortBy:"DatePlayed",SortOrder:"Descending",Filters:"IsPlayed",UserId:this.userId,Fields:"PrimaryImageAspectRatio,Genres"});return await this.request(`/Items?${n}`)}async getAlbumTracks(t){const n=new URLSearchParams({ParentId:t,IncludeItemTypes:"Audio",SortBy:"IndexNumber",SortOrder:"Ascending",UserId:this.userId,Fields:"PrimaryImageAspectRatio,Genres"});return(await this.request(`/Items?${n}`)).Items}async getArtistItems(t){const n=new URLSearchParams({ArtistIds:t,IncludeItemTypes:"MusicAlbum,Audio",Recursive:"true",UserId:this.userId,Fields:"PrimaryImageAspectRatio,Genres"}),r=await this.request(`/Items?${n}`),s=[],o=[];return r.Items.forEach(a=>{a.Type==="MusicAlbum"?s.push(a):a.Type==="Audio"&&o.push(a)}),{albums:s,songs:o}}async getGenreItems(t,n=50){const r=this.buildQueryString({genreIds:[t],includeItemTypes:["MusicAlbum"],recursive:!0,limit:n,sortBy:["DateCreated"],sortOrder:"Descending"});return this.request(`/Items?${r}`)}async getPlaylists(t={}){const n=this.buildQueryString({...t,includeItemTypes:["Playlist"],recursive:!0});return this.request(`/Items?${n}`)}async markItemAsPlayed(t){if(!this.userId||!this.baseUrl||!t)throw new Error("Not authenticated or invalid item ID");try{await this.request(`/Users/${this.userId}/PlayedItems/${t}`,{method:"POST"})}catch(n){console.warn("Failed to mark item as played:",n)}}async getLyrics(t){if(!this.userId||!this.baseUrl||!t)return null;try{const n=[`/Items/${t}/Lyrics`,`/Items/${t}/RemoteLyrics`,`/Audio/${t}/Lyrics`];let r=null;for(const s of n){const o=new URLSearchParams({UserId:this.userId}),a=`${this.baseUrl}${s}?${o}`;try{const c=await fetch(a,{headers:this.getHeaders()});if(c.ok){const i=await c.json();if(i.Lyrics&&Array.isArray(i.Lyrics)&&i.Lyrics.length>0)return i.Lyrics.map(m=>m.Text||"").join(`
`);if(typeof i=="string")return i;if(i.Text)return i.Text}else if(c.status===404){r=`404 for ${s}`;continue}else{const i=await c.text().catch(()=>"");r=`${c.status}: ${i}`;continue}}catch(c){r=c instanceof Error?c.message:String(c);continue}}return null}catch(n){return console.warn("[getLyrics] Failed to fetch lyrics:",n),null}}}const _=new dx,Li=Ss()(Jl(e=>({serverUrl:"",username:"",accessToken:"",userId:"",isAuthenticated:!1,login:async(t,n,r)=>{try{const s=await _.authenticate(t,n,r);e({serverUrl:t,username:n,accessToken:s.AccessToken,userId:s.User.Id,isAuthenticated:!0}),_.setCredentials(t,s.AccessToken,s.User.Id)}catch(s){throw s}},logout:()=>{e({serverUrl:"",username:"",accessToken:"",userId:"",isAuthenticated:!1}),ys.remove("auth-storage")},setCredentials:(t,n,r)=>{e({serverUrl:t,accessToken:n,userId:r,isAuthenticated:!0}),_.setCredentials(t,n,r)}}),{name:"auth-storage",onRehydrateStorage:()=>e=>{e!=null&&e.isAuthenticated&&e.serverUrl&&e.accessToken&&e.userId&&_.setCredentials(e.serverUrl,e.accessToken,e.userId)}})),ks=Ss()(Jl(e=>({serverUrl:"",setServerUrl:t=>e({serverUrl:t}),pageVisibility:{artists:!0,albums:!0,songs:!0,genres:!0,playlists:!0},setPageVisibility:t=>e(n=>({pageVisibility:{...n.pageVisibility,...t}})),accentColor:"blue",setAccentColor:t=>e({accentColor:t}),enableQueueRecommendations:!0,setEnableQueueRecommendations:t=>e({enableQueueRecommendations:t})}),{name:"settings-storage"})),au="last-server-url";function fx(){const[e,t]=p.useState(""),[n,r]=p.useState(""),[s,o]=p.useState(""),[a,c]=p.useState(""),[i,u]=p.useState(!1),m=Li(f=>f.login);p.useEffect(()=>{const f=ys.get(au);f&&t(f)},[]);const h=async f=>{f.preventDefault(),c(""),u(!0),e.trim()&&ys.set(au,e.trim());try{await m(e,n,s)}catch(d){c(d instanceof Error?d.message:"Login failed. Please check your credentials.")}finally{u(!1)}};return l.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Tunetuna"}),l.jsx("p",{className:"text-gray-400",children:"Sign in to your Jellyfin server"})]}),l.jsxs("form",{onSubmit:h,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"serverUrl",className:"block text-sm font-medium text-gray-300 mb-2",children:"Server URL"}),l.jsx("input",{id:"serverUrl",type:"url",value:e,onChange:f=>t(f.target.value),placeholder:"https://your-server.com",required:!0,className:"w-full px-4 py-3 bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)] focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-300 mb-2",children:"Username"}),l.jsx("input",{id:"username",type:"text",value:n,onChange:f=>r(f.target.value),placeholder:"Your username",required:!0,className:"w-full px-4 py-3 bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)] focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),l.jsx("input",{id:"password",type:"password",value:s,onChange:f=>o(f.target.value),placeholder:"Your password",required:!0,className:"w-full px-4 py-3 bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)] focus:border-transparent"})]}),a&&l.jsx("div",{className:"bg-red-900/30 border border-red-800 text-red-200 px-4 py-3 rounded-lg text-sm whitespace-pre-wrap",children:a}),l.jsx("button",{type:"submit",disabled:i,className:"w-full bg-[var(--accent-color)] hover:brightness-90 disabled:bg-gray-700 disabled:cursor-not-allowed text-white font-semibold py-3 px-4 rounded-lg transition-colors",children:i?"Signing in...":"Sign In"})]})]})})}/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),hx=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),iu=e=>{const t=hx(e);return t.charAt(0).toUpperCase()+t.slice(1)},Qf=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim(),px=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var gx={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=p.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:o,iconNode:a,...c},i)=>p.createElement("svg",{ref:i,...gx,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:Qf("lucide",s),...!o&&!px(c)&&{"aria-hidden":"true"},...c},[...a.map(([u,m])=>p.createElement(u,m)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=(e,t)=>{const n=p.forwardRef(({className:r,...s},o)=>p.createElement(xx,{ref:o,iconNode:t,className:Qf(`lucide-${mx(iu(e))}`,`lucide-${e}`,r),...s}));return n.displayName=iu(e),n};/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],zn=we("arrow-left",yx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vx=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],bs=we("arrow-up-down",vx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],_i=we("calendar",wx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],zi=we("chevron-down",Nx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ix=we("chevron-left",jx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],kx=we("chevron-right",Sx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Vf=we("chevron-up",bx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Ge=we("disc",Cx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ax=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Di=we("ellipsis",Ax);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ex=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],Px=we("github",Ex);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tx=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],Rx=we("grip-horizontal",Tx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mx=[["path",{d:"m11.9 12.1 4.514-4.514",key:"109xqo"}],["path",{d:"M20.1 2.3a1 1 0 0 0-1.4 0l-1.114 1.114A2 2 0 0 0 17 4.828v1.344a2 2 0 0 1-.586 1.414A2 2 0 0 1 17.828 7h1.344a2 2 0 0 0 1.414-.586L21.7 5.3a1 1 0 0 0 0-1.4z",key:"txyc8t"}],["path",{d:"m6 16 2 2",key:"16qmzd"}],["path",{d:"M8.23 9.85A3 3 0 0 1 11 8a5 5 0 0 1 5 5 3 3 0 0 1-1.85 2.77l-.92.38A2 2 0 0 0 12 18a4 4 0 0 1-4 4 6 6 0 0 1-6-6 4 4 0 0 1 4-4 2 2 0 0 0 1.85-1.23z",key:"1de1vg"}]],Gn=we("guitar",Mx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lx=[["path",{d:"M19.414 14.414C21 12.828 22 11.5 22 9.5a5.5 5.5 0 0 0-9.591-3.676.6.6 0 0 1-.818.001A5.5 5.5 0 0 0 2 9.5c0 2.3 1.5 4 3 5.5l5.535 5.362a2 2 0 0 0 2.879.052 2.12 2.12 0 0 0-.004-3 2.124 2.124 0 1 0 3-3 2.124 2.124 0 0 0 3.004 0 2 2 0 0 0 0-2.828l-1.881-1.882a2.41 2.41 0 0 0-3.409 0l-1.71 1.71a2 2 0 0 1-2.828 0 2 2 0 0 1 0-2.828l2.823-2.762",key:"17lmqv"}]],_x=we("heart-handshake",Lx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zx=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Dx=we("house",zx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ox=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M16 12H3",key:"1a2rj7"}],["path",{d:"M9 19H3",key:"s61nz1"}],["path",{d:"m16 16-3 3 3 3",key:"117b85"}],["path",{d:"M21 5v12a2 2 0 0 1-2 2h-6",key:"hey24a"}]],Dt=we("list-end",Ox);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $x=[["path",{d:"M16 5H3",key:"m91uny"}],["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M11 19H3",key:"zflm78"}],["path",{d:"M21 16V5",key:"yxg4q8"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Fx=we("list-music",$x);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ux=[["path",{d:"M3 5h6",key:"1ltk0q"}],["path",{d:"M3 12h13",key:"ppymz1"}],["path",{d:"M3 19h13",key:"bpdczq"}],["path",{d:"m16 8-3-3 3-3",key:"1pjpp6"}],["path",{d:"M21 19V7a2 2 0 0 0-2-2h-6",key:"4zzq67"}]],Vs=we("list-start",Ux);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bx=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M10 12H3",key:"1ulcyk"}],["path",{d:"M10 19H3",key:"108z41"}],["path",{d:"M15 12.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997a1 1 0 0 1-1.517-.86z",key:"ms4nik"}]],Gx=we("list-video",Bx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Qx=we("log-out",Hx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=[["path",{d:"m11 7.601-5.994 8.19a1 1 0 0 0 .1 1.298l.817.818a1 1 0 0 0 1.314.087L15.09 12",key:"80a601"}],["path",{d:"M16.5 21.174C15.5 20.5 14.372 20 13 20c-2.058 0-3.928 2.356-6 2-2.072-.356-2.775-3.369-1.5-4.5",key:"j0ngtp"}],["circle",{cx:"16",cy:"7",r:"5",key:"d08jfb"}]],Wx=we("mic-vocal",Vx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],qx=we("music",Yx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],bn=we("pause",Kx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],st=we("play",Xx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jx=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Xr=we("refresh-cw",Jx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zx=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}],["path",{d:"M11 10h1v4",key:"70cz1p"}]],Wf=we("repeat-1",Zx);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Yf=we("repeat",e0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],n0=we("settings",t0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],Dn=we("shuffle",r0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],qf=we("skip-back",s0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],Oi=we("skip-forward",l0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}],["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}]],a0=we("square-play",o0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],tt=we("user",i0);/**
 * @license lucide-react v0.560.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],u0=we("x",c0),d0=[{path:"/",label:"Home",icon:Dx,key:"home"},{path:"/artists",label:"Artists",icon:tt,key:"artists"},{path:"/albums",label:"Albums",icon:Ge,key:"albums"},{path:"/songs",label:"Songs",icon:qx,key:"songs"},{path:"/genres",label:"Genres",icon:Gn,key:"genres"},{path:"/playlists",label:"Playlists",icon:Fx,key:"playlists"}];function f0(){const e=en(),{pageVisibility:t}=ks(),n=d0.filter(s=>s.key==="home"?!0:t[s.key]),r=(s,o)=>{window.dispatchEvent(new CustomEvent("closePlayerModal")),e.pathname===o&&s.preventDefault()};return l.jsx("nav",{className:"fixed left-0 right-0 bg-zinc-900 border-t border-zinc-800 z-40",style:{bottom:"calc(env(safe-area-inset-bottom) - 8px)"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsx("div",{className:"flex justify-around items-center h-16",children:n.map(s=>{const o=e.pathname===s.path,a=s.icon;return l.jsxs(Pg,{to:s.path,onClick:c=>r(c,s.path),className:`flex flex-col items-center justify-center flex-1 h-full transition-colors ${o?"text-[var(--accent-color)]":"text-gray-400 hover:text-gray-300"}`,children:[l.jsx(a,{className:"w-5 h-5 mb-1"}),l.jsx("span",{className:"text-xs font-medium",children:s.label})]},s.path)})})})})}const pr=new Set,Vt=new Map;function Dr(e,t,n=5e3){var a;const r=pe.getState().queue;r.find(c=>c.Id===e)&&((a=r.find(c=>c.Id===e))==null||a._isRecommended);const s=Vt.get(e);if(s&&clearTimeout(s),pr.has(e))return;const o=setTimeout(async()=>{var i;const c=t();if((c==null?void 0:c.Id)===e)try{const u=pe.getState().queue,m=u.find(h=>h.Id===e)?(i=u.find(h=>h.Id===e))==null?void 0:i._isRecommended:!1;await _.markItemAsPlayed(e),pr.add(e),setTimeout(()=>{window.dispatchEvent(new CustomEvent("trackPlayed",{detail:{trackId:e}}))},4e3)}catch{}Vt.delete(e)},n);Vt.set(e,o)}function m0(e){pr.add(e);const t=Vt.get(e);t&&(clearTimeout(t),Vt.delete(e))}function Ut(e){const t=[...e];for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}const pe=Ss()(Jl((e,t)=>({currentTrack:null,lastPlayedTrack:null,queue:[],originalQueue:[],shuffledOrder:[],recommendations:[],previousSongs:[],playedSongIds:[],collectionStartIndex:-1,currentIndex:-1,isPlaying:!1,currentTime:0,duration:0,volume:1,shuffle:!1,repeat:"off",audioElement:null,manuallyCleared:!1,isFetchingRecommendations:!1,setAudioElement:n=>{e({audioElement:n}),n&&(n.volume=t().volume)},setIsFetchingRecommendations:n=>{e({isFetchingRecommendations:n})},setCurrentTrack:n=>{var a,c;const r=t().currentTrack,s=t().queue;if(r&&s.find(i=>i.Id===r.Id)&&((a=s.find(i=>i.Id===r.Id))==null||a._isRecommended),n&&s.find(i=>i.Id===n.Id)&&((c=s.find(i=>i.Id===n.Id))==null||c._isRecommended),r&&n&&r.Id!==n.Id)if(pr.has(r.Id)){const i=Vt.get(r.Id);i&&(clearTimeout(i),Vt.delete(r.Id))}else{const i=Vt.get(r.Id);i&&(clearTimeout(i),Vt.delete(r.Id)),pr.add(r.Id),_.markItemAsPlayed(r.Id).then(()=>{setTimeout(()=>{window.dispatchEvent(new CustomEvent("trackPlayed",{detail:{trackId:r.Id}}))},4e3)}).catch(u=>{pr.delete(r.Id)})}n?(e({currentTrack:n,lastPlayedTrack:n}),(!r||r.Id!==n.Id)&&Ie.getState().addToRecentlyPlayed(n)):e({currentTrack:n});const o=t().audioElement;if(o&&n){const i=_.serverBaseUrl,u=i?`${i}/Audio/${n.Id}/stream?static=true`:"";o.src!==u&&(o.src=u,o.load())}},setQueue:n=>{const r=n.map(s=>({...s,_isRecommended:!1}));e({queue:r,originalQueue:[...r],shuffledOrder:[...r],manuallyCleared:!0,playedSongIds:[]})},addToQueue:(n,r=!1)=>{e(s=>{const o=n.map(f=>({...f,_isRecommended:r})),a=s.shuffle?s.shuffledOrder||[]:s.originalQueue||[];let c,i,u,m;if(r)m=[...s.recommendations,...o],c=[...a,...m],i=[...s.originalQueue],u=[...s.shuffledOrder];else{const f=new Set([...s.originalQueue.map(v=>v.Id)]),d=o.filter(v=>!f.has(v.Id));if(i=[...s.originalQueue,...d],s.shuffle){let v;if(s.currentIndex>=0&&s.currentTrack){const x=i.findIndex(N=>{var y;return N.Id===((y=s.currentTrack)==null?void 0:y.Id)});if(x>=0){const N=i.slice(0,x+1),y=i.slice(x+1),g=Ut(y);v=[...N,...g]}else v=Ut(i)}else v=Ut(i);u=v,c=[...v,...s.recommendations]}else u=[...i],c=[...i,...s.recommendations];m=[...s.recommendations]}let h=s.currentIndex;if(!r&&s.currentIndex>=0&&s.shuffle&&s.currentTrack){const f=c.findIndex(d=>{var v;return d.Id===((v=s.currentTrack)==null?void 0:v.Id)});f>=0&&(h=f)}return{queue:c,originalQueue:i,shuffledOrder:u,recommendations:m,currentIndex:h,manuallyCleared:r?s.manuallyCleared:!1}})},removeFromQueue:n=>{e(r=>{const s=[...r.queue],o=s[n];s.splice(n,1);const a=o&&o._isRecommended;let c=[...r.originalQueue],i=[...r.shuffledOrder],u=[...r.recommendations];if(o){const d=c.findIndex(x=>x.Id===o.Id);d>=0&&c.splice(d,1);const v=i.findIndex(x=>x.Id===o.Id);if(v>=0&&i.splice(v,1),a){const x=u.findIndex(N=>N.Id===o.Id);x>=0&&u.splice(x,1)}}const h=[...r.shuffle?i:c,...u];let f=r.currentIndex;if(n<r.currentIndex?f=r.currentIndex-1:n===r.currentIndex&&h.length>0&&(f=Math.min(r.currentIndex,h.length-1)),r.currentTrack){const d=h.findIndex(v=>{var x;return v.Id===((x=r.currentTrack)==null?void 0:x.Id)});d>=0&&(f=d)}return{queue:h,originalQueue:c,shuffledOrder:i,recommendations:u,currentIndex:f,manuallyCleared:!0}})},clearQueue:()=>{e({queue:[],originalQueue:[],shuffledOrder:[],recommendations:[],previousSongs:[],playedSongIds:[],collectionStartIndex:-1,currentIndex:-1,manuallyCleared:!0})},play:()=>{const n=t().audioElement,r=t().currentTrack;if(n&&r){if(!n.src){const s=_.serverBaseUrl,o=s?`${s}/Audio/${r.Id}/stream?static=true`:"";n.src=o,n.load()}n.play().then(()=>{e({isPlaying:!0}),r&&Dr(r.Id,()=>t().currentTrack)}).catch(s=>{console.error("Playback error:",s),e({isPlaying:!1})})}},pause:()=>{const n=t().audioElement;n&&(n.pause(),e({isPlaying:!1}))},togglePlayPause:()=>{const{isPlaying:n,play:r,pause:s}=t();n?s():r()},next:()=>{const{queue:n,currentIndex:r,repeat:s,shuffle:o,currentTrack:a}=t();if(n.length===0)return;let c=r+1;if(r===-1&&n.length>0){if(!a&&n.length>1)c=1;else if(a){const m=n.findIndex(h=>h.Id===a.Id);m>=0&&(c=m+1)}}if(c>=n.length)if(s==="all")c=0;else return;if(o&&c<n.length){const m=n[c];if(m&&m._isRecommended){const f=n.filter(N=>!N._isRecommended),{playedSongIds:d}=t(),v=new Set(d);if(f.filter(N=>{var y;return!v.has(N.Id)&&N.Id!==((y=t().currentTrack)==null?void 0:y.Id)}).length>0){let N=-1;N=n.findIndex((y,g)=>{var w;return g>r&&!y._isRecommended&&!v.has(y.Id)&&y.Id!==((w=t().currentTrack)==null?void 0:w.Id)}),N===-1&&(N=n.findIndex((y,g)=>{var w;return!y._isRecommended&&!v.has(y.Id)&&y.Id!==((w=t().currentTrack)==null?void 0:w.Id)})),N>=0&&(c=N)}}}e(m=>{const h=[...m.queue],f=[...m.previousSongs];let d=[...m.playedSongIds],v=[...m.originalQueue],x=c;if(o){let y=m.currentIndex;if(y<0&&m.currentTrack&&(y=h.findIndex(g=>{var w;return g.Id===((w=m.currentTrack)==null?void 0:w.Id)})),y>=0&&y<h.length){const g=h[y];g&&(f.some(w=>w.Id===g.Id)||(f.unshift(g),f.length>10&&f.pop()),d.includes(g.Id)||d.push(g.Id))}if(y>=0&&c!==y+1&&c!==0){const g=Math.min(y+1,c),w=Math.max(y+1,c);for(let j=g;j<w&&j<h.length;j++){const S=h[j];S&&!d.includes(S.Id)&&d.push(S.Id)}}x=c}else if(m.currentIndex>=0&&m.currentIndex<h.length){const y=h.length===1,g=s==="all"&&c===0&&m.currentIndex===h.length-1,w=h[m.currentIndex];if(!y||!g){if(w){f.unshift(w),f.length>10&&f.pop();const j=v.findIndex(S=>S.Id===w.Id);j>=0&&v.splice(j,1)}h.splice(m.currentIndex,1),m.currentIndex<c?x=c-1:m.currentIndex===c&&c>=h.length&&(x=s==="all"?0:Math.max(0,h.length-1))}}x>=h.length&&(x=s==="all"&&h.length>0?0:Math.max(0,h.length-1)),x<0&&(x=0);const N=h.filter((y,g)=>y._isRecommended&&g>x);return{queue:h,originalQueue:v,previousSongs:f,playedSongIds:d,currentIndex:x,recommendations:N}});const i=t(),u=i.queue[i.currentIndex];u?(t().setCurrentTrack(u),t().play()):console.error("[Shuffle] next() - trackToPlay is null! This is the stuck state.",{currentIndex:i.currentIndex,queueLength:i.queue.length,queue:i.queue})},previous:()=>{const{queue:n,previousSongs:r,currentIndex:s,currentTrack:o}=t();if(r.length>0&&(s<=0||n.length===0)){const i=r[0];i&&(e(u=>{const m=[...u.queue],h=[...u.previousSongs];let f=[...u.originalQueue];const d=h.shift();return m.unshift(d),f.some(v=>v.Id===d.Id)||f.unshift(d),{queue:m,originalQueue:f,previousSongs:h,currentIndex:0}}),t().setCurrentTrack(i),t().play());return}if(n.length===0)return;let a=s-1;a<0&&(a=n.length-1);const c=n[a];c?(e({currentIndex:a}),t().setCurrentTrack(c),t().play()):console.error("[Shuffle] previous() - prevTrack is null! This is the stuck state.",{prevIndex:a,currentIndex:s,queueLength:n.length,queue:n})},seek:n=>{const r=t().audioElement;r&&(r.currentTime=n,e({currentTime:n}))},setCurrentTime:n=>{e({currentTime:n})},setDuration:n=>{e({duration:n})},setVolume:n=>{e({volume:n});const r=t().audioElement;r&&(r.volume=n)},toggleShuffle:()=>{e(n=>{const r=!n.shuffle,s=n.currentTrack;if(r){let o=-1;s&&(o=n.originalQueue.findIndex(u=>u.Id===s.Id));let a;if(o>=0){let u,m=[];if(n.collectionStartIndex>0){u=n.originalQueue.slice(n.collectionStartIndex);const h=u.findIndex(f=>f.Id===s.Id);if(h>=0){m=u.slice(0,h+1);const f=u.slice(h+1),d=Ut(f);a=[...m,...d]}else a=Ut(u)}else{m=n.originalQueue.slice(0,o+1);const h=n.originalQueue.slice(o+1),f=Ut(h);a=[...m,...f]}}else n.originalQueue.length>0?a=Ut(n.originalQueue):a=[];const c=[...a,...n.recommendations];console.log("[toggleShuffle] Final shuffled queue:",{finalQueueLength:c.length,shuffledSongs:a.length,recommendations:n.recommendations.length});let i=n.currentIndex;if(s){const u=c.findIndex(m=>m.Id===s.Id);u>=0&&(i=u)}return{shuffle:r,shuffledOrder:a,queue:c,currentIndex:i}}else{let o=n.originalQueue;n.collectionStartIndex>0&&(o=n.originalQueue.slice(n.collectionStartIndex));const a=[...o,...n.recommendations];let c=0;if(s){const i=a.findIndex(u=>u.Id===s.Id);i>=0&&(c=i)}return{shuffle:r,queue:a,shuffledOrder:[...o],currentIndex:c,playedSongIds:[]}}})},toggleRepeat:()=>{e(n=>({repeat:n.repeat==="off"?"all":n.repeat==="all"?"one":"off"}))},playTrack:(n,r)=>{const s=t().queue,o=t().shuffle,a=s.some(N=>N.Id===n.Id),c=r||[n],i=r?[...c].sort((N,y)=>{const g=N.ParentIndexNumber??1,w=y.ParentIndexNumber??1;if(g!==w)return g-w;const j=N.IndexNumber??0,S=y.IndexNumber??0;return j-S}):c,u=i.findIndex(N=>N.Id===n.Id);let m,h=[],f=-1;r&&r.length>1?o?(m=i,f=u):(m=i.slice(u),h=i.slice(0,u).reverse(),f=0):(m=i,f=-1);const d=m.map(N=>({...N,_isRecommended:!1})),v=d.findIndex(N=>N.Id===n.Id);e({queue:d,originalQueue:[...d],shuffledOrder:[...d],recommendations:[],collectionStartIndex:f,currentIndex:v>=0?v:0,manuallyCleared:!1,previousSongs:a?t().previousSongs:h});const x=t().audioElement;if(x){const N=_.serverBaseUrl,y=N?`${N}/Audio/${n.Id}/stream?static=true`:"";x.src=y,x.load(),t().setCurrentTrack(n),x.play().then(()=>{e({isPlaying:!0}),Dr(n.Id,()=>t().currentTrack)}).catch(g=>{console.error("Playback error:",g),e({isPlaying:!1})})}},playAlbum:n=>{if(n.length===0)return;const r=[...n],s=r.map(c=>({...c,_isRecommended:!1})),o=r[0];e({queue:s,originalQueue:[...s],shuffledOrder:[...s],recommendations:[],collectionStartIndex:0,currentIndex:0,manuallyCleared:!1,previousSongs:[],playedSongIds:[],shuffle:!1});const a=t().audioElement;if(a){const c=_.serverBaseUrl,i=c?`${c}/Audio/${o.Id}/stream?static=true`:"";a.src=i,a.load(),t().setCurrentTrack(o),a.play().then(()=>{e({isPlaying:!0}),Dr(o.Id,()=>t().currentTrack)}).catch(u=>{console.error("Playback error:",u),e({isPlaying:!1})})}},playNext:n=>{n.length!==0&&e(r=>{const s=n.map(h=>({...h,_isRecommended:!1})),o=r.currentIndex;let a,c,i,u=o;const m=o>=0&&o<r.originalQueue.length?o+1:r.originalQueue.length;if(c=[...r.originalQueue],c.splice(m,0,...s),n.length===1)if(r.shuffle){const h=r.shuffledOrder.findIndex(f=>{var d;return f.Id===((d=r.currentTrack)==null?void 0:d.Id)});if(h>=0){const f=r.shuffledOrder.slice(0,h+1),d=r.shuffledOrder.slice(h+1);i=[...f,...s,...d]}else i=[...r.shuffledOrder,...s];a=[...i,...r.recommendations]}else i=[...c],a=[...c,...r.recommendations];else if(r.shuffle){const h=Ut(s),f=r.shuffledOrder.findIndex(d=>{var v;return d.Id===((v=r.currentTrack)==null?void 0:v.Id)});if(f>=0){const d=r.shuffledOrder.slice(0,f+1),v=r.shuffledOrder.slice(f+1);i=[...d,...h,...v]}else i=[...r.shuffledOrder,...h];a=[...i,...r.recommendations]}else i=[...c],a=[...c,...r.recommendations];if(r.currentTrack){const h=a.findIndex(f=>{var d;return f.Id===((d=r.currentTrack)==null?void 0:d.Id)});h>=0&&(u=h)}return{queue:a,originalQueue:c,shuffledOrder:i,currentIndex:u,manuallyCleared:!1}})},shuffleArtist:n=>{if(n.length===0)return;const r=Ut(n),s=r.map(c=>({...c,_isRecommended:!1})),o=r[0];e({queue:s,originalQueue:[...s],shuffledOrder:[...s],recommendations:[],currentIndex:0,manuallyCleared:!1,previousSongs:[],playedSongIds:[],shuffle:!1});const a=t().audioElement;if(a){const c=_.serverBaseUrl,i=c?`${c}/Audio/${o.Id}/stream?static=true`:"";a.src=i,a.load(),t().setCurrentTrack(o),a.play().then(()=>{e({isPlaying:!0}),Dr(o.Id,()=>t().currentTrack)}).catch(u=>{console.error("Playback error:",u),e({isPlaying:!1})})}},reorderQueue:(n,r)=>{e(s=>{const o=[...s.queue],[a]=o.splice(n,1);let c=r;n<r&&(c=Math.max(0,r-1)),o.splice(c,0,a);let i=[];if(s.shuffle){const m=new Map(s.originalQueue.map(h=>[h.Id,h]));for(const h of o){const f=m.get(h.Id);f&&i.push(f)}for(const h of s.originalQueue)o.some(f=>f.Id===h.Id)||i.push(h)}else i=[...o];let u=s.currentIndex;return s.currentIndex===n?u=c:n<s.currentIndex&&r>=s.currentIndex?u=s.currentIndex-1:n>s.currentIndex&&r<=s.currentIndex&&(u=s.currentIndex+1),{queue:o,originalQueue:i,currentIndex:u}})},skipToTrack:n=>{const{queue:r,originalQueue:s}=t();if(n<0||n>=r.length)return;const o=r.slice(n),a=o[0];let c=[...s];if(a){const m=c.findIndex(h=>h.Id===a.Id);m>=0&&(c=c.slice(m))}const i=o.filter((m,h)=>m._isRecommended&&h>0);e({queue:o,originalQueue:c,recommendations:i,currentIndex:0,manuallyCleared:!1,previousSongs:[]});const u=t().audioElement;if(u&&a){const m=_.serverBaseUrl,h=m?`${m}/Audio/${a.Id}/stream?static=true`:"";u.src=h,u.load(),e({currentTrack:a,lastPlayedTrack:a}),u.play().then(()=>{e({isPlaying:!0}),Dr(a.Id,()=>t().currentTrack)}).catch(f=>{console.error("Playback error:",f),e({isPlaying:!1})})}},refreshCurrentTrack:async()=>{const n=t().currentTrack;if(n!=null&&n.Id)try{const r=await _.getSongById(n.Id);if(r){e({currentTrack:r});const s=t().queue,o=t().originalQueue,a=s.findIndex(i=>i.Id===n.Id),c=o.findIndex(i=>i.Id===n.Id);if(a>=0||c>=0){const i=a>=0?[...s]:s,u=c>=0?[...o]:o;a>=0&&(i[a]={...i[a],...r}),c>=0&&(u[c]={...u[c],...r}),e({queue:i,originalQueue:u})}}}catch(r){console.error("Failed to refresh current track:",r)}}}),{name:"player-storage",partialize:e=>({volume:e.volume,shuffle:e.shuffle,repeat:e.repeat,lastPlayedTrack:e.lastPlayedTrack})}));function lt({src:e,alt:t,className:n="",fallback:r,style:s,showOutline:o,rounded:a="rounded",onError:c}){const[i,u]=p.useState(e),[m,h]=p.useState(!1),[f,d]=p.useState(!1);p.useEffect(()=>{u(e),h(!1),d(!1)},[e]);const v=()=>{!m&&r?(u(r),h(!0)):c?(c(),d(!0)):u('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="300" height="300"%3E%3Crect fill="%23333" width="300" height="300"/%3E%3Ctext fill="%23999" font-family="sans-serif" font-size="20" dy="10.5" font-weight="bold" x="50%25" y="50%25" text-anchor="middle"%3ENo Image%3C/text%3E%3C/svg%3E')};return f?null:l.jsxs("div",{className:"relative w-full h-full",children:[l.jsx("img",{src:i,alt:t,className:`block ${n}`,onError:v,loading:"lazy",style:s}),o&&l.jsx("div",{className:`absolute inset-0 pointer-events-none border ${a}`,style:{borderColor:"rgba(24, 24, 27, 0.6)",borderWidth:"1px"}})]})}function tn(){return l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}function Kf({isOpen:e,onClose:t,children:n,zIndex:r=110}){const[s,o]=p.useState(!1),[a,c]=p.useState(!1);if(p.useEffect(()=>{if(e)o(!1),c(!0),requestAnimationFrame(()=>{requestAnimationFrame(()=>{o(!0)})}),document.body.style.overflow="hidden";else{o(!1);const u=setTimeout(()=>{c(!1),document.body.style.overflow=""},300);return()=>{clearTimeout(u),document.body.style.overflow=""}}},[e]),!a)return null;const i=l.jsxs("div",{className:"fixed inset-0",style:{zIndex:r},children:[l.jsx("div",{className:`absolute inset-0 bg-black/50 transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`,onClick:t}),l.jsx("div",{className:`absolute bottom-0 left-0 right-0 bg-zinc-900 rounded-t-2xl shadow-2xl transform transition-transform duration-300 ease-out ${s?"translate-y-0":"translate-y-full"}`,onClick:u=>u.stopPropagation(),children:l.jsx("div",{className:"pb-safe pt-4",children:l.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:n})})})]});return Yn.createPortal(i,document.body)}const Zl=Ss((e,t)=>({state:"idle",source:null,message:null,abortController:null,startSync:(n,r="Syncing...")=>{const s=new AbortController;e({state:"syncing",source:n,message:r,abortController:s})},completeSync:(n,r)=>{e({state:n?"success":"error",message:r||(n?"Sync complete":"Sync failed"),abortController:null}),setTimeout(()=>{t().reset()},3e3)},cancelSync:()=>{const{abortController:n}=t();n&&n.abort(),e({state:"idle",source:null,message:null,abortController:null})},reset:()=>{e({state:"idle",source:null,message:null,abortController:null})}}));function Be({item:e,itemType:t,isOpen:n,onClose:r,zIndex:s,onNavigate:o}){const a=$e(),[c,i]=p.useState(!1),[u,m]=p.useState(null),{playTrack:h,playAlbum:f,addToQueue:d,playNext:v,shuffleArtist:x,toggleShuffle:N}=pe(),{startSync:y,completeSync:g}=Zl(),{genres:w}=Ie();if(!e||!t)return null;const j=E=>{if(!E)return null;const M=w.find(U=>{var q;return((q=U.Name)==null?void 0:q.toLowerCase())===E.toLowerCase()});return(M==null?void 0:M.Id)||null},S=async E=>{var M,U,q,se,X;if(e){if(E.startsWith("goTo")){if(r(),o&&o(),E==="goToArtist"){const F=((U=(M=e.ArtistItems)==null?void 0:M[0])==null?void 0:U.Id)||((se=(q=e.AlbumArtists)==null?void 0:q[0])==null?void 0:se.Id);F&&a(`/artist/${F}`)}else if(E==="goToAlbum")e.AlbumId&&a(`/album/${e.AlbumId}`);else if(E==="goToGenre"){const F=(X=e.Genres)==null?void 0:X[0];if(F){const Z=j(F);if(Z)a(`/genre/${Z}`);else{const T=(await _.getGenres()).find(Q=>{var L;return((L=Q.Name)==null?void 0:L.toLowerCase())===F.toLowerCase()});T!=null&&T.Id&&a(`/genre/${T.Id}`)}}}return}i(!0),m(E);try{switch(t){case"album":{if(E==="play"){const F=await _.getAlbumTracks(e.Id),{shuffle:Z}=pe.getState();Z&&N(),f(F)}else if(E==="shuffle"){const F=await _.getAlbumTracks(e.Id),{shuffle:Z}=pe.getState();Z&&N(),f(F),requestAnimationFrame(()=>{const{shuffle:H}=pe.getState();H||N()})}else if(E==="playNext"){const F=await _.getAlbumTracks(e.Id);v(F)}else if(E==="addToQueue"){const F=await _.getAlbumTracks(e.Id);d(F)}else if(E==="sync"){y("context-menu",`Syncing ${e.Name}...`);try{await _.getAlbumTracks(e.Id),g(!0,`${e.Name} synced`)}catch{g(!1,`Failed to sync ${e.Name}`)}}break}case"song":{if(E==="play")h(e);else if(E==="playNext")v([e]);else if(E==="addToQueue")d([e]);else if(E==="sync"){y("context-menu",`Syncing ${e.Name}...`);try{await _.getSongById(e.Id),g(!0,`${e.Name} synced`)}catch{g(!1,`Failed to sync ${e.Name}`)}}break}case"artist":{if(E==="shuffle"){const{songs:F}=await _.getArtistItems(e.Id);x(F)}else if(E==="playNext"){const{songs:F}=await _.getArtistItems(e.Id);v(F)}else if(E==="addToQueue"){const{songs:F}=await _.getArtistItems(e.Id);d(F)}else if(E==="sync"){y("context-menu",`Syncing ${e.Name}...`);try{await _.getArtistItems(e.Id),g(!0,`${e.Name} synced`)}catch{g(!1,`Failed to sync ${e.Name}`)}}break}case"playlist":{if(E==="play"){const F=await _.getAlbumTracks(e.Id),{shuffle:Z}=pe.getState();Z&&N(),f(F)}else if(E==="shuffle"){const F=await _.getAlbumTracks(e.Id),{shuffle:Z}=pe.getState();Z&&N(),f(F),requestAnimationFrame(()=>{const{shuffle:H}=pe.getState();H||N()})}else if(E==="playNext"){const F=await _.getAlbumTracks(e.Id);v(F)}else if(E==="addToQueue"){const F=await _.getAlbumTracks(e.Id);d(F)}break}}r()}catch(F){console.error("Context menu action failed:",F)}finally{i(!1),m(null)}}},k=(()=>{var E,M,U,q,se,X,F,Z;switch(t){case"album":{const H=((M=(E=e.ArtistItems)==null?void 0:E[0])==null?void 0:M.Name)||((q=(U=e.AlbumArtists)==null?void 0:U[0])==null?void 0:q.Name)||"Artist",T=((se=e.Genres)==null?void 0:se[0])||"Genre";return[{id:"play",label:"Play",icon:st},{id:"shuffle",label:"Shuffle",icon:Dn},{id:"playNext",label:"Play Next",icon:Vs},{id:"addToQueue",label:"Add to Queue",icon:Dt},{id:"goToArtist",label:`Go to ${H}`,icon:tt},{id:"goToGenre",label:`Go to ${T}`,icon:Gn},{id:"sync",label:"Sync",icon:Xr}]}case"song":{const H=((F=(X=e.ArtistItems)==null?void 0:X[0])==null?void 0:F.Name)||e.AlbumArtist||"Artist",T=e.Album||"Album",Q=((Z=e.Genres)==null?void 0:Z[0])||"Genre";return[{id:"play",label:"Play",icon:st},{id:"playNext",label:"Play Next",icon:Vs},{id:"addToQueue",label:"Add to Queue",icon:Dt},{id:"goToArtist",label:`Go to ${H}`,icon:tt},{id:"goToAlbum",label:`Go to ${T}`,icon:Ge},{id:"goToGenre",label:`Go to ${Q}`,icon:Gn},{id:"sync",label:"Sync",icon:Xr}]}case"artist":return[{id:"shuffle",label:"Shuffle",icon:Dn},{id:"playNext",label:"Play Next",icon:Vs},{id:"addToQueue",label:"Add to Queue",icon:Dt},{id:"sync",label:"Sync",icon:Xr}];case"playlist":return[{id:"play",label:"Play",icon:st},{id:"shuffle",label:"Shuffle",icon:Dn},{id:"playNext",label:"Play Next",icon:Vs},{id:"addToQueue",label:"Add to Queue",icon:Dt}];default:return[]}})(),A=e.Name||"Unknown";return l.jsx(Kf,{isOpen:n,onClose:r,zIndex:s,children:l.jsxs("div",{className:"pb-6",children:[l.jsx("div",{className:"mb-4 ml-4",children:l.jsx("div",{className:"text-lg font-semibold text-white break-words",children:A})}),l.jsx("div",{className:"space-y-1",children:k.map(E=>{const M=E.icon,U=c&&u===E.id;return l.jsxs("button",{onClick:()=>S(E.id),disabled:c,className:"w-full flex items-center gap-4 pl-4 pr-4 py-3 rounded-lg hover:bg-white/10 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(M,{className:"w-5 h-5 text-white"}),l.jsx("span",{className:"flex-1 text-left text-white font-medium",children:E.label}),U&&l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"})]},E.id)})})]})})}function be({onLongPress:e,onClick:t,delay:n=500,moveThreshold:r=10}){const s=p.useRef(null),o=p.useRef(null),a=p.useRef(!1),c=p.useRef(null),i=p.useRef(!1),u=p.useCallback(f=>{f.preventDefault(),a.current=!1,i.current=!1,o.current=f.target,"touches"in f&&f.touches.length>0?c.current={x:f.touches[0].clientX,y:f.touches[0].clientY}:c.current=null,s.current=setTimeout(()=>{i.current||(a.current=!0,e(f))},n)},[e,n]),m=p.useCallback(f=>{if(!c.current||f.touches.length===0)return;const d=f.touches[0].clientX,v=f.touches[0].clientY,x=Math.abs(d-c.current.x),N=Math.abs(v-c.current.y);Math.sqrt(x*x+N*N)>r&&(i.current=!0,s.current&&(clearTimeout(s.current),s.current=null))},[r]),h=p.useCallback(f=>{const d=a.current;s.current&&(clearTimeout(s.current),s.current=null),t&&o.current===f.target&&!d&&!i.current&&t(f),a.current=!1,i.current=!1,o.current=null,c.current=null},[t]);return{onMouseDown:u,onTouchStart:u,onTouchMove:m,onMouseUp:h,onMouseLeave:f=>{s.current&&(clearTimeout(s.current),s.current=null),a.current=!1,i.current=!1,o.current=null,c.current=null},onTouchEnd:h}}function Po({track:e,index:t,isCurrent:n,isPlaying:r,showRemoveButton:s=!0,onClick:o,onRemove:a,onReorderDragStart:c,onReorderDrop:i,onContextMenu:u,isDragOver:m,onDragEnterRow:h}){var d,v;const f=be({onLongPress:x=>{x.preventDefault(),u(e)}});return l.jsxs("div",{draggable:!n,onDragOver:x=>{x.preventDefault(),x.dataTransfer.dropEffect="move"},onDragEnter:x=>{x.preventDefault(),n||h(t)},onDrop:x=>!n&&i(x,t),className:`queue-row flex items-center gap-3 p-3 ${n?"cursor-pointer":"hover:bg-zinc-900 cursor-pointer"} ${n?"bg-zinc-900":""} relative`,onClick:n?void 0:o,onContextMenu:x=>{x.preventDefault(),u(e)},children:[m&&!n&&l.jsx("div",{className:"absolute left-3 right-3 top-0 h-0.5 bg-[var(--accent-color)] rounded-full pointer-events-none"}),l.jsx("div",{className:"queue-drag-art w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 ml-1",children:l.jsx(lt,{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm"})}),l.jsxs("div",{className:"flex-1 min-w-0",...f,children:[l.jsx("div",{className:`text-sm font-medium truncate ${n?"text-[var(--accent-color)]":"text-white"}`,children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((v=(d=e.ArtistItems)==null?void 0:d[0])==null?void 0:v.Name)||"Unknown Artist"})]}),n?l.jsx("button",{onClick:x=>{x.stopPropagation(),o()},className:"text-gray-400 hover:text-gray-300 transition-colors p-2",children:r?l.jsx(bn,{className:"w-5 h-5"}):l.jsx(st,{className:"w-5 h-5"})}):l.jsx(l.Fragment,{children:s&&l.jsxs(l.Fragment,{children:[l.jsx("button",{draggable:!0,onDragStart:x=>c(x,t),className:"text-gray-500 hover:text-gray-300 transition-colors p-2 cursor-grab active:cursor-grabbing",children:l.jsx(Rx,{className:"w-4 h-4"})}),a&&l.jsx("button",{onClick:x=>{x.stopPropagation(),a()},className:"text-gray-400 hover:text-gray-300 transition-colors p-2",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]},`${e.Id}-${t}`)}function h0({onClose:e,onNavigateFromContextMenu:t}){const n=p.useRef(null),[r,s]=p.useState(!1),[o,a]=p.useState(null),[c,i]=p.useState(null),[u,m]=p.useState(null),{queue:h,previousSongs:f,playedSongIds:d,currentIndex:v,currentTrack:x,playTrack:N,removeFromQueue:y,reorderQueue:g,setQueue:w,clearQueue:j,isPlaying:S,shuffle:C,repeat:k,togglePlayPause:A,toggleShuffle:E,toggleRepeat:M,next:U,previous:q,skipToTrack:se,isFetchingRecommendations:X}=pe(),F=(I,R)=>{I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("text/plain",R.toString()),m(R);const z=I.currentTarget,$=z==null?void 0:z.closest(".queue-row");if($&&I.dataTransfer.setDragImage){const b=$.querySelector(".queue-drag-art")??$,P=b.getBoundingClientRect();I.dataTransfer.setDragImage(b,P.width/2,P.height/2)}},Z=(I,R)=>{I.preventDefault();const z=I.dataTransfer.getData("text/plain")||I.dataTransfer.getData("text/html"),$=parseInt(z,10);if(Number.isNaN($))return;const b=h[u??$],P=h[R],oe=b?!!b._isRecommended:!1,O=P?!!P._isRecommended:!1;if(b&&P&&oe!==O){i(null),m(null);return}$!==R&&g($,R),i(null),m(null)},H=x||(v>=0&&v<h.length?h[v]:null),T=v>=0&&v<h.length?v:H?h.findIndex(I=>I.Id===H.Id):-1,Q=new Set(d),L=H==null?void 0:H.Id,le=h.filter((I,R)=>{const $=!I._isRecommended,W=R!==v&&I.Id!==L,b=!Q.has(I.Id)||I.Id===L;return $&&W&&b}),re=le,fe=h.filter((I,R)=>{if(!I._isRecommended)return I.Id===L,!1;if(I.Id===L)return!1;const $=T===-1?!0:R>T,W=!Q.has(I.Id);return $&&W}),xe=fe.length>0,me=()=>{const{clearQueue:I}=pe.getState();I()},he=T>=0&&T<h.length-1,G=T>0&&T<h.length||f.length>0;h.length===0||le.length;const D=I=>{a(I),s(!0)},J=I=>{if(u==null)return;const R=h[u],z=h[I];if(!R||!z)return;const $=!!R._isRecommended,W=!!z._isRecommended;if($!==W){i(null);return}i(I)};return l.jsxs("div",{className:"flex-1 flex flex-col min-h-0 max-w-[768px] mx-auto w-full",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[l.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",style:{paddingBottom:"8rem"},children:h.length===0&&!H?l.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:l.jsx("p",{children:"Queue is empty"})}):l.jsxs("div",{children:[H&&l.jsxs("div",{children:[l.jsx("div",{className:"px-4 pb-0 pt-3 text-lg font-semibold text-white tracking-wider",children:"Now Playing"}),l.jsx(Po,{track:H,index:v>=0?v:-1,isCurrent:!0,isPlaying:S,showRemoveButton:!1,onClick:()=>{A()},onReorderDragStart:F,onReorderDrop:Z,onContextMenu:D,isDragOver:!1,onDragEnterRow:J})]}),(re.length>0||xe)&&l.jsx("div",{children:l.jsxs("div",{className:"px-4 pb-0 pt-3 flex items-center justify-between",children:[l.jsx("div",{className:"text-lg font-semibold text-white tracking-wider",children:"Queue"}),l.jsx("button",{onClick:me,className:"text-xs font-semibold text-gray-300 hover:opacity-80 transition-opacity tracking-wider",children:"Clear"})]})}),re.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"px-4 pb-0 pt-4 text-xs font-semibold text-gray-400 tracking-wider",children:"Added By You"}),re.map(I=>{const R=h.findIndex(z=>z.Id===I.Id);return l.jsx(Po,{track:I,index:R,isCurrent:!1,isPlaying:S,showRemoveButton:!0,onClick:()=>{se(R)},onRemove:()=>{y(R)},onReorderDragStart:F,onReorderDrop:Z,onContextMenu:D,isDragOver:c===R,onDragEnterRow:J},`${I.Id}-${R}`)})]}),xe&&l.jsxs("div",{children:[l.jsx("div",{className:"px-4 pb-0 pt-4 text-xs font-semibold text-gray-400 tracking-wider",children:"Recommendations"}),fe.map(I=>{const R=h.findIndex($=>$.Id===I.Id),z=R>=0?R:-1;return l.jsx(Po,{track:I,index:z,isCurrent:!1,isPlaying:S,showRemoveButton:!0,onClick:()=>{z>=0&&se(z)},onRemove:()=>{z>=0&&y(z)},onReorderDragStart:F,onReorderDrop:Z,onContextMenu:D,isDragOver:c===z,onDragEnterRow:J},`${I.Id}-${z}`)})]}),X&&l.jsx("div",{className:"px-4 pt-4 pb-6 flex justify-center",children:l.jsx(tn,{})})]})}),l.jsx(Be,{item:o,itemType:o?"song":null,isOpen:r,onClose:()=>{s(!1),a(null)},onNavigate:t}),l.jsx("div",{ref:n,className:"px-6 pt-2 space-y-6 flex-shrink-0",style:{paddingBottom:"1.5rem"},children:l.jsxs("div",{className:"flex items-center justify-center gap-8",children:[l.jsx("button",{onClick:E,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${C?"text-[var(--accent-color)]":"text-gray-400 hover:text-gray-300"}`,children:l.jsx(Dn,{className:"w-6 h-6"})}),l.jsx("button",{onClick:q,disabled:!G,className:`w-12 h-12 flex-shrink-0 aspect-square flex items-center justify-center rounded-full transition-colors ${G?"text-white hover:bg-zinc-800 active:bg-zinc-800":"text-zinc-600 cursor-not-allowed"}`,children:l.jsx(qf,{className:"w-8 h-8"})}),l.jsx("button",{onClick:A,className:"w-16 h-16 flex items-center justify-center rounded-full transition-colors aspect-square bg-[var(--accent-color)] text-white hover:opacity-90",children:S?l.jsx(bn,{className:"w-8 h-8"}):l.jsx(st,{className:"w-8 h-8"})}),l.jsx("button",{onClick:U,disabled:!he,className:`w-12 h-12 flex-shrink-0 aspect-square flex items-center justify-center rounded-full transition-colors ${he?"text-white hover:bg-zinc-800 active:bg-zinc-800":"text-zinc-600 cursor-not-allowed"}`,children:l.jsx(Oi,{className:"w-8 h-8"})}),l.jsx("button",{onClick:M,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${k!=="off"?"text-[var(--accent-color)]":"text-gray-400 hover:text-gray-300"}`,children:k==="one"?l.jsx(Wf,{className:"w-6 h-6"}):l.jsx(Yf,{className:"w-6 h-6"})})]})})]})}function p0({onClose:e}){const{currentTrack:t,lastPlayedTrack:n}=pe(),r=t||n,[s,o]=p.useState(null),[a,c]=p.useState(!1);return p.useEffect(()=>{(async()=>{if(!r){o(null);return}c(!0);try{const u=await _.getLyrics(r.Id);o(u)}catch(u){console.error("Failed to fetch lyrics:",u),o(null)}finally{c(!1)}})()},[r]),r?l.jsx("div",{className:"fixed left-0 right-0 bg-zinc-900 z-[55] flex flex-col",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 4rem)",bottom:"calc(11rem + env(safe-area-inset-bottom))"},children:l.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 px-6 py-4 relative",children:[l.jsx("div",{className:"sticky left-0 right-0 h-16 bg-gradient-to-b from-zinc-900 via-zinc-900/50 to-transparent pointer-events-none z-10 -mx-6",style:{top:"-24px"}}),a?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("div",{className:"text-gray-400",children:"Loading lyrics..."})}):s?l.jsx("div",{className:"max-w-[768px] mx-auto pb-8",children:l.jsx("div",{className:"text-white text-left whitespace-pre-line leading-relaxed",children:s.split(`
`).map((i,u)=>l.jsx("div",{className:"mb-2",children:i},u))})}):l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("div",{className:"text-gray-400 text-center",children:"This song has no lyrics"})}),l.jsx("div",{className:"sticky left-0 right-0 h-16 bg-gradient-to-t from-zinc-900 via-zinc-900/50 to-transparent pointer-events-none z-10 -mx-6",style:{bottom:"-16px"}})]})}):null}function g0({onClose:e,onClosingStart:t,closeRef:n}){const r=$e(),{currentTrack:s,lastPlayedTrack:o,isPlaying:a,currentTime:c,duration:i,shuffle:u,repeat:m,togglePlayPause:h,next:f,previous:d,seek:v,setVolume:x,toggleShuffle:N,toggleRepeat:y,queue:g,previousSongs:w,currentIndex:j,playTrack:S}=pe(),C=s||o,[k,A]=p.useState(!1),[E,M]=p.useState(!1),[U,q]=p.useState(!1),[se,X]=p.useState(!1),[F,Z]=p.useState(!1),[H,T]=p.useState(!1),Q=p.useRef(null),L=p.useRef(null),le=p.useRef(null),re=p.useRef(null),fe=p.useRef(!1),xe=p.useRef(null);p.useEffect(()=>{const Y=window.getComputedStyle(document.body).overflowY,ie=window.getComputedStyle(document.documentElement).overflowY,ce=document.getElementById("root")?window.getComputedStyle(document.getElementById("root")).overflowY:"N/A";document.body.style.overflowY="hidden",document.documentElement.style.overflowY="hidden";const je=document.getElementById("root");return je&&(je.style.overflowY="hidden"),()=>{document.body.style.overflowY=Y,document.documentElement.style.overflowY=ie,je&&(je.style.overflowY=ce!=="N/A"?ce:"")}},[]),p.useEffect(()=>{requestAnimationFrame(()=>{Z(!0)})},[]);const me=j>=0&&j<g.length?j:s?g.findIndex(Y=>Y.Id===s.Id):-1,he=me>=0&&me<g.length-1,G=me>0&&me<g.length||w.length>0;p.useEffect(()=>{x(1)},[x]),p.useEffect(()=>{(async()=>{if(!C){q(!1);return}try{const ie=await _.getLyrics(C.Id),ce=ie!==null&&ie.trim().length>0;q(ce)}catch(ie){console.warn("[PlayerModal] Lyrics check failed:",ie),q(!1)}})()},[C]);const D=Y=>{if(!Y)return"Unknown";if(Y.Name&&Y.Name.trim())return Y.Name;const ie=Y.Path;return ie&&typeof ie=="string"&&(ie.split("/").pop()||ie.split("\\").pop())||"Unknown"},J=Y=>{var ie,ce;return Y&&(Y.AlbumArtist||((ce=(ie=Y.ArtistItems)==null?void 0:ie[0])==null?void 0:ce.Name))||""};if(p.useEffect(()=>{"mediaSession"in navigator&&C&&(navigator.mediaSession.metadata=new MediaMetadata({title:D(C),artist:J(C),album:C.Album||"",artwork:[{src:_.getAlbumArtUrl(C.AlbumId||C.Id,512),sizes:"512x512",type:"image/jpeg"}]}),navigator.mediaSession.setActionHandler("play",h),navigator.mediaSession.setActionHandler("pause",h),navigator.mediaSession.setActionHandler("previoustrack",d),navigator.mediaSession.setActionHandler("nexttrack",f))},[C,a,h,f,d]),p.useEffect(()=>{T(!1)},[C==null?void 0:C.Id]),!C)return null;const I=i>0?c/i*100:0,R=Y=>{const ie=Math.floor(Y/60),ce=Math.floor(Y%60);return`${ie}:${ce.toString().padStart(2,"0")}`},z=()=>{if(C.Name&&C.Name.trim())return C.Name;const Y=C.Path;return Y&&typeof Y=="string"&&(Y.split("/").pop()||Y.split("\\").pop())||"Unknown"},$=()=>{var Y,ie;return C.AlbumArtist||((ie=(Y=C.ArtistItems)==null?void 0:Y[0])==null?void 0:ie.Name)},W=C.AlbumId&&C.Album&&C.Album.trim(),b=Y=>{if(!Q.current||!i||fe.current)return;const ie=Q.current.getBoundingClientRect(),ce=(Y.clientX-ie.left)/ie.width;v(Math.max(0,Math.min(1,ce))*i)},P=Y=>{if(!Q.current||!i)return;fe.current=!0,xe.current=Y.clientX;const ie=Q.current.getBoundingClientRect(),ce=(Y.clientX-ie.left)/ie.width;v(Math.max(0,Math.min(1,ce))*i)},oe=()=>{fe.current=!1,xe.current=null},O=Y=>{if(!Q.current||!i)return;Y.stopPropagation(),fe.current=!0;const ie=Y.touches[0],ce=Q.current.getBoundingClientRect(),je=(ie.clientX-ce.left)/ce.width;v(Math.max(0,Math.min(1,je))*i)},K=Y=>{if(!fe.current||!Q.current||!i)return;Y.stopPropagation(),Y.preventDefault();const ie=Y.touches[0],ce=Q.current.getBoundingClientRect(),je=(ie.clientX-ce.left)/ce.width;v(Math.max(0,Math.min(1,je))*i)},te=Y=>{Y.stopPropagation(),fe.current=!1,xe.current=null};p.useEffect(()=>{const Y=ce=>{if(!fe.current||!Q.current||!i)return;const je=Q.current.getBoundingClientRect(),Ve=(ce.clientX-je.left)/je.width;v(Math.max(0,Math.min(1,Ve))*i)},ie=()=>{fe.current&&(fe.current=!1,xe.current=null)};return document.addEventListener("mousemove",Y),document.addEventListener("mouseup",ie),()=>{document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",ie)}},[i,v]);const ue=()=>{X(!0),t==null||t(),setTimeout(()=>{e()},300)};p.useEffect(()=>(n&&(n.current=ue),()=>{n&&(n.current=null)}),[n]);const de=Y=>{k||E||(L.current=Y.touches[0].clientY,le.current=Date.now())},Ne=Y=>{if(k||E||L.current===null)return;const ce=Y.touches[0].clientY-L.current;if(ce>0&&re.current){const je=Math.min(ce,window.innerHeight*.5);re.current.style.transform=`translateY(${je}px)`}},ee=Y=>{if(k||E||L.current===null||le.current===null){L.current=null,le.current=null,re.current&&(re.current.style.transform="");return}const ce=Y.changedTouches[0].clientY-L.current,je=Date.now()-le.current,Ve=50,ne=.3;re.current&&(re.current.style.transform="");const B=ce/je;(ce>Ve||ce>30&&B>ne)&&ue(),L.current=null,le.current=null};return l.jsxs(l.Fragment,{children:[l.jsx("style",{children:`
      @media (min-aspect-ratio: 4/3) and (min-width: 768px) {
        .landscape\\:flex-row { flex-direction: row; }
        .landscape\\:items-center { align-items: center; }
        .landscape\\:gap-8 { gap: 2rem; }
        .landscape\\:order-1 { order: 1; }
        .landscape\\:flex-shrink-0 { flex-shrink: 0; }
        .landscape\\:order-2 { order: 2; }
        .landscape\\:text-left { text-align: left; }
        .landscape\\:flex-1 { flex: 1; }
        .landscape\\:max-w-xs { max-width: 20rem; }
        .landscape\\:justify-start { justify-content: flex-start; }
        .landscape\\:mx-0 { margin-left: 0; margin-right: 0; }
      }
    `}),l.jsxs("div",{ref:re,onTouchStart:de,onTouchMove:Ne,onTouchEnd:ee,className:`fixed left-0 right-0 bg-zinc-900 z-[70] flex flex-col transition-transform duration-300 ease-out ${se?"translate-y-full":F?"translate-y-0":"translate-y-full"}`,style:{top:"var(--header-offset, 0px)",paddingTop:"calc(env(safe-area-inset-top) + var(--header-offset, 0px))",bottom:"calc(-1 * env(safe-area-inset-bottom))",height:"calc(100% + env(safe-area-inset-bottom) + var(--header-offset, 0px))",transition:L.current===null?"transform 300ms ease-out":"none"},children:[l.jsxs("div",{className:"flex items-center justify-between p-4 relative",children:[l.jsx("button",{onClick:ue,className:"text-white hover:text-gray-300 transition-colors z-10 flex-shrink-0",children:l.jsx(zi,{className:"w-8 h-8"})}),E&&C&&l.jsx("h2",{className:"absolute left-0 right-0 text-center text-white text-sm sm:text-base font-medium px-20 truncate",children:z()}),l.jsxs("div",{className:"flex items-center gap-2 z-10 flex-shrink-0",children:[U&&!k&&l.jsx("button",{onClick:()=>M(!E),className:`transition-colors pr-2 ${E?"text-[var(--accent-color)] hover:text-[var(--accent-color)]":"text-white hover:text-gray-300"}`,children:l.jsx(Wx,{className:"w-6 h-6"})}),l.jsx("button",{onClick:()=>{k||M(!1),A(!k)},className:"text-white hover:text-gray-300 transition-colors",children:k?l.jsx(a0,{className:"w-6 h-6"}):l.jsx(Gx,{className:"w-6 h-6"})})]})]}),k?l.jsx(h0,{onClose:()=>A(!1),onNavigateFromContextMenu:()=>{ue()}}):l.jsxs("div",{className:"flex-1 flex flex-col min-h-0 max-w-[768px] mx-auto w-full relative",style:{paddingBottom:"env(safe-area-inset-bottom)"},children:[l.jsx("div",{className:"flex-1 overflow-hidden min-h-0 flex items-center justify-center",children:l.jsx("div",{className:"w-full flex flex-col items-center px-4 sm:px-8",children:l.jsxs("div",{className:"w-full flex flex-col items-center landscape:flex-row landscape:items-center landscape:gap-8",children:[l.jsx("div",{className:"landscape:order-1 landscape:flex-shrink-0",children:l.jsx("div",{className:`rounded overflow-hidden mb-4 lg:mb-8 bg-zinc-900 ${H?"":"shadow-2xl"}`,style:{width:"clamp(224px, min(70vw, 50vh), 480px)",height:"clamp(224px, min(70vw, 50vh), 480px)",maxWidth:"100%"},children:H?l.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-zinc-900 flex items-center justify-center relative",children:l.jsx("img",{src:"/assets/vinyl.png",alt:"Vinyl Record",className:"w-full h-full object-cover",onError:Y=>{console.error("Failed to load vinyl image"),Y.currentTarget.style.display="none"}})}):l.jsx(lt,{src:_.getAlbumArtUrl(C.AlbumId||C.Id),alt:C.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>T(!0)})})}),l.jsxs("div",{className:"text-center landscape:text-left w-full landscape:order-2 landscape:flex-1 landscape:max-w-xs",children:[l.jsx("h3",{className:"text-xl sm:text-2xl font-bold mb-2",children:z()}),$()&&l.jsxs("button",{onClick:()=>{var ie,ce;const Y=(ce=(ie=C.ArtistItems)==null?void 0:ie[0])==null?void 0:ce.Id;Y&&(e(),r(`/artist/${Y}`))},className:"flex items-center justify-start landscape:justify-start gap-2 text-gray-400 text-base sm:text-lg hover:text-white transition-colors mx-auto landscape:mx-0 landscape:text-left max-w-full min-w-0",children:[l.jsx(tt,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),l.jsx("span",{className:"break-words min-w-0",children:$()})]}),W&&l.jsxs("button",{onClick:()=>{e(),r(`/album/${C.AlbumId}`)},className:"flex items-center justify-start landscape:justify-start gap-2 text-gray-400 text-base sm:text-lg hover:text-white transition-colors mx-auto landscape:mx-0 landscape:text-left mt-1 max-w-full min-w-0",children:[l.jsx(Ge,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),l.jsx("span",{className:"break-words min-w-0",children:C.Album})]})]})]})})}),l.jsxs("div",{className:"pt-2 space-y-6 flex-shrink-0 mt-4 sm:mt-0 max-w-[768px] mx-auto w-full",style:{paddingBottom:"1.5rem"},children:[l.jsx("div",{className:"space-y-3 px-4 w-full",children:l.jsxs("div",{className:"max-w-[768px] mx-auto",children:[l.jsx("div",{ref:Q,className:"h-2 bg-zinc-800 rounded-full cursor-pointer w-full select-none overflow-hidden",onClick:b,onMouseDown:P,onMouseUp:oe,onMouseLeave:oe,onTouchStart:O,onTouchMove:K,onTouchEnd:te,children:l.jsx("div",{className:"h-full bg-[var(--accent-color)] transition-all",style:{width:`${I}%`,borderTopLeftRadius:"9999px",borderBottomLeftRadius:"9999px",borderTopRightRadius:I>=100?"9999px":"0",borderBottomRightRadius:I>=100?"9999px":"0"}})}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[l.jsx("span",{children:R(c)}),l.jsx("span",{children:R(i)})]})]})}),l.jsxs("div",{className:"flex items-center justify-center gap-8 px-6",children:[l.jsx("button",{onClick:N,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${u?"text-[var(--accent-color)]":"text-gray-400 hover:text-gray-300"}`,children:l.jsx(Dn,{className:"w-6 h-6"})}),l.jsx("button",{onClick:d,disabled:!G,className:`w-12 h-12 flex-shrink-0 aspect-square flex items-center justify-center rounded-full transition-colors ${G?"text-white hover:bg-zinc-800 active:bg-zinc-800":"text-gray-600 cursor-not-allowed"}`,children:l.jsx(qf,{className:"w-8 h-8"})}),l.jsx("button",{onClick:()=>{s?h():C&&S(C)},className:"w-16 h-16 flex items-center justify-center rounded-full transition-colors aspect-square bg-[var(--accent-color)] text-white hover:opacity-90",children:a&&s?l.jsx(bn,{className:"w-8 h-8"}):l.jsx(st,{className:"w-8 h-8"})}),l.jsx("button",{onClick:f,disabled:!he,className:`w-12 h-12 flex-shrink-0 aspect-square flex items-center justify-center rounded-full transition-colors ${he?"text-white hover:bg-zinc-800 active:bg-zinc-800":"text-gray-600 cursor-not-allowed"}`,children:l.jsx(Oi,{className:"w-8 h-8"})}),l.jsx("button",{onClick:y,className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${m!=="off"?"text-[var(--accent-color)]":"text-gray-400 hover:text-gray-300"}`,children:m==="one"?l.jsx(Wf,{className:"w-6 h-6"}):l.jsx(Yf,{className:"w-6 h-6"})})]})]})]}),E&&l.jsx(p0,{onClose:()=>M(!1)})]})]})}function x0(){var q,se;const{currentTrack:e,lastPlayedTrack:t,isPlaying:n,currentTime:r,duration:s,audioElement:o,setAudioElement:a,togglePlayPause:c,next:i,setCurrentTime:u,setDuration:m,playTrack:h,queue:f,currentIndex:d,repeat:v}=pe(),[x,N]=p.useState(!1),[y,g]=p.useState(!1),[w,j]=p.useState(!1),S=p.useRef(null),C=p.useRef(null),k=en();p.useEffect(()=>{x&&(g(!0),setTimeout(()=>{N(!1),g(!1)},300))},[k.pathname]),p.useEffect(()=>{const X=()=>{x&&C.current&&C.current()};return window.addEventListener("closePlayerModal",X),()=>{window.removeEventListener("closePlayerModal",X)}},[x]);const A=()=>{g(!0),setTimeout(()=>{N(!1),g(!1)},300)};p.useEffect(()=>{S.current||(S.current=new Audio,S.current.setAttribute("playsinline","true"),S.current.setAttribute("preload","auto"),a(S.current));const X=S.current;if(!X)return;const F=()=>{u(X.currentTime)},Z=()=>{m(X.duration)},H=async()=>{var le;const L=pe.getState().queue;if(e&&((le=L.find(re=>re.Id===e.Id))==null||le._isRecommended),e)try{await _.markItemAsPlayed(e.Id),m0(e.Id),setTimeout(()=>{window.dispatchEvent(new CustomEvent("trackPlayed",{detail:{trackId:e.Id}}))},4e3)}catch{}i()},T=()=>{pe.setState({isPlaying:!0})},Q=()=>{pe.setState({isPlaying:!1})};return X.addEventListener("timeupdate",F),X.addEventListener("loadedmetadata",Z),X.addEventListener("ended",H),X.addEventListener("play",T),X.addEventListener("pause",Q),()=>{X.removeEventListener("timeupdate",F),X.removeEventListener("loadedmetadata",Z),X.removeEventListener("ended",H),X.removeEventListener("play",T),X.removeEventListener("pause",Q)}},[a,u,m,i]),p.useEffect(()=>{S.current&&(S.current.volume=pe.getState().volume)},[]),p.useEffect(()=>{const X=pe.getState();if(X.lastPlayedTrack&&!X.currentTrack&&X.queue.length===0){const F=X.lastPlayedTrack;pe.getState().setQueue([F]),pe.getState().setCurrentTrack(F),pe.setState({manuallyCleared:!1})}},[]),p.useEffect(()=>{if(o&&e&&!n){const X=_.serverBaseUrl,F=X?`${X}/Audio/${e.Id}/stream?static=true`:"";o.src!==F&&(o.src=F,o.load())}},[o,e,n]);const E=e||t;p.useEffect(()=>{j(!1)},[E==null?void 0:E.Id]);const M=s>0?r/s*100:0,U=f.length>0&&(d<0||d<f.length-1||v==="all");return E?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"fixed left-0 right-0 bg-zinc-900 border-t border-zinc-800 z-40 cursor-pointer",style:{bottom:"calc(4rem + env(safe-area-inset-bottom) - 8px)"},onClick:()=>{N(!0)},children:[l.jsxs("div",{className:"flex items-center gap-3 py-3 pr-3 pl-4",children:[!w&&l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900",children:l.jsx(lt,{src:_.getAlbumArtUrl((e||E).AlbumId||(e||E).Id,96),alt:(e||E).Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm",onError:()=>j(!0)},(e==null?void 0:e.Id)||E.Id)}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate",children:(e||E).Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:(e||E).AlbumArtist||((se=(q=(e||E).ArtistItems)==null?void 0:q[0])==null?void 0:se.Name)||"Unknown Artist"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("button",{onClick:X=>{X.stopPropagation(),e?c():E&&h(E)},className:"w-10 h-10 flex items-center justify-center text-white hover:bg-zinc-800 rounded-full transition-colors ml-4",children:n&&e?l.jsx(bn,{className:"w-5 h-5"}):l.jsx(st,{className:"w-5 h-5"})}),l.jsx("button",{onClick:X=>{X.stopPropagation(),U&&i()},className:`w-10 h-10 flex items-center justify-center rounded-full transition-colors ml-1 ${U?"text-white hover:bg-zinc-800":"text-zinc-600 cursor-not-allowed"}`,disabled:!U,children:l.jsx(Oi,{className:"w-5 h-5"})})]})]}),E&&l.jsx("div",{className:"h-1 bg-zinc-800",children:l.jsx("div",{className:"h-full bg-[var(--accent-color)] transition-all",style:{width:`${M}%`}})})]}),x&&l.jsx(g0,{onClose:A,onClosingStart:()=>g(!0),closeRef:C})]}):null}function y0(){const{state:e,message:t,cancelSync:n}=Zl();if(e==="idle")return null;const r=()=>{switch(e){case"syncing":return"bg-zinc-800";case"success":return"bg-green-800";case"error":return"bg-red-800";default:return"bg-zinc-800"}};return l.jsx("div",{className:`fixed top-0 left-0 right-0 z-[10002] ${r()} transition-colors duration-300`,style:{height:"28px",top:"0px"},children:l.jsxs("div",{className:"max-w-[768px] mx-auto h-full flex items-center justify-between px-4",children:[l.jsx("span",{className:"text-white text-sm font-medium truncate",children:t}),e==="syncing"&&l.jsx("button",{onClick:n,className:"text-white text-sm font-medium hover:text-gray-300 transition-colors",children:"Cancel"})]})})}async function v0({currentTrack:e,queue:t,recentQueue:n,lastPlayedTrack:r}){var o,a,c,i,u,m,h;const s=((a=(o=import.meta)==null?void 0:o.env)==null?void 0:a.DEV)??!1;if(!e)return s&&console.log("[Recommendations] No current track"),[];try{const f=e.Genres||[],d=e.ProductionYear||e.PremiereDate?new Date(e.PremiereDate||"").getFullYear():null;s&&(console.log("[Recommendations] ===== GENRE MATCHING DEBUG ====="),console.log("[Recommendations] Current track:",{name:e.Name,id:e.Id,genres:f,genresCount:f.length,year:d,albumArtist:e.AlbumArtist,artistItems:e.ArtistItems})),f.length===0&&s&&console.error("[Recommendations] Current track has no genres; falling back to non-genre strategies.");const v=[],x=[];if(f.length>0)try{const I=await _.getGenres();s&&(console.log(`[Recommendations] Found ${I.length} total genres in library`),console.log("[Recommendations] Looking for genres:",f.slice(0,3)));for(const R of f.slice(0,3)){const z=I.find($=>{var W;return((W=$.Name)==null?void 0:W.toLowerCase())===R.toLowerCase()});s&&console.log("[Recommendations] Genre match candidate:",{requested:R,found:!!z,id:z==null?void 0:z.Id,name:z==null?void 0:z.Name,isSynthetic:(c=z==null?void 0:z.Id)==null?void 0:c.startsWith("synthetic-")}),z!=null&&z.Id?z.Id.startsWith("synthetic-")?(x.push(R),s&&console.log(`[Recommendations] Genre "${R}" is synthetic, will filter by name`)):(v.push(z.Id),s&&console.log(`[Recommendations] Genre "${R}" has real ID: ${z.Id}`)):(x.push(R),s&&console.warn(`[Recommendations] Genre "${R}" not found in library genres, treating as synthetic`))}s&&console.log("[Recommendations] Genre matching results:",{realGenreIds:v,syntheticGenreNames:x,totalGenres:f.length})}catch(I){s&&console.error("[Recommendations] Failed to get genre IDs:",I)}else s&&console.warn("[Recommendations] No genres to match - will use fallback strategies");if(v.length===0&&x.length>0){s&&console.log("[Recommendations] Using genre name filtering (synthetic genres)");try{let I=[];const R=new Set,z=20;if(d&&!isNaN(d)){const O=[{range:3,years:[d-3,d-2,d-1,d,d+1,d+2,d+3]},{range:5,years:[d-5,d-4,d-3,d-2,d-1,d,d+1,d+2,d+3,d+4,d+5]},{range:7,years:[d-7,d-6,d-5,d-4,d-3,d-2,d-1,d,d+1,d+2,d+3,d+4,d+5,d+6,d+7]},{range:10,years:[d-10,d-9,d-8,d-7,d-6,d-5,d-4,d-3,d-2,d-1,d,d+1,d+2,d+3,d+4,d+5,d+6,d+7,d+8,d+9,d+10]}];for(const{range:K,years:te}of O){if(I.length>=z&&K>3){s&&console.log(`[Recommendations] Already have ${I.length} year-matched songs, skipping year range ${K}`);break}const Ne=((await _.getSongs({years:te,limit:300})).Items||[]).filter(ee=>{var Y;return((Y=ee.Genres)==null?void 0:Y.some(ie=>x.some(ce=>ce.toLowerCase()===ie.toLowerCase())))&&!R.has(ee.Id)});if(Ne.forEach(ee=>{I.push(ee),R.add(ee.Id)}),s&&console.log(`[Recommendations] Year range ${K} returned ${Ne.length} genre-matched songs (total: ${I.length})`),I.length>=z){s&&console.log(`[Recommendations] Have enough year-matched songs (${I.length}), stopping expansion`);break}}}let $=[];if(d&&!isNaN(d)&&I.length<z){s&&console.log(`[Recommendations] Only have ${I.length} year-matched songs, getting additional without year filter`);const K=((await _.getSongs({limit:500})).Items||[]).filter(te=>{var ue;return((ue=te.Genres)==null?void 0:ue.some(de=>x.some(Ne=>Ne.toLowerCase()===de.toLowerCase())))&&!R.has(te.Id)});$=[...I,...K],s&&console.log(`[Recommendations] Combined: ${$.length} total (${I.length} with year match, ${K.length} without)`)}else d&&!isNaN(d)?($=I,s&&console.log(`[Recommendations] Using only year-matched songs: ${$.length} songs`)):($=((await _.getSongs({limit:500})).Items||[]).filter(K=>{var te;return(te=K.Genres)==null?void 0:te.some(ue=>x.some(de=>de.toLowerCase()===ue.toLowerCase()))}),s&&console.log(`[Recommendations] No year filter (no year data) returned ${$.length} genre-matched songs`));const W=Array.from(new Map($.map(O=>[O.Id,O])).values()),b=new Set([e.Id,...t.map(O=>O.Id),...n.map(O=>O.Id)]),P=W.filter(O=>!b.has(O.Id));let oe=P;if(d&&!isNaN(d)&&(oe=P.sort((O,K)=>{const te=O.ProductionYear||(O.PremiereDate?new Date(O.PremiereDate).getFullYear():null),ue=K.ProductionYear||(K.PremiereDate?new Date(K.PremiereDate).getFullYear():null);return te&&!ue?-1:!te&&ue?1:!te&&!ue||!te||!ue?0:Math.abs(te-d)-Math.abs(ue-d)})),oe.length>0&&s)return console.log(`[Recommendations] Found ${oe.length} songs by genre name filtering`),oe.slice(0,10)}catch(I){console.error("[Recommendations] Genre name filtering failed:",I)}}if(v.length===0&&x.length===0){s&&(console.error("[Recommendations] No genre IDs or names found. Using fallback strategies."),console.log("[Recommendations] No genre IDs found, using fallback strategies (these will not filter by genre)."));const I=[],R=e.AlbumArtist||((u=(i=e.ArtistItems)==null?void 0:i[0])==null?void 0:u.Id),z=e.AlbumId;try{if(R&&f.length===0){let oe=((await _.getSongs({artistIds:[R],limit:50})).Items||[]).filter(K=>K.Id!==e.Id);const O=[...oe].sort(()=>Math.random()-.5);I.push(...O.slice(0,20)),s&&console.log(`[Recommendations] Fallback: Found ${oe.length} songs by same artist (limited to 20, shuffled)`)}else R&&f.length>0&&s&&console.log("[Recommendations] Fallback: Skipping same-artist strategy since we have genre names to match");if(z&&I.length<10){const oe=((await _.getSongs({albumIds:[z],limit:50})).Items||[]).filter(O=>O.Id!==e.Id);I.push(...oe),s&&console.log(`[Recommendations] Fallback: Found ${oe.length} songs from same album`)}if(d&&!isNaN(d)&&I.length<10){const P=[{range:3,years:[d-3,d-2,d-1,d,d+1,d+2,d+3]},{range:5,years:[d-5,d-4,d-3,d-2,d-1,d,d+1,d+2,d+3,d+4,d+5]}];for(const{range:oe,years:O}of P){let te=((await _.getSongs({years:O,limit:200})).Items||[]).filter(ue=>ue.Id!==e.Id);if(f.length>0){const ue=te.filter(de=>{var Ne;return(Ne=de.Genres)==null?void 0:Ne.some(ee=>f.some(Y=>Y.toLowerCase()===ee.toLowerCase()))});ue.length>0&&s&&(console.log(`[Recommendations] Fallback: Found ${ue.length} songs from ${oe} years AND matching genre`),te=ue)}if(I.push(...te),s&&console.log(`[Recommendations] Fallback: Found ${te.length} songs from ${oe} years`),I.length>=20)break}}const $=Array.from(new Map(I.map(P=>[P.Id,P])).values()),W=new Set([e.Id,...t.map(P=>P.Id),...n.map(P=>P.Id)]),b=$.filter(P=>!W.has(P.Id));if(f.length>0&&b.length>0){const P=b.filter(oe=>{var O;return(O=oe.Genres)==null?void 0:O.some(K=>f.some(te=>te.toLowerCase()===K.toLowerCase()))});if(P.length>0){s&&console.log(`[Recommendations] Fallback: Filtered to ${P.length} songs that match genre`);const O=[...P].sort(()=>Math.random()-.5).slice(0,10);return console.log(`[Recommendations] Fallback: Returning ${O.length} genre-matched recommendations`),O}else return s&&(console.error(`[Recommendations] CRITICAL: Fallback found ${b.length} songs but NONE match genre ${f.join(", ")}!`),console.error("[Recommendations] First 5 fallback songs and their genres:",b.slice(0,5).map(oe=>({name:oe.Name,genres:oe.Genres})))),[]}if(b.length>0&&s){console.warn(`[Recommendations] Fallback: Returning ${Math.min(b.length,10)} recommendations WITHOUT genre filtering (no genre info available)`);const P=Math.min(b.length,100),O=[...b.slice(0,P)];for(let K=O.length-1;K>0;K--){const te=Math.floor(Math.random()*(K+1));[O[K],O[te]]=[O[te],O[K]]}return O.slice(0,10)}if(b.length===0){console.log("[Recommendations] Fallback: No songs found from fallback strategies, getting recently added songs from library");try{const oe=((await _.getSongs({limit:100,sortBy:["DateCreated"],sortOrder:"Descending"})).Items||[]).filter(te=>te.Id!==e.Id),O=new Set([e.Id,...t.map(te=>te.Id),...n.map(te=>te.Id)]),K=oe.filter(te=>!O.has(te.Id));if(K.length>0){const te=[...K];for(let de=te.length-1;de>0;de--){const Ne=Math.floor(Math.random()*(de+1));[te[de],te[Ne]]=[te[Ne],te[de]]}const ue=te.slice(0,10);return s&&console.log(`[Recommendations] Fallback: Returning ${ue.length} random songs from recently added`),ue}}catch(P){s&&console.error("[Recommendations] Failed to get recently added songs:",P)}}}catch($){s&&console.error("[Recommendations] Fallback strategies failed:",$)}return s&&console.warn("[Recommendations] All fallback strategies failed, returning empty"),[]}s&&console.log("[Recommendations] Found genre IDs:",v);const N=[];if(v.length>0)try{for(const I of v){let R=[];if(d&&!isNaN(d)){const z=[{range:3,years:[d-3,d-2,d-1,d,d+1,d+2,d+3]},{range:5,years:[d-5,d-4,d-3,d-2,d-1,d,d+1,d+2,d+3,d+4,d+5]},{range:7,years:[d-7,d-6,d-5,d-4,d-3,d-2,d-1,d,d+1,d+2,d+3,d+4,d+5,d+6,d+7]},{range:10,years:[d-10,d-9,d-8,d-7,d-6,d-5,d-4,d-3,d-2,d-1,d,d+1,d+2,d+3,d+4,d+5,d+6,d+7,d+8,d+9,d+10]}],$=[],W=new Set,b=20;for(const{range:P,years:oe}of z){if($.length>=b&&P>3){s&&console.log(`[Recommendations] Already have ${$.length} songs, skipping year range ${P}`);break}const O={genreIds:[I],years:oe,limit:200},ue=((await _.getSongs(O)).Items||[]).filter(de=>{var Ne;return(Ne=de.Genres)==null?void 0:Ne.some(ee=>f.some(Y=>Y.toLowerCase()===ee.toLowerCase()))});if(ue.forEach(de=>{W.has(de.Id)||($.push(de),W.add(de.Id))}),s&&console.log(`[Recommendations] Year range ${P} returned ${ue.length} genre-matched songs (total accumulated: ${$.length})`),$.length>=b){s&&console.log(`[Recommendations] Have enough songs (${$.length}), stopping year range expansion`);break}}if($.length<b){s&&console.log(`[Recommendations] Only have ${$.length} year-matched songs, getting additional genre-matched songs without year filter`);const P={genreIds:[I],limit:500},K=((await _.getSongs(P)).Items||[]).filter(te=>{var ue;return((ue=te.Genres)==null?void 0:ue.some(de=>f.some(Ne=>Ne.toLowerCase()===de.toLowerCase())))&&!W.has(te.Id)});R=[...$,...K],s&&console.log(`[Recommendations] Combined: ${R.length} total genre-matched songs (${$.length} with year match, ${K.length} without year match)`)}else R=$,s&&console.log(`[Recommendations] Using only year-matched songs: ${R.length} songs (all within year ranges)`)}else{const z={genreIds:[I],limit:100};R=((await _.getSongs(z)).Items||[]).filter(b=>{var P;return(P=b.Genres)==null?void 0:P.some(oe=>f.some(O=>O.toLowerCase()===oe.toLowerCase()))}),s&&console.log(`[Recommendations] No year filter (no year data) returned ${R.length} genre-matched songs`)}N.push(...R)}}catch(I){s&&console.error("[Recommendations] Failed to get genre songs:",I)}if(s){if(console.log(`[Recommendations] Found ${N.length} genre-matched songs`),N.length>0){const I=new Set;N.slice(0,10).forEach(z=>{var $;($=z.Genres)==null||$.forEach(W=>I.add(W.toLowerCase()))}),console.log("[Recommendations] Genres of first 10 returned songs:",Array.from(I)),console.log("[Recommendations] Expected genres:",f.map(z=>z.toLowerCase()));const R=N.filter(z=>{var $;return($=z.Genres)==null?void 0:$.some(W=>f.some(b=>b.toLowerCase()===W.toLowerCase()))});console.log(`[Recommendations] Songs that actually match current track genres: ${R.length} out of ${N.length}`),R.length===0&&N.length>0&&(console.warn("[Recommendations] Returned songs do not match current track genres."),console.warn("[Recommendations] First 5 returned songs and their genres:",N.slice(0,5).map(z=>({name:z.Name,genres:z.Genres}))))}N.length===0&&console.warn("[Recommendations] No genre-matched songs found. Check if songs in library have matching genres.")}const y=N,g=Array.from(new Map(y.map(I=>[I.Id,I])).values());s&&console.log(`[Recommendations] After deduplication: ${g.length} unique candidates`);const w=new Set(t.filter(I=>I._isRecommended).map(I=>I.Id)),j=new Set([e.Id,...r?[r.Id]:[],...t.map(I=>I.Id),...n.map(I=>I.Id),...w]);s&&console.log(`[Recommendations] Filtering out ${j.size} recent songs (current + lastPlayed + queue + recentQueue + previouslyRecommended)`);const S=new Set(Array.from(j).map(I=>String(I))),C=g.filter(I=>{const R=String(I.Id);return!S.has(R)}),k=g.length-C.length;s&&(console.log(`[Recommendations] After filtering recent songs: ${C.length} candidates (filtered out ${k})`),C.length===0&&g.length>0&&console.warn("[Recommendations] All candidates were filtered out as recent songs!"));const A=C.filter(I=>{var R;return(R=I.Genres)==null?void 0:R.some(z=>f.some($=>$.toLowerCase()===z.toLowerCase()))});s&&console.log(`[Recommendations] Genre-matched songs: ${A.length}`);const E=t.filter(I=>!I._isRecommended);s&&console.log(`[Recommendations] User-added queue songs: ${E.length} (total queue: ${t.length})`);const M=new Set(E.map(I=>{var R,z;return I.AlbumArtist||((z=(R=I.ArtistItems)==null?void 0:R[0])==null?void 0:z.Id)}).filter(Boolean));s&&console.log(`[Recommendations] Queue artist IDs: ${M.size} unique artists`);const U=new Set(E.map(I=>I.Grouping).filter(I=>!!I));s&&console.log(`[Recommendations] Queue groupings: ${U.size} unique groupings`,U.size>0?Array.from(U):"none");const q=I=>I.sort((R,z)=>{var oe,O,K,te;const $=R.AlbumArtist||((O=(oe=R.ArtistItems)==null?void 0:oe[0])==null?void 0:O.Id),W=z.AlbumArtist||((te=(K=z.ArtistItems)==null?void 0:K[0])==null?void 0:te.Id),b=$&&M.has($),P=W&&M.has(W);return b&&!P?-1:!b&&P?1:0}),se=I=>I.sort((R,z)=>{const $=R.Grouping,W=z.Grouping,b=$&&U.has($),P=W&&U.has(W);return b&&!P?-1:!b&&P?1:0}),X=I=>!d||isNaN(d)?I:I.sort((R,z)=>{const $=R.ProductionYear||(R.PremiereDate?new Date(R.PremiereDate).getFullYear():null),W=z.ProductionYear||(z.PremiereDate?new Date(z.PremiereDate).getFullYear():null);if($&&!W)return-1;if(!$&&W)return 1;if(!$&&!W||!$||!W)return 0;const b=Math.abs($-d),P=Math.abs(W-d),oe=b<=3,O=P<=3;return oe&&!O?-1:!oe&&O?1:b-P}),F=q(A),Z=se(F),H=X(Z);s&&console.log(`[Recommendations] After prioritization: ${H.length} songs`);const T=new Map;H.forEach(I=>{const R=(()=>{var P,oe;const b=I.AlbumArtist||((oe=(P=I.ArtistItems)==null?void 0:P[0])==null?void 0:oe.Id);return b&&M.has(b)?"artist":"no-artist"})(),z=I.Grouping&&U.has(I.Grouping)?"grouping":"no-grouping",$=(()=>{if(!d||isNaN(d))return"no-year";const b=I.ProductionYear||(I.PremiereDate?new Date(I.PremiereDate).getFullYear():null);if(!b)return"no-year";const P=Math.abs(b-d);return P<=3?"year-close":P<=5?"year-medium":"year-far"})(),W=`${R}-${z}-${$}`;T.has(W)||T.set(W,[]),T.get(W).push(I)});const Q=I=>{var $;if(I.length<=1)return[...I];const R=[...I],z=3;for(let W=0;W<z;W++){const b=Date.now()+W*1e3+Math.random()*1e3;for(let P=R.length-1;P>0;P--){const oe=Math.sin(b+P)*1e4%1,O=Math.floor(Math.abs(oe)*(P+1)),K=R[P];R[P]=R[O],R[O]=K}}for(let W=R.length-1;W>0;W--){const b=Math.floor(Math.random()*(W+1)),P=R[W];R[W]=R[b],R[b]=P}if(s)if(I.length>0&&typeof(($=I[0])==null?void 0:$.Name)<"u"){const W=I.slice(0,5).map(P=>P==null?void 0:P.Name).join(", "),b=R.slice(0,5).map(P=>P==null?void 0:P.Name).join(", ");console.log(`[Recommendations] Shuffled ${I.length} items. First 5 before: [${W}], after: [${b}]`)}else console.log(`[Recommendations] Shuffled array of ${I.length} items`);return R},L=I=>{const R=I.split("-"),z=R[0]==="artist"?100:0,$=R[1]==="grouping"?50:0,W=R[2]==="year-close"?30:R[2]==="year-medium"?20:R[2]==="year-far"?10:0;return z+$+W},le=[],re=Array.from(T.keys()).sort((I,R)=>{const z=L(I),$=L(R);return z!==$?$-z:I.localeCompare(R)});s&&(console.log("[Recommendations] Priority groups:",Array.from(T.entries()).map(([I,R])=>{var z;return{key:I,count:R.length,priority:L(I),firstSong:(z=R[0])==null?void 0:z.Name}})),console.log(`[Recommendations] Priority group order (sorted by priority): ${re.join(", ")}`));for(const I of re){const R=T.get(I);s&&console.log(`[Recommendations] Processing priority group "${I}" with ${R.length} songs. First 3:`,R.slice(0,3).map($=>$.Name));const z=Q(R);s&&console.log("[Recommendations] After shuffle, first 3:",z.slice(0,3).map($=>$.Name)),le.push(...z)}s&&console.log(`[Recommendations] After randomization within groups: ${le.length} songs. First 5:`,le.slice(0,5).map(I=>I.Name));const fe=Q(le);s&&console.log(`[Recommendations] After FULL shuffle of all songs: ${fe.length} songs. First 5:`,fe.slice(0,5).map(I=>I.Name));const xe=e.AlbumArtist||((h=(m=e.ArtistItems)==null?void 0:m[0])==null?void 0:h.Id);s&&console.log(`[Recommendations] Current track artist ID: ${xe||"none"}`);let me=fe.filter((I,R)=>{var $,W;const z=I.AlbumArtist||((W=($=I.ArtistItems)==null?void 0:$[0])==null?void 0:W.Id);return R>2?!0:z!==xe});const he=le.length-me.length;if(s&&console.log(`[Recommendations] After filtering same artist: ${me.length} songs (filtered out ${he} same-artist songs)`),me.length===0&&le.length>0&&(s&&console.warn("[Recommendations] All songs filtered out due to same artist filter. Relaxing filter..."),me=le,console.log(`[Recommendations] Relaxed filter: now ${me.length} songs`)),me.length<5&&le.length>me.length){const I=le.filter(z=>{var W,b;return(z.AlbumArtist||((b=(W=z.ArtistItems)==null?void 0:W[0])==null?void 0:b.Id))===xe}),R=Math.min(5-me.length,I.length);if(R>0){const z=I.slice(0,R);me.push(...z),console.log(`[Recommendations] Added back ${z.length} same-artist songs to reach minimum`)}}me.length===0&&fe.length>0&&(s&&console.warn("[Recommendations] Still no results after safeguards, returning fully shuffled list"),me=fe.slice(0,10));const G=me.filter(I=>I.Id!==e.Id);s&&G.length!==me.length&&console.warn(`[Recommendations] Current track ${e.Name} (${e.Id}) was in recommendations and has been removed.`);let D=Q(G);D=Q(D);const J=D.slice(0,10);return s&&console.log(`[Recommendations] Final result: ${J.length} recommendations`),J}catch(f){return s&&console.error("[Recommendations] Error in getRecommendedSongs:",f),[]}}function w0(e){const t=[...e];for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}function N0(){const{queue:e,currentTrack:t,currentIndex:n,addToQueue:r,lastPlayedTrack:s,manuallyCleared:o,refreshCurrentTrack:a,isFetchingRecommendations:c,setIsFetchingRecommendations:i,collectionStartIndex:u,originalQueue:m,playedSongIds:h}=pe(),{enableQueueRecommendations:f}=ks(),d=p.useRef([]),v=p.useRef(!1);p.useEffect(()=>{d.current=e.slice(-20)},[e]),p.useEffect(()=>{const{shuffle:x}=pe.getState();let N=0;if(n>=0&&n<e.length?N=e.length-n:(e.length===1&&t||e.length===0&&t)&&(N=1),!!!(f&&!v.current&&!o&&t&&N>0&&N<=3)||!t)return;v.current=!0,i==null||i(!0),(async()=>{try{await a();const w=pe.getState().currentTrack||t,j=[],S=n>=0&&n<e.length?n:-1;if(S>=0){const Z=e[S];Z&&j.push(Z);const H=e[S+1];H&&j.push(H);const T=e[S+2];T&&j.push(T)}j.length===0&&w&&j.push(w);let C=12;j.length===2&&(C=6),j.length>=3&&(C=4);const k=new Map;for(let Z=0;Z<j.length;Z++){const H=j[Z];if(!H)continue;const T=await v0({currentTrack:H,queue:e,recentQueue:d.current,lastPlayedTrack:s});if(!Array.isArray(T)||T.length===0){console.warn(`[Recommendations Hook] Seed ${Z} returned no recommendations`);continue}T.filter(L=>L&&L.Id&&!k.has(String(L.Id))).slice(0,C).forEach(L=>{k.set(String(L.Id),L)})}let A=Array.from(k.values());const{queue:E,currentTrack:M,lastPlayedTrack:U,playedSongIds:q}=pe.getState(),se=A.filter(Z=>{const H=E.some(le=>le.Id===Z.Id),T=(M==null?void 0:M.Id)===Z.Id,Q=(U==null?void 0:U.Id)===Z.Id,L=q.includes(Z.Id);return H||T||Q||L?(console.warn(`[Recommendations Hook] Filtering out ${Z.Name} (${Z.Id}) - inQueue: ${H}, isCurrent: ${T}, isLastPlayed: ${Q}, alreadyPlayed: ${L}`),!1):!0});if(se.length<A.length&&console.warn(`[Recommendations Hook] Filtered out ${A.length-se.length} songs that are now in queue/playing`),se.length===0){console.warn("[Recommendations Hook] No safe combined recommendations remain after filtering");return}const F=w0(se).slice(0,12);F.length>0?r(F,!0):console.warn("[Recommendations Hook] No recommendations to add after shuffling/slicing")}catch(w){console.error("[Recommendations Hook] CRITICAL: Failed to get multi-seed recommendations:",w),console.error("[Recommendations Hook] Error details:",{message:w instanceof Error?w.message:String(w),stack:w instanceof Error?w.stack:"No stack trace",currentTrack:t==null?void 0:t.Name,queueLength:e.length})}finally{v.current=!1,i==null||i(!1)}})()},[n,e.length,t,e,r,s,o,a,f,i])}const cu={slate:"#64748b",gray:"#6b7280",zinc:"#71717a",neutral:"#737373",stone:"#78716c",red:"#ef4444",orange:"#f97316",amber:"#f59e0b",yellow:"#eab308",lime:"#84cc16",green:"#22c55e",emerald:"#10b981",teal:"#14b8a6",cyan:"#06b6d4",sky:"#0ea5e9",blue:"#3b82f6",indigo:"#6366f1",violet:"#8b5cf6",purple:"#a855f7",fuchsia:"#d946ef",pink:"#ec4899",rose:"#f43f5e"};function j0({children:e}){N0();const{accentColor:t}=ks(),{genres:n}=Ie(),{state:r}=Zl();return p.useEffect(()=>{const s=cu[t]||cu.blue;document.documentElement.style.setProperty("--accent-color",s)},[t]),p.useEffect(()=>{const s=r!=="idle"?"28px":"0px";document.documentElement.style.setProperty("--header-offset",s)},[r]),p.useEffect(()=>{n.length===0&&_.getGenres().catch(s=>{console.warn("Background genre preload failed:",s)})},[n.length]),l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:r!=="idle"?"28px":"0px"}}),l.jsx(y0,{}),l.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-zinc-900 z-40 pointer-events-none",style:{height:"calc(4rem + env(safe-area-inset-bottom) - 8px)"}}),l.jsxs("div",{className:"min-h-screen bg-black text-white",style:{paddingBottom:"calc(4rem + env(safe-area-inset-bottom) - 8px)",paddingTop:r!=="idle"?"28px":"0",overflowX:"hidden",maxWidth:"100vw",width:"100%"},children:[l.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:e}),l.jsx(x0,{}),l.jsx(f0,{})]})]})}const Hn=p.forwardRef(({value:e,onChange:t,placeholder:n="Search...",debounceMs:r=300,showClearButton:s=!1,onClear:o},a)=>{const[c,i]=p.useState(e),u=p.useRef(t),m=p.useRef(null),h=f=>{m.current=f,typeof a=="function"?a(f):a&&(a.current=f)};return p.useEffect(()=>{u.current=t},[t]),p.useEffect(()=>{const f=setTimeout(()=>{u.current(c)},r);return()=>clearTimeout(f)},[c,r]),p.useEffect(()=>{i(e)},[e]),l.jsxs("div",{className:"relative",children:[l.jsx("input",{ref:h,type:"text",value:c,onChange:f=>{i(f.target.value)},placeholder:n,className:`w-full px-4 py-2 ${s&&c?"pl-10 pr-10":"pl-10"} bg-zinc-900 border border-zinc-800 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)] focus:border-transparent`}),l.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s&&c&&l.jsx("button",{onClick:f=>{f.preventDefault(),f.stopPropagation(),i(""),o&&o(),setTimeout(()=>{var d;(d=m.current)==null||d.focus()},0)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 hover:text-white transition-colors","aria-label":"Clear search",type:"button",children:l.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"w-full h-full",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})});Hn.displayName="SearchInput";function Qn({isOpen:e,onClose:t,filterType:n,options:r=[],selectedValues:s=[],onApply:o,availableYears:a=[],yearRange:c={min:null,max:null},onApplyYear:i,genres:u=[]}){const[m,h]=p.useState(s),[f,d]=p.useState(c),v=p.useRef(null),x=p.useRef(null);p.useEffect(()=>{h(s)},[s]),p.useEffect(()=>{d(c)},[c]);const N=k=>{h(A=>A.includes(k)?A.filter(E=>E!==k):[...A,k])},y=()=>{n==="year"&&i?i(f):o&&o(m),t()},g=()=>{n==="year"?(d({min:null,max:null}),i&&i({min:null,max:null})):(h([]),o&&o([])),t()},w=a.length>0?a[0]:1900,j=a.length>0?a[a.length-1]:new Date().getFullYear();p.useEffect(()=>{if(n==="year"&&e&&a.length>0){if(v.current&&f.min!==null){const k=a.indexOf(f.min);k!==-1&&setTimeout(()=>{var E;const A=(E=v.current)==null?void 0:E.querySelector(`[data-year-index="${k}"]`);A&&A.scrollIntoView({behavior:"smooth",block:"center"})},100)}if(x.current&&f.max!==null){const k=a.indexOf(f.max);k!==-1&&setTimeout(()=>{var E;const A=(E=x.current)==null?void 0:E.querySelector(`[data-year-index="${k}"]`);A&&A.scrollIntoView({behavior:"smooth",block:"center"})},100)}}},[n,e,f.min,f.max,a]);const S=(k,A)=>{d(E=>{if(k==="min"){const M=E.max!==null&&A>E.max?E.max:A;return setTimeout(()=>{const U=a.indexOf(M);if(U!==-1&&v.current){const q=v.current.querySelector(`[data-year-index="${U}"]`);q&&q.scrollIntoView({behavior:"smooth",block:"center"})}},50),{...E,min:M}}else{const M=E.min!==null&&A<E.min?E.min:A;return setTimeout(()=>{const U=a.indexOf(M);if(U!==-1&&x.current){const q=x.current.querySelector(`[data-year-index="${U}"]`);q&&q.scrollIntoView({behavior:"smooth",block:"center"})}},50),{...E,max:M}}})},C=(f.min===null||f.min===w)&&(f.max===null||f.max===j)&&c.min===null&&c.max===null;return l.jsx(Kf,{isOpen:e,onClose:t,zIndex:10001,children:l.jsxs("div",{className:"pb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[l.jsxs("div",{className:"text-lg font-semibold text-white",children:["Filter by ",n==="genre"?"Genre":n==="year"?"Year":"Grouping"]}),l.jsx("button",{onClick:t,className:"w-8 h-8 flex items-center justify-center text-white hover:bg-white/10 rounded-full transition-colors","aria-label":"Close",children:l.jsx(u0,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"px-4 max-h-[75vh] overflow-y-auto",children:n==="year"?l.jsx("div",{className:"space-y-6",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx("div",{ref:v,className:"h-64 overflow-y-auto scroll-smooth snap-y snap-mandatory py-[calc(50%-1.5rem)]",children:a.length>0?a.map((k,A)=>{const E=f.min===k,M=f.max!==null&&k>f.max;return l.jsx("button",{"data-year-index":A,onClick:()=>S("min",k),disabled:M,className:`w-full py-3 px-4 text-center snap-center transition-colors ${E?"bg-[var(--accent-color)] text-white font-semibold rounded-lg":M?"text-gray-500 cursor-not-allowed":"text-white hover:bg-white/10"}`,children:k},k)}):l.jsx("div",{className:"text-center py-8 text-gray-400",children:l.jsx("div",{className:"text-sm",children:"No years available"})})}),l.jsx("div",{className:"absolute top-0 left-0 right-0 h-12 bg-gradient-to-b from-zinc-900 to-transparent pointer-events-none"}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-zinc-900 to-transparent pointer-events-none"})]}),l.jsx("div",{className:"text-white font-medium self-center",children:"to"}),l.jsxs("div",{className:"flex-1 relative",children:[l.jsx("div",{ref:x,className:"h-64 overflow-y-auto scroll-smooth snap-y snap-mandatory py-[calc(50%-1.5rem)]",children:a.length>0?a.map((k,A)=>{const E=f.max===k,M=f.min!==null&&k<f.min;return l.jsx("button",{"data-year-index":A,onClick:()=>S("max",k),disabled:M,className:`w-full py-3 px-4 text-center snap-center transition-colors ${E?"bg-[var(--accent-color)] text-white font-semibold rounded-lg":M?"text-gray-500 cursor-not-allowed":"text-white hover:bg-white/10"}`,children:k},k)}):l.jsx("div",{className:"text-center py-8 text-gray-400",children:l.jsx("div",{className:"text-sm",children:"No years available"})})}),l.jsx("div",{className:"absolute top-0 left-0 right-0 h-14 bg-gradient-to-b from-zinc-900 via-zinc-900/80 to-transparent pointer-events-none"}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-14 bg-gradient-to-t from-zinc-900 via-zinc-900/80 to-transparent pointer-events-none"})]})]})}):l.jsx("div",{className:"space-y-2",children:n==="genre"?u.length>0?[...u].sort((k,A)=>(k.Name||"").localeCompare(A.Name||"")).map(k=>{const A=k.Name||"",E=m.includes(A);return l.jsxs("button",{onClick:()=>N(A),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors text-left",children:[l.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${E?"bg-white border-white":"border-white/40 bg-transparent"}`,children:E&&l.jsx("svg",{className:"w-3 h-3 text-zinc-900",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),l.jsx("span",{className:"text-white font-medium",children:A})]},k.Id)}):l.jsx("div",{className:"text-center py-8 text-gray-400",children:l.jsx("div",{className:"text-sm",children:"No genres available"})}):r.length>0?r.map(k=>{const A=m.includes(k);return l.jsxs("button",{onClick:()=>N(k),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition-colors text-left",children:[l.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-colors ${A?"bg-white border-white":"border-white/40 bg-transparent"}`,children:A&&l.jsx("svg",{className:"w-3 h-3 text-zinc-900",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),l.jsx("span",{className:"text-white font-medium",children:k})]},k)}):l.jsx("div",{className:"text-center py-8 text-gray-400",children:l.jsxs("div",{className:"text-sm",children:["No ",n==="genre"?"genres":"groupings"," available"]})})})}),l.jsxs("div",{className:"flex gap-3 mt-6 px-4",children:[l.jsx("button",{onClick:g,disabled:n==="year"&&C,className:"flex-1 px-4 py-3 bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors",children:"Clear"}),l.jsx("button",{onClick:y,className:"flex-1 px-4 py-3 bg-white text-zinc-900 font-medium rounded-lg hover:bg-gray-100 transition-colors",children:"Apply"})]})]})})}async function Cs(e,t){var v,x,N,y;const n=await _.search(e,t);let r=((v=n.Songs)==null?void 0:v.Items)||[],s=((x=n.Albums)==null?void 0:x.Items)||[],o=((N=n.Artists)==null?void 0:N.Items)||[],a=((y=n.Playlists)==null?void 0:y.Items)||[];if(!(r.length>0||s.length>0||o.length>0||a.length>0)&&e.trim().length>0){const g=await As(t);r=g.songs,s=g.albums,o=g.artists,a=g.playlists}const u=Lt(e).toLowerCase().trim(),m=r.filter(g=>{var S,C,k;if(Lt(g.Name||"").toLowerCase().includes(u))return!0;const j=[];return g.AlbumArtist&&j.push(Lt(g.AlbumArtist)),(S=g.AlbumArtists)!=null&&S.length&&j.push(...g.AlbumArtists.map(A=>Lt(A.Name||"")).filter(Boolean)),(C=g.ArtistItems)!=null&&C.length&&j.push(...g.ArtistItems.map(A=>Lt(A.Name||"")).filter(Boolean)),!!(j.some(A=>A.toLowerCase().includes(u))||(k=g.Genres)!=null&&k.some(A=>Lt(A).toLowerCase().includes(u)))}),h=o.filter(g=>Lt(g.Name||"").toLowerCase().includes(u)),f=s.filter(g=>{var S,C;const w=Lt(g.Name||""),j=Lt(g.AlbumArtist||((C=(S=g.ArtistItems)==null?void 0:S[0])==null?void 0:C.Name)||"");return w.toLowerCase().includes(u)||j.toLowerCase().includes(u)}),d=a.filter(g=>Lt(g.Name||"").toLowerCase().includes(u));return{artists:h,albums:f,playlists:d,songs:m}}async function As(e){const[t,n,r,s]=await Promise.all([_.getArtists({limit:e}),_.getAlbums({limit:e}),_.getPlaylists({limit:e}),_.getSongs({limit:e})]);return{artists:t.Items||[],albums:n.Items||[],playlists:r.Items||[],songs:s.Items||[]}}const To=new Map;function I0({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var d,v;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,[i,u]=p.useState(null);p.useEffect(()=>{var g;if((g=e.ImageTags)!=null&&g.Primary){u(null);return}const x=To.get(e.Id);if(x!==void 0){u(x);return}let N=!1;return(async()=>{try{const{albums:w,songs:j}=await _.getArtistItems(e.Id),S=w[0],C=j.find(M=>M.AlbumId)||j[0],k=S||C,A=k?k.AlbumId||k.Id:null,E=A?_.getAlbumArtUrl(A,96):null;To.set(e.Id,E),N||u(E)}catch(w){console.error("Failed to load fallback album art for artist (home search):",e.Id,w),To.set(e.Id,null)}})(),()=>{N=!0}},[e.Id,e.ImageTags]);const m=x=>{if(c||a.current){x.preventDefault(),x.stopPropagation(),a.current=!1;return}t(e.Id)},h=x=>{x.preventDefault(),x.stopPropagation(),a.current=!0,n(e,"artist"),setTimeout(()=>{a.current=!1},100)},f=be({onLongPress:x=>{x.preventDefault(),a.current=!0,n(e,"artist")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left px-4 h-[72px]",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:s?l.jsx(tt,{className:"w-6 h-6 text-gray-500"}):(d=e.ImageTags)!=null&&d.Primary||i?l.jsx("img",{src:(v=e.ImageTags)!=null&&v.Primary?_.getArtistImageUrl(e.Id,96):i||"",alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):l.jsx(tt,{className:"w-6 h-6 text-gray-500"})}),l.jsx("div",{className:"flex-1 min-w-0",children:l.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function S0({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,i=d=>{if(c||a.current){d.preventDefault(),d.stopPropagation(),a.current=!1;return}t(e.Id)},u=d=>{d.preventDefault(),d.stopPropagation(),a.current=!0,n(e,"album"),setTimeout(()=>{a.current=!1},100)},m=be({onLongPress:d=>{d.preventDefault(),a.current=!0,n(e,"album")},onClick:i});return l.jsxs("button",{onClick:i,onContextMenu:u,...m,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function k0({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:s=!0}){var v,x;const{currentTrack:o}=pe(),a=p.useRef(!1),c=r===e.Id,[i,u]=p.useState(!1),m=N=>{const y=Math.floor(N/1e7),g=Math.floor(y/60),w=y%60;return`${g}:${w.toString().padStart(2,"0")}`},h=N=>{if(c||a.current){N.preventDefault(),N.stopPropagation(),a.current=!1;return}t(e)},f=N=>{N.preventDefault(),N.stopPropagation(),a.current=!0,n(e,"song"),setTimeout(()=>{a.current=!1},100)},d=be({onLongPress:N=>{N.preventDefault(),a.current=!0,n(e,"song")},onClick:h});return l.jsxs("button",{onClick:h,onContextMenu:f,...d,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:i?l.jsx(Ge,{className:"w-7 h-7 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>u(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(o==null?void 0:o.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),l.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((x=(v=e.ArtistItems)==null?void 0:v[0])==null?void 0:x.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:m(e.RunTimeTicks)})]})}function b0({onSearchStateChange:e}){const[t,n]=p.useState(""),[r,s]=p.useState(!1),[o,a]=p.useState(null),[c,i]=p.useState(!1),[u,m]=p.useState(!1),[h,f]=p.useState(null),[d,v]=p.useState(null),x=p.useRef(null),[N,y]=p.useState([]),[g,w]=p.useState({min:null,max:null}),[j,S]=p.useState(!1),[C,k]=p.useState(null),{genres:A}=Ie(),[E,M]=p.useState([]),[U,q]=p.useState(!1),[se,X]=p.useState(45),{playAlbum:F,addToQueue:Z,playTrack:H}=pe(),T=$e();p.useEffect(()=>{(async()=>{q(!0);try{const P=Ie.getState();if(P.years.length>0)M(P.years);else{const oe=await _.getYears();M(oe)}}catch(P){console.error("Failed to load filter values:",P)}finally{q(!1)}})()},[]);const Q=N.length>0||g.min!==null||g.max!==null;p.useEffect(()=>{const b=t.trim().length>0;if(b||Q){i(!0);const P=window.setTimeout(()=>{(async()=>{try{if(b){const O=await Cs(t,450);a(O)}else{const O=await As(450);a(O)}}catch(O){console.error("Search failed:",O),a(null)}finally{i(!1)}})()},250);return()=>{window.clearTimeout(P)}}else a(null),i(!1)},[t,Q]),p.useEffect(()=>{X(45)},[t,r,o==null?void 0:o.songs.length]),p.useEffect(()=>{var P;if(!r||!((P=o==null?void 0:o.songs)!=null&&P.length))return;const b=()=>{const oe=window.scrollY||document.documentElement.scrollTop,O=window.innerHeight||document.documentElement.clientHeight,K=document.documentElement.scrollHeight;oe+O*1.5>=K&&X(te=>Math.min(te+45,o.songs.length))};return window.addEventListener("scroll",b,{passive:!0}),()=>window.removeEventListener("scroll",b)},[r,o==null?void 0:o.songs.length]);const L=p.useMemo(()=>{if(!o)return null;const b=O=>{if(g.min!==null||g.max!==null)return!1;if(N.length>0){const K=O.Genres||[];if(!N.some(ue=>K.some(de=>de.toLowerCase()===ue.toLowerCase())))return!1}return!0},P=O=>{if(N.length>0){const K=O.Genres||[];if(!N.some(ue=>K.some(de=>de.toLowerCase()===ue.toLowerCase())))return!1}if(g.min!==null||g.max!==null){const K=O.ProductionYear;if(!K||K<=0||g.min!==null&&K<g.min||g.max!==null&&K>g.max)return!1}return!0},oe=O=>!(g.min!==null||g.max!==null||N.length>0);return{artists:o.artists.filter(b),albums:o.albums.filter(P),playlists:(o.playlists||[]).filter(oe),songs:o.songs.filter(P)}},[o,N,g]),le=b=>{n(b),b.trim().length>0&&!r&&s(!0)},re=b=>{T(`/artist/${b}`),s(!1),n(""),setSearchResults(null)},fe=b=>{T(`/album/${b}`),s(!1),n(""),setSearchResults(null)},xe=b=>{H(b,[b])},me=b=>{T(`/playlist/${b}`),s(!1),n(""),setSearchResults(null)},he=(b,P)=>{f(b),v(P),m(!0)},G=()=>{n(""),a(null)},D=()=>{s(!1),n(""),a(null),y([]),w({min:null,max:null})},J=b=>{k(b),S(!0)},I=b=>{y(b)},R=b=>{w(b)},z=b=>{b.preventDefault(),b.stopPropagation(),L!=null&&L.songs&&L.songs.length>0&&F(L.songs)},$=b=>{b.preventDefault(),b.stopPropagation(),L!=null&&L.songs&&L.songs.length>0&&Z(L.songs)},W=r;return p.useEffect(()=>{e&&e(W)},[W,e]),p.useEffect(()=>{var b;if(r&&((b=x.current)==null||b.focus(),x.current)){const P=x.current.value.length;x.current.setSelectionRange(P,P)}},[r]),l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("div",{className:"text-lg font-semibold text-white",children:"Tunetuna"}),l.jsx("button",{onClick:()=>T("/settings"),className:"w-8 h-8 flex items-center justify-center text-white hover:bg-gray-800 rounded-full transition-colors","aria-label":"Settings",children:l.jsx(n0,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"relative",onClick:()=>s(!0),children:l.jsx(Hn,{value:t,onChange:le,placeholder:"Search for artists, albums, songs...",showClearButton:t.trim().length>0,onClear:G})})]}),r&&Yn.createPortal(l.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:l.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:l.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[l.jsx("div",{className:"flex-1",children:l.jsx(Hn,{ref:x,value:t,onChange:le,showClearButton:t.trim().length>0,onClear:G})}),l.jsx("button",{onClick:D,className:"px-4 py-2 text-white text-sm font-medium hover:text-gray-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),l.jsxs("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(76px + env(safe-area-inset-top))"},children:[l.jsx("div",{className:"sticky bg-black z-10 pt-3 pb-4 border-b border-zinc-800",style:{top:"calc(76px + env(safe-area-inset-top))"},children:l.jsxs("div",{className:"flex items-center gap-3 px-4",children:[l.jsxs("button",{onClick:()=>J("genre"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${N.length>0?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by genre",children:[l.jsx(Gn,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Genre"})]}),l.jsxs("button",{onClick:()=>J("year"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${g.min!==null||g.max!==null?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by year",children:[l.jsx(_i,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Year"})]})]})}),l.jsx("div",{className:"pb-32 pt-4",children:c?l.jsx("div",{className:"flex items-center justify-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):L?l.jsxs("div",{className:"space-y-8",children:[L.artists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),l.jsx("div",{className:"space-y-0",children:L.artists.slice(0,5).map(b=>l.jsx(I0,{artist:b,onClick:re,onContextMenu:he,contextMenuItemId:(h==null?void 0:h.Id)||null},b.Id))})]}),L.albums.length>0&&l.jsxs("div",{className:"px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),l.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:L.albums.slice(0,12).map(b=>l.jsx(S0,{album:b,onClick:fe,onContextMenu:he,contextMenuItemId:(h==null?void 0:h.Id)||null},b.Id))})]}),L.playlists&&L.playlists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),l.jsx("div",{className:"space-y-0",children:L.playlists.map(b=>l.jsxs("button",{onClick:()=>me(b.Id),onContextMenu:P=>{P.preventDefault(),P.stopPropagation(),he(b,"playlist")},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:l.jsx("img",{src:_.getAlbumArtUrl(b.Id,96),alt:b.Name,className:"w-full h-full object-cover",loading:"lazy"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:b.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:b.ChildCount?`${b.ChildCount} tracks`:"Playlist"})]})]},b.Id))})]}),L.songs.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:z,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:l.jsx(st,{className:"w-5 h-5"})}),l.jsx("button",{type:"button",onClick:$,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:l.jsx(Dt,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"space-y-0",children:L.songs.map((b,P)=>l.jsx(k0,{song:b,onClick:xe,onContextMenu:he,contextMenuItemId:(h==null?void 0:h.Id)||null,showImage:P<se},b.Id))})]}),L.artists.length===0&&L.albums.length===0&&(!L.playlists||L.playlists.length===0)&&L.songs.length===0&&l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[l.jsx("div",{className:"text-lg mb-2",children:"No results found"}),l.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):l.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})]})]}),document.body),l.jsx(Be,{item:h,itemType:d,isOpen:u,onClose:()=>{m(!1),f(null),v(null)},zIndex:r?10001:1e4}),C==="genre"&&l.jsx(Qn,{isOpen:j,onClose:()=>S(!1),filterType:"genre",genres:A,selectedValues:N,onApply:I}),C==="year"&&l.jsx(Qn,{isOpen:j,onClose:()=>S(!1),filterType:"year",availableYears:E,yearRange:g,onApplyYear:R})]})}function uu({album:e,onNavigate:t,onContextMenu:n}){var a,c;const[r,s]=p.useState(!1),o=be({onLongPress:i=>{i.preventDefault(),n(e)},onClick:()=>t(e.Id)});return l.jsxs("button",{onClick:()=>t(e.Id),onContextMenu:i=>{i.preventDefault(),n(e)},...o,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-2 bg-zinc-900 flex items-center justify-center",children:r?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsx(lt,{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>s(!0)})}),l.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((c=(a=e.ArtistItems)==null?void 0:a[0])==null?void 0:c.Name)||"Unknown Artist"})]})}function C0(){const{recentlyAdded:e,setRecentlyAdded:t,setLoading:n}=Ie(),r=$e(),s=p.useRef(null),[o,a]=p.useState(0),[c,i]=p.useState(!1),[u,m]=p.useState(null);p.useEffect(()=>{(async()=>{n("recentlyAdded",!0);try{const N=await _.getRecentlyAdded(18);t(N.Items||[])}catch(N){console.error("Failed to load recently added:",N)}finally{n("recentlyAdded",!1)}})()},[t,n]);const h=()=>{if(!s.current)return;const x=s.current,N=x.scrollLeft,y=x.clientWidth,g=Math.round(N/y);a(g)},f=x=>{if(!s.current)return;const N=s.current,y=N.clientWidth;N.scrollTo({left:x*y,behavior:"smooth"})};if(!e||e.length===0)return null;const d=6,v=[];for(let x=0;x<e.length;x+=d)v.push(e.slice(x,x+d));return l.jsxs("div",{className:"px-4 mb-8",children:[l.jsx("h2",{className:"text-xl font-bold mb-4",children:"Recently Added"}),l.jsxs("div",{className:"md:hidden",children:[l.jsx("div",{ref:s,onScroll:h,className:"overflow-x-auto snap-x snap-mandatory scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:l.jsx("div",{className:"flex",style:{width:`${v.length*100}%`},children:v.map((x,N)=>{const y=Math.ceil(x.length/3);return l.jsx("div",{className:"snap-start flex-shrink-0 w-full",style:{width:`${100/v.length}%`},children:l.jsx("div",{className:"grid grid-cols-3 gap-3",style:{gridTemplateRows:`repeat(${y}, minmax(0, 1fr))`},children:x.map(g=>l.jsx(uu,{album:g,onNavigate:w=>r(`/album/${w}`),onContextMenu:w=>{m(w),i(!0)}},g.Id))})},N)})})}),v.length>1&&l.jsx("div",{className:"flex justify-center gap-2 mt-4",children:v.map((x,N)=>l.jsx("button",{onClick:()=>f(N),className:`w-2 h-2 rounded-full transition-colors ${N===o?"bg-white":"bg-gray-600"}`,"aria-label":`Go to page ${N+1}`},N))})]}),l.jsx("div",{className:"hidden md:block",children:l.jsx("div",{className:"grid grid-cols-4 gap-3",children:e.slice(0,8).map(x=>l.jsx(uu,{album:x,onNavigate:N=>r(`/album/${N}`),onContextMenu:N=>{m(N),i(!0)}},x.Id))})}),l.jsx("style",{children:`
        .scrollbar-hide::-webkit-scrollbar {
          display: none;
        }
      `}),l.jsx(Be,{item:u,itemType:"album",isOpen:c,onClose:()=>{i(!1),m(null)}})]})}function A0({song:e,onClick:t,onContextMenu:n}){var i,u;const{currentTrack:r}=pe(),[s,o]=p.useState(!1),a=m=>{const h=Math.floor(m/1e7),f=Math.floor(h/60),d=h%60;return`${f}:${d.toString().padStart(2,"0")}`},c=be({onLongPress:m=>{m.preventDefault(),n(e)},onClick:()=>t(e)});return l.jsxs("button",{onClick:()=>t(e),onContextMenu:m=>{m.preventDefault(),n(e)},...c,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-7 h-7 text-gray-500"}):l.jsx(lt,{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm",onError:()=>o(!0)})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(r==null?void 0:r.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),l.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((u=(i=e.ArtistItems)==null?void 0:i[0])==null?void 0:u.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:a(e.RunTimeTicks)})]})}function E0(){const{recentlyPlayed:e}=Ie(),{playTrack:t}=pe(),[n,r]=p.useState(!1),[s,o]=p.useState(null),a=c=>{t(c,e)};return!e||e.length===0?null:l.jsxs("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-xl font-bold mb-2 px-4",children:"Recently Played"}),l.jsx("div",{className:"space-y-0",children:e.map(c=>l.jsx(A0,{song:c,onClick:a,onContextMenu:i=>{o(i),r(!0)}},c.Id))}),l.jsx(Be,{item:s,itemType:"song",isOpen:n,onClose:()=>{r(!1),o(null)}})]})}function P0(){const[e,t]=p.useState(!1),{recentlyAdded:n,recentlyPlayed:r,loading:s}=Ie(),o=p.useRef(!1);p.useEffect(()=>{(s.recentlyAdded||s.recentlyPlayed)&&(o.current=!0)},[s.recentlyAdded,s.recentlyPlayed]);const a=o.current&&!s.recentlyAdded&&!s.recentlyPlayed&&n.length===0&&r.length===0;return l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsx(b0,{onSearchStateChange:t})})}),l.jsxs("div",{className:e?"hidden":"",style:{paddingTop:"calc(env(safe-area-inset-top) + 7.5rem)"},children:[l.jsx(C0,{}),l.jsx(E0,{}),a&&l.jsx("div",{className:"flex items-center justify-center py-16 text-gray-400",children:l.jsx("p",{children:"No music found"})})]})]})}const Ro=new Map;function T0({artist:e}){var f,d;const t=$e(),[n,r]=p.useState(!1),[s,o]=p.useState(!1),a=p.useRef(!1),[c,i]=p.useState(null);p.useEffect(()=>{var y;if((y=e.ImageTags)!=null&&y.Primary){i(null);return}const v=Ro.get(e.Id);if(v!==void 0){i(v);return}let x=!1;return(async()=>{try{const{albums:g,songs:w}=await _.getArtistItems(e.Id),j=g[0],S=w.find(E=>E.AlbumId)||w[0],C=j||S,k=C?C.AlbumId||C.Id:null,A=k?_.getAlbumArtUrl(k,96):null;Ro.set(e.Id,A),x||i(A)}catch(g){console.error("Failed to load fallback album art for artist:",e.Id,g),Ro.set(e.Id,null)}})(),()=>{x=!0}},[e.Id,e.ImageTags]);const u=v=>{if(a.current){v.preventDefault(),a.current=!1;return}t(`/artist/${e.Id}`)},m=be({onLongPress:v=>{v.preventDefault(),a.current=!0,o(!0)},onClick:u}),h=v=>{v.preventDefault(),v.stopPropagation(),a.current=!0,o(!0),setTimeout(()=>{a.current=!1},100)};return l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:u,onContextMenu:h,...m,className:"w-full flex items-center gap-4 hover:bg-white/10 transition-colors group px-4 h-[72px]",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:n?l.jsx(tt,{className:"w-6 h-6 text-gray-500"}):(f=e.ImageTags)!=null&&f.Primary||c?l.jsx("img",{src:(d=e.ImageTags)!=null&&d.Primary?_.getArtistImageUrl(e.Id,96):c||"",alt:e.Name,className:"w-full h-full object-cover",onError:()=>r(!0),loading:"lazy"}):l.jsx(tt,{className:"w-6 h-6 text-gray-500"})}),l.jsx("div",{className:"flex-1 min-w-0 text-left",children:l.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]}),l.jsx(Be,{item:e,itemType:"artist",isOpen:s,onClose:()=>o(!1)})]})}function $i({currentPage:e,totalPages:t,onPageChange:n,itemsPerPage:r,totalItems:s}){if(t<=1)return null;const o=e*r+1,a=Math.min((e+1)*r,s);return l.jsxs("div",{className:"flex items-center justify-between px-4 py-4",children:[l.jsxs("div",{className:"text-sm text-gray-400",children:["Showing ",o,"-",a," of ",s]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>n(e-1),disabled:e===0,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-gray-800 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Previous page",children:l.jsx(Ix,{className:"w-5 h-5"})}),l.jsxs("div",{className:"text-sm text-white min-w-[60px] text-center",children:[e+1," / ",t]}),l.jsx("button",{onClick:()=>n(e+1),disabled:e>=t-1,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-gray-800 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Next page",children:l.jsx(kx,{className:"w-5 h-5"})})]})]})}const Mo=new Map;function R0({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var d;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,[i,u]=p.useState(null);p.useEffect(()=>{var y;if((y=e.ImageTags)!=null&&y.Primary){u(null);return}const v=Mo.get(e.Id);if(v!==void 0){u(v);return}let x=!1;return(async()=>{try{const{albums:g,songs:w}=await _.getArtistItems(e.Id),j=g[0],S=w.find(E=>E.AlbumId)||w[0],C=j||S,k=C?C.AlbumId||C.Id:null,A=k?_.getAlbumArtUrl(k,96):null;Mo.set(e.Id,A),x||u(A)}catch(g){console.error("Failed to load fallback album art for artist (search item):",e.Id,g),Mo.set(e.Id,null)}})(),()=>{x=!0}},[e.Id,e.ImageTags]);const m=v=>{if(c||a.current){v.preventDefault(),v.stopPropagation(),a.current=!1;return}t(e.Id)},h=v=>{v.preventDefault(),v.stopPropagation(),a.current=!0,n(e,"artist"),setTimeout(()=>{a.current=!1},100)},f=be({onLongPress:v=>{v.preventDefault(),a.current=!0,n(e,"artist")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left cursor-pointer px-4 h-[72px]",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:s?l.jsx(tt,{className:"w-6 h-6 text-gray-500"}):i||(d=e.ImageTags)!=null&&d.Primary?l.jsx("img",{src:i||_.getArtistImageUrl(e.Id,96),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):l.jsx(tt,{className:"w-6 h-6 text-gray-500"})}),l.jsx("div",{className:"flex-1 min-w-0",children:l.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function M0({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,i=d=>{if(c||a.current){d.preventDefault(),d.stopPropagation(),a.current=!1;return}t(e.Id)},u=d=>{d.preventDefault(),d.stopPropagation(),a.current=!0,n(e,"album"),setTimeout(()=>{a.current=!1},100)},m=be({onLongPress:d=>{d.preventDefault(),a.current=!0,n(e,"album")},onClick:i});return l.jsxs("button",{onClick:i,onContextMenu:u,...m,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function L0({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:s=!0}){var d,v;const o=p.useRef(!1),a=r===e.Id,[c,i]=p.useState(!1),u=x=>{const N=Math.floor(x/1e7),y=Math.floor(N/60),g=N%60;return`${y}:${g.toString().padStart(2,"0")}`},m=x=>{if(a||o.current){x.preventDefault(),x.stopPropagation(),o.current=!1;return}t(e)},h=x=>{x.preventDefault(),x.stopPropagation(),o.current=!0,n(e,"song"),setTimeout(()=>{o.current=!1},100)},f=be({onLongPress:x=>{x.preventDefault(),o.current=!0,n(e,"song")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:c?l.jsx(Ge,{className:"w-7 h-7 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>i(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),l.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((v=(d=e.ArtistItems)==null?void 0:d[0])==null?void 0:v.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:u(e.RunTimeTicks)})]})}const Kn=90,du=45,_0=45,fu=45,z0=45;function D0(){const{artists:e,setArtists:t,sortPreferences:n,setSortPreference:r,setLoading:s,loading:o,genres:a}=Ie(),{playTrack:c,playAlbum:i,addToQueue:u}=pe(),[m,h]=p.useState(""),[f,d]=p.useState(!1),[v,x]=p.useState(null),[N,y]=p.useState(!1),[g,w]=p.useState(!1),[j,S]=p.useState(null),[C,k]=p.useState(null),[A,E]=p.useState(0),[M,U]=p.useState(0),[q,se]=p.useState(fu),X=$e(),F=p.useRef(null),[Z,H]=p.useState([]),[T,Q]=p.useState(!1),[L,le]=p.useState(null),re=n.artists,fe=p.useRef(!0),[xe,me]=p.useState(!1),he=p.useRef(re),[G,D]=p.useState(du),J=Z.length>0;p.useEffect(()=>{const ee=m.trim().length>0;if(ee||J){y(!0);const Y=window.setTimeout(()=>{(async()=>{try{if(ee){const ce=await Cs(m,450);x(ce)}else{const ce=await As(450);x(ce)}}catch(ce){console.error("Search failed:",ce),x(null)}finally{y(!1)}})()},250);return()=>{window.clearTimeout(Y)}}else x(null),y(!1)},[m,J]);const I=p.useMemo(()=>{if(!v)return null;const ee=ie=>{if(Z.length>0){const ce=ie.Genres||[];if(!Z.some(Ve=>ce.some(ne=>ne.toLowerCase()===Ve.toLowerCase())))return!1}return!0},Y=ie=>{if(Z.length>0){const ce=ie.Genres||[];if(!Z.some(Ve=>ce.some(ne=>ne.toLowerCase()===Ve.toLowerCase())))return!1}return!0};return{artists:v.artists.filter(ee),albums:v.albums.filter(Y),playlists:v.playlists||[],songs:v.songs.filter(Y)}},[v,Z]);p.useEffect(()=>{var ee;if(f&&((ee=F.current)==null||ee.focus(),F.current)){const Y=F.current.value.length;F.current.setSelectionRange(Y,Y)}},[f]);const R=ee=>{h(ee),ee.trim().length>0&&!f&&d(!0)},z=()=>{h(""),x(null)},$=()=>{d(!1),h(""),x(null),H([])},W=()=>{le("genre"),Q(!0)},b=ee=>{H(ee)},P=ee=>{X(`/artist/${ee}`),d(!1),h(""),x(null)},oe=ee=>{X(`/album/${ee}`),d(!1),h(""),x(null)},O=ee=>{c(ee,[ee])},K=ee=>{ee.preventDefault(),ee.stopPropagation(),I!=null&&I.songs&&I.songs.length>0&&i(I.songs)},te=ee=>{ee.preventDefault(),ee.stopPropagation(),I!=null&&I.songs&&I.songs.length>0&&u(I.songs)},ue=ee=>{X(`/playlist/${ee}`),d(!1),h(""),x(null)},de=(ee,Y)=>{S(ee),k(Y),w(!0)},Ne=async()=>{var Y;const ee=Date.now();s("artists",!0);try{const ie={limit:Kn,startIndex:A*Kn};re==="RecentlyAdded"?(ie.sortBy=["DateCreated"],ie.sortOrder="Descending"):(ie.sortBy=["SortName"],ie.sortOrder="Ascending");let ce=await _.getArtists(ie);(((Y=ce.Items)==null?void 0:Y.length)||0)===0&&(ce=await _.getArtists({limit:Kn,startIndex:A*Kn}));const je=ce.Items||[];U(ce.TotalRecordCount||0);const Ve=Date.now()-ee;t(je)}catch(ie){console.error("Failed to load artists:",ie),t([]),U(0)}finally{s("artists",!1),me(!1)}};return p.useEffect(()=>{!m.trim()&&!f&&E(0)},[re,m,f]),p.useEffect(()=>{D(du)},[m,f,v==null?void 0:v.songs.length]),p.useEffect(()=>{var Y;if(!f||!((Y=v==null?void 0:v.songs)!=null&&Y.length))return;const ee=()=>{const ie=window.scrollY||document.documentElement.scrollTop,ce=window.innerHeight||document.documentElement.clientHeight,je=document.documentElement.scrollHeight;ie+ce*1.5>=je&&D(Ve=>Math.min(Ve+_0,v.songs.length))};return window.addEventListener("scroll",ee,{passive:!0}),()=>window.removeEventListener("scroll",ee)},[f,v==null?void 0:v.songs.length]),p.useEffect(()=>{se(fu)},[A,e.length]),p.useEffect(()=>{const ee=()=>{const Y=window.scrollY||document.documentElement.scrollTop,ie=window.innerHeight||document.documentElement.clientHeight,ce=document.documentElement.scrollHeight;Y+ie*1.5>=ce&&se(je=>Math.min(je+z0,e.length))};return window.addEventListener("scroll",ee,{passive:!0}),()=>window.removeEventListener("scroll",ee)},[e.length]),p.useEffect(()=>{!m.trim()&&!f&&(!fe.current&&he.current!==re&&me(!0),he.current=re,Ne())},[A,re,m,f]),p.useEffect(()=>{fe.current&&(fe.current=!1)},[]),l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 border-b border-zinc-800",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"Artists"}),l.jsx("button",{onClick:()=>d(!0),className:"w-10 h-10 flex items-center justify-center text-white hover:bg-gray-800 rounded-full transition-colors","aria-label":"Search",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),!f&&l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("button",{onClick:()=>r("artists",re==="RecentlyAdded"?"Alphabetical":"RecentlyAdded"),className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[re==="RecentlyAdded"?"Recently Added":"Alphabetically",l.jsx(bs,{className:"w-4 h-4"})]}),o.artists&&!fe.current&&l.jsx("div",{className:"flex items-center",children:l.jsx(tn,{})})]})]})})}),l.jsx("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 7rem)"},children:!f&&l.jsxs("div",{className:xe?"opacity-50 pointer-events-none":"",children:[e.length===0&&!o.artists&&l.jsx("div",{className:"flex items-center justify-center py-8 text-gray-400",children:l.jsx("p",{children:"No artists found"})}),e.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-0",children:e.slice(0,q).map(ee=>l.jsx(T0,{artist:ee},ee.Id))}),l.jsx($i,{currentPage:A,totalPages:Math.ceil(M/Kn),onPageChange:E,itemsPerPage:Kn,totalItems:M})]})]})})]}),f&&Yn.createPortal(l.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:l.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:l.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[l.jsx("div",{className:"flex-1",children:l.jsx(Hn,{ref:F,value:m,onChange:R,showClearButton:m.trim().length>0,onClear:z})}),l.jsx("button",{onClick:$,className:"px-4 py-2 text-white text-sm font-medium hover:text-gray-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),l.jsxs("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(76px + env(safe-area-inset-top))"},children:[l.jsx("div",{className:"sticky bg-black z-10 pt-3 pb-4 border-b border-zinc-800",style:{top:"calc(76px + env(safe-area-inset-top))"},children:l.jsx("div",{className:"flex items-center gap-3 px-4",children:l.jsxs("button",{onClick:W,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${Z.length>0?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by genre",children:[l.jsx(Gn,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Genre"})]})})}),l.jsx("div",{className:"pb-32 pt-4",children:N?l.jsx("div",{className:"flex items-center justify-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):I?l.jsxs("div",{className:"space-y-8",children:[I.artists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),l.jsx("div",{className:"space-y-0",children:I.artists.map(ee=>l.jsx(R0,{artist:ee,onClick:P,onContextMenu:de,contextMenuItemId:(j==null?void 0:j.Id)||null},ee.Id))})]}),I.albums.length>0&&l.jsxs("div",{className:"px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),l.jsx("div",{className:"grid grid-cols-3 gap-4",children:I.albums.slice(0,9).map(ee=>l.jsx(M0,{album:ee,onClick:oe,onContextMenu:de,contextMenuItemId:(j==null?void 0:j.Id)||null},ee.Id))})]}),I.playlists&&I.playlists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),l.jsx("div",{className:"space-y-0",children:I.playlists.map(ee=>l.jsxs("button",{onClick:()=>ue(ee.Id),onContextMenu:Y=>{Y.preventDefault(),Y.stopPropagation(),de(ee,"playlist")},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:l.jsx("img",{src:_.getAlbumArtUrl(ee.Id,96),alt:ee.Name,className:"w-full h-full object-cover",loading:"lazy"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:ee.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:"Playlist"})]})]},ee.Id))})]}),I.songs.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:K,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:l.jsx(st,{className:"w-5 h-5"})}),l.jsx("button",{type:"button",onClick:te,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:l.jsx(Dt,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"space-y-0",children:I.songs.map((ee,Y)=>l.jsx(L0,{song:ee,onClick:O,onContextMenu:de,contextMenuItemId:(j==null?void 0:j.Id)||null,showImage:Y<G},ee.Id))})]}),I.artists.length===0&&I.albums.length===0&&(!I.playlists||I.playlists.length===0)&&I.songs.length===0&&l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[l.jsx("div",{className:"text-lg mb-2",children:"No results found"}),l.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):l.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})]})]}),document.body),L==="genre"&&l.jsx(Qn,{isOpen:T,onClose:()=>Q(!1),filterType:"genre",genres:a,selectedValues:Z,onApply:b}),l.jsx(Be,{item:j,itemType:C,isOpen:g,onClose:()=>{w(!1),S(null),k(null)}})]})}function O0({album:e}){var m,h;const t=$e(),[n,r]=p.useState(!1),[s,o]=p.useState(!1),a=p.useRef(!1),c=f=>{if(a.current){f.preventDefault(),a.current=!1;return}t(`/album/${e.Id}`)},i=be({onLongPress:f=>{f.preventDefault(),a.current=!0,r(!0)},onClick:c}),u=f=>{f.preventDefault(),f.stopPropagation(),a.current=!0,r(!0),setTimeout(()=>{a.current=!1},100)};return l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:c,onContextMenu:u,...i,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-2 bg-zinc-900 relative flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsx(lt,{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>o(!0)})}),l.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((h=(m=e.ArtistItems)==null?void 0:m[0])==null?void 0:h.Name)||"Unknown Artist"})]}),l.jsx(Be,{item:e,itemType:"album",isOpen:n,onClose:()=>r(!1)})]})}const Lo=new Map;function $0({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var d,v;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,[i,u]=p.useState(null);p.useEffect(()=>{var g;if((g=e.ImageTags)!=null&&g.Primary){u(null);return}const x=Lo.get(e.Id);if(x!==void 0){u(x);return}let N=!1;return(async()=>{try{const{albums:w,songs:j}=await _.getArtistItems(e.Id),S=w[0],C=j.find(M=>M.AlbumId)||j[0],k=S||C,A=k?k.AlbumId||k.Id:null,E=A?_.getAlbumArtUrl(A,96):null;Lo.set(e.Id,E),N||u(E)}catch(w){console.error("Failed to load fallback album art for artist (albums search):",e.Id,w),Lo.set(e.Id,null)}})(),()=>{N=!0}},[e.Id,e.ImageTags]);const m=x=>{if(c||a.current){x.preventDefault(),x.stopPropagation(),a.current=!1;return}t(e.Id)},h=x=>{x.preventDefault(),x.stopPropagation(),a.current=!0,n(e,"artist"),setTimeout(()=>{a.current=!1},100)},f=be({onLongPress:x=>{x.preventDefault(),a.current=!0,n(e,"artist")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left px-4 h-[72px]",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:s?l.jsx(tt,{className:"w-6 h-6 text-gray-500"}):(d=e.ImageTags)!=null&&d.Primary||i?l.jsx("img",{src:(v=e.ImageTags)!=null&&v.Primary?_.getArtistImageUrl(e.Id,96):i||"",alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):l.jsx(tt,{className:"w-6 h-6 text-gray-500"})}),l.jsx("div",{className:"flex-1 min-w-0",children:l.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function F0({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,i=d=>{if(c||a.current){d.preventDefault(),d.stopPropagation(),a.current=!1;return}t(e.Id)},u=d=>{d.preventDefault(),d.stopPropagation(),a.current=!0,n(e,"album"),setTimeout(()=>{a.current=!1},100)},m=be({onLongPress:d=>{d.preventDefault(),a.current=!0,n(e,"album")},onClick:i});return l.jsxs("button",{onClick:i,onContextMenu:u,...m,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function U0({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:s=!0}){var d,v;const o=p.useRef(!1),a=r===e.Id,[c,i]=p.useState(!1),u=x=>{const N=Math.floor(x/1e7),y=Math.floor(N/60),g=N%60;return`${y}:${g.toString().padStart(2,"0")}`},m=x=>{if(a||o.current){x.preventDefault(),x.stopPropagation(),o.current=!1;return}t(e)},h=x=>{x.preventDefault(),x.stopPropagation(),o.current=!0,n(e,"song"),setTimeout(()=>{o.current=!1},100)},f=be({onLongPress:x=>{x.preventDefault(),o.current=!0,n(e,"song")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:c?l.jsx(Ge,{className:"w-7 h-7 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>i(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),l.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((v=(d=e.ArtistItems)==null?void 0:d[0])==null?void 0:v.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:u(e.RunTimeTicks)})]})}const Ws=90,mu=45,B0=45,hu=45,G0=45;function H0(){const{albums:e,setAlbums:t,sortPreferences:n,setSortPreference:r,setLoading:s,loading:o,genres:a}=Ie(),{playTrack:c,playAlbum:i,addToQueue:u}=pe(),[m,h]=p.useState(""),[f,d]=p.useState(!1),[v,x]=p.useState(null),[N,y]=p.useState(!1),[g,w]=p.useState(!1),[j,S]=p.useState(null),[C,k]=p.useState(null),[A,E]=p.useState(0),[M,U]=p.useState(0),[q,se]=p.useState(mu),X=$e(),[F,Z]=Rg(),H=p.useRef(null),[T,Q]=p.useState([]),[L,le]=p.useState({min:null,max:null}),[re,fe]=p.useState(!1),[xe,me]=p.useState(null),[he,G]=p.useState([]),D=n.albums,J=p.useRef(!0),[I,R]=p.useState(!1),z=p.useRef(D),[$,W]=p.useState(hu);p.useEffect(()=>{const B=F.get("year");if(B){const ge=parseInt(B,10);!isNaN(ge)&&ge>0&&(le({min:ge,max:ge}),d(!0),Z({},{replace:!0}))}},[F,Z]),p.useEffect(()=>{(async()=>{try{const ge=Ie.getState();if(ge.years.length>0)G(ge.years);else{const Pe=await _.getYears();G(Pe)}}catch(ge){console.error("Failed to load filter values:",ge)}})()},[]);const b=T.length>0||L.min!==null||L.max!==null;p.useEffect(()=>{const B=m.trim().length>0;if(B||b){y(!0);const ge=window.setTimeout(()=>{(async()=>{try{if(B){const ke=await Cs(m,450);x(ke)}else{const ke=await As(450);x(ke)}}catch(ke){console.error("Search failed:",ke),x(null)}finally{y(!1)}})()},250);return()=>{window.clearTimeout(ge)}}else x(null),y(!1)},[m,b]);const P=p.useMemo(()=>{if(!v)return null;const B=ke=>{if(L.min!==null||L.max!==null)return!1;if(T.length>0){const Ke=ke.Genres||[];if(!T.some(Cn=>Ke.some(eo=>eo.toLowerCase()===Cn.toLowerCase())))return!1}return!0},ge=ke=>{if(T.length>0){const Ke=ke.Genres||[];if(!T.some(Cn=>Ke.some(eo=>eo.toLowerCase()===Cn.toLowerCase())))return!1}if(L.min!==null||L.max!==null){const Ke=ke.ProductionYear;if(!Ke||Ke<=0||L.min!==null&&Ke<L.min||L.max!==null&&Ke>L.max)return!1}return!0},Pe=ke=>!(L.min!==null||L.max!==null||T.length>0);return{albums:v.albums.filter(ge),artists:v.artists.filter(B),playlists:(v.playlists||[]).filter(Pe),songs:v.songs.filter(ge)}},[v,T,L]);p.useEffect(()=>{var B;if(f&&((B=H.current)==null||B.focus(),H.current)){const ge=H.current.value.length;H.current.setSelectionRange(ge,ge)}},[f]);const oe=B=>{h(B),B.trim().length>0&&!f&&d(!0)},O=()=>{h(""),x(null)},K=()=>{d(!1),h(""),x(null),Q([]),le({min:null,max:null})},te=B=>{me(B),fe(!0)},ue=B=>{Q(B)},de=B=>{le(B)},Ne=B=>{X(`/artist/${B}`),d(!1),h(""),x(null)},ee=B=>{X(`/album/${B}`),d(!1),h(""),x(null)},Y=B=>{c(B,[B])},ie=B=>{B.preventDefault(),B.stopPropagation(),P!=null&&P.songs&&P.songs.length>0&&i(P.songs)},ce=B=>{B.preventDefault(),B.stopPropagation(),P!=null&&P.songs&&P.songs.length>0&&u(P.songs)},je=B=>{X(`/playlist/${B}`),d(!1),h(""),x(null)},Ve=(B,ge)=>{S(B),k(ge),w(!0)};p.useEffect(()=>{m.trim()||E(0)},[D,m]),p.useEffect(()=>{W(hu)},[m,f,v==null?void 0:v.songs.length]),p.useEffect(()=>{var ge;if(!f||!((ge=v==null?void 0:v.songs)!=null&&ge.length))return;const B=()=>{const Pe=window.scrollY||document.documentElement.scrollTop,ke=window.innerHeight||document.documentElement.clientHeight,Ke=document.documentElement.scrollHeight;Pe+ke*1.5>=Ke&&W(Ft=>Math.min(Ft+G0,v.songs.length))};return window.addEventListener("scroll",B,{passive:!0}),()=>window.removeEventListener("scroll",B)},[f,v==null?void 0:v.songs.length]),p.useEffect(()=>{se(mu)},[A,e.length]),p.useEffect(()=>{const B=()=>{const ge=window.scrollY||document.documentElement.scrollTop,Pe=window.innerHeight||document.documentElement.clientHeight,ke=document.documentElement.scrollHeight;ge+Pe*1.5>=ke&&se(Ke=>Math.min(Ke+B0,e.length))};return window.addEventListener("scroll",B,{passive:!0}),()=>window.removeEventListener("scroll",B)},[e.length]),p.useEffect(()=>{m.trim()||(!J.current&&z.current!==D&&R(!0),z.current=D,ne())},[A,D,m]),p.useEffect(()=>{J.current&&(J.current=!1)},[]);const ne=async()=>{s("albums",!0);try{const B={limit:Ws,startIndex:A*Ws};D==="RecentlyAdded"?(B.sortBy=["DateCreated"],B.sortOrder="Descending"):(B.sortBy=["SortName"],B.sortOrder="Ascending");const ge=await _.getAlbums(B);t(ge.Items),U(ge.TotalRecordCount||0)}catch(B){console.error("Failed to load albums:",B),t([]),U(0)}finally{s("albums",!1),R(!1)}};return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 border-b border-zinc-800",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"Albums"}),l.jsx("button",{onClick:()=>d(!0),className:"w-10 h-10 flex items-center justify-center text-white hover:bg-gray-800 rounded-full transition-colors","aria-label":"Search",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),!f&&l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("button",{onClick:()=>r("albums",D==="RecentlyAdded"?"Alphabetical":"RecentlyAdded"),className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[D==="RecentlyAdded"?"Recently Added":"Alphabetically",l.jsx(bs,{className:"w-4 h-4"})]}),o.albums&&!J.current&&l.jsx("div",{className:"flex items-center",children:l.jsx(tn,{})})]})]})})}),l.jsx("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 7rem)"},children:!f&&l.jsx("div",{className:I?"opacity-50 pointer-events-none":"",children:e.length===0&&!o.albums?l.jsx("div",{className:"flex items-center justify-center py-16 text-gray-400",children:l.jsx("p",{children:"No albums found"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"p-4",children:l.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:e.slice(0,q).map(B=>l.jsx(O0,{album:B},B.Id))})}),l.jsx($i,{currentPage:A,totalPages:Math.ceil(M/Ws),onPageChange:E,itemsPerPage:Ws,totalItems:M})]})})})]}),f&&Yn.createPortal(l.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:l.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:l.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[l.jsx("div",{className:"flex-1",children:l.jsx(Hn,{ref:H,value:m,onChange:oe,showClearButton:m.trim().length>0,onClear:O})}),l.jsx("button",{onClick:K,className:"px-4 py-2 text-white text-sm font-medium hover:text-gray-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),l.jsxs("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(76px + env(safe-area-inset-top))"},children:[l.jsx("div",{className:"sticky bg-black z-10 pt-3 pb-4 border-b border-zinc-800",style:{top:"calc(76px + env(safe-area-inset-top))"},children:l.jsxs("div",{className:"flex items-center gap-3 px-4",children:[l.jsxs("button",{onClick:()=>te("genre"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${T.length>0?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by genre",children:[l.jsx(Gn,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Genre"})]}),l.jsxs("button",{onClick:()=>te("year"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${L.min!==null||L.max!==null?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by year",children:[l.jsx(_i,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Year"})]})]})}),l.jsx("div",{className:"pb-32 pt-4",children:N?l.jsx("div",{className:"flex items-center justify-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):P?l.jsxs("div",{className:"space-y-8",children:[P.albums.length>0&&l.jsxs("div",{className:"px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),l.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:P.albums.slice(0,9).map(B=>l.jsx(F0,{album:B,onClick:ee,onContextMenu:Ve,contextMenuItemId:(j==null?void 0:j.Id)||null},B.Id))})]}),P.artists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),l.jsx("div",{className:"space-y-0",children:P.artists.map(B=>l.jsx($0,{artist:B,onClick:Ne,onContextMenu:Ve,contextMenuItemId:(j==null?void 0:j.Id)||null},B.Id))})]}),P.playlists&&P.playlists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),l.jsx("div",{className:"space-y-0",children:P.playlists.map(B=>l.jsxs("button",{onClick:()=>je(B.Id),onContextMenu:ge=>{ge.preventDefault(),ge.stopPropagation(),Ve(B,"playlist")},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:l.jsx("img",{src:_.getAlbumArtUrl(B.Id,96),alt:B.Name,className:"w-full h-full object-cover",loading:"lazy"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:B.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:B.ChildCount?`${B.ChildCount} tracks`:"Playlist"})]})]},B.Id))})]}),P.songs.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:ie,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:l.jsx(st,{className:"w-5 h-5"})}),l.jsx("button",{type:"button",onClick:ce,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:l.jsx(Dt,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"space-y-0",children:P.songs.map((B,ge)=>l.jsx(U0,{song:B,onClick:Y,onContextMenu:Ve,contextMenuItemId:(j==null?void 0:j.Id)||null,showImage:ge<$},B.Id))})]}),P.artists.length===0&&P.albums.length===0&&(!P.playlists||P.playlists.length===0)&&P.songs.length===0&&l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[l.jsx("div",{className:"text-lg mb-2",children:"No results found"}),l.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):l.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})]})]}),document.body),xe==="genre"&&l.jsx(Qn,{isOpen:re,onClose:()=>fe(!1),filterType:"genre",genres:a,selectedValues:T,onApply:ue}),xe==="year"&&l.jsx(Qn,{isOpen:re,onClose:()=>fe(!1),filterType:"year",availableYears:he,yearRange:L,onApplyYear:de}),l.jsx(Be,{item:j,itemType:C,isOpen:g,onClose:()=>{w(!1),S(null),k(null)},zIndex:f?200:void 0})]})}function Xf({song:e,showImage:t=!0}){var d,v;const{playTrack:n,currentTrack:r}=pe(),[s,o]=p.useState(!1),a=p.useRef(!1),[c,i]=p.useState(!1),u=x=>{const N=Math.floor(x/1e7),y=Math.floor(N/60),g=N%60;return`${y}:${g.toString().padStart(2,"0")}`},m=x=>{if(a.current){x.preventDefault(),a.current=!1;return}n(e)},h=be({onLongPress:x=>{x.preventDefault(),a.current=!0,o(!0)},onClick:m}),f=x=>{x.preventDefault(),x.stopPropagation(),a.current=!0,o(!0),setTimeout(()=>{a.current=!1},100)};return l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:x=>{if(s||a.current){x.preventDefault(),x.stopPropagation();return}m(x)},onContextMenu:f,...h,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center flex items-center justify-center",children:c?l.jsx(Ge,{className:"w-7 h-7 text-gray-500"}):t?l.jsx(lt,{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm",onError:()=>i(!0)}):l.jsx("div",{className:"w-full h-full bg-zinc-900"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(r==null?void 0:r.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),l.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((v=(d=e.ArtistItems)==null?void 0:d[0])==null?void 0:v.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:u(e.RunTimeTicks)})]}),l.jsx(Be,{item:e,itemType:"song",isOpen:s,onClose:()=>o(!1)})]})}const _o=new Map;function Q0({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var d;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,[i,u]=p.useState(null);p.useEffect(()=>{var y;if((y=e.ImageTags)!=null&&y.Primary){u(null);return}const v=_o.get(e.Id);if(v!==void 0){u(v);return}let x=!1;return(async()=>{try{const{albums:g,songs:w}=await _.getArtistItems(e.Id),j=g[0],S=w.find(E=>E.AlbumId)||w[0],C=j||S,k=C?C.AlbumId||C.Id:null,A=k?_.getAlbumArtUrl(k,96):null;_o.set(e.Id,A),x||u(A)}catch(g){console.error("Failed to load fallback album art for artist (search item):",e.Id,g),_o.set(e.Id,null)}})(),()=>{x=!0}},[e.Id,e.ImageTags]);const m=v=>{if(c||a.current){v.preventDefault(),v.stopPropagation(),a.current=!1;return}t(e.Id)},h=v=>{v.preventDefault(),v.stopPropagation(),a.current=!0,n(e,"artist"),setTimeout(()=>{a.current=!1},100)},f=be({onLongPress:v=>{v.preventDefault(),a.current=!0,n(e,"artist")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left cursor-pointer px-4 h-[72px]",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:s?l.jsx(tt,{className:"w-6 h-6 text-gray-500"}):i||(d=e.ImageTags)!=null&&d.Primary?l.jsx("img",{src:i||_.getArtistImageUrl(e.Id,96),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):l.jsx(tt,{className:"w-6 h-6 text-gray-500"})}),l.jsx("div",{className:"flex-1 min-w-0",children:l.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function V0({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,i=d=>{if(c||a.current){d.preventDefault(),d.stopPropagation(),a.current=!1;return}t(e.Id)},u=d=>{d.preventDefault(),d.stopPropagation(),a.current=!0,n(e,"album"),setTimeout(()=>{a.current=!1},100)},m=be({onLongPress:d=>{d.preventDefault(),a.current=!0,n(e,"album")},onClick:i});return l.jsxs("button",{onClick:i,onContextMenu:u,...m,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function W0({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:s=!0}){var d,v;const o=p.useRef(!1),a=r===e.Id,[c,i]=p.useState(!1),u=x=>{const N=Math.floor(x/1e7),y=Math.floor(N/60),g=N%60;return`${y}:${g.toString().padStart(2,"0")}`},m=x=>{if(a||o.current){x.preventDefault(),x.stopPropagation(),o.current=!1;return}t(e)},h=x=>{x.preventDefault(),x.stopPropagation(),o.current=!0,n(e,"song"),setTimeout(()=>{o.current=!1},100)},f=be({onLongPress:x=>{x.preventDefault(),o.current=!0,n(e,"song")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:c?l.jsx(Ge,{className:"w-7 h-7 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>i(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),l.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((v=(d=e.ArtistItems)==null?void 0:d[0])==null?void 0:v.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:u(e.RunTimeTicks)})]})}const Ys=90,pu=45,Y0=45,gu=45,q0=45;function K0(){const{songs:e,setSongs:t,sortPreferences:n,setSortPreference:r,setLoading:s,loading:o,genres:a}=Ie(),{playTrack:c,playAlbum:i,addToQueue:u}=pe(),[m,h]=p.useState(""),[f,d]=p.useState(!1),[v,x]=p.useState(null),[N,y]=p.useState(!1),[g,w]=p.useState(null),[j,S]=p.useState(null),[C,k]=p.useState(!1),[A,E]=p.useState(0),[M,U]=p.useState(0),q=$e(),se=p.useRef(null),X=p.useRef(null),[F,Z]=p.useState([]),[H,T]=p.useState({min:null,max:null}),[Q,L]=p.useState(!1),[le,re]=p.useState(null),[fe,xe]=p.useState([]),me=n.songs,he=p.useRef(!0),[G,D]=p.useState(!1),J=p.useRef(me),[I,R]=p.useState(pu),[z,$]=p.useState(gu);p.useEffect(()=>{(async()=>{try{const B=Ie.getState();if(B.years.length>0)xe(B.years);else{const ge=await _.getYears();xe(ge)}}catch(B){console.error("Failed to load filter values:",B)}})()},[]);const W=F.length>0||H.min!==null||H.max!==null;p.useEffect(()=>{const ne=m.trim().length>0;if(ne||W){k(!0);const B=window.setTimeout(()=>{(async()=>{try{if(ne){const Pe=await Cs(m,450);x(Pe)}else{const Pe=await As(450);x(Pe)}}catch(Pe){console.error("Search failed:",Pe),x(null)}finally{k(!1)}})()},250);return()=>{window.clearTimeout(B)}}else x(null),k(!1)},[m,W]);const b=p.useMemo(()=>{if(!v)return null;const ne=Pe=>{if(H.min!==null||H.max!==null)return!1;if(F.length>0){const ke=Pe.Genres||[];if(!F.some(Ft=>ke.some(Cn=>Cn.toLowerCase()===Ft.toLowerCase())))return!1}return!0},B=Pe=>{if(F.length>0){const ke=Pe.Genres||[];if(!F.some(Ft=>ke.some(Cn=>Cn.toLowerCase()===Ft.toLowerCase())))return!1}if(H.min!==null||H.max!==null){const ke=Pe.ProductionYear;if(!ke||ke<=0||H.min!==null&&ke<H.min||H.max!==null&&ke>H.max)return!1}return!0},ge=Pe=>!(H.min!==null||H.max!==null||F.length>0);return{songs:v.songs.filter(B),artists:v.artists.filter(ne),albums:v.albums.filter(B),playlists:(v.playlists||[]).filter(ge)}},[v,F,H]);p.useEffect(()=>{var ne;if(f&&((ne=se.current)==null||ne.focus(),se.current)){const B=se.current.value.length;se.current.setSelectionRange(B,B)}},[f]);const P=ne=>{h(ne),ne.trim().length>0&&!f&&d(!0)},oe=()=>{h(""),x(null)},O=()=>{d(!1),h(""),x(null),Z([]),T({min:null,max:null})},K=ne=>{re(ne),L(!0)},te=ne=>{Z(ne)},ue=ne=>{T(ne)},de=ne=>{q(`/artist/${ne}`),d(!1),h(""),x(null)},Ne=ne=>{q(`/album/${ne}`),d(!1),h(""),x(null)},ee=ne=>{c(ne,[ne])},Y=ne=>{ne.preventDefault(),ne.stopPropagation(),b!=null&&b.songs&&b.songs.length>0&&i(b.songs)},ie=ne=>{ne.preventDefault(),ne.stopPropagation(),b!=null&&b.songs&&b.songs.length>0&&u(b.songs)},ce=ne=>{q(`/playlist/${ne}`),d(!1),h(""),x(null)},je=(ne,B)=>{w(ne),S(B),y(!0)};p.useEffect(()=>{m.trim()||E(0)},[me,m]),p.useEffect(()=>{$(gu)},[m,f,v==null?void 0:v.songs.length]),p.useEffect(()=>{var ge;const ne=X.current;if(!f||!ne||!((ge=v==null?void 0:v.songs)!=null&&ge.length))return;const B=()=>{const Pe=ne.scrollTop,ke=ne.clientHeight,Ke=ne.scrollHeight;Pe+ke*1.5>=Ke&&$(Ft=>Math.min(Ft+q0,v.songs.length))};return ne.addEventListener("scroll",B,{passive:!0}),()=>ne.removeEventListener("scroll",B)},[f,v==null?void 0:v.songs.length,z]),p.useEffect(()=>{R(pu)},[A,e.length]),p.useEffect(()=>{const ne=()=>{const B=window.scrollY||document.documentElement.scrollTop,ge=window.innerHeight||document.documentElement.clientHeight,Pe=document.documentElement.scrollHeight;B+ge*1.5>=Pe&&R(ke=>Math.min(ke+Y0,e.length))};return window.addEventListener("scroll",ne,{passive:!0}),()=>window.removeEventListener("scroll",ne)},[e.length]),p.useEffect(()=>{m.trim()||(!he.current&&J.current!==me&&D(!0),J.current=me,Ve())},[A,me,m]),p.useEffect(()=>{he.current&&(he.current=!1)},[]);const Ve=async()=>{s("songs",!0);try{const ne={limit:Ys,startIndex:A*Ys};me==="RecentlyAdded"?(ne.sortBy=["DateCreated"],ne.sortOrder="Descending"):(ne.sortBy=["SortName"],ne.sortOrder="Ascending");const B=await _.getSongs(ne);t(B.Items),U(B.TotalRecordCount||0)}catch(ne){console.error("Failed to load songs:",ne),t([]),U(0)}finally{s("songs",!1),D(!1)}};return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 border-b border-zinc-800",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"Songs"}),l.jsx("button",{onClick:()=>d(!0),className:"w-10 h-10 flex items-center justify-center text-white hover:bg-gray-800 rounded-full transition-colors","aria-label":"Search",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),!f&&l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("button",{onClick:()=>r("songs",me==="RecentlyAdded"?"Alphabetical":"RecentlyAdded"),className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[me==="RecentlyAdded"?"Recently Added":"Alphabetically",l.jsx(bs,{className:"w-4 h-4"})]}),o.songs&&!he.current&&l.jsx("div",{className:"flex items-center",children:l.jsx(tn,{})})]})]})})}),l.jsx("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 7rem)"},children:!f&&l.jsx("div",{className:G?"opacity-50 pointer-events-none":"",children:e.length===0&&!o.songs?l.jsx("div",{className:"flex items-center justify-center py-16 text-gray-400",children:l.jsx("p",{children:"No songs found"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-0",children:e.map((ne,B)=>l.jsx(Xf,{song:ne,showImage:B<I},ne.Id))}),l.jsx($i,{currentPage:A,totalPages:Math.ceil(M/Ys),onPageChange:E,itemsPerPage:Ys,totalItems:M})]})})})]}),f&&Yn.createPortal(l.jsxs("div",{ref:X,className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:l.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:l.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[l.jsx("div",{className:"flex-1",children:l.jsx(Hn,{ref:se,value:m,onChange:P,showClearButton:m.trim().length>0,onClear:oe})}),l.jsx("button",{onClick:O,className:"px-4 py-2 text-white text-sm font-medium hover:text-gray-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),l.jsxs("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(76px + env(safe-area-inset-top))"},children:[l.jsx("div",{className:"sticky bg-black z-10 pt-3 pb-4 border-b border-zinc-800",style:{top:"calc(76px + env(safe-area-inset-top))"},children:l.jsxs("div",{className:"flex items-center gap-3 px-4",children:[l.jsxs("button",{onClick:()=>K("genre"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${F.length>0?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by genre",children:[l.jsx(Gn,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Genre"})]}),l.jsxs("button",{onClick:()=>K("year"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${H.min!==null||H.max!==null?"bg-[var(--accent-color)] text-white":"bg-white/10 text-white hover:bg-white/20"}`,"aria-label":"Filter by year",children:[l.jsx(_i,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:"Year"})]})]})}),l.jsx("div",{className:"pb-32 pt-4",children:C?l.jsx("div",{className:"flex items-center justify-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):b?l.jsxs("div",{className:"space-y-8",children:[b.songs.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:Y,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:l.jsx(st,{className:"w-5 h-5"})}),l.jsx("button",{type:"button",onClick:ie,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:l.jsx(Dt,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"space-y-0",children:b.songs.map((ne,B)=>l.jsx(W0,{song:ne,onClick:ee,onContextMenu:je,contextMenuItemId:(g==null?void 0:g.Id)||null,showImage:B<z},ne.Id))})]}),b.artists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),l.jsx("div",{className:"space-y-0",children:b.artists.map(ne=>l.jsx(Q0,{artist:ne,onClick:de,onContextMenu:je,contextMenuItemId:(g==null?void 0:g.Id)||null},ne.Id))})]}),b.albums.length>0&&l.jsxs("div",{className:"px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),l.jsx("div",{className:"grid grid-cols-3 gap-4",children:b.albums.slice(0,9).map(ne=>l.jsx(V0,{album:ne,onClick:Ne,onContextMenu:je,contextMenuItemId:(g==null?void 0:g.Id)||null},ne.Id))})]}),b.playlists&&b.playlists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),l.jsx("div",{className:"space-y-0",children:b.playlists.map(ne=>l.jsxs("button",{onClick:()=>ce(ne.Id),onContextMenu:B=>{B.preventDefault(),B.stopPropagation(),je(ne,"playlist")},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:l.jsx("img",{src:_.getAlbumArtUrl(ne.Id,96),alt:ne.Name,className:"w-full h-full object-cover",loading:"lazy"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:ne.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:ne.ChildCount?`${ne.ChildCount} tracks`:"Playlist"})]})]},ne.Id))})]}),b.artists.length===0&&b.albums.length===0&&(!b.playlists||b.playlists.length===0)&&b.songs.length===0&&l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[l.jsx("div",{className:"text-lg mb-2",children:"No results found"}),l.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):l.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})]})]}),document.body),le==="genre"&&l.jsx(Qn,{isOpen:Q,onClose:()=>L(!1),filterType:"genre",genres:a,selectedValues:F,onApply:te}),le==="year"&&l.jsx(Qn,{isOpen:Q,onClose:()=>L(!1),filterType:"year",availableYears:fe,yearRange:H,onApplyYear:ue}),l.jsx(Be,{item:g,itemType:j,isOpen:N,onClose:()=>{y(!1),w(null),S(null)},zIndex:f?200:void 0})]})}function X0({genre:e}){const t=$e();return l.jsx("button",{onClick:()=>t(`/genre/${e.Id}`),className:"w-full flex items-center justify-between h-12 pl-4 pr-4 hover:bg-zinc-900 transition-colors group",children:l.jsx("div",{className:"text-base font-medium text-white group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})}function J0(){const{genres:e,setGenres:t,setLoading:n,loading:r}=Ie();return p.useEffect(()=>{if(e.length>0)return;(async()=>{n("genres",!0);try{const a=(await _.getGenres()||[]).sort((c,i)=>(c.Name||"").localeCompare(i.Name||""));t(a)}catch(o){console.error("Failed to load genres:",o),t([])}finally{n("genres",!1)}})()},[e.length,t,n]),l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsx("div",{className:"p-4",children:l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"Genres"}),r.genres&&l.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:l.jsx(tn,{})}),!r.genres&&l.jsx("div",{className:"w-10 h-10"})]})})})}),l.jsxs("div",{className:"pb-4",style:{paddingTop:"calc(env(safe-area-inset-top) + 6rem)"},children:[e.length===0&&!r.genres&&l.jsx("div",{className:"flex items-center justify-center py-8 text-gray-400",children:l.jsx("p",{children:"No genres found"})}),e.length>0&&l.jsx("div",{className:"space-y-2",children:[...e].sort((s,o)=>(s.Name||"").localeCompare(o.Name||"")).map(s=>l.jsx(X0,{genre:s},s.Id))})]})]})}function Z0({playlist:e}){const t=$e(),[n,r]=p.useState(!1),s=p.useRef(!1),o=i=>{if(s.current){i.preventDefault(),s.current=!1;return}t(`/playlist/${e.Id}`)},a=be({onLongPress:i=>{i.preventDefault(),s.current=!0,r(!0)},onClick:o}),c=i=>{i.preventDefault(),i.stopPropagation(),s.current=!0,r(!0),setTimeout(()=>{s.current=!1},100)};return l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:i=>{if(n||s.current){i.preventDefault(),i.stopPropagation();return}o(i)},onContextMenu:c,...a,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:l.jsx(lt,{src:_.getAlbumArtUrl(e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left flex flex-col justify-center",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.ChildCount?`${e.ChildCount} tracks`:"Playlist"})]})]}),l.jsx(Be,{item:e,itemType:"playlist",isOpen:n,onClose:()=>r(!1)})]})}const zo=new Map;function ey({artist:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var d,v;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,[i,u]=p.useState(null);p.useEffect(()=>{var g;if((g=e.ImageTags)!=null&&g.Primary){u(null);return}const x=zo.get(e.Id);if(x!==void 0){u(x);return}let N=!1;return(async()=>{try{const{albums:w,songs:j}=await _.getArtistItems(e.Id),S=w[0],C=j.find(M=>M.AlbumId)||j[0],k=S||C,A=k?k.AlbumId||k.Id:null,E=A?_.getAlbumArtUrl(A,96):null;zo.set(e.Id,E),N||u(E)}catch(w){console.error("Failed to load fallback album art for artist (playlists search):",e.Id,w),zo.set(e.Id,null)}})(),()=>{N=!0}},[e.Id,e.ImageTags]);const m=x=>{if(c||a.current){x.preventDefault(),x.stopPropagation(),a.current=!1;return}t(e.Id)},h=x=>{x.preventDefault(),x.stopPropagation(),a.current=!0,n(e,"artist"),setTimeout(()=>{a.current=!1},100)},f=be({onLongPress:x=>{x.preventDefault(),a.current=!0,n(e,"artist")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-4 hover:bg-white/10 transition-colors text-left px-4 h-[72px]",children:[l.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-zinc-900 flex items-center justify-center",children:s?l.jsx(tt,{className:"w-6 h-6 text-gray-500"}):(d=e.ImageTags)!=null&&d.Primary||i?l.jsx("img",{src:(v=e.ImageTags)!=null&&v.Primary?_.getArtistImageUrl(e.Id,96):i||"",alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0),loading:"lazy"}):l.jsx(tt,{className:"w-6 h-6 text-gray-500"})}),l.jsx("div",{className:"flex-1 min-w-0",children:l.jsx("div",{className:"text-base font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name})})]})}function ty({album:e,onClick:t,onContextMenu:n,contextMenuItemId:r}){var h,f;const[s,o]=p.useState(!1),a=p.useRef(!1),c=r===e.Id,i=d=>{if(c||a.current){d.preventDefault(),d.stopPropagation(),a.current=!1;return}t(e.Id)},u=d=>{d.preventDefault(),d.stopPropagation(),a.current=!0,n(e,"album"),setTimeout(()=>{a.current=!1},100)},m=be({onLongPress:d=>{d.preventDefault(),a.current=!0,n(e,"album")},onClick:i});return l.jsxs("button",{onClick:i,onContextMenu:u,...m,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-3 bg-zinc-900 shadow-lg relative flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",onError:()=>o(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsx("div",{className:"text-sm font-semibold text-white truncate mb-1",children:e.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:e.AlbumArtist||((f=(h=e.ArtistItems)==null?void 0:h[0])==null?void 0:f.Name)||"Unknown Artist"})]})}function ny({song:e,onClick:t,onContextMenu:n,contextMenuItemId:r,showImage:s=!0}){var d,v;const o=p.useRef(!1),a=r===e.Id,[c,i]=p.useState(!1),u=x=>{const N=Math.floor(x/1e7),y=Math.floor(N/60),g=N%60;return`${y}:${g.toString().padStart(2,"0")}`},m=x=>{if(a||o.current){x.preventDefault(),x.stopPropagation(),o.current=!1;return}t(e)},h=x=>{x.preventDefault(),x.stopPropagation(),o.current=!0,n(e,"song"),setTimeout(()=>{o.current=!1},100)},f=be({onLongPress:x=>{x.preventDefault(),o.current=!0,n(e,"song")},onClick:m});return l.jsxs("button",{onClick:m,onContextMenu:h,...f,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center relative flex items-center justify-center",children:c?l.jsx(Ge,{className:"w-7 h-7 text-gray-500"}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",loading:"lazy",onError:()=>i(!0)}),l.jsx("div",{className:"absolute inset-0 pointer-events-none border border-white rounded-sm",style:{borderColor:"rgba(255, 255, 255, 0.03)",borderWidth:"1px"}})]})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:e.Name}),l.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((v=(d=e.ArtistItems)==null?void 0:d[0])==null?void 0:v.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:u(e.RunTimeTicks)})]})}function ry(){const[e,t]=p.useState([]),[n,r]=p.useState(!0),{sortPreferences:s,setSortPreference:o}=Ie(),{playTrack:a,playAlbum:c,addToQueue:i}=pe(),u=s.playlists,m=p.useRef(!0),[h,f]=p.useState(!1),d=p.useRef(u),v=$e(),x=p.useRef(null),[N,y]=p.useState(""),[g,w]=p.useState(!1),[j,S]=p.useState(null),[C,k]=p.useState(!1),[A,E]=p.useState(!1),[M,U]=p.useState(null),[q,se]=p.useState(null),[X,F]=p.useState(45);p.useEffect(()=>{g||(!m.current&&d.current!==u&&f(!0),d.current=u,Z())},[u,g]),p.useEffect(()=>{m.current&&(m.current=!1)},[]),p.useEffect(()=>{if(N.trim()){k(!0);const D=window.setTimeout(()=>{(async()=>{try{const I=await Cs(N,450);S(I)}catch(I){console.error("Search failed:",I),S(null)}finally{k(!1)}})()},250);return()=>{window.clearTimeout(D)}}else S(null),k(!1)},[N]),p.useEffect(()=>{F(45)},[N,g,j==null?void 0:j.songs.length]),p.useEffect(()=>{var J;if(!g||!((J=j==null?void 0:j.songs)!=null&&J.length))return;const D=()=>{const I=window.scrollY||document.documentElement.scrollTop,R=window.innerHeight||document.documentElement.clientHeight,z=document.documentElement.scrollHeight;I+R*1.5>=z&&F($=>Math.min($+45,j.songs.length))};return window.addEventListener("scroll",D,{passive:!0}),()=>window.removeEventListener("scroll",D)},[g,j==null?void 0:j.songs.length]),p.useEffect(()=>{var D;if(g&&((D=x.current)==null||D.focus(),x.current)){const J=x.current.value.length;x.current.setSelectionRange(J,J)}},[g]);const Z=async()=>{r(!0);try{const D={limit:100};u==="RecentlyAdded"?(D.sortBy=["DateCreated"],D.sortOrder="Descending"):(D.sortBy=["SortName"],D.sortOrder="Ascending");const J=await _.getPlaylists(D);t(J.Items)}catch(D){console.error("Failed to load playlists:",D)}finally{r(!1),f(!1)}},H=D=>{y(D),D.trim().length>0&&!g&&w(!0)},T=()=>{y(""),S(null)},Q=()=>{w(!1),y(""),S(null)},L=D=>{v(`/artist/${D}`),w(!1),y(""),S(null)},le=D=>{v(`/album/${D}`),w(!1),y(""),S(null)},re=D=>{a(D,[D])},fe=D=>{D.preventDefault(),D.stopPropagation(),G!=null&&G.songs&&G.songs.length>0&&c(G.songs)},xe=D=>{D.preventDefault(),D.stopPropagation(),G!=null&&G.songs&&G.songs.length>0&&i(G.songs)},me=D=>{v(`/playlist/${D}`),w(!1),y(""),S(null)},he=(D,J)=>{U(D),se(J),E(!0)},G=p.useMemo(()=>j?{playlists:j.playlists||[],artists:j.artists||[],albums:j.albums||[],songs:j.songs||[]}:null,[j]);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 border-b border-zinc-800",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h1",{className:"text-2xl font-bold text-white",children:"Playlists"}),l.jsx("button",{onClick:()=>w(!0),className:"w-10 h-10 flex items-center justify-center text-white hover:bg-gray-800 rounded-full transition-colors","aria-label":"Search",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),!g&&l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("button",{onClick:()=>o("playlists",u==="RecentlyAdded"?"Alphabetical":"RecentlyAdded"),className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[u==="RecentlyAdded"?"Recently Added":"Alphabetically",l.jsx(bs,{className:"w-4 h-4"})]}),n&&!m.current&&l.jsx("div",{className:"flex items-center",children:l.jsx(tn,{})})]})]})})}),l.jsx("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 7rem)"},children:!g&&l.jsx("div",{className:h?"opacity-50 pointer-events-none":"",children:e.length===0&&!n?l.jsx("div",{className:"flex items-center justify-center py-16 text-gray-400",children:l.jsx("p",{children:"No playlists found"})}):l.jsx("div",{className:"space-y-0",children:e.map(D=>l.jsx(Z0,{playlist:D},D.Id))})})})]}),g&&Yn.createPortal(l.jsxs("div",{className:"fixed inset-0 bg-black z-[9999] overflow-y-auto p-0 m-0",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-50 pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)"}}),l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 pt-0 pb-0 w-full m-0",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))",height:"76px"},children:l.jsx("div",{className:"max-w-[768px] mx-auto w-full",children:l.jsxs("div",{className:"flex items-center gap-3 px-4 pt-4",children:[l.jsx("div",{className:"flex-1",children:l.jsx(Hn,{ref:x,value:N,onChange:H,showClearButton:N.trim().length>0,onClear:T})}),l.jsx("button",{onClick:Q,className:"px-4 py-2 text-white text-sm font-medium hover:text-gray-300 transition-colors whitespace-nowrap flex-shrink-0",children:"Cancel"})]})})}),l.jsx("div",{className:"max-w-[768px] mx-auto w-full",style:{paddingTop:"calc(76px + env(safe-area-inset-top))"},children:l.jsx("div",{className:"pb-32 pt-4",children:C?l.jsx("div",{className:"flex items-center justify-center py-16",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-zinc-800 border-t-[var(--accent-color)]"})}):G?l.jsxs("div",{className:"space-y-8",children:[G.playlists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Playlists"}),l.jsx("div",{className:"space-y-0",children:G.playlists.map(D=>l.jsxs("button",{onClick:()=>me(D.Id),onContextMenu:J=>{J.preventDefault(),J.stopPropagation(),he(D,"playlist")},className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:l.jsx("img",{src:_.getAlbumArtUrl(D.Id,96),alt:D.Name,className:"w-full h-full object-cover",loading:"lazy"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:"text-sm font-medium text-white truncate group-hover:text-[var(--accent-color)] transition-colors",children:D.Name}),l.jsx("div",{className:"text-xs text-gray-400 truncate",children:D.ChildCount?`${D.ChildCount} tracks`:"Playlist"})]})]},D.Id))})]}),G.artists.length>0&&l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4 px-4",children:"Artists"}),l.jsx("div",{className:"space-y-0",children:G.artists.map(D=>l.jsx(ey,{artist:D,onClick:L,onContextMenu:he,contextMenuItemId:(M==null?void 0:M.Id)||null},D.Id))})]}),G.albums.length>0&&l.jsxs("div",{className:"px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Albums"}),l.jsx("div",{className:"grid grid-cols-3 gap-4",children:G.albums.slice(0,9).map(D=>l.jsx(ty,{album:D,onClick:le,onContextMenu:he,contextMenuItemId:(M==null?void 0:M.Id)||null},D.Id))})]}),G.songs.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4 px-4",children:[l.jsx("h2",{className:"text-xl font-bold text-white",children:"Songs"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:fe,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:l.jsx(st,{className:"w-5 h-5"})}),l.jsx("button",{type:"button",onClick:xe,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:l.jsx(Dt,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"space-y-0",children:G.songs.map((D,J)=>l.jsx(ny,{song:D,onClick:re,onContextMenu:he,contextMenuItemId:(M==null?void 0:M.Id)||null,showImage:J<X},D.Id))})]}),G.playlists.length===0&&G.artists.length===0&&G.albums.length===0&&G.songs.length===0&&l.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4",children:[l.jsx("div",{className:"text-lg mb-2",children:"No results found"}),l.jsx("div",{className:"text-sm",children:"Try a different search term"})]})]}):l.jsx("div",{className:"flex flex-col items-center justify-center py-16 text-gray-400 px-4"})})})]}),document.body),l.jsx(Be,{item:M,itemType:q,isOpen:A,onClose:()=>{E(!1),U(null),se(null)}})]})}function sy({track:e,index:t,tracks:n,onClick:r,onContextMenu:s}){var i,u;const{currentTrack:o}=pe(),a=m=>{const h=Math.floor(m/1e7),f=Math.floor(h/60),d=h%60;return`${f}:${d.toString().padStart(2,"0")}`},c=be({onLongPress:m=>{m.preventDefault(),s(e)},onClick:()=>r(e,n)});return l.jsxs("button",{onClick:()=>r(e,n),onContextMenu:m=>{m.preventDefault(),s(e)},...c,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:l.jsx(lt,{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(o==null?void 0:o.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),l.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[e.AlbumArtist||((u=(i=e.ArtistItems)==null?void 0:i[0])==null?void 0:u.Name)||"Unknown Artist",e.Album&&`  ${e.Album}`]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:a(e.RunTimeTicks)})]})}function ly(){const{id:e}=Kl(),t=$e(),{playAlbum:n,playTrack:r,currentTrack:s,isPlaying:o}=pe(),[a,c]=p.useState(null),[i,u]=p.useState([]),[m,h]=p.useState(!0),[f,d]=p.useState(!1),[v,x]=p.useState(null),[N,y]=p.useState(!1);p.useEffect(()=>{if(!e)return;(async()=>{h(!0);try{const S=await _.getAlbumTracks(e);u(S);const k=(await _.getPlaylists({limit:1e3})).Items.find(A=>A.Id===e);k?c(k):S.length>0&&c({Id:e,Name:"Playlist",Type:"Playlist"})}catch(S){console.error("Failed to load playlist data:",S)}finally{h(!1)}})()},[e]);const g=()=>{i.length>0&&n(i)},w=()=>!i.length||!s?!1:i.some(j=>j.Id===s.Id);return m?l.jsx("div",{className:"pb-20",children:l.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:l.jsx("p",{children:"Loading..."})})}):!a||i.length===0?l.jsx("div",{className:"pb-20",children:l.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:l.jsx("p",{children:"Playlist not found"})})}):l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"flex items-center justify-between gap-4 px-4",style:{paddingTop:"calc(1rem + 8px)",paddingBottom:"1rem"},children:[l.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-gray-300 transition-colors",children:l.jsx(zn,{className:"w-6 h-6"})}),a&&l.jsx("button",{onClick:()=>y(!0),className:"text-white hover:text-gray-300 transition-colors",children:l.jsx(Di,{className:"w-6 h-6"})})]})})}),l.jsxs("div",{className:"pt-20",children:[l.jsx("div",{className:"mb-6 px-4 pt-4",children:l.jsxs("div",{className:"w-full",children:[l.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-0.5 text-left break-words",children:a.Name}),l.jsxs("div",{className:"flex items-center justify-between gap-4 mt-2",children:[l.jsxs("div",{className:"text-gray-400",children:[i.length," ",i.length===1?"track":"tracks"]}),l.jsx("button",{onClick:w()&&o?()=>pe.getState().pause():g,className:"bg-white/10 hover:bg-white/20 text-white font-semibold py-1.5 px-3 rounded-full transition-all hover:scale-105 flex items-center gap-1.5 backdrop-blur-sm border border-white/20 flex-shrink-0",children:w()&&o?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-3.5 h-3.5"}),"Pause"]}):l.jsxs(l.Fragment,{children:[l.jsx(st,{className:"w-3.5 h-3.5"}),"Play"]})})]})]})}),l.jsx("div",{children:l.jsx("div",{className:"space-y-0",children:i.map((j,S)=>l.jsx(sy,{track:j,index:S,tracks:i,onClick:C=>r(C,i),onContextMenu:C=>{x(C),d(!0)}},j.Id))})})]}),l.jsx(Be,{item:v,itemType:"song",isOpen:f,onClose:()=>{d(!1),x(null)}}),l.jsx(Be,{item:a,itemType:"playlist",isOpen:N,onClose:()=>{y(!1)}})]})}const oy=[{name:"zinc",hex:"#71717a"},{name:"red",hex:"#ef4444"},{name:"orange",hex:"#f97316"},{name:"amber",hex:"#f59e0b"},{name:"yellow",hex:"#eab308"},{name:"lime",hex:"#84cc16"},{name:"green",hex:"#22c55e"},{name:"emerald",hex:"#10b981"},{name:"teal",hex:"#14b8a6"},{name:"cyan",hex:"#06b6d4"},{name:"sky",hex:"#0ea5e9"},{name:"blue",hex:"#3b82f6"},{name:"indigo",hex:"#6366f1"},{name:"violet",hex:"#8b5cf6"},{name:"purple",hex:"#a855f7"},{name:"fuchsia",hex:"#d946ef"},{name:"pink",hex:"#ec4899"},{name:"rose",hex:"#f43f5e"}];function ay(){const e=$e(),{pageVisibility:t,setPageVisibility:n,accentColor:r,setAccentColor:s,enableQueueRecommendations:o,setEnableQueueRecommendations:a}=ks(),{logout:c,serverUrl:i}=Li(),{setGenres:u}=Ie(),{state:m,startSync:h,completeSync:f}=Zl(),[d,v]=p.useState(!1),x=()=>{c(),e("/")},N=w=>{n({[w]:!t[w]})},y=async()=>{h("settings","Syncing library...");try{await _.syncLibrary();const j=(await _.getGenres()||[]).sort((S,C)=>(S.Name||"").localeCompare(C.Name||""));u(j),f(!0,"Library synced successfully")}catch(w){f(!1,w instanceof Error?w.message:"Failed to sync library")}},g=async()=>{if(i)try{await navigator.clipboard.writeText(i),v(!0),setTimeout(()=>v(!1),1500)}catch{}};return l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 border-b border-gray-800",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"flex items-center gap-4 p-4",children:[l.jsx("button",{onClick:()=>e("/"),className:"text-white hover:text-gray-300 transition-colors",children:l.jsx(zn,{className:"w-6 h-6"})}),l.jsx("h1",{className:"text-xl font-bold flex-1",children:"Settings"})]})})}),l.jsxs("div",{className:"p-4 space-y-8",style:{paddingTop:"calc(env(safe-area-inset-top) + 4.5rem + 1rem)"},children:[l.jsxs("section",{children:[l.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Page Visibility"}),l.jsx("div",{className:"space-y-3",children:["artists","albums","songs","genres","playlists"].map(w=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-900 rounded-lg",children:[l.jsx("label",{className:"text-white capitalize font-medium",children:w}),l.jsx("button",{onClick:()=>N(w),className:`relative w-12 h-6 rounded-full transition-colors ${t[w]?"bg-[var(--accent-color)]":"bg-gray-600"}`,children:l.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${t[w]?"translate-x-6":"translate-x-0"}`})})]},w))})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Recommendations"}),l.jsx("div",{className:"space-y-3",children:l.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-900 rounded-lg",children:[l.jsx("label",{className:"text-white font-medium",children:"Recommendations in the queue"}),l.jsx("button",{onClick:()=>a(!o),className:`relative w-12 h-6 rounded-full transition-colors ${o?"bg-[var(--accent-color)]":"bg-gray-600"}`,children:l.jsx("span",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full transition-transform ${o?"translate-x-6":"translate-x-0"}`})})]})})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Accent Color"}),l.jsx("div",{className:"grid grid-cols-6 md:grid-cols-9 gap-3 mb-6",children:oy.map(w=>l.jsx("button",{onClick:()=>s(w.name),className:`aspect-square rounded-lg transition-all ${r===w.name?"ring-2 ring-white ring-offset-2 ring-offset-black scale-110":"hover:scale-105"}`,style:{backgroundColor:w.hex},"aria-label":`Select ${w.name} color`},w.name))}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-white mb-3",children:"About Tunetuna"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("a",{href:"https://github.com/AlessioLaiso/tunetuna",target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-3 bg-transparent border border-[var(--accent-color)] text-white hover:bg-[var(--accent-color)]/10 font-semibold rounded-full transition-colors text-center flex items-center justify-center gap-2",children:[l.jsx(Px,{className:"w-5 h-5"}),l.jsx("span",{children:"GitHub"})]}),l.jsxs("a",{href:"https://www.paypal.com/donate/?hosted_button_id=XBVKHU3JV9W8N",target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-3 bg-transparent border border-[var(--accent-color)] text-white hover:bg-[var(--accent-color)]/10 font-semibold rounded-full transition-colors text-center flex items-center justify-center gap-2",children:[l.jsx(_x,{className:"w-5 h-5"}),l.jsx("span",{children:"Donate"})]})]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-lg font-semibold text-white mb-1",children:"Jellyfin Library"}),l.jsxs("div",{className:"relative inline-block mb-3",children:[l.jsx("button",{type:"button",onClick:g,disabled:!i,className:`text-left text-xs break-all transition-colors ${i?"text-gray-400 hover:text-gray-200 cursor-pointer":"text-gray-600 cursor-not-allowed"}`,children:i?`Server: ${i}`:"Server: Not configured"}),d&&l.jsx("div",{className:"absolute left-0 mt-1 px-2 py-1 rounded bg-zinc-800 text-[10px] text-white shadow-lg",children:"Copied to clipboard"})]}),l.jsx("div",{className:"space-y-3",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:y,disabled:m==="syncing",className:"flex-1 px-4 py-3 bg-transparent border border-[var(--accent-color)] text-white hover:bg-[var(--accent-color)]/10 disabled:opacity-50 disabled:cursor-not-allowed font-semibold rounded-full transition-colors flex items-center justify-center gap-2",children:m==="syncing"?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{className:"w-5 h-5 animate-spin"}),l.jsx("span",{children:"Syncing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(Xr,{className:"w-5 h-5"}),l.jsx("span",{children:"Sync"})]})}),l.jsxs("button",{onClick:x,className:"flex-1 px-4 py-3 bg-transparent border border-red-500 text-red-500 hover:bg-red-500/10 font-semibold rounded-full transition-colors flex items-center justify-center gap-2",children:[l.jsx(Qx,{className:"w-5 h-5"}),l.jsx("span",{children:"Log Out"})]})]})})]})]})]})}function iy({album:e,year:t,onNavigate:n,onContextMenu:r}){const[s,o]=p.useState(!1),a=be({onLongPress:c=>{c.preventDefault(),r(e)},onClick:()=>n(e.Id)});return l.jsxs("button",{onClick:()=>n(e.Id),onContextMenu:c=>{c.preventDefault(),r(e)},...a,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-2 bg-zinc-900 flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsx(lt,{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>o(!0)})}),l.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.Name}),t&&l.jsx("div",{className:"text-xs text-gray-400 truncate",children:t})]})}function cy({song:e,album:t,year:n,onClick:r,onContextMenu:s}){const{currentTrack:o}=pe(),a=i=>{const u=Math.floor(i/1e7),m=Math.floor(u/60),h=u%60;return`${m}:${h.toString().padStart(2,"0")}`},c=be({onLongPress:i=>{i.preventDefault(),s(e)},onClick:()=>r(e)});return l.jsxs("button",{onClick:()=>r(e),onContextMenu:i=>{i.preventDefault(),s(e)},...c,className:"w-full flex items-center gap-3 hover:bg-white/10 transition-colors group px-4 py-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-sm overflow-hidden flex-shrink-0 bg-zinc-900 self-center",children:l.jsx(lt,{src:_.getAlbumArtUrl(e.AlbumId||e.Id,96),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded-sm"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(o==null?void 0:o.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name}),(t||n)&&l.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1 min-w-0",children:[t&&l.jsx("span",{className:"truncate",children:t}),t&&n&&l.jsx("span",{className:"flex-shrink-0",children:""}),n&&l.jsx("span",{className:"flex-shrink-0",children:n})]})]}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right",children:a(e.RunTimeTicks)})]})}function uy(){var he;const{id:e}=Kl(),t=$e(),{playAlbum:n,playTrack:r,currentTrack:s,isPlaying:o,pause:a,addToQueue:c}=pe(),[i,u]=p.useState(null),[m,h]=p.useState([]),[f,d]=p.useState([]),[v,x]=p.useState(!0),[N,y]=p.useState(!1),[g,w]=p.useState(!0),[j,S]=p.useState(!0),[C,k]=p.useState(!1),[A,E]=p.useState(null),[M,U]=p.useState(null),[q,se]=p.useState(!1),[X,F]=p.useState("Alphabetical"),Z=p.useRef(null);p.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[e]);const H=G=>G.toLowerCase().replace(/[_\*\-\.]/g,"").trim();p.useEffect(()=>{if(!e)return;(async()=>{var D;x(!0);try{let I=await _.getArtistById(e);if(!I){const W=(await _.getArtists({limit:1e3})).Items.find(b=>b.Id===e);W&&(I=W)}if(!I){x(!1);return}u(I),S(!0);const R=await _.getArtistItems(e);if(R.albums.length===0&&R.songs.length===0&&I.Name){const $=H(I.Name),b=((D=(await _.search(I.Name,50)).Artists)==null?void 0:D.Items)||[];for(const P of b)if(P.Id!==e&&H(P.Name)===$){const oe=await _.getArtistItems(P.Id);if(oe.albums.length>0||oe.songs.length>0){t(`/artist/${P.Id}`,{replace:!0});return}}}const z=[...R.albums].sort(($,W)=>{const b=$.ProductionYear||($.PremiereDate?new Date($.PremiereDate).getFullYear():0);return(W.ProductionYear||(W.PremiereDate?new Date(W.PremiereDate).getFullYear():0))-b});h(z),d(R.songs)}catch(J){console.error("Failed to load artist data:",J)}finally{x(!1)}})()},[e,t]),p.useEffect(()=>{if(!(i!=null&&i.Overview))return;w(!0);let G=null,D=null,J=null,I=!1;const R=()=>{const W=Z.current;if(!W||!(i!=null&&i.Overview)){w(!1);return}const b=window.getComputedStyle(W);let P=parseFloat(b.lineHeight||"0");if((!Number.isFinite(P)||P===0)&&(P=parseFloat(b.fontSize||"16")*1.5),P===0){w(!1);return}const oe=W.scrollHeight;if(oe===0&&!I){I=!0,z();return}const K=Math.round(oe/P)>2;w(K)},z=()=>{G!==null&&cancelAnimationFrame(G),D!==null&&clearTimeout(D),G=requestAnimationFrame(()=>{D=window.setTimeout(R,0)}),J!==null&&clearTimeout(J),J=window.setTimeout(()=>{I=!1,R()},300)},$=()=>{I=!1,z()};return z(),window.addEventListener("resize",$),()=>{G!==null&&cancelAnimationFrame(G),D!==null&&clearTimeout(D),J!==null&&clearTimeout(J),window.removeEventListener("resize",$)}},[i==null?void 0:i.Overview]);const T=()=>{if(re.length>0){const G=[...re].sort(()=>Math.random()-.5);n(G)}},Q=G=>G.ProductionYear?G.ProductionYear.toString():G.PremiereDate?new Date(G.PremiereDate).getFullYear().toString():null,L=G=>{const D=G.Album||null;let J=null;if(G.AlbumId){const I=m.find(R=>R.Id===G.AlbumId);I&&(J=Q(I))}return{album:D,year:J}},le=G=>{if(G.AlbumId){const J=m.find(I=>I.Id===G.AlbumId);if(J){const I=J.ProductionYear||(J.PremiereDate?new Date(J.PremiereDate).getFullYear():0);return J.PremiereDate&&new Date(J.PremiereDate).getMonth(),J.PremiereDate&&new Date(J.PremiereDate).getDate(),J.PremiereDate?new Date(J.PremiereDate).getTime():I*1e4}}const D=G.ProductionYear||(G.PremiereDate?new Date(G.PremiereDate).getFullYear():0);return G.PremiereDate?new Date(G.PremiereDate).getTime():D*1e4},re=p.useMemo(()=>{if(X==="Alphabetical")return[...f].sort((J,I)=>{const R=J.Name||"",z=I.Name||"";return R.localeCompare(z)});const G=(J,I,R)=>{const z=le(J),$=le(I),W=J.AlbumId||"",b=I.AlbumId||"";if(z!==$)return R?$-z:z-$;if(W!==b)return W.localeCompare(b);const P=J.IndexNumber||0,oe=I.IndexNumber||0;return P!==oe?P-oe:(J.Name||"").localeCompare(I.Name||"")},D=X==="Newest";return[...f].sort((J,I)=>G(J,I,D))},[f,X,m]),fe=G=>{G.preventDefault(),G.stopPropagation(),re.length>0&&n(re)},xe=G=>{G.preventDefault(),G.stopPropagation(),re.length>0&&c(re)},me=()=>{F(G=>G==="Alphabetical"?"Newest":G==="Newest"?"Oldest":"Alphabetical")};return v?l.jsx("div",{className:"pb-20",children:l.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:l.jsx(tn,{})})}):i?l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-[60]",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"relative flex items-center justify-between gap-4 p-4",children:[l.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-gray-300 transition-colors z-10",children:l.jsx(zn,{className:"w-6 h-6"})}),i&&l.jsx("button",{onClick:()=>se(!0),className:"text-white hover:text-gray-300 transition-colors z-10",children:l.jsx(Di,{className:"w-6 h-6"})})]})})}),l.jsxs("div",{className:"relative z-30 w-screen",style:{marginTop:"calc(-1 * env(safe-area-inset-top))",marginLeft:"calc(50% - 50vw)",marginRight:"calc(50% - 50vw)"},children:[j&&l.jsxs("div",{className:"relative w-full min-h-64 md:min-h-80 bg-black",style:{paddingTop:"env(safe-area-inset-top)"},children:[l.jsx("div",{className:"w-full flex items-center justify-center md:hidden",children:l.jsx(lt,{src:_.getArtistImageUrl(i.Id),alt:i.Name,className:"w-full h-auto object-contain",onError:()=>S(!1)})}),l.jsx("div",{className:"hidden md:block w-full h-80",children:l.jsx("img",{src:_.getArtistBackdropUrl(i.Id),alt:i.Name,className:"w-full h-full object-cover",onError:()=>S(!1)})}),l.jsx("div",{className:"absolute inset-x-0 top-0 bottom-[-1px] bg-gradient-to-b from-transparent via-black/60 to-black pointer-events-none"})]}),l.jsx("div",{className:`left-0 right-0 ${j?"absolute":"relative"} ${j?"pt-16":"pt-12"}`,style:j?{bottom:"-28px",paddingBottom:"1.5rem"}:{},children:l.jsxs("div",{className:"max-w-[768px] mx-auto px-4 flex items-end gap-6 md:grid md:grid-cols-3 md:gap-4",children:[j&&l.jsx("div",{className:"hidden md:block md:col-span-1",children:l.jsx("div",{className:"aspect-square rounded overflow-hidden bg-zinc-900 flex items-center justify-center",children:l.jsx(lt,{src:_.getArtistImageUrl(i.Id),alt:i.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded"})})}),l.jsx("div",{className:`flex-1 min-w-0 pb-2 ${j?"md:col-span-2":"md:col-span-3"}`,children:l.jsxs("div",{className:"mb-4 mt-4",children:[l.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-white mb-2 break-words",children:i.Name}),l.jsxs("div",{className:"flex items-center justify-between gap-4 mt-2",children:[l.jsxs("p",{className:"text-sm text-gray-300",children:[m.length," ",m.length===1?"album":"albums","  ",re.length," ",re.length===1?"song":"songs"]}),l.jsx("button",{onClick:()=>{var D;s&&o&&(((D=s.ArtistItems)==null?void 0:D.some(J=>J.Id===e))||s.AlbumArtist===(i==null?void 0:i.Name))?a():T()},className:"bg-white/10 hover:bg-white/20 text-white font-semibold py-1.5 px-3 rounded-full transition-all hover:scale-105 flex items-center gap-1.5 backdrop-blur-sm border border-white/20 flex-shrink-0",children:s&&o&&((he=s.ArtistItems)!=null&&he.some(G=>G.Id===e)||s.AlbumArtist===(i==null?void 0:i.Name))?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-3.5 h-3.5"}),"Pause"]}):l.jsxs(l.Fragment,{children:[l.jsx(Dn,{className:"w-3.5 h-3.5"}),"Shuffle"]})})]})]})})]})})]}),l.jsxs("div",{className:"pt-6 md:pt-10",children:[i.Overview&&l.jsx("div",{className:"mb-6 -mt-4 px-4",children:l.jsxs("div",{className:"text-white relative",children:[l.jsx("p",{ref:Z,className:"text-sm text-gray-300 leading-relaxed absolute opacity-0 pointer-events-none -z-10",children:i.Overview}),!N&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>y(!0),className:"flex-1 text-left min-w-0",children:l.jsx("p",{className:"text-sm text-gray-300 leading-relaxed line-clamp-2",children:i.Overview})}),l.jsx("button",{onClick:()=>y(!0),className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors",children:l.jsx(zi,{className:"w-4 h-4"})})]}),N&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-line",children:i.Overview}),l.jsxs("button",{onClick:()=>y(!1),className:"mt-2 flex items-center gap-1 text-sm text-gray-400 hover:text-white transition-colors ml-auto",children:["Show less",l.jsx(Vf,{className:"w-4 h-4"})]})]})]})}),m.length>0&&l.jsxs("div",{className:"mb-10 px-4",children:[l.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Albums (",m.length,")"]}),l.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:m.map(G=>{const D=Q(G);return l.jsx(iy,{album:G,year:D,onNavigate:J=>t(`/album/${J}`),onContextMenu:J=>{E(J),U("album"),k(!0)}},G.Id)})})]}),f.length>0&&l.jsxs("div",{id:"songs-section",children:[l.jsxs("div",{className:"px-4 mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Songs (",f.length,")"]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{type:"button",onClick:fe,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Play all songs",children:l.jsx(st,{className:"w-5 h-5"})}),l.jsx("button",{type:"button",onClick:xe,className:"w-10 h-10 flex items-center justify-center text-white hover:bg-white/10 rounded-lg transition-colors","aria-label":"Add all songs to queue",children:l.jsx(Dt,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"mt-1",children:l.jsxs("button",{type:"button",onClick:me,className:"text-sm text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[X,l.jsx(bs,{className:"w-4 h-4"})]})})]}),l.jsx("div",{className:"space-y-0",children:re.map(G=>{const{album:D,year:J}=L(G);return l.jsx(cy,{song:G,album:D,year:J,onClick:r,onContextMenu:I=>{E(I),U("song"),k(!0)}},G.Id)})})]})]}),l.jsx(Be,{item:A,itemType:M,isOpen:C,onClose:()=>{k(!1),E(null),U(null)}}),l.jsx(Be,{item:i,itemType:"artist",isOpen:q,onClose:()=>{se(!1)}})]}):l.jsx("div",{className:"pb-20",children:l.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:l.jsx("p",{children:"Artist not found on the Jellyfin server"})})})}function dy({track:e,trackNumber:t,tracks:n,onClick:r,onContextMenu:s}){const{currentTrack:o}=pe(),a=i=>{const u=Math.floor(i/1e7),m=Math.floor(u/60),h=u%60;return`${m}:${h.toString().padStart(2,"0")}`},c=be({onLongPress:i=>{i.preventDefault(),s(e)},onClick:()=>r(e,n)});return l.jsxs("button",{onClick:()=>r(e,n),onContextMenu:i=>{i.preventDefault(),s(e)},...c,className:"w-full flex items-baseline hover:bg-white/10 transition-colors group py-3",children:[l.jsx("span",{className:`text-sm w-6 text-right flex-shrink-0 mr-4 ${(o==null?void 0:o.Id)===e.Id?"text-[var(--accent-color)]":"text-gray-500"}`,children:t&&t>0?t:"-"}),l.jsx("div",{className:"flex-1 min-w-0 text-left",children:l.jsx("div",{className:`text-sm font-medium truncate transition-colors ${(o==null?void 0:o.Id)===e.Id?"text-[var(--accent-color)]":"text-white group-hover:text-[var(--accent-color)]"}`,children:e.Name})}),e.RunTimeTicks&&l.jsx("div",{className:"text-xs text-gray-500 flex-shrink-0 text-right mr-4",children:a(e.RunTimeTicks)})]})}function fy(){const{id:e}=Kl(),t=$e(),{playAlbum:n,playTrack:r,currentTrack:s,isPlaying:o,play:a,pause:c}=pe(),[i,u]=p.useState(null),[m,h]=p.useState([]),[f,d]=p.useState(!0),[v,x]=p.useState(!1),[N,y]=p.useState(!0),[g,w]=p.useState(!1),[j,S]=p.useState(null),[C,k]=p.useState(!1),[A,E]=p.useState(null),[M,U]=p.useState(!1),[q,se]=p.useState(!1),[X,F]=p.useState(!1),[Z,H]=p.useState(1),T=p.useRef(!1);p.useEffect(()=>{R.current=Z},[Z]);const[Q,L]=p.useState(0),le=p.useRef(0),re=p.useRef(null),fe=p.useRef(0),xe=p.useRef(!1),me=p.useRef(null),he=p.useRef(null),G=p.useRef(!1),D=p.useRef(null),J=p.useRef(!1),I=p.useRef(!1),R=p.useRef(1);p.useEffect(()=>{if(!e)return;(async()=>{var K;d(!0);try{const te=await _.getAlbumTracks(e);h(te);let de=await _.getAlbumById(e);if(!de){const Y=(await _.getAlbums({limit:1})).Items.find(ie=>ie.Id===e);Y&&(de=Y)}de||te.length>0&&te[0].AlbumId===e&&(de={Id:e,Name:te[0].Album||"Unknown Album",AlbumArtist:te[0].AlbumArtist}),de&&(u(de),y(!0));const Ne=z(te,de);if(Ne)try{const ee=await _.getArtistById(Ne);(K=ee==null?void 0:ee.ImageTags)!=null&&K.Logo?(E(_.getImageUrl(Ne,"Logo")),U(!0)):(U(!1),E(null))}catch(ee){console.warn("Failed to load artist logo:",ee),U(!1),E(null)}else U(!1),E(null)}catch(te){console.error("Failed to load album data:",te)}finally{d(!1)}})()},[e]),p.useEffect(()=>{const O=(s==null?void 0:s.AlbumId)===(i==null?void 0:i.Id)&&o,K=(i==null?void 0:i.Id)||null,te=he.current!==null&&he.current!==K;if(D.current&&(G.current&&!O||te)&&(clearTimeout(D.current),D.current=null),G.current=O,(!O||te)&&(I.current=!1,(O||te)&&(T.current=!1)),!N){se(!1),F(!1),H(1),he.current=K;return}return O?(T.current&&(T.current=!1),(te||!xe.current||!q)&&(se(!0),F(!1),H(1),R.current=1,xe.current=!0),J.current=window.innerWidth>=768,R.current===1&&J.current&&!I.current?(I.current=!0,D.current=window.setTimeout(()=>{(s==null?void 0:s.AlbumId)===(i==null?void 0:i.Id)&&o&&window.innerWidth>=768&&H(0)},500)):R.current===0&&!J.current&&(H(1),I.current=!1),he.current=K):xe.current&&q&&!O?(T.current||(T.current=!0,J.current&&R.current===0?(H(1),R.current=1,D.current=window.setTimeout(()=>{F(!1)},300)):(F(!1),H(1),R.current=1),J.current=!1),he.current=K):xe.current?(se(!1),F(!1),H(1),he.current=K):(se(!1),F(!1),H(1),xe.current=!0,he.current=K),()=>{}},[s==null?void 0:s.AlbumId,i==null?void 0:i.Id,o,q,N]),p.useEffect(()=>{const O=()=>{const K=(s==null?void 0:s.AlbumId)===(i==null?void 0:i.Id)&&o,te=window.innerWidth>=768;K&&q&&(J.current=te,te&&Z===1?(D.current&&clearTimeout(D.current),D.current=window.setTimeout(()=>{H(0)},100)):!te&&Z===0&&H(1))};return window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[s==null?void 0:s.AlbumId,i==null?void 0:i.Id,o,q,Z]),p.useEffect(()=>{if((s==null?void 0:s.AlbumId)===(i==null?void 0:i.Id)&&o){const K=te=>{fe.current===0&&(fe.current=te);const ue=te-fe.current,de=360/1e4;le.current=(le.current+de*ue)%360,L(le.current),fe.current=te,re.current=requestAnimationFrame(K)};fe.current=0,re.current=requestAnimationFrame(K)}else re.current&&(cancelAnimationFrame(re.current),re.current=null),fe.current=0;return()=>{re.current&&cancelAnimationFrame(re.current)}},[s==null?void 0:s.AlbumId,i==null?void 0:i.Id,o]);const z=(O,K)=>O.length>0&&O[0].ArtistItems&&O[0].ArtistItems.length>0?O[0].ArtistItems[0].Id:K!=null&&K.ArtistItems&&K.ArtistItems.length>0?K.ArtistItems[0].Id:null,$=()=>{m.length>0&&n(m)},W=()=>{if(m.length>0){const O=m[0];if(O.ProductionYear&&O.ProductionYear>0)return O.ProductionYear.toString();if(O.PremiereDate){const K=new Date(O.PremiereDate).getFullYear();if(K>0)return K.toString()}}return null},b=()=>m.length>0&&m[0].ArtistItems&&m[0].ArtistItems.length>0?m[0].ArtistItems[0].Id:i!=null&&i.ArtistItems&&i.ArtistItems.length>0?i.ArtistItems[0].Id:null,P=()=>{var O,K;return i.AlbumArtist||((K=(O=i.ArtistItems)==null?void 0:O[0])==null?void 0:K.Name)||null},oe=()=>{const O=b();O&&t(`/artist/${O}`)};return f?l.jsx("div",{className:"pb-20",children:l.jsx("div",{className:"flex items-center justify-center h-screen",children:l.jsx(tn,{})})}):!i||m.length===0?l.jsx("div",{className:"pb-20",children:l.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:l.jsx("p",{children:"Album not found"})})}):l.jsxs("div",{className:"pb-20",style:{overflowX:"hidden",maxWidth:"100vw",width:"100%"},children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 z-[55] pointer-events-none",style:{height:"env(safe-area-inset-top)",top:"var(--header-offset, 0px)",background:"transparent"}}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-10 pointer-events-none",style:{height:"calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 4rem)",top:"var(--header-offset, 0px)",background:`linear-gradient(to bottom,
            #000000 0%,
            #000000 calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 0.5rem),
            rgba(0, 0, 0, 0.95) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 1rem),
            rgba(0, 0, 0, 0.85) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 1.5rem),
            rgba(0, 0, 0, 0.7) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 2rem),
            rgba(0, 0, 0, 0.5) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 2.5rem),
            rgba(0, 0, 0, 0.3) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 3rem),
            rgba(0, 0, 0, 0.15) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 3.5rem),
            rgba(0, 0, 0, 0) calc(var(--header-offset, 0px) + env(safe-area-inset-top) + 4rem)
          )`}}),l.jsx("div",{className:"fixed top-0 left-0 right-0 z-20",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto relative",children:l.jsxs("div",{className:"flex items-center justify-between gap-4 p-4 relative z-10",children:[l.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-gray-300 transition-colors",children:l.jsx(zn,{className:"w-6 h-6"})}),i&&l.jsx("button",{onClick:()=>k(!0),className:"text-white hover:text-gray-300 transition-colors",children:l.jsx(Di,{className:"w-6 h-6"})})]})})}),l.jsxs("div",{style:{paddingTop:"calc(5rem + 12px - 48px)"},children:[l.jsxs("div",{className:"mb-6 px-4 pt-4",style:{overflow:"visible"},children:[N&&l.jsx("div",{className:"flex justify-center mb-6 relative",style:{overflowX:"visible",overflowY:"visible",paddingLeft:"16px",paddingRight:"16px"},children:l.jsxs("div",{ref:me,className:"w-64 h-64 relative",style:{overflow:"visible"},children:[l.jsx("div",{className:"absolute inset-0 rounded-full overflow-hidden",style:{opacity:q?1:0,zIndex:1},children:l.jsxs("div",{className:"w-full h-full",style:{transformOrigin:"center center",transform:`rotate(${Q}deg)`},children:[l.jsx("img",{src:"/assets/vinyl.png",alt:"Vinyl Record",className:"w-full h-full object-cover",onError:O=>{console.error("Failed to load vinyl image"),O.currentTarget.style.display="none"}}),l.jsx("div",{className:"absolute top-1/2 left-1/2 rounded-full",style:{width:"52%",height:"52%",backgroundColor:"#a1a1aa",transform:"translate(-50%, -50%)",transformOrigin:"center center"}}),M&&A?l.jsx("div",{className:"absolute top-1/2 left-1/2 rounded-full overflow-hidden flex items-center justify-center",style:{width:"47%",height:"47%",transform:"translate(-50%, -50%)",transformOrigin:"center center"},children:l.jsx("img",{src:A,alt:"Artist Logo",className:"w-full h-full object-contain",onError:()=>{U(!1),E(null)}})}):N?l.jsx("div",{className:"absolute top-1/2 left-1/2 rounded-full overflow-hidden flex items-center justify-center",style:{width:"52%",height:"52%",transform:"translate(-50%, -50%)",transformOrigin:"center center"},children:l.jsx("img",{src:_.getAlbumArtUrl(i.Id),alt:i.Name,className:"w-full h-full object-cover"})}):null]})}),l.jsx("div",{className:"absolute inset-0 rounded overflow-hidden bg-zinc-900 transition-all duration-500",style:{transform:(s==null?void 0:s.AlbumId)===i.Id&&o||X?"translateX(calc(-100% - 24px))":"translateX(0)",opacity:Z,transitionProperty:"transform, opacity",transitionDuration:"500ms, 300ms",transitionTimingFunction:"ease-in-out, ease-in-out",zIndex:10},children:l.jsx(lt,{src:_.getAlbumArtUrl(i.Id),alt:i.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>y(!1)})})]})}),l.jsxs("div",{className:"w-full",children:[l.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-0.5 text-left break-words",children:i.Name}),l.jsxs("div",{className:"flex items-center justify-between gap-4 mt-2",children:[l.jsxs("div",{className:"text-gray-400 flex items-center gap-1.5",children:[P()&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:oe,className:`hover:text-white transition-colors ${b()?"cursor-pointer":"cursor-default"}`,children:P()}),W()&&l.jsx("span",{children:""})]}),W()&&l.jsx("button",{onClick:()=>t(`/albums?year=${W()}`),className:"hover:text-white transition-colors cursor-pointer",children:W()})]}),l.jsx("button",{onClick:()=>{(s==null?void 0:s.AlbumId)===i.Id&&o?c():(s==null?void 0:s.AlbumId)===i.Id&&!o?a():$()},className:"bg-white/10 hover:bg-white/20 text-white font-semibold py-1.5 px-3 rounded-full transition-all hover:scale-105 flex items-center gap-1.5 backdrop-blur-sm border border-white/20 flex-shrink-0",children:(s==null?void 0:s.AlbumId)===i.Id&&o?l.jsxs(l.Fragment,{children:[l.jsx(bn,{className:"w-3.5 h-3.5"}),"Pause"]}):l.jsxs(l.Fragment,{children:[l.jsx(st,{className:"w-3.5 h-3.5"}),"Play"]})})]})]})]}),i.Overview&&l.jsx("div",{className:"mb-6 px-4",children:l.jsxs("div",{className:"text-white relative",children:[!v&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>x(!0),className:"flex-1 text-left min-w-0",children:l.jsx("p",{className:"text-sm text-gray-300 leading-relaxed line-clamp-2",children:i.Overview})}),l.jsx("button",{onClick:()=>x(!0),className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors",children:l.jsx(zi,{className:"w-4 h-4"})})]}),v&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-300 leading-relaxed whitespace-pre-line",children:i.Overview}),l.jsxs("button",{onClick:()=>x(!1),className:"mt-2 flex items-center gap-1 text-sm text-gray-400 hover:text-white transition-colors ml-auto",children:["Show less",l.jsx(Vf,{className:"w-4 h-4"})]})]})]})}),l.jsx("div",{children:l.jsx("div",{className:"space-y-0",children:(()=>{const O=new Map;m.forEach(ue=>{const de=ue.ParentIndexNumber??1;O.has(de)||O.set(de,[]),O.get(de).push(ue)});const K=O.size>1;return Array.from(O.keys()).sort((ue,de)=>ue-de).map(ue=>{const de=O.get(ue);return l.jsxs("div",{children:[K&&l.jsxs("div",{className:`px-4 py-2 text-xs font-medium text-gray-400 uppercase tracking-wider ${ue>1?"pt-4":""}`,children:["Disc ",ue]}),de.map(Ne=>l.jsx(dy,{track:Ne,trackNumber:Ne.IndexNumber??null,tracks:m,onClick:ee=>r(ee,m),onContextMenu:ee=>{S(ee),w(!0)}},Ne.Id))]},ue)})})()})})]}),l.jsx(Be,{item:j,itemType:"song",isOpen:g,onClose:()=>{w(!1),S(null)}}),l.jsx(Be,{item:i,itemType:"album",isOpen:C,onClose:()=>{k(!1)}})]})}function my({album:e,year:t,onNavigate:n,onContextMenu:r}){const[s,o]=p.useState(!1),a=be({onLongPress:c=>{c.preventDefault(),r(e)},onClick:()=>n(e.Id)});return l.jsxs("button",{onClick:()=>n(e.Id),onContextMenu:c=>{c.preventDefault(),r(e)},...a,className:"text-left group",children:[l.jsx("div",{className:"aspect-square rounded overflow-hidden mb-2 bg-zinc-900 flex items-center justify-center",children:s?l.jsx(Ge,{className:"w-12 h-12 text-gray-500"}):l.jsx(lt,{src:_.getAlbumArtUrl(e.Id,474),alt:e.Name,className:"w-full h-full object-cover",showOutline:!0,rounded:"rounded",onError:()=>o(!0)})}),l.jsx("div",{className:"text-sm font-medium text-white truncate",children:e.Name}),t&&l.jsx("div",{className:"text-xs text-gray-400 truncate",children:t})]})}function hy(){var E;const{id:e}=Kl(),t=$e(),{playAlbum:n,toggleShuffle:r,currentTrack:s,isPlaying:o,pause:a}=pe(),{genres:c,genreSongs:i,setGenreSongs:u}=Ie(),[m,h]=p.useState(null),[f,d]=p.useState([]),[v,x]=p.useState(!0),[N,y]=p.useState(!1),[g,w]=p.useState(null),[j,S]=p.useState(null);p.useEffect(()=>{if(!e)return;(async()=>{const U=i[e];if(U&&U.length>0){let q=c;q.length===0&&(q=await _.getGenres());const se=q.find(X=>X.Id===e);se&&h(se),d(U),x(!1);return}x(!0);try{let q=c;q.length===0&&(q=await _.getGenres());const se=q.find(Z=>Z.Id===e);if(!se){x(!1);return}h(se);const X=se.Name;if(!X){x(!1);return}const F=await _.getGenreSongs(e,X);u(e,F),d(F)}catch(q){console.error("Failed to load genre songs:",q)}finally{x(!1)}})()},[e,c,i,u]);const C=()=>{if(f.length>0){const M=[...f].sort(()=>Math.random()-.5),{shuffle:U}=pe.getState();U||r(),n(M)}},k=p.useMemo(()=>{const M=new Map;return f.forEach(U=>{U.AlbumId&&U.Album&&(M.has(U.AlbumId)||M.set(U.AlbumId,{Id:U.AlbumId,Name:U.Album,AlbumArtist:U.AlbumArtist,ArtistItems:U.ArtistItems,ProductionYear:U.ProductionYear,PremiereDate:U.PremiereDate}))}),Array.from(M.values()).sort((U,q)=>{const se=U.ProductionYear||(U.PremiereDate?new Date(U.PremiereDate).getFullYear():0),X=q.ProductionYear||(q.PremiereDate?new Date(q.PremiereDate).getFullYear():0);if(se!==X)return X-se;const F=U.Name||"",Z=q.Name||"";return F.localeCompare(Z)})},[f]),A=p.useMemo(()=>{const M=new Map;f.forEach(q=>{var Z,H;const se=q.AlbumArtist||((H=(Z=q.ArtistItems)==null?void 0:Z[0])==null?void 0:H.Name)||"Unknown Artist",X=q.AlbumId||"no-album";M.has(se)||M.set(se,new Map);const F=M.get(se);F.has(X)||F.set(X,[]),F.get(X).push(q)});const U=[];return M.forEach((q,se)=>{const X=[];q.forEach((F,Z)=>{var Q;const H=[...F].sort((L,le)=>{const re=L.IndexNumber||0,fe=le.IndexNumber||0;return re-fe}),T=((Q=H[0])==null?void 0:Q.Album)||"Unknown Album";X.push({albumId:Z,albumName:T,songs:H})}),X.sort((F,Z)=>{const H=F.songs[0],T=Z.songs[0],Q=(H==null?void 0:H.ProductionYear)||(H!=null&&H.PremiereDate?new Date(H.PremiereDate).getFullYear():0),L=(T==null?void 0:T.ProductionYear)||(T!=null&&T.PremiereDate?new Date(T.PremiereDate).getFullYear():0);return Q!==L?L-Q:F.albumName.localeCompare(Z.albumName)}),U.push({artist:se,albums:X})}),U.sort((q,se)=>q.artist.localeCompare(se.artist)),U},[f]);return v?l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 border-b border-zinc-800",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"flex items-center gap-4 p-4",children:[l.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-gray-300 transition-colors",children:l.jsx(zn,{className:"w-6 h-6"})}),l.jsx("h1",{className:"text-xl font-bold flex-1 truncate",children:(m==null?void 0:m.Name)||""}),l.jsx("div",{className:"flex items-center",children:l.jsx(tn,{})})]})})}),l.jsx("div",{className:"pt-20",children:l.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400"})})]}):!m||f.length===0?l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 border-b border-zinc-800",style:{top:"calc(var(--header-offset, 0px) + env(safe-area-inset-top))"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"flex items-center gap-4 p-4",children:[l.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-gray-300 transition-colors",children:l.jsx(zn,{className:"w-6 h-6"})}),l.jsx("h1",{className:"text-xl font-bold flex-1 truncate",children:"Genre"})]})})}),l.jsx("div",{className:"pt-20",children:l.jsx("div",{className:"flex items-center justify-center h-screen text-gray-400",children:l.jsx("p",{children:"Genre not found or no songs available"})})})]}):l.jsxs("div",{className:"pb-20",children:[l.jsx("div",{className:"fixed top-0 left-0 right-0 bg-black z-10 border-b border-zinc-800",style:{top:"env(safe-area-inset-top)"},children:l.jsx("div",{className:"max-w-[768px] mx-auto",children:l.jsxs("div",{className:"flex items-center gap-4 p-4",children:[l.jsx("button",{onClick:()=>t(-1),className:"text-white hover:text-gray-300 transition-colors",children:l.jsx(zn,{className:"w-6 h-6"})}),l.jsx("h1",{className:"text-xl font-bold flex-1 truncate",children:m.Name}),l.jsx("button",{onClick:()=>{var U;s&&o&&m&&((U=s.Genres)==null?void 0:U.some(q=>{var se;return q.toLowerCase()===((se=m.Name)==null?void 0:se.toLowerCase())}))?a():C()},className:"w-10 h-10 flex items-center justify-center rounded-full bg-white/10 hover:bg-white/20 text-white transition-colors backdrop-blur-sm border border-white/20 flex-shrink-0",children:s&&o&&m&&((E=s.Genres)!=null&&E.some(M=>{var U;return M.toLowerCase()===((U=m.Name)==null?void 0:U.toLowerCase())}))?l.jsx(bn,{className:"w-5 h-5"}):l.jsx(Dn,{className:"w-5 h-5"})})]})})}),l.jsxs("div",{style:{paddingTop:"calc(env(safe-area-inset-top) + 5rem)"},children:[k.length>0&&l.jsxs("div",{className:"mb-10 px-4 pt-4",children:[l.jsxs("h2",{className:"text-xl font-bold text-white mb-4",children:["Albums (",k.length,")"]}),l.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-4",children:k.map(M=>{const U=M.ProductionYear||(M.PremiereDate?new Date(M.PremiereDate).getFullYear():null);return l.jsx(my,{album:M,year:U,onNavigate:q=>t(`/album/${q}`),onContextMenu:q=>{w(q),S("album"),y(!0)}},M.Id)})})]}),f.length>0&&l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-bold text-white mb-2 px-4",children:["Songs (",f.length,")"]}),l.jsx("div",{className:"space-y-0",children:A.map(({artist:M,albums:U})=>l.jsx("div",{children:U.map(({albumId:q,albumName:se,songs:X})=>l.jsx("div",{children:X.map(F=>l.jsx(Xf,{song:F},F.Id))},q))},M))})]})]}),l.jsx(Be,{item:g,itemType:j,isOpen:N,onClose:()=>{y(!1),w(null),S(null)}})]})}function py(){const{pathname:e}=en();return p.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"})},[e]),null}function gy(){const{isAuthenticated:e,logout:t}=Li(),{pageVisibility:n}=ks();return p.useEffect(()=>{e&&window.location.search.includes("logout=true")&&(t(),window.location.search="")},[e]),e?l.jsxs(Cg,{children:[l.jsx(py,{}),l.jsx(j0,{children:l.jsxs(vg,{children:[l.jsx(mt,{path:"/",element:l.jsx(P0,{})}),l.jsx(mt,{path:"/settings",element:l.jsx(ay,{})}),n.artists&&l.jsxs(l.Fragment,{children:[l.jsx(mt,{path:"/artists",element:l.jsx(D0,{})}),l.jsx(mt,{path:"/artist/:id",element:l.jsx(uy,{})})]}),n.albums&&l.jsxs(l.Fragment,{children:[l.jsx(mt,{path:"/albums",element:l.jsx(H0,{})}),l.jsx(mt,{path:"/album/:id",element:l.jsx(fy,{})})]}),n.songs&&l.jsx(mt,{path:"/songs",element:l.jsx(K0,{})}),n.genres&&l.jsxs(l.Fragment,{children:[l.jsx(mt,{path:"/genres",element:l.jsx(J0,{})}),l.jsx(mt,{path:"/genre/:id",element:l.jsx(hy,{})})]}),n.playlists&&l.jsxs(l.Fragment,{children:[l.jsx(mt,{path:"/playlists",element:l.jsx(ry,{})}),l.jsx(mt,{path:"/playlist/:id",element:l.jsx(ly,{})})]}),l.jsx(mt,{path:"*",element:l.jsx(xg,{to:"/",replace:!0})})]})})]}):l.jsx(fx,{})}class xy extends p.Component{constructor(){super(...arguments);An(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Uncaught error:",n,r)}render(){var n;return this.state.hasError?l.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center p-4",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Something went wrong"}),l.jsx("p",{className:"text-gray-400 mb-4",children:(n=this.state.error)==null?void 0:n.message}),l.jsx("button",{onClick:()=>{localStorage.clear(),window.location.reload()},className:"bg-[var(--accent-color)] hover:brightness-90 text-white font-semibold py-2 px-4 rounded-lg transition-colors",children:"Clear Data & Reload"})]})}):this.props.children}}Do.createRoot(document.getElementById("root")).render(l.jsx(Oa.StrictMode,{children:l.jsx(xy,{children:l.jsx(gy,{})})}));
